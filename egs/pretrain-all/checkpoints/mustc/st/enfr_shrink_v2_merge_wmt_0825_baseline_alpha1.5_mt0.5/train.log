2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:14652
2023-08-25 11:51:45 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:14652
2023-08-25 11:51:46 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:14652
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-25 11:51:46 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-25 11:51:47 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-25 11:51:50 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:14652', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 11000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 11000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=False, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=1.0, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=0.0, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=True, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=False, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=1.0, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=0.0, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=True, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=False, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=1.0, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=0.0, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=True, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-25 11:51:50 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 9,999
2023-08-25 11:51:50 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 9,999
2023-08-25 11:51:50 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-25 11:51:50 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-25 11:51:50 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-25 11:51:54 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-25 11:51:54 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_enfr_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-25 11:51:54 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-25 11:51:56 | INFO | root | load pretrained hubert
2023-08-25 11:52:04 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-25 11:52:07 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-25 11:52:14 | INFO | root | load pretrained decoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-25 11:52:14 | INFO | root | share the sematic adapter and textual encoder
2023-08-25 11:52:14 | INFO | fairseq_cli.train | S2TJoint(
  (acoustic_encoder): AcousticEncoder(
    (compress_ffn): Linear(in_features=768, out_features=512, bias=True)
    (proj): Linear(in_features=512, out_features=9999, bias=False)
    (w2v_model): HubertModel(
      (feature_extractor): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Fp32GroupNorm(512, 512, eps=1e-05, affine=True)
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
        )
      )
      (post_extract_proj): Linear(in_features=512, out_features=768, bias=True)
      (dropout_input): Dropout(p=0.0, inplace=False)
      (dropout_features): Dropout(p=0.1, inplace=False)
      (encoder): TransformerEncoder(
        (pos_conv): Sequential(
          (0): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
          (1): SamePad()
          (2): GELU(approximate='none')
        )
        (layers): ModuleList(
          (0-11): 12 x TransformerSentenceEncoderLayer(
            (self_attn): MultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
            (dropout3): Dropout(p=0.1, inplace=False)
            (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
          )
        )
        (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      (final_proj): None
    )
    (noad): NormalAdapter(
      (subsample): Conv1dSubsampler(
        (conv_layers): ModuleList(
          (0): Conv1d(512, 512, kernel_size=(5,), stride=(2,), padding=(2,))
          (1): Conv1d(256, 1024, kernel_size=(5,), stride=(2,), padding=(2,))
        )
      )
      (layers): ModuleList()
    )
    (sead): SemanticAdapter(
      (embed_positions): SinusoidalPositionalEmbedding()
      (layers): ModuleList(
        (0-5): 6 x TransformerEncoderLayerBase(
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        )
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    )
    (final_dropout): Dropout(p=0.1, inplace=False)
    (shrink_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (textual_encoder): MTModelEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayerBase(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoderScriptable(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=512, out_features=9999, bias=False)
  )
  (task_net): TaskNetwork(
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (down_proj): Linear(in_features=512, out_features=256, bias=True)
    (up_proj): Linear(in_features=256, out_features=512, bias=True)
    (dropout_module): FairseqDropout()
    (task_proj): Linear(in_features=512, out_features=1, bias=False)
  )
)
2023-08-25 11:52:14 | INFO | fairseq_cli.train | task: JointTriplePretrainingMergeTask
2023-08-25 11:52:14 | INFO | fairseq_cli.train | model: S2TJoint
2023-08-25 11:52:14 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropywithW2vCtcShrinkJointATMerge
2023-08-25 11:52:14 | INFO | fairseq_cli.train | num. shared model params: 147,043,968 (num. trained: 147,043,968)
2023-08-25 11:52:14 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2023-08-25 11:52:14 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-25 11:52:14 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-25 11:52:14 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-25 11:52:14 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="dev_st", n_samples=1408, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-25 11:52:29 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:2 to store for rank: 0
2023-08-25 11:52:29 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- textual_encoder.embed_tokens.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.embed_tokens.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.output_projection.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.0.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.1.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.2.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.3.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.4.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.5.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.6.0.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- decoder.output_projection.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- task_net.task_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.weight <- textual_encoder.layers.0.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.bias <- textual_encoder.layers.0.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.weight <- textual_encoder.layers.0.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.bias <- textual_encoder.layers.0.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.weight <- textual_encoder.layers.0.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.bias <- textual_encoder.layers.0.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.weight <- textual_encoder.layers.0.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.bias <- textual_encoder.layers.0.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.weight <- textual_encoder.layers.0.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.bias <- textual_encoder.layers.0.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.weight <- textual_encoder.layers.0.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.bias <- textual_encoder.layers.0.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.weight <- textual_encoder.layers.0.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.bias <- textual_encoder.layers.0.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.weight <- textual_encoder.layers.0.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.bias <- textual_encoder.layers.0.final_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.weight <- textual_encoder.layers.1.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.bias <- textual_encoder.layers.1.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.weight <- textual_encoder.layers.1.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.bias <- textual_encoder.layers.1.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.weight <- textual_encoder.layers.1.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.bias <- textual_encoder.layers.1.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.weight <- textual_encoder.layers.1.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.bias <- textual_encoder.layers.1.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.weight <- textual_encoder.layers.1.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.bias <- textual_encoder.layers.1.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.weight <- textual_encoder.layers.1.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.bias <- textual_encoder.layers.1.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.weight <- textual_encoder.layers.1.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.bias <- textual_encoder.layers.1.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.weight <- textual_encoder.layers.1.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.bias <- textual_encoder.layers.1.final_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.weight <- textual_encoder.layers.2.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.bias <- textual_encoder.layers.2.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.weight <- textual_encoder.layers.2.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.bias <- textual_encoder.layers.2.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.weight <- textual_encoder.layers.2.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.bias <- textual_encoder.layers.2.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.weight <- textual_encoder.layers.2.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.bias <- textual_encoder.layers.2.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.weight <- textual_encoder.layers.2.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.bias <- textual_encoder.layers.2.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.weight <- textual_encoder.layers.2.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.bias <- textual_encoder.layers.2.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.weight <- textual_encoder.layers.2.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.bias <- textual_encoder.layers.2.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.weight <- textual_encoder.layers.2.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.bias <- textual_encoder.layers.2.final_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.weight <- textual_encoder.layers.3.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.bias <- textual_encoder.layers.3.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.weight <- textual_encoder.layers.3.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.bias <- textual_encoder.layers.3.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.weight <- textual_encoder.layers.3.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.bias <- textual_encoder.layers.3.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.weight <- textual_encoder.layers.3.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.bias <- textual_encoder.layers.3.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.weight <- textual_encoder.layers.3.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.bias <- textual_encoder.layers.3.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.weight <- textual_encoder.layers.3.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.bias <- textual_encoder.layers.3.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.weight <- textual_encoder.layers.3.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.bias <- textual_encoder.layers.3.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.weight <- textual_encoder.layers.3.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.bias <- textual_encoder.layers.3.final_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.weight <- textual_encoder.layers.4.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.bias <- textual_encoder.layers.4.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.weight <- textual_encoder.layers.4.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.bias <- textual_encoder.layers.4.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.weight <- textual_encoder.layers.4.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.bias <- textual_encoder.layers.4.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.weight <- textual_encoder.layers.4.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.bias <- textual_encoder.layers.4.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.weight <- textual_encoder.layers.4.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.bias <- textual_encoder.layers.4.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.weight <- textual_encoder.layers.4.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.bias <- textual_encoder.layers.4.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.weight <- textual_encoder.layers.4.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.bias <- textual_encoder.layers.4.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.weight <- textual_encoder.layers.4.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.bias <- textual_encoder.layers.4.final_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.weight <- textual_encoder.layers.5.self_attn.k_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.bias <- textual_encoder.layers.5.self_attn.k_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.weight <- textual_encoder.layers.5.self_attn.v_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.bias <- textual_encoder.layers.5.self_attn.v_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.weight <- textual_encoder.layers.5.self_attn.q_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.bias <- textual_encoder.layers.5.self_attn.q_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.weight <- textual_encoder.layers.5.self_attn.out_proj.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.bias <- textual_encoder.layers.5.self_attn.out_proj.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.weight <- textual_encoder.layers.5.self_attn_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.bias <- textual_encoder.layers.5.self_attn_layer_norm.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.weight <- textual_encoder.layers.5.fc1.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.bias <- textual_encoder.layers.5.fc1.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.weight <- textual_encoder.layers.5.fc2.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.bias <- textual_encoder.layers.5.fc2.bias
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.weight <- textual_encoder.layers.5.final_layer_norm.weight
2023-08-25 11:52:29 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.bias <- textual_encoder.layers.5.final_layer_norm.bias
2023-08-25 11:52:30 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   1: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   2: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   3: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   4: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   5: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   6: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | rank   7: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-25 11:52:30 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-25 11:52:30 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)
2023-08-25 11:52:30 | INFO | fairseq_cli.train | max tokens per device = 11000 and max sentences per device = None
2023-08-25 11:52:30 | INFO | fairseq.trainer | Preparing to load checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 11:52:30 | INFO | fairseq.trainer | No existing checkpoint found ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 11:52:30 | INFO | fairseq.trainer | loading train data for epoch 1
2023-08-25 11:52:30 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-25 11:52:30 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-25 11:52:30 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-25 11:52:32 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_asr", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-25 11:52:34 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_st", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-25 11:53:24 | INFO | fairseq.optim.adam | using FusedAdam
2023-08-25 11:53:24 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 11:53:24 | INFO | fairseq.trainer | begin training epoch 1
2023-08-25 11:53:24 | INFO | fairseq_cli.train | Start iterating over samples
True False
None None None
2023-08-25 11:53:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
2023-08-25 11:55:46 | INFO | train_inner | epoch 001:    101 / 1191 loss=20.422, trans_loss=6.402, nll_loss=5.176, w2v_ctc_loss=21.912, task_loss=0, contrastive_loss=3.586, total=6744.77, n_correct=205.7, ppl=36.15, accuracy=3.05, wps=17818.2, ups=0.91, wpb=19532.8, bsz=684.7, num_updates=100, lr=4.098e-06, gnorm=1.708, clip=0, loss_scale=64, train_wall=132, gb_free=17.7, wall=196
2023-08-25 11:56:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-25 11:58:05 | INFO | train_inner | epoch 001:    202 / 1191 loss=16.804, trans_loss=6.323, nll_loss=5.121, w2v_ctc_loss=16.387, task_loss=0, contrastive_loss=3.658, total=6674.03, n_correct=191.72, ppl=34.8, accuracy=2.873, wps=13925, ups=0.72, wpb=19342.6, bsz=676.8, num_updates=200, lr=8.096e-06, gnorm=6.357, clip=24, loss_scale=32, train_wall=138, gb_free=17.8, wall=335
2023-08-25 12:00:13 | INFO | train_inner | epoch 001:    302 / 1191 loss=11.666, trans_loss=6.242, nll_loss=5.076, w2v_ctc_loss=8.419, task_loss=0, contrastive_loss=3.757, total=6864.64, n_correct=203.97, ppl=33.73, accuracy=2.971, wps=15475.2, ups=0.78, wpb=19894.5, bsz=719.8, num_updates=300, lr=1.2094e-05, gnorm=1.662, clip=0, loss_scale=32, train_wall=128, gb_free=18.2, wall=464
2023-08-25 12:02:20 | INFO | train_inner | epoch 001:    402 / 1191 loss=10.966, trans_loss=6.193, nll_loss=5.051, w2v_ctc_loss=7.54, task_loss=0, contrastive_loss=3.614, total=6664.2, n_correct=187.06, ppl=33.15, accuracy=2.807, wps=15210.2, ups=0.79, wpb=19324, bsz=657.6, num_updates=400, lr=1.6092e-05, gnorm=0.843, clip=0, loss_scale=32, train_wall=87, gb_free=17.9, wall=591
2023-08-25 12:04:30 | INFO | train_inner | epoch 001:    502 / 1191 loss=10.718, trans_loss=6.163, nll_loss=5.027, w2v_ctc_loss=7.186, task_loss=0, contrastive_loss=3.625, total=6743.88, n_correct=184.15, ppl=32.59, accuracy=2.731, wps=15109.9, ups=0.77, wpb=19536.7, bsz=687.8, num_updates=500, lr=2.009e-05, gnorm=0.765, clip=0, loss_scale=32, train_wall=128, gb_free=17.7, wall=720
2023-08-25 12:06:41 | INFO | train_inner | epoch 001:    602 / 1191 loss=10.563, trans_loss=6.1, nll_loss=4.959, w2v_ctc_loss=7.048, task_loss=0, contrastive_loss=3.565, total=6761.26, n_correct=174.52, ppl=31.11, accuracy=2.581, wps=14889.1, ups=0.76, wpb=19590.9, bsz=685.7, num_updates=600, lr=2.4088e-05, gnorm=1.018, clip=0, loss_scale=32, train_wall=131, gb_free=19, wall=852
2023-08-25 12:08:45 | INFO | train_inner | epoch 001:    702 / 1191 loss=10.402, trans_loss=6.023, nll_loss=4.874, w2v_ctc_loss=6.915, task_loss=0, contrastive_loss=3.583, total=6642.51, n_correct=154.38, ppl=29.33, accuracy=2.324, wps=15615, ups=0.81, wpb=19237.1, bsz=677.7, num_updates=700, lr=2.8086e-05, gnorm=1.034, clip=0, loss_scale=32, train_wall=56, gb_free=17.6, wall=975
2023-08-25 12:09:32 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 12:10:56 | INFO | train_inner | epoch 001:    803 / 1191 loss=10.245, trans_loss=5.881, nll_loss=4.723, w2v_ctc_loss=6.813, task_loss=0, contrastive_loss=3.561, total=6735.78, n_correct=136.85, ppl=26.42, accuracy=2.032, wps=14806.1, ups=0.76, wpb=19507.2, bsz=685.7, num_updates=800, lr=3.2084e-05, gnorm=1.378, clip=0, loss_scale=16, train_wall=74, gb_free=18.3, wall=1107
2023-08-25 12:13:07 | INFO | train_inner | epoch 001:    903 / 1191 loss=9.263, trans_loss=5.829, nll_loss=4.658, w2v_ctc_loss=5.394, task_loss=0, contrastive_loss=3.55, total=6706.37, n_correct=49.47, ppl=25.25, accuracy=0.738, wps=14846, ups=0.76, wpb=19433.6, bsz=675.8, num_updates=900, lr=3.6082e-05, gnorm=0.893, clip=0, loss_scale=16, train_wall=81, gb_free=17.6, wall=1238
2023-08-25 12:15:07 | INFO | train_inner | epoch 001:   1003 / 1191 loss=9.01, trans_loss=5.836, nll_loss=4.667, w2v_ctc_loss=5.032, task_loss=0, contrastive_loss=3.528, total=6668.9, n_correct=37.9, ppl=25.41, accuracy=0.568, wps=16080.9, ups=0.83, wpb=19321.9, bsz=662.2, num_updates=1000, lr=4.008e-05, gnorm=0.492, clip=0, loss_scale=16, train_wall=83, gb_free=18.6, wall=1358
2023-08-25 12:17:11 | INFO | train_inner | epoch 001:   1103 / 1191 loss=8.698, trans_loss=5.841, nll_loss=4.673, w2v_ctc_loss=4.573, task_loss=0, contrastive_loss=3.475, total=6578.13, n_correct=30.78, ppl=25.51, accuracy=0.468, wps=15453.2, ups=0.81, wpb=19050.5, bsz=647.4, num_updates=1100, lr=4.4078e-05, gnorm=0.635, clip=0, loss_scale=16, train_wall=123, gb_free=17.6, wall=1481
2023-08-25 12:19:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2023-08-25 12:19:44 | INFO | dev_st | epoch 001 | valid on 'dev_st' subset | loss 11.946 | trans_loss 12.105 | nll_loss 11.458 | w2v_ctc_loss 5.542 | task_loss 0 | contrastive_loss 5.157 | total 6138.43 | n_correct 34.5714 | ppl 2812.82 | accuracy 0.563 | uer 73 | wer 70.744 | raw_wer 70.744 | bleu 0 | wps 1129 | wpb 6138.4 | bsz 201.1 | num_updates 1188
2023-08-25 12:19:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 1188 updates
2023-08-25 12:19:44 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:19:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:19:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 1 @ 1188 updates, score 0.0) (writing took 3.757271949000824 seconds)
2023-08-25 12:19:48 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-08-25 12:19:48 | INFO | train | epoch 001 | loss 11.478 | trans_loss 6.059 | nll_loss 4.893 | w2v_ctc_loss 8.51 | task_loss 0 | contrastive_loss 3.59 | total 6702.67 | n_correct 133.316 | ppl 29.71 | accuracy 1.989 | wps 14865.3 | ups 0.77 | wpb 19419.6 | bsz 678.1 | num_updates 1188 | lr 4.75962e-05 | gnorm 1.464 | clip 2 | loss_scale 16 | train_wall 1240 | gb_free 18.5 | wall 1638
2023-08-25 12:19:48 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 12:19:48 | INFO | fairseq.trainer | begin training epoch 2
2023-08-25 12:19:48 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 12:20:03 | INFO | train_inner | epoch 002:     12 / 1191 loss=8.484, trans_loss=5.833, nll_loss=4.665, w2v_ctc_loss=4.202, task_loss=0, contrastive_loss=3.57, total=6631.26, n_correct=31.46, ppl=25.37, accuracy=0.474, wps=11154.1, ups=0.58, wpb=19218.6, bsz=679.5, num_updates=1200, lr=4.8076e-05, gnorm=0.711, clip=0, loss_scale=16, train_wall=86, gb_free=17.5, wall=1653
2023-08-25 12:21:06 | INFO | train_inner | epoch 002:    112 / 1191 loss=8.261, trans_loss=5.832, nll_loss=4.662, w2v_ctc_loss=3.915, task_loss=0, contrastive_loss=3.509, total=6617.43, n_correct=39.02, ppl=25.31, accuracy=0.59, wps=30450.1, ups=1.59, wpb=19164.1, bsz=662.2, num_updates=1300, lr=5.2074e-05, gnorm=0.698, clip=0, loss_scale=16, train_wall=62, gb_free=17.6, wall=1716
2023-08-25 12:22:10 | INFO | train_inner | epoch 002:    212 / 1191 loss=8.121, trans_loss=5.815, nll_loss=4.643, w2v_ctc_loss=3.697, task_loss=0, contrastive_loss=3.497, total=6716.9, n_correct=52.67, ppl=24.98, accuracy=0.784, wps=30322.4, ups=1.56, wpb=19456.2, bsz=672.8, num_updates=1400, lr=5.6072e-05, gnorm=0.724, clip=0, loss_scale=16, train_wall=63, gb_free=17.5, wall=1780
2023-08-25 12:23:13 | INFO | train_inner | epoch 002:    312 / 1191 loss=8.03, trans_loss=5.823, nll_loss=4.662, w2v_ctc_loss=3.523, task_loss=0, contrastive_loss=3.494, total=6776.25, n_correct=76.96, ppl=25.31, accuracy=1.136, wps=31111, ups=1.58, wpb=19634.6, bsz=690.8, num_updates=1500, lr=6.007e-05, gnorm=0.706, clip=0, loss_scale=16, train_wall=62, gb_free=18, wall=1844
2023-08-25 12:24:16 | INFO | train_inner | epoch 002:    412 / 1191 loss=7.944, trans_loss=5.845, nll_loss=4.697, w2v_ctc_loss=3.384, task_loss=0, contrastive_loss=3.516, total=6718.15, n_correct=108.18, ppl=25.94, accuracy=1.61, wps=30937.2, ups=1.59, wpb=19472.2, bsz=690.8, num_updates=1600, lr=6.4068e-05, gnorm=0.83, clip=0, loss_scale=16, train_wall=62, gb_free=17.8, wall=1907
2023-08-25 12:25:19 | INFO | train_inner | epoch 002:    512 / 1191 loss=7.84, trans_loss=5.854, nll_loss=4.703, w2v_ctc_loss=3.273, task_loss=0, contrastive_loss=3.493, total=6696.54, n_correct=133.49, ppl=26.05, accuracy=1.993, wps=30890.6, ups=1.59, wpb=19408.7, bsz=678.7, num_updates=1700, lr=6.8066e-05, gnorm=0.684, clip=0, loss_scale=16, train_wall=62, gb_free=18.1, wall=1969
2023-08-25 12:26:22 | INFO | train_inner | epoch 002:    612 / 1191 loss=7.744, trans_loss=5.897, nll_loss=4.742, w2v_ctc_loss=3.15, task_loss=0, contrastive_loss=3.418, total=6640.77, n_correct=150.1, ppl=26.76, accuracy=2.26, wps=30719.1, ups=1.6, wpb=19228.2, bsz=659.1, num_updates=1800, lr=7.2064e-05, gnorm=0.677, clip=0, loss_scale=16, train_wall=62, gb_free=17.8, wall=2032
2023-08-25 12:27:24 | INFO | train_inner | epoch 002:    712 / 1191 loss=7.741, trans_loss=5.941, nll_loss=4.796, w2v_ctc_loss=3.068, task_loss=0, contrastive_loss=3.431, total=6799.78, n_correct=163.02, ppl=27.77, accuracy=2.397, wps=31328.1, ups=1.59, wpb=19685.9, bsz=701.6, num_updates=1900, lr=7.6062e-05, gnorm=0.713, clip=0, loss_scale=16, train_wall=62, gb_free=17.9, wall=2095
2023-08-25 12:28:27 | INFO | train_inner | epoch 002:    812 / 1191 loss=7.66, trans_loss=5.942, nll_loss=4.803, w2v_ctc_loss=3, task_loss=0, contrastive_loss=3.328, total=6729.15, n_correct=171.49, ppl=27.91, accuracy=2.548, wps=31080.6, ups=1.59, wpb=19495.9, bsz=677.7, num_updates=2000, lr=8.006e-05, gnorm=0.701, clip=0, loss_scale=16, train_wall=62, gb_free=17.8, wall=2158
2023-08-25 12:28:27 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 12:29:03 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 11.729 | trans_loss 12.684 | nll_loss 12.242 | w2v_ctc_loss 3.825 | task_loss 0 | contrastive_loss 4.842 | total 6138.43 | n_correct 148.429 | ppl 4844.68 | accuracy 2.418 | uer 54.43 | wer 53.358 | raw_wer 53.358 | bleu 0 | wps 1680.7 | wpb 6138.4 | bsz 201.1 | num_updates 2000 | best_bleu 0
2023-08-25 12:29:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2000 updates
2023-08-25 12:29:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_2_2000.pt
2023-08-25 12:29:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_2_2000.pt
2023-08-25 12:29:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.0) (writing took 11.306242530000418 seconds)
2023-08-25 12:30:16 | INFO | train_inner | epoch 002:    912 / 1191 loss=7.611, trans_loss=5.957, nll_loss=4.824, w2v_ctc_loss=2.937, task_loss=0, contrastive_loss=3.385, total=6738.95, n_correct=162.4, ppl=28.33, accuracy=2.41, wps=17889.3, ups=0.92, wpb=19533.2, bsz=703.8, num_updates=2100, lr=8.4058e-05, gnorm=0.746, clip=0, loss_scale=16, train_wall=62, gb_free=17.9, wall=2267
2023-08-25 12:31:20 | INFO | train_inner | epoch 002:   1012 / 1191 loss=7.532, trans_loss=5.959, nll_loss=4.826, w2v_ctc_loss=2.896, task_loss=0, contrastive_loss=3.271, total=6774.79, n_correct=173.42, ppl=28.37, accuracy=2.56, wps=31069.3, ups=1.58, wpb=19640.8, bsz=687.3, num_updates=2200, lr=8.8056e-05, gnorm=0.678, clip=0, loss_scale=16, train_wall=62, gb_free=18.1, wall=2330
2023-08-25 12:32:22 | INFO | train_inner | epoch 002:   1112 / 1191 loss=7.429, trans_loss=5.957, nll_loss=4.82, w2v_ctc_loss=2.85, task_loss=0, contrastive_loss=3.178, total=6659.17, n_correct=170.97, ppl=28.24, accuracy=2.567, wps=30753.2, ups=1.59, wpb=19287, bsz=656.7, num_updates=2300, lr=9.2054e-05, gnorm=0.692, clip=0, loss_scale=16, train_wall=62, gb_free=18.4, wall=2393
2023-08-25 12:33:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 12:33:46 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 11.545 | trans_loss 12.665 | nll_loss 12.208 | w2v_ctc_loss 3.627 | task_loss 0 | contrastive_loss 4.518 | total 6138.43 | n_correct 154.571 | ppl 4729.89 | accuracy 2.518 | uer 51.125 | wer 51.499 | raw_wer 51.499 | bleu 0 | wps 1742.9 | wpb 6138.4 | bsz 201.1 | num_updates 2379 | best_bleu 0
2023-08-25 12:33:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2379 updates
2023-08-25 12:33:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:33:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:33:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 2 @ 2379 updates, score 0.0) (writing took 12.167563656000311 seconds)
2023-08-25 12:33:59 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-08-25 12:33:59 | INFO | train | epoch 002 | loss 7.786 | trans_loss 5.895 | nll_loss 4.746 | w2v_ctc_loss 3.225 | task_loss 0 | contrastive_loss 3.398 | total 6703.69 | n_correct 128.982 | ppl 26.84 | accuracy 1.924 | wps 27194.4 | ups 1.4 | wpb 19422.7 | bsz 678.2 | num_updates 2379 | lr 9.52124e-05 | gnorm 0.719 | clip 0 | loss_scale 16 | train_wall 741 | gb_free 17.7 | wall 2489
2023-08-25 12:33:59 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 12:33:59 | INFO | fairseq.trainer | begin training epoch 3
2023-08-25 12:33:59 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 12:34:19 | INFO | train_inner | epoch 003:     21 / 1191 loss=7.359, trans_loss=5.938, nll_loss=4.801, w2v_ctc_loss=2.828, task_loss=0, contrastive_loss=3.177, total=6599.17, n_correct=163.33, ppl=27.88, accuracy=2.475, wps=16391.2, ups=0.86, wpb=19129.9, bsz=657.1, num_updates=2400, lr=9.6052e-05, gnorm=0.775, clip=0, loss_scale=16, train_wall=62, gb_free=18.1, wall=2509
2023-08-25 12:35:22 | INFO | train_inner | epoch 003:    121 / 1191 loss=7.311, trans_loss=5.927, nll_loss=4.789, w2v_ctc_loss=2.779, task_loss=0, contrastive_loss=3.142, total=6686.57, n_correct=166.14, ppl=27.64, accuracy=2.485, wps=30606.1, ups=1.58, wpb=19387.8, bsz=684.3, num_updates=2500, lr=0.00010005, gnorm=0.735, clip=0, loss_scale=16, train_wall=63, gb_free=18.7, wall=2573
2023-08-25 12:36:26 | INFO | train_inner | epoch 003:    221 / 1191 loss=7.217, trans_loss=5.923, nll_loss=4.782, w2v_ctc_loss=2.72, task_loss=0, contrastive_loss=3.073, total=6719.64, n_correct=176.66, ppl=27.52, accuracy=2.629, wps=30792.7, ups=1.58, wpb=19473.2, bsz=686.5, num_updates=2600, lr=0.000104048, gnorm=0.736, clip=0, loss_scale=16, train_wall=63, gb_free=18.8, wall=2636
2023-08-25 12:37:28 | INFO | train_inner | epoch 003:    321 / 1191 loss=7.076, trans_loss=5.908, nll_loss=4.761, w2v_ctc_loss=2.722, task_loss=0, contrastive_loss=2.893, total=6583.91, n_correct=168.39, ppl=27.11, accuracy=2.558, wps=30513.5, ups=1.6, wpb=19066, bsz=626, num_updates=2700, lr=0.000108046, gnorm=0.775, clip=0, loss_scale=16, train_wall=62, gb_free=17.7, wall=2698
2023-08-25 12:38:30 | INFO | train_inner | epoch 003:    421 / 1191 loss=7.063, trans_loss=5.905, nll_loss=4.762, w2v_ctc_loss=2.675, task_loss=0, contrastive_loss=2.972, total=6692.35, n_correct=166.8, ppl=27.12, accuracy=2.492, wps=31286.5, ups=1.61, wpb=19390.6, bsz=688.7, num_updates=2800, lr=0.000112044, gnorm=0.758, clip=0, loss_scale=32, train_wall=61, gb_free=17.5, wall=2760
2023-08-25 12:39:33 | INFO | train_inner | epoch 003:    521 / 1191 loss=6.976, trans_loss=5.884, nll_loss=4.734, w2v_ctc_loss=2.679, task_loss=0, contrastive_loss=2.799, total=6739.55, n_correct=179.33, ppl=26.6, accuracy=2.661, wps=31081.8, ups=1.59, wpb=19529.7, bsz=674.5, num_updates=2900, lr=0.000116042, gnorm=0.78, clip=0, loss_scale=32, train_wall=62, gb_free=17.9, wall=2823
2023-08-25 12:40:36 | INFO | train_inner | epoch 003:    621 / 1191 loss=6.893, trans_loss=5.876, nll_loss=4.724, w2v_ctc_loss=2.658, task_loss=0, contrastive_loss=2.721, total=6762.74, n_correct=178.57, ppl=26.42, accuracy=2.64, wps=31006.6, ups=1.58, wpb=19599.1, bsz=667.2, num_updates=3000, lr=0.00012004, gnorm=0.811, clip=0, loss_scale=32, train_wall=62, gb_free=17.6, wall=2886
2023-08-25 12:40:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 12:40:38 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-25 12:40:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
2023-08-25 12:40:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
2023-08-25 12:42:07 | INFO | train_inner | epoch 003:    725 / 1191 loss=5.857, trans_loss=5.047, nll_loss=3.664, w2v_ctc_loss=2.536, task_loss=0, contrastive_loss=2.364, total=6728.35, n_correct=746.81, ppl=12.67, accuracy=11.099, wps=21352.8, ups=1.1, wpb=19500.2, bsz=697.2, num_updates=3100, lr=0.000124038, gnorm=3.876, clip=5, loss_scale=2, train_wall=91, gb_free=13.8, wall=2978
2023-08-25 12:43:34 | INFO | train_inner | epoch 003:    825 / 1191 loss=4.768, trans_loss=4.24, nll_loss=2.595, w2v_ctc_loss=2.349, task_loss=0, contrastive_loss=1.85, total=6796.98, n_correct=2050.26, ppl=6.04, accuracy=30.164, wps=22786, ups=1.16, wpb=19702, bsz=714.8, num_updates=3200, lr=0.000128036, gnorm=2.324, clip=0, loss_scale=2, train_wall=86, gb_free=13.8, wall=3064
2023-08-25 12:44:59 | INFO | train_inner | epoch 003:    925 / 1191 loss=4.258, trans_loss=4.077, nll_loss=2.385, w2v_ctc_loss=2.253, task_loss=0, contrastive_loss=1.426, total=6782.18, n_correct=2416.85, ppl=5.22, accuracy=35.635, wps=22974.9, ups=1.17, wpb=19644.8, bsz=706.4, num_updates=3300, lr=0.000132034, gnorm=2.111, clip=0, loss_scale=2, train_wall=85, gb_free=15.1, wall=3150
2023-08-25 12:46:27 | INFO | train_inner | epoch 003:   1025 / 1191 loss=3.876, trans_loss=4.052, nll_loss=2.355, w2v_ctc_loss=2.192, task_loss=0, contrastive_loss=1.029, total=6546.31, n_correct=2376.92, ppl=5.12, accuracy=36.309, wps=21687.5, ups=1.14, wpb=18971.5, bsz=618.8, num_updates=3400, lr=0.000136032, gnorm=1.789, clip=0, loss_scale=2, train_wall=87, gb_free=14.3, wall=3237
2023-08-25 12:47:54 | INFO | train_inner | epoch 003:   1125 / 1191 loss=3.629, trans_loss=4.026, nll_loss=2.319, w2v_ctc_loss=2.033, task_loss=0, contrastive_loss=0.905, total=6780.28, n_correct=2530.68, ppl=4.99, accuracy=37.324, wps=22469.1, ups=1.14, wpb=19627.7, bsz=710.5, num_updates=3500, lr=0.00014003, gnorm=1.761, clip=0, loss_scale=2, train_wall=87, gb_free=9.9, wall=3325
2023-08-25 12:48:52 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 12:49:27 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 5.779 | trans_loss 6.926 | nll_loss 4.732 | w2v_ctc_loss 2.275 | task_loss 0 | contrastive_loss 0.889 | total 6138.43 | n_correct 2381 | ppl 26.58 | accuracy 38.788 | uer 33.327 | wer 33.276 | raw_wer 33.276 | bleu 0.4 | wps 1480.6 | wpb 6138.4 | bsz 201.1 | num_updates 3566 | best_bleu 0.4
2023-08-25 12:49:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 3566 updates
2023-08-25 12:49:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:49:35 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 12:49:41 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 3 @ 3566 updates, score 0.4) (writing took 13.928902026998912 seconds)
2023-08-25 12:49:42 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-08-25 12:49:42 | INFO | train | epoch 003 | loss 5.792 | trans_loss 5.119 | nll_loss 3.741 | w2v_ctc_loss 2.482 | task_loss 0 | contrastive_loss 2.22 | total 6705.35 | n_correct 1080.46 | ppl 13.37 | accuracy 16.113 | wps 24455.9 | ups 1.26 | wpb 19427.5 | bsz 678.6 | num_updates 3566 | lr 0.000142669 | gnorm 1.494 | clip 0.4 | loss_scale 2 | train_wall 878 | gb_free 15.4 | wall 3432
2023-08-25 12:49:42 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 12:49:42 | INFO | fairseq.trainer | begin training epoch 4
2023-08-25 12:49:42 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 12:50:19 | INFO | train_inner | epoch 004:     34 / 1191 loss=3.404, trans_loss=4.017, nll_loss=2.308, w2v_ctc_loss=1.916, task_loss=0, contrastive_loss=0.706, total=6564.78, n_correct=2462.43, ppl=4.95, accuracy=37.51, wps=13134, ups=0.69, wpb=19000.8, bsz=644.2, num_updates=3600, lr=0.000144028, gnorm=1.626, clip=0, loss_scale=2, train_wall=87, gb_free=12.2, wall=3469
2023-08-25 12:51:46 | INFO | train_inner | epoch 004:    134 / 1191 loss=3.252, trans_loss=3.995, nll_loss=2.281, w2v_ctc_loss=1.808, task_loss=0, contrastive_loss=0.578, total=6736.4, n_correct=2563.43, ppl=4.86, accuracy=38.053, wps=22439.6, ups=1.15, wpb=19512.8, bsz=658, num_updates=3700, lr=0.000148026, gnorm=1.414, clip=0, loss_scale=2, train_wall=86, gb_free=12, wall=3556
2023-08-25 12:53:12 | INFO | train_inner | epoch 004:    234 / 1191 loss=3.209, trans_loss=3.987, nll_loss=2.271, w2v_ctc_loss=1.748, task_loss=0, contrastive_loss=0.702, total=6741.46, n_correct=2600.25, ppl=4.83, accuracy=38.571, wps=22596, ups=1.16, wpb=19536.2, bsz=701.1, num_updates=3800, lr=0.000152024, gnorm=1.38, clip=0, loss_scale=2, train_wall=86, gb_free=14.8, wall=3643
2023-08-25 12:54:38 | INFO | train_inner | epoch 004:    334 / 1191 loss=3.099, trans_loss=3.982, nll_loss=2.265, w2v_ctc_loss=1.703, task_loss=0, contrastive_loss=0.49, total=6665.94, n_correct=2586.65, ppl=4.81, accuracy=38.804, wps=22489.2, ups=1.16, wpb=19316.7, bsz=662.4, num_updates=3900, lr=0.000156022, gnorm=1.238, clip=0, loss_scale=2, train_wall=85, gb_free=13.3, wall=3729
2023-08-25 12:56:06 | INFO | train_inner | epoch 004:    434 / 1191 loss=3.072, trans_loss=3.965, nll_loss=2.243, w2v_ctc_loss=1.67, task_loss=0, contrastive_loss=0.603, total=6709.87, n_correct=2639.9, ppl=4.74, accuracy=39.344, wps=22249.3, ups=1.14, wpb=19443.9, bsz=683.5, num_updates=4000, lr=0.00016002, gnorm=1.165, clip=0, loss_scale=2, train_wall=87, gb_free=13.6, wall=3816
2023-08-25 12:56:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 12:56:39 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 5.475 | trans_loss 6.786 | nll_loss 4.55 | w2v_ctc_loss 1.919 | task_loss 0 | contrastive_loss 0.595 | total 6138.43 | n_correct 2500.14 | ppl 23.42 | accuracy 40.729 | uer 29.949 | wer 30.881 | raw_wer 30.881 | bleu 1.22 | wps 1634 | wpb 6138.4 | bsz 201.1 | num_updates 4000 | best_bleu 1.22
2023-08-25 12:56:39 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4000 updates
2023-08-25 12:56:39 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_4_4000.pt
2023-08-25 12:56:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_4_4000.pt
2023-08-25 12:56:51 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_4_4000.pt (epoch 4 @ 4000 updates, score 1.22) (writing took 12.111971960001028 seconds)
2023-08-25 12:58:18 | INFO | train_inner | epoch 004:    534 / 1191 loss=2.975, trans_loss=3.948, nll_loss=2.221, w2v_ctc_loss=1.622, task_loss=0, contrastive_loss=0.413, total=6689.54, n_correct=2665.05, ppl=4.66, accuracy=39.839, wps=14618.4, ups=0.75, wpb=19381.9, bsz=671.5, num_updates=4100, lr=0.000164018, gnorm=1.073, clip=0, loss_scale=2, train_wall=87, gb_free=14.1, wall=3949
2023-08-25 12:59:45 | INFO | train_inner | epoch 004:    634 / 1191 loss=2.95, trans_loss=3.93, nll_loss=2.198, w2v_ctc_loss=1.593, task_loss=0, contrastive_loss=0.494, total=6812.13, n_correct=2774.67, ppl=4.59, accuracy=40.731, wps=22629.9, ups=1.15, wpb=19744.8, bsz=706.1, num_updates=4200, lr=0.000168016, gnorm=1.071, clip=0, loss_scale=2, train_wall=87, gb_free=11.5, wall=4036
2023-08-25 13:01:11 | INFO | train_inner | epoch 004:    734 / 1191 loss=2.89, trans_loss=3.903, nll_loss=2.16, w2v_ctc_loss=1.549, task_loss=0, contrastive_loss=0.493, total=6701.57, n_correct=2813.24, ppl=4.47, accuracy=41.979, wps=22616.8, ups=1.17, wpb=19412.3, bsz=686.4, num_updates=4300, lr=0.000172014, gnorm=0.998, clip=0, loss_scale=2, train_wall=85, gb_free=14.1, wall=4122
2023-08-25 13:02:39 | INFO | train_inner | epoch 004:    834 / 1191 loss=2.822, trans_loss=3.854, nll_loss=2.096, w2v_ctc_loss=1.523, task_loss=0, contrastive_loss=0.464, total=6852.4, n_correct=3034.32, ppl=4.28, accuracy=44.281, wps=22704.6, ups=1.14, wpb=19846.6, bsz=720.7, num_updates=4400, lr=0.000176012, gnorm=0.977, clip=0, loss_scale=2, train_wall=87, gb_free=14.8, wall=4209
2023-08-25 13:04:05 | INFO | train_inner | epoch 004:    934 / 1191 loss=2.743, trans_loss=3.78, nll_loss=1.998, w2v_ctc_loss=1.502, task_loss=0, contrastive_loss=0.421, total=6741.87, n_correct=3211.2, ppl=4, accuracy=47.631, wps=22530.6, ups=1.15, wpb=19519.8, bsz=706.3, num_updates=4500, lr=0.00018001, gnorm=0.979, clip=0, loss_scale=2, train_wall=86, gb_free=14.2, wall=4296
2023-08-25 13:05:33 | INFO | train_inner | epoch 004:   1034 / 1191 loss=2.675, trans_loss=3.721, nll_loss=1.922, w2v_ctc_loss=1.503, task_loss=0, contrastive_loss=0.371, total=6629.56, n_correct=3331.9, ppl=3.79, accuracy=50.258, wps=21928.6, ups=1.14, wpb=19201.2, bsz=657.7, num_updates=4600, lr=0.000184008, gnorm=0.951, clip=0, loss_scale=2, train_wall=87, gb_free=14.6, wall=4383
2023-08-25 13:07:00 | INFO | train_inner | epoch 004:   1134 / 1191 loss=2.583, trans_loss=3.667, nll_loss=1.854, w2v_ctc_loss=1.471, task_loss=0, contrastive_loss=0.272, total=6577.33, n_correct=3452.85, ppl=3.62, accuracy=52.496, wps=22018.8, ups=1.15, wpb=19069.3, bsz=633.2, num_updates=4700, lr=0.000188006, gnorm=0.896, clip=0, loss_scale=2, train_wall=86, gb_free=12.5, wall=4470
2023-08-25 13:07:49 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 13:08:22 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 4.545 | trans_loss 5.639 | nll_loss 3.039 | w2v_ctc_loss 1.66 | task_loss 0 | contrastive_loss 0.443 | total 6138.43 | n_correct 3632.43 | ppl 8.22 | accuracy 59.175 | uer 25.925 | wer 26.962 | raw_wer 26.962 | bleu 15.26 | wps 1626.1 | wpb 6138.4 | bsz 201.1 | num_updates 4757 | best_bleu 15.26
2023-08-25 13:08:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4757 updates
2023-08-25 13:08:22 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:08:28 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:08:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 4 @ 4757 updates, score 15.26) (writing took 10.905271625999376 seconds)
2023-08-25 13:08:33 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-08-25 13:08:33 | INFO | train | epoch 004 | loss 2.928 | trans_loss 3.877 | nll_loss 2.127 | w2v_ctc_loss 1.609 | task_loss 0 | contrastive_loss 0.478 | total 6703.69 | n_correct 2900.01 | ppl 4.37 | accuracy 43.26 | wps 20442.8 | ups 1.05 | wpb 19422.7 | bsz 678.2 | num_updates 4757 | lr 0.000190285 | gnorm 1.106 | clip 0 | loss_scale 2 | train_wall 1026 | gb_free 13.6 | wall 4564
2023-08-25 13:08:33 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 13:08:33 | INFO | fairseq.trainer | begin training epoch 5
2023-08-25 13:08:33 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 13:09:17 | INFO | train_inner | epoch 005:     43 / 1191 loss=2.551, trans_loss=3.616, nll_loss=1.789, w2v_ctc_loss=1.434, task_loss=0, contrastive_loss=0.36, total=6757.75, n_correct=3685.94, ppl=3.46, accuracy=54.544, wps=14244.6, ups=0.73, wpb=19584.7, bsz=709.8, num_updates=4800, lr=0.000192004, gnorm=0.877, clip=0, loss_scale=2, train_wall=85, gb_free=14.7, wall=4607
2023-08-25 13:10:44 | INFO | train_inner | epoch 005:    143 / 1191 loss=2.496, trans_loss=3.593, nll_loss=1.758, w2v_ctc_loss=1.398, task_loss=0, contrastive_loss=0.349, total=6724.83, n_correct=3748.45, ppl=3.38, accuracy=55.74, wps=22381.7, ups=1.15, wpb=19483, bsz=681.8, num_updates=4900, lr=0.000196002, gnorm=0.865, clip=0, loss_scale=2, train_wall=86, gb_free=13.6, wall=4695
2023-08-25 13:12:11 | INFO | train_inner | epoch 005:    243 / 1191 loss=2.464, trans_loss=3.57, nll_loss=1.729, w2v_ctc_loss=1.382, task_loss=0, contrastive_loss=0.313, total=6862.8, n_correct=3905.09, ppl=3.32, accuracy=56.902, wps=22872.9, ups=1.15, wpb=19880.1, bsz=727.9, num_updates=5000, lr=0.0002, gnorm=0.833, clip=0, loss_scale=2, train_wall=86, gb_free=11.6, wall=4781
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:0')
2023-08-25 13:13:38 | INFO | train_inner | epoch 005:    343 / 1191 loss=2.419, trans_loss=3.55, nll_loss=1.703, w2v_ctc_loss=1.364, task_loss=0, contrastive_loss=0.302, total=6612.86, n_correct=3817.54, ppl=3.26, accuracy=57.729, wps=21938.6, ups=1.15, wpb=19159.2, bsz=660.7, num_updates=5100, lr=0.00019803, gnorm=0.525, clip=0, loss_scale=4, train_wall=87, gb_free=13.4, wall=4869
2023-08-25 13:15:05 | INFO | train_inner | epoch 005:    443 / 1191 loss=2.424, trans_loss=3.533, nll_loss=1.684, w2v_ctc_loss=1.37, task_loss=0, contrastive_loss=0.336, total=6682.75, n_correct=3896.01, ppl=3.21, accuracy=58.3, wps=22302.1, ups=1.15, wpb=19374.4, bsz=677.7, num_updates=5200, lr=0.000196116, gnorm=0.525, clip=0, loss_scale=4, train_wall=86, gb_free=13.7, wall=4956
2023-08-25 13:16:32 | INFO | train_inner | epoch 005:    543 / 1191 loss=2.407, trans_loss=3.52, nll_loss=1.665, w2v_ctc_loss=1.349, task_loss=0, contrastive_loss=0.386, total=6679.73, n_correct=3943.08, ppl=3.17, accuracy=59.031, wps=22236.2, ups=1.15, wpb=19347.8, bsz=678.8, num_updates=5300, lr=0.000194257, gnorm=0.52, clip=0, loss_scale=4, train_wall=86, gb_free=14.3, wall=5043
2023-08-25 13:17:58 | INFO | train_inner | epoch 005:    643 / 1191 loss=2.357, trans_loss=3.51, nll_loss=1.651, w2v_ctc_loss=1.337, task_loss=0, contrastive_loss=0.228, total=6696.14, n_correct=3994.88, ppl=3.14, accuracy=59.659, wps=22523.1, ups=1.16, wpb=19387.6, bsz=665.4, num_updates=5400, lr=0.00019245, gnorm=0.5, clip=0, loss_scale=4, train_wall=85, gb_free=13.9, wall=5129
2023-08-25 13:19:26 | INFO | train_inner | epoch 005:    743 / 1191 loss=2.363, trans_loss=3.493, nll_loss=1.633, w2v_ctc_loss=1.328, task_loss=0, contrastive_loss=0.33, total=6727.55, n_correct=4046.09, ppl=3.1, accuracy=60.142, wps=22236.2, ups=1.14, wpb=19498.5, bsz=687.8, num_updates=5500, lr=0.000190693, gnorm=0.495, clip=0, loss_scale=4, train_wall=87, gb_free=14.4, wall=5216
2023-08-25 13:20:53 | INFO | train_inner | epoch 005:    843 / 1191 loss=2.329, trans_loss=3.482, nll_loss=1.618, w2v_ctc_loss=1.307, task_loss=0, contrastive_loss=0.302, total=6763.54, n_correct=4098.38, ppl=3.07, accuracy=60.595, wps=22443.8, ups=1.15, wpb=19590.6, bsz=686.9, num_updates=5600, lr=0.000188982, gnorm=0.489, clip=0, loss_scale=4, train_wall=87, gb_free=14.1, wall=5304
2023-08-25 13:22:21 | INFO | train_inner | epoch 005:    943 / 1191 loss=2.32, trans_loss=3.482, nll_loss=1.619, w2v_ctc_loss=1.31, task_loss=0, contrastive_loss=0.282, total=6598.45, n_correct=4005.22, ppl=3.07, accuracy=60.699, wps=21836.5, ups=1.14, wpb=19124, bsz=655, num_updates=5700, lr=0.000187317, gnorm=0.493, clip=0, loss_scale=4, train_wall=87, gb_free=14.6, wall=5391
2023-08-25 13:23:48 | INFO | train_inner | epoch 005:   1043 / 1191 loss=2.3, trans_loss=3.474, nll_loss=1.608, w2v_ctc_loss=1.297, task_loss=0, contrastive_loss=0.259, total=6643.21, n_correct=4054.88, ppl=3.05, accuracy=61.038, wps=22100.6, ups=1.15, wpb=19245.1, bsz=648.6, num_updates=5800, lr=0.000185695, gnorm=0.482, clip=0, loss_scale=4, train_wall=86, gb_free=14.8, wall=5478
2023-08-25 13:25:15 | INFO | train_inner | epoch 005:   1143 / 1191 loss=2.302, trans_loss=3.468, nll_loss=1.601, w2v_ctc_loss=1.298, task_loss=0, contrastive_loss=0.276, total=6704.92, n_correct=4113.88, ppl=3.03, accuracy=61.356, wps=22422.8, ups=1.15, wpb=19427.4, bsz=670.9, num_updates=5900, lr=0.000184115, gnorm=0.49, clip=0, loss_scale=4, train_wall=86, gb_free=14, wall=5565
2023-08-25 13:25:56 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.4615, device='cuda:7')
2023-08-25 13:26:27 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.163 | trans_loss 5.212 | nll_loss 2.511 | w2v_ctc_loss 1.457 | task_loss 0 | contrastive_loss 0.362 | total 6138.43 | n_correct 4043.43 | ppl 5.7 | accuracy 65.871 | uer 22.654 | wer 23.912 | raw_wer 23.912 | bleu 23.06 | wps 1869.3 | wpb 6138.4 | bsz 201.1 | num_updates 5948 | best_bleu 23.06
2023-08-25 13:26:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 5948 updates
2023-08-25 13:26:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:26:33 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:26:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 5 @ 5948 updates, score 23.06) (writing took 10.358704173999286 seconds)
2023-08-25 13:26:38 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-08-25 13:26:38 | INFO | train | epoch 005 | loss 2.382 | trans_loss 3.517 | nll_loss 1.662 | w2v_ctc_loss 1.34 | task_loss 0 | contrastive_loss 0.31 | total 6703.69 | n_correct 3965.18 | ppl 3.16 | accuracy 59.149 | wps 21330.6 | ups 1.1 | wpb 19422.7 | bsz 678.2 | num_updates 5948 | lr 0.000183371 | gnorm 0.572 | clip 0 | loss_scale 4 | train_wall 1027 | gb_free 11.6 | wall 5648
2023-08-25 13:26:38 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 13:26:38 | INFO | fairseq.trainer | begin training epoch 6
2023-08-25 13:26:38 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 13:27:29 | INFO | train_inner | epoch 006:     52 / 1191 loss=2.249, trans_loss=3.44, nll_loss=1.566, w2v_ctc_loss=1.239, task_loss=0, contrastive_loss=0.298, total=6663.58, n_correct=4149.39, ppl=2.96, accuracy=62.27, wps=14336.5, ups=0.74, wpb=19308.8, bsz=664.4, num_updates=6000, lr=0.000182574, gnorm=0.466, clip=0, loss_scale=4, train_wall=85, gb_free=12.3, wall=5700
2023-08-25 13:27:29 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 13:28:00 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.172 | trans_loss 5.213 | nll_loss 2.514 | w2v_ctc_loss 1.491 | task_loss 0 | contrastive_loss 0.357 | total 6138.43 | n_correct 4039 | ppl 5.71 | accuracy 65.799 | uer 23.456 | wer 24.887 | raw_wer 24.887 | bleu 23.36 | wps 1849 | wpb 6138.4 | bsz 201.1 | num_updates 6000 | best_bleu 23.36
2023-08-25 13:28:00 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 6000 updates
2023-08-25 13:28:00 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_6_6000.pt
2023-08-25 13:28:02 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_6_6000.pt
2023-08-25 13:28:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_6_6000.pt (epoch 6 @ 6000 updates, score 23.36) (writing took 10.739055127000029 seconds)
2023-08-25 13:29:39 | INFO | train_inner | epoch 006:    152 / 1191 loss=2.216, trans_loss=3.436, nll_loss=1.558, w2v_ctc_loss=1.221, task_loss=0, contrastive_loss=0.242, total=6710.71, n_correct=4192.07, ppl=2.94, accuracy=62.468, wps=15012.1, ups=0.77, wpb=19428.5, bsz=674.5, num_updates=6100, lr=0.000181071, gnorm=0.459, clip=0, loss_scale=4, train_wall=87, gb_free=13.5, wall=5829
2023-08-25 13:31:06 | INFO | train_inner | epoch 006:    252 / 1191 loss=2.229, trans_loss=3.424, nll_loss=1.545, w2v_ctc_loss=1.216, task_loss=0, contrastive_loss=0.306, total=6837.1, n_correct=4301.08, ppl=2.92, accuracy=62.908, wps=22799.5, ups=1.15, wpb=19809.8, bsz=717.6, num_updates=6200, lr=0.000179605, gnorm=0.464, clip=0, loss_scale=4, train_wall=86, gb_free=13.8, wall=5916
2023-08-25 13:32:33 | INFO | train_inner | epoch 006:    352 / 1191 loss=2.202, trans_loss=3.428, nll_loss=1.548, w2v_ctc_loss=1.217, task_loss=0, contrastive_loss=0.203, total=6732.22, n_correct=4233.09, ppl=2.92, accuracy=62.878, wps=22223.9, ups=1.14, wpb=19495.9, bsz=678.5, num_updates=6300, lr=0.000178174, gnorm=0.452, clip=0, loss_scale=4, train_wall=87, gb_free=12.8, wall=6004
2023-08-25 13:33:59 | INFO | train_inner | epoch 006:    452 / 1191 loss=2.212, trans_loss=3.426, nll_loss=1.548, w2v_ctc_loss=1.226, task_loss=0, contrastive_loss=0.266, total=6555.97, n_correct=4120.09, ppl=2.92, accuracy=62.845, wps=22089.3, ups=1.16, wpb=18999.7, bsz=643.9, num_updates=6400, lr=0.000176777, gnorm=0.458, clip=0, loss_scale=4, train_wall=85, gb_free=12.3, wall=6090
2023-08-25 13:35:27 | INFO | train_inner | epoch 006:    552 / 1191 loss=2.176, trans_loss=3.414, nll_loss=1.534, w2v_ctc_loss=1.202, task_loss=0, contrastive_loss=0.19, total=6707.81, n_correct=4241.39, ppl=2.9, accuracy=63.231, wps=22308.3, ups=1.15, wpb=19445.6, bsz=669.8, num_updates=6500, lr=0.000175412, gnorm=0.446, clip=0, loss_scale=4, train_wall=86, gb_free=13.9, wall=6177
2023-08-25 13:36:54 | INFO | train_inner | epoch 006:    652 / 1191 loss=2.181, trans_loss=3.418, nll_loss=1.537, w2v_ctc_loss=1.193, task_loss=0, contrastive_loss=0.251, total=6667.25, n_correct=4219.92, ppl=2.9, accuracy=63.293, wps=22035.4, ups=1.14, wpb=19310.6, bsz=652.9, num_updates=6600, lr=0.000174078, gnorm=0.444, clip=0, loss_scale=4, train_wall=87, gb_free=14.3, wall=6265
2023-08-25 13:38:22 | INFO | train_inner | epoch 006:    752 / 1191 loss=2.207, trans_loss=3.409, nll_loss=1.526, w2v_ctc_loss=1.194, task_loss=0, contrastive_loss=0.328, total=6842.62, n_correct=4351.37, ppl=2.88, accuracy=63.592, wps=22554, ups=1.14, wpb=19824, bsz=722.5, num_updates=6700, lr=0.000172774, gnorm=0.454, clip=0, loss_scale=4, train_wall=87, gb_free=14.6, wall=6352
2023-08-25 13:39:49 | INFO | train_inner | epoch 006:    852 / 1191 loss=2.193, trans_loss=3.404, nll_loss=1.523, w2v_ctc_loss=1.199, task_loss=0, contrastive_loss=0.301, total=6631.09, n_correct=4219.68, ppl=2.87, accuracy=63.635, wps=22062.6, ups=1.15, wpb=19229.5, bsz=681.3, num_updates=6800, lr=0.000171499, gnorm=0.444, clip=0, loss_scale=4, train_wall=87, gb_free=13.4, wall=6440
2023-08-25 13:41:17 | INFO | train_inner | epoch 006:    952 / 1191 loss=2.175, trans_loss=3.412, nll_loss=1.53, w2v_ctc_loss=1.2, task_loss=0, contrastive_loss=0.226, total=6626, n_correct=4212.05, ppl=2.89, accuracy=63.569, wps=21956.3, ups=1.14, wpb=19192.3, bsz=634.2, num_updates=6900, lr=0.000170251, gnorm=0.44, clip=0, loss_scale=4, train_wall=87, gb_free=11.2, wall=6527
2023-08-25 13:42:43 | INFO | train_inner | epoch 006:   1052 / 1191 loss=2.165, trans_loss=3.399, nll_loss=1.515, w2v_ctc_loss=1.17, task_loss=0, contrastive_loss=0.295, total=6673.87, n_correct=4271.27, ppl=2.86, accuracy=64, wps=22306.4, ups=1.15, wpb=19342.2, bsz=669.1, num_updates=7000, lr=0.000169031, gnorm=0.44, clip=0, loss_scale=4, train_wall=86, gb_free=14.7, wall=6614
2023-08-25 13:44:09 | INFO | train_inner | epoch 006:   1152 / 1191 loss=2.135, trans_loss=3.393, nll_loss=1.508, w2v_ctc_loss=1.162, task_loss=0, contrastive_loss=0.175, total=6762.05, n_correct=4345.74, ppl=2.84, accuracy=64.267, wps=22808, ups=1.16, wpb=19598.4, bsz=712.9, num_updates=7100, lr=0.000167836, gnorm=0.441, clip=0, loss_scale=8, train_wall=85, gb_free=12.8, wall=6700
2023-08-25 13:44:43 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 13:45:14 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.048 | trans_loss 5.106 | nll_loss 2.381 | w2v_ctc_loss 1.358 | task_loss 0 | contrastive_loss 0.317 | total 6138.43 | n_correct 4149.43 | ppl 5.21 | accuracy 67.598 | uer 21.582 | wer 23.079 | raw_wer 23.079 | bleu 25.36 | wps 1814.8 | wpb 6138.4 | bsz 201.1 | num_updates 7139 | best_bleu 25.36
2023-08-25 13:45:14 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 7139 updates
2023-08-25 13:45:14 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:45:20 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 13:45:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 6 @ 7139 updates, score 25.36) (writing took 10.348495457999888 seconds)
2023-08-25 13:45:25 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-08-25 13:45:25 | INFO | train | epoch 006 | loss 2.19 | trans_loss 3.415 | nll_loss 1.534 | w2v_ctc_loss 1.199 | task_loss 0 | contrastive_loss 0.254 | total 6703.69 | n_correct 4245.51 | ppl 2.9 | accuracy 63.331 | wps 20522.9 | ups 1.06 | wpb 19422.7 | bsz 678.2 | num_updates 7139 | lr 0.000167377 | gnorm 0.449 | clip 0 | loss_scale 8 | train_wall 1028 | gb_free 13.8 | wall 6775
2023-08-25 13:45:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 13:45:25 | INFO | fairseq.trainer | begin training epoch 7
2023-08-25 13:45:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 13:46:25 | INFO | train_inner | epoch 007:     61 / 1191 loss=2.135, trans_loss=3.388, nll_loss=1.498, w2v_ctc_loss=1.141, task_loss=0, contrastive_loss=0.28, total=6728.8, n_correct=4329.82, ppl=2.82, accuracy=64.348, wps=14352.7, ups=0.74, wpb=19481.1, bsz=693.5, num_updates=7200, lr=0.000166667, gnorm=0.429, clip=0, loss_scale=8, train_wall=86, gb_free=12.7, wall=6835
2023-08-25 13:47:53 | INFO | train_inner | epoch 007:    161 / 1191 loss=2.108, trans_loss=3.373, nll_loss=1.483, w2v_ctc_loss=1.126, task_loss=0, contrastive_loss=0.261, total=6657.18, n_correct=4306.28, ppl=2.8, accuracy=64.686, wps=22075.3, ups=1.14, wpb=19310.2, bsz=668.2, num_updates=7300, lr=0.000165521, gnorm=0.426, clip=0, loss_scale=8, train_wall=87, gb_free=13.8, wall=6923
2023-08-25 13:49:19 | INFO | train_inner | epoch 007:    261 / 1191 loss=2.094, trans_loss=3.373, nll_loss=1.481, w2v_ctc_loss=1.127, task_loss=0, contrastive_loss=0.174, total=6692.05, n_correct=4337.79, ppl=2.79, accuracy=64.82, wps=22477, ups=1.16, wpb=19388.9, bsz=676.3, num_updates=7400, lr=0.000164399, gnorm=0.426, clip=0, loss_scale=8, train_wall=85, gb_free=15, wall=7009
2023-08-25 13:50:44 | INFO | train_inner | epoch 007:    361 / 1191 loss=2.065, trans_loss=3.361, nll_loss=1.467, w2v_ctc_loss=1.1, task_loss=0, contrastive_loss=0.155, total=6739.19, n_correct=4402.61, ppl=2.76, accuracy=65.328, wps=22904.3, ups=1.17, wpb=19532.5, bsz=691.6, num_updates=7500, lr=0.000163299, gnorm=0.423, clip=0, loss_scale=8, train_wall=85, gb_free=14.4, wall=7094
2023-08-25 13:52:10 | INFO | train_inner | epoch 007:    461 / 1191 loss=2.097, trans_loss=3.371, nll_loss=1.479, w2v_ctc_loss=1.111, task_loss=0, contrastive_loss=0.248, total=6791.88, n_correct=4415.45, ppl=2.79, accuracy=65.011, wps=22779.6, ups=1.16, wpb=19680.7, bsz=711.2, num_updates=7600, lr=0.000162221, gnorm=0.427, clip=0, loss_scale=8, train_wall=86, gb_free=13, wall=7181
2023-08-25 13:53:38 | INFO | train_inner | epoch 007:    561 / 1191 loss=2.082, trans_loss=3.369, nll_loss=1.475, w2v_ctc_loss=1.116, task_loss=0, contrastive_loss=0.175, total=6695.38, n_correct=4360.59, ppl=2.78, accuracy=65.128, wps=22088.7, ups=1.14, wpb=19395.2, bsz=669.3, num_updates=7700, lr=0.000161165, gnorm=0.427, clip=0, loss_scale=8, train_wall=87, gb_free=14.4, wall=7269
2023-08-25 13:55:06 | INFO | train_inner | epoch 007:    661 / 1191 loss=2.091, trans_loss=3.371, nll_loss=1.479, w2v_ctc_loss=1.104, task_loss=0, contrastive_loss=0.254, total=6755.96, n_correct=4394.86, ppl=2.79, accuracy=65.052, wps=22352.7, ups=1.14, wpb=19573.7, bsz=691.6, num_updates=7800, lr=0.000160128, gnorm=0.423, clip=0, loss_scale=8, train_wall=87, gb_free=13.4, wall=7356
2023-08-25 13:56:33 | INFO | train_inner | epoch 007:    761 / 1191 loss=2.067, trans_loss=3.365, nll_loss=1.469, w2v_ctc_loss=1.104, task_loss=0, contrastive_loss=0.164, total=6684.34, n_correct=4364.79, ppl=2.77, accuracy=65.299, wps=22328.3, ups=1.15, wpb=19359, bsz=672.8, num_updates=7900, lr=0.000159111, gnorm=0.42, clip=0, loss_scale=8, train_wall=86, gb_free=13.9, wall=7443
2023-08-25 13:57:59 | INFO | train_inner | epoch 007:    861 / 1191 loss=2.083, trans_loss=3.367, nll_loss=1.473, w2v_ctc_loss=1.095, task_loss=0, contrastive_loss=0.28, total=6664.42, n_correct=4348.15, ppl=2.78, accuracy=65.244, wps=22210.9, ups=1.15, wpb=19300.9, bsz=658.9, num_updates=8000, lr=0.000158114, gnorm=0.428, clip=0, loss_scale=8, train_wall=86, gb_free=13.2, wall=7530
2023-08-25 13:57:59 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 13:58:32 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.009 | trans_loss 5.045 | nll_loss 2.305 | w2v_ctc_loss 1.379 | task_loss 0 | contrastive_loss 0.313 | total 6138.43 | n_correct 4203 | ppl 4.94 | accuracy 68.47 | uer 20.488 | wer 22.042 | raw_wer 22.042 | bleu 25.98 | wps 1739.7 | wpb 6138.4 | bsz 201.1 | num_updates 8000 | best_bleu 25.98
2023-08-25 13:58:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8000 updates
2023-08-25 13:58:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_7_8000.pt
2023-08-25 13:58:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_7_8000.pt
2023-08-25 13:58:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_7_8000.pt (epoch 7 @ 8000 updates, score 25.98) (writing took 10.620386116999725 seconds)
2023-08-25 14:00:10 | INFO | train_inner | epoch 007:    961 / 1191 loss=2.053, trans_loss=3.358, nll_loss=1.463, w2v_ctc_loss=1.097, task_loss=0, contrastive_loss=0.17, total=6616.88, n_correct=4331.31, ppl=2.76, accuracy=65.458, wps=14709.9, ups=0.77, wpb=19171.8, bsz=639.8, num_updates=8100, lr=0.000157135, gnorm=0.42, clip=0, loss_scale=8, train_wall=87, gb_free=11.7, wall=7660
2023-08-25 14:01:38 | INFO | train_inner | epoch 007:   1061 / 1191 loss=2.085, trans_loss=3.359, nll_loss=1.461, w2v_ctc_loss=1.095, task_loss=0, contrastive_loss=0.281, total=6683.03, n_correct=4380.43, ppl=2.75, accuracy=65.546, wps=22066.1, ups=1.14, wpb=19348.3, bsz=694.2, num_updates=8200, lr=0.000156174, gnorm=0.42, clip=0, loss_scale=8, train_wall=87, gb_free=13.8, wall=7748
2023-08-25 14:03:04 | INFO | train_inner | epoch 007:   1161 / 1191 loss=2.074, trans_loss=3.36, nll_loss=1.467, w2v_ctc_loss=1.094, task_loss=0, contrastive_loss=0.253, total=6730.91, n_correct=4405.47, ppl=2.76, accuracy=65.451, wps=22485.9, ups=1.15, wpb=19511.5, bsz=682.6, num_updates=8300, lr=0.00015523, gnorm=0.421, clip=0, loss_scale=8, train_wall=86, gb_free=13.6, wall=7835
2023-08-25 14:03:31 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 14:04:02 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 3.976 | trans_loss 5.037 | nll_loss 2.298 | w2v_ctc_loss 1.295 | task_loss 0 | contrastive_loss 0.301 | total 6138.43 | n_correct 4209.43 | ppl 4.92 | accuracy 68.575 | uer 20.178 | wer 21.763 | raw_wer 21.763 | bleu 26.06 | wps 1804 | wpb 6138.4 | bsz 201.1 | num_updates 8330 | best_bleu 26.06
2023-08-25 14:04:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8330 updates
2023-08-25 14:04:02 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 14:04:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 14:04:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 7 @ 8330 updates, score 26.06) (writing took 11.254352696998467 seconds)
2023-08-25 14:04:14 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-08-25 14:04:14 | INFO | train | epoch 007 | loss 2.084 | trans_loss 3.367 | nll_loss 1.473 | w2v_ctc_loss 1.107 | task_loss 0 | contrastive_loss 0.224 | total 6703.69 | n_correct 4368.46 | ppl 2.78 | accuracy 65.165 | wps 20491.2 | ups 1.06 | wpb 19422.7 | bsz 678.2 | num_updates 8330 | lr 0.00015495 | gnorm 0.424 | clip 0 | loss_scale 8 | train_wall 1028 | gb_free 13.2 | wall 7904
2023-08-25 14:04:14 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 14:04:14 | INFO | fairseq.trainer | begin training epoch 8
2023-08-25 14:04:14 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 14:05:21 | INFO | train_inner | epoch 008:     70 / 1191 loss=2.015, trans_loss=3.341, nll_loss=1.439, w2v_ctc_loss=1.058, task_loss=0, contrastive_loss=0.136, total=6730.54, n_correct=4453.75, ppl=2.71, accuracy=66.172, wps=14220.5, ups=0.73, wpb=19489.8, bsz=668, num_updates=8400, lr=0.000154303, gnorm=0.406, clip=0, loss_scale=8, train_wall=86, gb_free=13.1, wall=7972
2023-08-25 14:06:48 | INFO | train_inner | epoch 008:    170 / 1191 loss=2.038, trans_loss=3.332, nll_loss=1.432, w2v_ctc_loss=1.046, task_loss=0, contrastive_loss=0.286, total=6744.24, n_correct=4468.01, ppl=2.7, accuracy=66.249, wps=22485, ups=1.15, wpb=19557.6, bsz=714.2, num_updates=8500, lr=0.000153393, gnorm=0.408, clip=0, loss_scale=8, train_wall=86, gb_free=14.6, wall=8059
2023-08-25 14:08:16 | INFO | train_inner | epoch 008:    270 / 1191 loss=2.023, trans_loss=3.337, nll_loss=1.435, w2v_ctc_loss=1.05, task_loss=0, contrastive_loss=0.209, total=6744.09, n_correct=4470.63, ppl=2.7, accuracy=66.29, wps=22216.4, ups=1.14, wpb=19538.4, bsz=691.2, num_updates=8600, lr=0.000152499, gnorm=0.41, clip=0, loss_scale=8, train_wall=87, gb_free=14.4, wall=8147
2023-08-25 14:09:44 | INFO | train_inner | epoch 008:    370 / 1191 loss=2.005, trans_loss=3.342, nll_loss=1.444, w2v_ctc_loss=1.056, task_loss=0, contrastive_loss=0.132, total=6638.8, n_correct=4381.85, ppl=2.72, accuracy=66.004, wps=21814.9, ups=1.13, wpb=19244.1, bsz=639.1, num_updates=8700, lr=0.00015162, gnorm=0.411, clip=0, loss_scale=8, train_wall=88, gb_free=14.3, wall=8235
2023-08-25 14:11:12 | INFO | train_inner | epoch 008:    470 / 1191 loss=2.022, trans_loss=3.335, nll_loss=1.434, w2v_ctc_loss=1.054, task_loss=0, contrastive_loss=0.202, total=6672.44, n_correct=4419.08, ppl=2.7, accuracy=66.229, wps=22059.9, ups=1.14, wpb=19339.8, bsz=667.9, num_updates=8800, lr=0.000150756, gnorm=0.414, clip=0, loss_scale=8, train_wall=87, gb_free=12.4, wall=8323
2023-08-25 14:12:39 | INFO | train_inner | epoch 008:    570 / 1191 loss=2.003, trans_loss=3.333, nll_loss=1.431, w2v_ctc_loss=1.034, task_loss=0, contrastive_loss=0.21, total=6676.91, n_correct=4432.75, ppl=2.7, accuracy=66.389, wps=22340.2, ups=1.15, wpb=19346.2, bsz=671.5, num_updates=8900, lr=0.000149906, gnorm=0.409, clip=0, loss_scale=8, train_wall=86, gb_free=13.8, wall=8409
2023-08-25 14:14:05 | INFO | train_inner | epoch 008:    670 / 1191 loss=1.997, trans_loss=3.337, nll_loss=1.436, w2v_ctc_loss=1.041, task_loss=0, contrastive_loss=0.138, total=6735.41, n_correct=4468.67, ppl=2.71, accuracy=66.346, wps=22738.8, ups=1.17, wpb=19514.6, bsz=679.1, num_updates=9000, lr=0.000149071, gnorm=0.408, clip=0, loss_scale=8, train_wall=85, gb_free=14.8, wall=8495
2023-08-25 14:15:32 | INFO | train_inner | epoch 008:    770 / 1191 loss=2.01, trans_loss=3.336, nll_loss=1.436, w2v_ctc_loss=1.044, task_loss=0, contrastive_loss=0.215, total=6676.21, n_correct=4427.52, ppl=2.7, accuracy=66.318, wps=22185.2, ups=1.15, wpb=19347.4, bsz=667.7, num_updates=9100, lr=0.00014825, gnorm=0.407, clip=0, loss_scale=8, train_wall=87, gb_free=12.1, wall=8582
2023-08-25 14:16:59 | INFO | train_inner | epoch 008:    870 / 1191 loss=2.006, trans_loss=3.329, nll_loss=1.427, w2v_ctc_loss=1.046, task_loss=0, contrastive_loss=0.165, total=6793.29, n_correct=4527.91, ppl=2.69, accuracy=66.653, wps=22652.2, ups=1.15, wpb=19684.1, bsz=704.6, num_updates=9200, lr=0.000147442, gnorm=0.409, clip=0, loss_scale=16, train_wall=86, gb_free=12.4, wall=8669
2023-08-25 14:18:26 | INFO | train_inner | epoch 008:    970 / 1191 loss=2.023, trans_loss=3.339, nll_loss=1.437, w2v_ctc_loss=1.041, task_loss=0, contrastive_loss=0.262, total=6661.73, n_correct=4412.34, ppl=2.71, accuracy=66.234, wps=22158.1, ups=1.15, wpb=19290.2, bsz=660.9, num_updates=9300, lr=0.000146647, gnorm=0.408, clip=0, loss_scale=16, train_wall=86, gb_free=14.1, wall=8756
2023-08-25 14:19:52 | INFO | train_inner | epoch 008:   1070 / 1191 loss=1.989, trans_loss=3.332, nll_loss=1.426, w2v_ctc_loss=1.039, task_loss=0, contrastive_loss=0.124, total=6683.31, n_correct=4450.55, ppl=2.69, accuracy=66.592, wps=22416.2, ups=1.16, wpb=19336.8, bsz=662.3, num_updates=9400, lr=0.000145865, gnorm=0.404, clip=0, loss_scale=16, train_wall=86, gb_free=14.3, wall=8842
2023-08-25 14:21:18 | INFO | train_inner | epoch 008:   1170 / 1191 loss=2.022, trans_loss=3.323, nll_loss=1.42, w2v_ctc_loss=1.023, task_loss=0, contrastive_loss=0.314, total=6727.93, n_correct=4490.69, ppl=2.68, accuracy=66.747, wps=22635.5, ups=1.16, wpb=19499.6, bsz=718.4, num_updates=9500, lr=0.000145095, gnorm=0.412, clip=0, loss_scale=16, train_wall=86, gb_free=12.5, wall=8929
2023-08-25 14:21:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 14:22:07 | INFO | dev_st | epoch 008 | valid on 'dev_st' subset | loss 3.937 | trans_loss 4.992 | nll_loss 2.243 | w2v_ctc_loss 1.288 | task_loss 0 | contrastive_loss 0.279 | total 6138.43 | n_correct 4247.43 | ppl 4.73 | accuracy 69.194 | uer 19.1 | wer 20.61 | raw_wer 20.61 | bleu 26.61 | wps 1835.2 | wpb 6138.4 | bsz 201.1 | num_updates 9521 | best_bleu 26.61
2023-08-25 14:22:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 9521 updates
2023-08-25 14:22:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 14:22:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 14:22:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 8 @ 9521 updates, score 26.61) (writing took 9.726794041000176 seconds)
2023-08-25 14:22:17 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-08-25 14:22:17 | INFO | train | epoch 008 | loss 2.012 | trans_loss 3.334 | nll_loss 1.432 | w2v_ctc_loss 1.043 | task_loss 0 | contrastive_loss 0.204 | total 6703.69 | n_correct 4449.47 | ppl 2.7 | accuracy 66.373 | wps 21352.4 | ups 1.1 | wpb 19422.7 | bsz 678.2 | num_updates 9521 | lr 0.000144935 | gnorm 0.409 | clip 0 | loss_scale 16 | train_wall 1027 | gb_free 14.4 | wall 8987
2023-08-25 14:22:17 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 14:22:17 | INFO | fairseq.trainer | begin training epoch 9
2023-08-25 14:22:17 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 14:23:32 | INFO | train_inner | epoch 009:     79 / 1191 loss=1.968, trans_loss=3.31, nll_loss=1.402, w2v_ctc_loss=0.997, task_loss=0, contrastive_loss=0.223, total=6681.43, n_correct=4486.21, ppl=2.64, accuracy=67.144, wps=14438.4, ups=0.75, wpb=19356.2, bsz=676, num_updates=9600, lr=0.000144338, gnorm=0.396, clip=0, loss_scale=16, train_wall=85, gb_free=12, wall=9063
2023-08-25 14:25:00 | INFO | train_inner | epoch 009:    179 / 1191 loss=1.956, trans_loss=3.302, nll_loss=1.393, w2v_ctc_loss=0.991, task_loss=0, contrastive_loss=0.197, total=6757.86, n_correct=4551.43, ppl=2.63, accuracy=67.35, wps=22434.8, ups=1.15, wpb=19588.1, bsz=692.6, num_updates=9700, lr=0.000143592, gnorm=0.399, clip=0, loss_scale=16, train_wall=87, gb_free=14.8, wall=9150
2023-08-25 14:26:26 | INFO | train_inner | epoch 009:    279 / 1191 loss=1.965, trans_loss=3.315, nll_loss=1.406, w2v_ctc_loss=1.011, task_loss=0, contrastive_loss=0.141, total=6797.76, n_correct=4567.75, ppl=2.65, accuracy=67.195, wps=22794.2, ups=1.16, wpb=19677.4, bsz=701.1, num_updates=9800, lr=0.000142857, gnorm=0.403, clip=0, loss_scale=16, train_wall=86, gb_free=10.1, wall=9236
2023-08-25 14:27:54 | INFO | train_inner | epoch 009:    379 / 1191 loss=1.96, trans_loss=3.31, nll_loss=1.402, w2v_ctc_loss=0.994, task_loss=0, contrastive_loss=0.196, total=6775.76, n_correct=4554.86, ppl=2.64, accuracy=67.223, wps=22259.6, ups=1.13, wpb=19634.3, bsz=694.7, num_updates=9900, lr=0.000142134, gnorm=0.398, clip=0, loss_scale=16, train_wall=88, gb_free=13.4, wall=9324
2023-08-25 14:29:22 | INFO | train_inner | epoch 009:    479 / 1191 loss=1.973, trans_loss=3.311, nll_loss=1.404, w2v_ctc_loss=1.009, task_loss=0, contrastive_loss=0.181, total=6696.55, n_correct=4505.04, ppl=2.65, accuracy=67.274, wps=22188, ups=1.14, wpb=19408.4, bsz=685.4, num_updates=10000, lr=0.000141421, gnorm=0.405, clip=0, loss_scale=16, train_wall=87, gb_free=14.4, wall=9412
2023-08-25 14:29:22 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 14:29:53 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.932 | trans_loss 4.986 | nll_loss 2.233 | w2v_ctc_loss 1.283 | task_loss 0 | contrastive_loss 0.283 | total 6138.43 | n_correct 4258.43 | ppl 4.7 | accuracy 69.373 | uer 18.822 | wer 20.405 | raw_wer 20.405 | bleu 27.25 | wps 1847.6 | wpb 6138.4 | bsz 201.1 | num_updates 10000 | best_bleu 27.25
2023-08-25 14:29:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10000 updates
2023-08-25 14:29:53 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_9_10000.pt
2023-08-25 14:29:55 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_9_10000.pt
2023-08-25 14:30:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_9_10000.pt (epoch 9 @ 10000 updates, score 27.25) (writing took 29.16378048899969 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 14:31:48 | INFO | train_inner | epoch 009:    579 / 1191 loss=1.952, trans_loss=3.307, nll_loss=1.397, w2v_ctc_loss=0.991, task_loss=0, contrastive_loss=0.184, total=6631.46, n_correct=4461.64, ppl=2.63, accuracy=67.28, wps=13152.3, ups=0.68, wpb=19212.3, bsz=667.7, num_updates=10100, lr=0.00014072, gnorm=0.337, clip=0, loss_scale=16, train_wall=85, gb_free=14.2, wall=9558
2023-08-25 14:33:14 | INFO | train_inner | epoch 009:    679 / 1191 loss=1.965, trans_loss=3.317, nll_loss=1.41, w2v_ctc_loss=1, task_loss=0, contrastive_loss=0.221, total=6564.56, n_correct=4403.34, ppl=2.66, accuracy=67.077, wps=22044.9, ups=1.16, wpb=19011.2, bsz=625.6, num_updates=10200, lr=0.000140028, gnorm=0.333, clip=0, loss_scale=16, train_wall=86, gb_free=15.5, wall=9644
2023-08-25 14:34:41 | INFO | train_inner | epoch 009:    779 / 1191 loss=1.977, trans_loss=3.312, nll_loss=1.405, w2v_ctc_loss=0.994, task_loss=0, contrastive_loss=0.247, total=6697.76, n_correct=4500.94, ppl=2.65, accuracy=67.201, wps=22342.3, ups=1.15, wpb=19409.9, bsz=686.9, num_updates=10300, lr=0.000139347, gnorm=0.336, clip=0, loss_scale=16, train_wall=86, gb_free=14.7, wall=9731
2023-08-25 14:36:07 | INFO | train_inner | epoch 009:    879 / 1191 loss=1.948, trans_loss=3.311, nll_loss=1.404, w2v_ctc_loss=0.996, task_loss=0, contrastive_loss=0.142, total=6725.6, n_correct=4522.06, ppl=2.65, accuracy=67.237, wps=22544.6, ups=1.16, wpb=19490.8, bsz=666.1, num_updates=10400, lr=0.000138675, gnorm=0.337, clip=0, loss_scale=16, train_wall=86, gb_free=14, wall=9818
2023-08-25 14:37:35 | INFO | train_inner | epoch 009:    979 / 1191 loss=1.961, trans_loss=3.309, nll_loss=1.4, w2v_ctc_loss=0.993, task_loss=0, contrastive_loss=0.203, total=6712.81, n_correct=4518.43, ppl=2.64, accuracy=67.311, wps=22285.6, ups=1.15, wpb=19443.8, bsz=681.9, num_updates=10500, lr=0.000138013, gnorm=0.33, clip=0, loss_scale=16, train_wall=87, gb_free=13.3, wall=9905
2023-08-25 14:39:01 | INFO | train_inner | epoch 009:   1079 / 1191 loss=1.968, trans_loss=3.308, nll_loss=1.4, w2v_ctc_loss=0.988, task_loss=0, contrastive_loss=0.264, total=6663.32, n_correct=4492.82, ppl=2.64, accuracy=67.426, wps=22241.5, ups=1.15, wpb=19311.7, bsz=678.6, num_updates=10600, lr=0.000137361, gnorm=0.333, clip=0, loss_scale=16, train_wall=86, gb_free=14.1, wall=9992
2023-08-25 14:40:28 | INFO | train_inner | epoch 009:   1179 / 1191 loss=1.953, trans_loss=3.307, nll_loss=1.4, w2v_ctc_loss=1.007, task_loss=0, contrastive_loss=0.131, total=6698.09, n_correct=4513.11, ppl=2.64, accuracy=67.379, wps=22336, ups=1.15, wpb=19412.6, bsz=660.3, num_updates=10700, lr=0.000136717, gnorm=0.332, clip=0, loss_scale=16, train_wall=86, gb_free=12.3, wall=10079
2023-08-25 14:40:39 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
2023-08-25 14:41:10 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.912 | trans_loss 4.979 | nll_loss 2.223 | w2v_ctc_loss 1.234 | task_loss 0 | contrastive_loss 0.278 | total 6138.43 | n_correct 4265.29 | ppl 4.67 | accuracy 69.485 | uer 18.477 | wer 20.108 | raw_wer 20.108 | bleu 27.01 | wps 1842.7 | wpb 6138.4 | bsz 201.1 | num_updates 10712 | best_bleu 27.25
2023-08-25 14:41:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10712 updates
2023-08-25 14:41:10 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.0107.pt
2023-08-25 14:41:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.0107.pt
2023-08-25 14:41:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.0107.pt (epoch 9 @ 10712 updates, score 27.01) (writing took 7.493751703999806 seconds)
2023-08-25 14:41:18 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-08-25 14:41:18 | INFO | train | epoch 009 | loss 1.961 | trans_loss 3.309 | nll_loss 1.401 | w2v_ctc_loss 0.997 | task_loss 0 | contrastive_loss 0.192 | total 6703.69 | n_correct 4509.81 | ppl 2.64 | accuracy 67.274 | wps 20282.1 | ups 1.04 | wpb 19422.7 | bsz 678.2 | num_updates 10712 | lr 0.000136641 | gnorm 0.361 | clip 0 | loss_scale 16 | train_wall 1026 | gb_free 14.6 | wall 10128
2023-08-25 14:41:18 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 14:41:18 | INFO | fairseq.trainer | begin training epoch 10
2023-08-25 14:41:18 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 14:42:41 | INFO | train_inner | epoch 010:     88 / 1191 loss=1.903, trans_loss=3.285, nll_loss=1.37, w2v_ctc_loss=0.954, task_loss=0, contrastive_loss=0.125, total=6635.56, n_correct=4523.27, ppl=2.58, accuracy=68.167, wps=14481.6, ups=0.75, wpb=19225.9, bsz=666.3, num_updates=10800, lr=0.000136083, gnorm=0.327, clip=0, loss_scale=16, train_wall=86, gb_free=8, wall=10211
2023-08-25 14:44:07 | INFO | train_inner | epoch 010:    188 / 1191 loss=1.933, trans_loss=3.298, nll_loss=1.387, w2v_ctc_loss=0.97, task_loss=0, contrastive_loss=0.185, total=6683.77, n_correct=4527.16, ppl=2.61, accuracy=67.734, wps=22604.7, ups=1.17, wpb=19364.3, bsz=682.4, num_updates=10900, lr=0.000135457, gnorm=0.333, clip=0, loss_scale=16, train_wall=85, gb_free=14.2, wall=10297
2023-08-25 14:45:34 | INFO | train_inner | epoch 010:    288 / 1191 loss=1.929, trans_loss=3.287, nll_loss=1.373, w2v_ctc_loss=0.958, task_loss=0, contrastive_loss=0.228, total=6747.3, n_correct=4589.21, ppl=2.59, accuracy=68.016, wps=22463.8, ups=1.15, wpb=19544.4, bsz=686.8, num_updates=11000, lr=0.00013484, gnorm=0.329, clip=0, loss_scale=16, train_wall=86, gb_free=13.3, wall=10384
2023-08-25 14:47:02 | INFO | train_inner | epoch 010:    388 / 1191 loss=1.954, trans_loss=3.292, nll_loss=1.379, w2v_ctc_loss=0.968, task_loss=0, contrastive_loss=0.271, total=6844.06, n_correct=4648.6, ppl=2.6, accuracy=67.922, wps=22557.3, ups=1.14, wpb=19828.5, bsz=731.6, num_updates=11100, lr=0.000134231, gnorm=0.33, clip=0, loss_scale=16, train_wall=87, gb_free=14.3, wall=10472
2023-08-25 14:48:28 | INFO | train_inner | epoch 010:    488 / 1191 loss=1.923, trans_loss=3.289, nll_loss=1.373, w2v_ctc_loss=0.975, task_loss=0, contrastive_loss=0.141, total=6740.33, n_correct=4581.91, ppl=2.59, accuracy=67.978, wps=22591.6, ups=1.16, wpb=19516.8, bsz=675.3, num_updates=11200, lr=0.000133631, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=15, wall=10558
2023-08-25 14:49:54 | INFO | train_inner | epoch 010:    588 / 1191 loss=1.924, trans_loss=3.295, nll_loss=1.382, w2v_ctc_loss=0.963, task_loss=0, contrastive_loss=0.186, total=6674.26, n_correct=4529.89, ppl=2.61, accuracy=67.871, wps=22370.9, ups=1.16, wpb=19333.8, bsz=659.7, num_updates=11300, lr=0.000133038, gnorm=0.332, clip=0, loss_scale=32, train_wall=86, gb_free=13.8, wall=10645
2023-08-25 14:51:22 | INFO | train_inner | epoch 010:    688 / 1191 loss=1.931, trans_loss=3.291, nll_loss=1.379, w2v_ctc_loss=0.968, task_loss=0, contrastive_loss=0.181, total=6780.39, n_correct=4608.21, ppl=2.6, accuracy=67.964, wps=22514.3, ups=1.15, wpb=19647.9, bsz=704.3, num_updates=11400, lr=0.000132453, gnorm=0.329, clip=0, loss_scale=32, train_wall=87, gb_free=13.3, wall=10732
2023-08-25 14:52:49 | INFO | train_inner | epoch 010:    788 / 1191 loss=1.9, trans_loss=3.288, nll_loss=1.375, w2v_ctc_loss=0.962, task_loss=0, contrastive_loss=0.101, total=6651.17, n_correct=4525.72, ppl=2.59, accuracy=68.044, wps=22202.9, ups=1.15, wpb=19273.7, bsz=652.3, num_updates=11500, lr=0.000131876, gnorm=0.328, clip=0, loss_scale=32, train_wall=86, gb_free=13.2, wall=10819
2023-08-25 14:54:16 | INFO | train_inner | epoch 010:    888 / 1191 loss=1.928, trans_loss=3.288, nll_loss=1.375, w2v_ctc_loss=0.974, task_loss=0, contrastive_loss=0.184, total=6538.32, n_correct=4447.03, ppl=2.59, accuracy=68.015, wps=21611.7, ups=1.14, wpb=18949.3, bsz=637, num_updates=11600, lr=0.000131306, gnorm=0.334, clip=0, loss_scale=32, train_wall=87, gb_free=14.6, wall=10907
2023-08-25 14:55:43 | INFO | train_inner | epoch 010:    988 / 1191 loss=1.911, trans_loss=3.285, nll_loss=1.371, w2v_ctc_loss=0.961, task_loss=0, contrastive_loss=0.135, total=6754.89, n_correct=4603.01, ppl=2.59, accuracy=68.143, wps=22602.5, ups=1.15, wpb=19571, bsz=687.6, num_updates=11700, lr=0.000130744, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=14.5, wall=10993
2023-08-25 14:57:09 | INFO | train_inner | epoch 010:   1088 / 1191 loss=1.917, trans_loss=3.282, nll_loss=1.369, w2v_ctc_loss=0.972, task_loss=0, contrastive_loss=0.131, total=6679.13, n_correct=4554.56, ppl=2.58, accuracy=68.191, wps=22360.5, ups=1.15, wpb=19365.7, bsz=675.9, num_updates=11800, lr=0.000130189, gnorm=0.327, clip=0, loss_scale=32, train_wall=86, gb_free=10.4, wall=11080
2023-08-25 14:58:36 | INFO | train_inner | epoch 010:   1188 / 1191 loss=1.945, trans_loss=3.289, nll_loss=1.375, w2v_ctc_loss=0.958, task_loss=0, contrastive_loss=0.312, total=6732.47, n_correct=4577.57, ppl=2.59, accuracy=67.992, wps=22555.1, ups=1.16, wpb=19499.8, bsz=688.7, num_updates=11900, lr=0.000129641, gnorm=0.328, clip=0, loss_scale=32, train_wall=86, gb_free=14.5, wall=11166
2023-08-25 14:58:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 14:59:09 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 3.88 | trans_loss 4.951 | nll_loss 2.189 | w2v_ctc_loss 1.198 | task_loss 0 | contrastive_loss 0.274 | total 6138.43 | n_correct 4290.71 | ppl 4.56 | accuracy 69.899 | uer 18.142 | wer 19.803 | raw_wer 19.803 | bleu 27.16 | wps 1868.7 | wpb 6138.4 | bsz 201.1 | num_updates 11903 | best_bleu 27.25
2023-08-25 14:59:09 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 11903 updates
2023-08-25 14:59:09 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.1600.pt
2023-08-25 14:59:11 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.1600.pt
2023-08-25 14:59:16 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.1600.pt (epoch 10 @ 11903 updates, score 27.16) (writing took 7.10426897599973 seconds)
2023-08-25 14:59:17 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-08-25 14:59:17 | INFO | train | epoch 010 | loss 1.925 | trans_loss 3.289 | nll_loss 1.376 | w2v_ctc_loss 0.965 | task_loss 0 | contrastive_loss 0.183 | total 6703.69 | n_correct 4558.84 | ppl 2.59 | accuracy 68.005 | wps 21438 | ups 1.1 | wpb 19422.7 | bsz 678.2 | num_updates 11903 | lr 0.000129624 | gnorm 0.329 | clip 0 | loss_scale 32 | train_wall 1025 | gb_free 12.6 | wall 11207
2023-08-25 14:59:17 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 14:59:17 | INFO | fairseq.trainer | begin training epoch 11
2023-08-25 14:59:17 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 15:00:48 | INFO | train_inner | epoch 011:     97 / 1191 loss=1.893, trans_loss=3.271, nll_loss=1.353, w2v_ctc_loss=0.946, task_loss=0, contrastive_loss=0.152, total=6629.5, n_correct=4543.42, ppl=2.56, accuracy=68.533, wps=14500.5, ups=0.75, wpb=19215.2, bsz=646.6, num_updates=12000, lr=0.000129099, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=13.3, wall=11299
2023-08-25 15:00:48 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 15:01:20 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.897 | trans_loss 4.949 | nll_loss 2.18 | w2v_ctc_loss 1.263 | task_loss 0 | contrastive_loss 0.268 | total 6138.43 | n_correct 4296.71 | ppl 4.53 | accuracy 69.997 | uer 18.287 | wer 19.996 | raw_wer 19.996 | bleu 27.82 | wps 1820.4 | wpb 6138.4 | bsz 201.1 | num_updates 12000 | best_bleu 27.82
2023-08-25 15:01:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 12000 updates
2023-08-25 15:01:20 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_11_12000.pt
2023-08-25 15:01:22 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_11_12000.pt
2023-08-25 15:01:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_11_12000.pt (epoch 11 @ 12000 updates, score 27.82) (writing took 12.66013469400059 seconds)
2023-08-25 15:02:59 | INFO | train_inner | epoch 011:    197 / 1191 loss=1.891, trans_loss=3.273, nll_loss=1.355, w2v_ctc_loss=0.924, task_loss=0, contrastive_loss=0.216, total=6695.87, n_correct=4595.51, ppl=2.56, accuracy=68.632, wps=14816.1, ups=0.76, wpb=19390.4, bsz=686.9, num_updates=12100, lr=0.000128565, gnorm=0.325, clip=0, loss_scale=32, train_wall=86, gb_free=14.5, wall=11430
2023-08-25 15:04:26 | INFO | train_inner | epoch 011:    297 / 1191 loss=1.889, trans_loss=3.269, nll_loss=1.35, w2v_ctc_loss=0.933, task_loss=0, contrastive_loss=0.178, total=6605.27, n_correct=4531.66, ppl=2.55, accuracy=68.607, wps=22118.6, ups=1.16, wpb=19137.7, bsz=664.2, num_updates=12200, lr=0.000128037, gnorm=0.325, clip=0, loss_scale=32, train_wall=86, gb_free=13.5, wall=11516
2023-08-25 15:05:53 | INFO | train_inner | epoch 011:    397 / 1191 loss=1.902, trans_loss=3.27, nll_loss=1.353, w2v_ctc_loss=0.937, task_loss=0, contrastive_loss=0.228, total=6597.68, n_correct=4522.75, ppl=2.55, accuracy=68.551, wps=22048.8, ups=1.15, wpb=19125.4, bsz=664.1, num_updates=12300, lr=0.000127515, gnorm=0.334, clip=0, loss_scale=32, train_wall=86, gb_free=11.5, wall=11603
2023-08-25 15:07:20 | INFO | train_inner | epoch 011:    497 / 1191 loss=1.884, trans_loss=3.275, nll_loss=1.36, w2v_ctc_loss=0.946, task_loss=0, contrastive_loss=0.102, total=6643.92, n_correct=4548.17, ppl=2.57, accuracy=68.456, wps=22141.3, ups=1.15, wpb=19259.8, bsz=646.3, num_updates=12400, lr=0.000127, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=11.4, wall=11690
2023-08-25 15:08:46 | INFO | train_inner | epoch 011:    597 / 1191 loss=1.882, trans_loss=3.272, nll_loss=1.357, w2v_ctc_loss=0.944, task_loss=0, contrastive_loss=0.1, total=6663.6, n_correct=4567.31, ppl=2.56, accuracy=68.541, wps=22358.4, ups=1.16, wpb=19323.3, bsz=673.3, num_updates=12500, lr=0.000126491, gnorm=0.323, clip=0, loss_scale=32, train_wall=86, gb_free=13.5, wall=11776
2023-08-25 15:10:14 | INFO | train_inner | epoch 011:    697 / 1191 loss=1.884, trans_loss=3.267, nll_loss=1.35, w2v_ctc_loss=0.935, task_loss=0, contrastive_loss=0.151, total=6694.31, n_correct=4592.14, ppl=2.55, accuracy=68.598, wps=22130.1, ups=1.14, wpb=19409, bsz=667.3, num_updates=12600, lr=0.000125988, gnorm=0.327, clip=0, loss_scale=32, train_wall=87, gb_free=5.8, wall=11864
2023-08-25 15:11:41 | INFO | train_inner | epoch 011:    797 / 1191 loss=1.907, trans_loss=3.275, nll_loss=1.359, w2v_ctc_loss=0.949, task_loss=0, contrastive_loss=0.17, total=6797.24, n_correct=4654.71, ppl=2.56, accuracy=68.479, wps=22629, ups=1.15, wpb=19694.2, bsz=704.4, num_updates=12700, lr=0.000125491, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=12.4, wall=11951
2023-08-25 15:12:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 15:13:09 | INFO | train_inner | epoch 011:    898 / 1191 loss=1.885, trans_loss=3.278, nll_loss=1.359, w2v_ctc_loss=0.928, task_loss=0, contrastive_loss=0.155, total=6779.33, n_correct=4649.81, ppl=2.57, accuracy=68.588, wps=22227.2, ups=1.13, wpb=19624.2, bsz=683.3, num_updates=12800, lr=0.000125, gnorm=0.32, clip=0, loss_scale=16, train_wall=88, gb_free=7, wall=12039
2023-08-25 15:14:36 | INFO | train_inner | epoch 011:    998 / 1191 loss=1.897, trans_loss=3.271, nll_loss=1.352, w2v_ctc_loss=0.92, task_loss=0, contrastive_loss=0.236, total=6790.04, n_correct=4670.19, ppl=2.55, accuracy=68.78, wps=22573, ups=1.15, wpb=19657.4, bsz=707.5, num_updates=12900, lr=0.000124515, gnorm=0.326, clip=0, loss_scale=16, train_wall=86, gb_free=12.3, wall=12126
2023-08-25 15:16:02 | INFO | train_inner | epoch 011:   1098 / 1191 loss=1.906, trans_loss=3.269, nll_loss=1.351, w2v_ctc_loss=0.933, task_loss=0, contrastive_loss=0.253, total=6766.38, n_correct=4647.54, ppl=2.55, accuracy=68.686, wps=22755.5, ups=1.16, wpb=19607.9, bsz=703.5, num_updates=13000, lr=0.000124035, gnorm=0.322, clip=0, loss_scale=16, train_wall=85, gb_free=12.6, wall=12213
2023-08-25 15:17:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 15:17:54 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.887 | trans_loss 4.931 | nll_loss 2.164 | w2v_ctc_loss 1.274 | task_loss 0 | contrastive_loss 0.266 | total 6138.43 | n_correct 4317.57 | ppl 4.48 | accuracy 70.337 | uer 17.832 | wer 19.435 | raw_wer 19.435 | bleu 27.8 | wps 1852.1 | wpb 6138.4 | bsz 201.1 | num_updates 13093 | best_bleu 27.82
2023-08-25 15:17:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 13093 updates
2023-08-25 15:17:54 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.8009.pt
2023-08-25 15:17:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.8009.pt
2023-08-25 15:18:03 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.8009.pt (epoch 11 @ 13093 updates, score 27.8) (writing took 8.35157761499795 seconds)
2023-08-25 15:18:03 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-08-25 15:18:03 | INFO | train | epoch 011 | loss 1.892 | trans_loss 3.272 | nll_loss 1.355 | w2v_ctc_loss 0.936 | task_loss 0 | contrastive_loss 0.175 | total 6704.38 | n_correct 4598.7 | ppl 2.56 | accuracy 68.592 | wps 20521 | ups 1.06 | wpb 19424.7 | bsz 678.5 | num_updates 13093 | lr 0.000123593 | gnorm 0.325 | clip 0 | loss_scale 16 | train_wall 1026 | gb_free 13.5 | wall 12333
2023-08-25 15:18:03 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 15:18:03 | INFO | fairseq.trainer | begin training epoch 12
2023-08-25 15:18:03 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 15:18:16 | INFO | train_inner | epoch 012:      7 / 1191 loss=1.885, trans_loss=3.274, nll_loss=1.354, w2v_ctc_loss=0.93, task_loss=0, contrastive_loss=0.15, total=6804.63, n_correct=4675.84, ppl=2.56, accuracy=68.716, wps=14681.2, ups=0.75, wpb=19695.8, bsz=712.2, num_updates=13100, lr=0.00012356, gnorm=0.322, clip=0, loss_scale=16, train_wall=86, gb_free=14.4, wall=12347
2023-08-25 15:19:43 | INFO | train_inner | epoch 012:    107 / 1191 loss=1.841, trans_loss=3.252, nll_loss=1.328, w2v_ctc_loss=0.904, task_loss=0, contrastive_loss=0.099, total=6726.14, n_correct=4658.43, ppl=2.51, accuracy=69.259, wps=22503.6, ups=1.15, wpb=19488.3, bsz=666.7, num_updates=13200, lr=0.000123091, gnorm=0.319, clip=0, loss_scale=16, train_wall=86, gb_free=13, wall=12433
2023-08-25 15:21:10 | INFO | train_inner | epoch 012:    207 / 1191 loss=1.862, trans_loss=3.26, nll_loss=1.338, w2v_ctc_loss=0.909, task_loss=0, contrastive_loss=0.168, total=6717.75, n_correct=4633.43, ppl=2.53, accuracy=68.973, wps=22442.6, ups=1.15, wpb=19462, bsz=666.9, num_updates=13300, lr=0.000122628, gnorm=0.318, clip=0, loss_scale=16, train_wall=86, gb_free=10.9, wall=12520
2023-08-25 15:22:37 | INFO | train_inner | epoch 012:    307 / 1191 loss=1.882, trans_loss=3.259, nll_loss=1.339, w2v_ctc_loss=0.914, task_loss=0, contrastive_loss=0.228, total=6705.4, n_correct=4626.31, ppl=2.53, accuracy=68.994, wps=22384, ups=1.15, wpb=19434.8, bsz=692.2, num_updates=13400, lr=0.000122169, gnorm=0.319, clip=0, loss_scale=16, train_wall=86, gb_free=13.8, wall=12607
2023-08-25 15:24:03 | INFO | train_inner | epoch 012:    407 / 1191 loss=1.863, trans_loss=3.258, nll_loss=1.336, w2v_ctc_loss=0.897, task_loss=0, contrastive_loss=0.2, total=6783.44, n_correct=4687.31, ppl=2.52, accuracy=69.099, wps=22833, ups=1.16, wpb=19652.9, bsz=708.9, num_updates=13500, lr=0.000121716, gnorm=0.319, clip=0, loss_scale=16, train_wall=85, gb_free=14.4, wall=12693
2023-08-25 15:25:30 | INFO | train_inner | epoch 012:    507 / 1191 loss=1.844, trans_loss=3.257, nll_loss=1.334, w2v_ctc_loss=0.899, task_loss=0, contrastive_loss=0.106, total=6734.71, n_correct=4662.11, ppl=2.52, accuracy=69.225, wps=22399.5, ups=1.15, wpb=19509.6, bsz=688.4, num_updates=13600, lr=0.000121268, gnorm=0.319, clip=0, loss_scale=16, train_wall=86, gb_free=11, wall=12780
2023-08-25 15:26:57 | INFO | train_inner | epoch 012:    607 / 1191 loss=1.872, trans_loss=3.257, nll_loss=1.334, w2v_ctc_loss=0.914, task_loss=0, contrastive_loss=0.192, total=6728.64, n_correct=4648.31, ppl=2.52, accuracy=69.082, wps=22451.4, ups=1.15, wpb=19492.3, bsz=678.2, num_updates=13700, lr=0.000120824, gnorm=0.326, clip=0, loss_scale=16, train_wall=86, gb_free=14.3, wall=12867
2023-08-25 15:28:24 | INFO | train_inner | epoch 012:    707 / 1191 loss=1.875, trans_loss=3.248, nll_loss=1.328, w2v_ctc_loss=0.908, task_loss=0, contrastive_loss=0.248, total=6764.33, n_correct=4677.99, ppl=2.51, accuracy=69.157, wps=22381.6, ups=1.14, wpb=19618.6, bsz=697.1, num_updates=13800, lr=0.000120386, gnorm=0.324, clip=0, loss_scale=16, train_wall=87, gb_free=14.4, wall=12955
2023-08-25 15:29:51 | INFO | train_inner | epoch 012:    807 / 1191 loss=1.864, trans_loss=3.263, nll_loss=1.341, w2v_ctc_loss=0.913, task_loss=0, contrastive_loss=0.149, total=6655.82, n_correct=4593.99, ppl=2.53, accuracy=69.022, wps=22185.4, ups=1.15, wpb=19273.2, bsz=663.1, num_updates=13900, lr=0.000119952, gnorm=0.322, clip=0, loss_scale=16, train_wall=86, gb_free=12.3, wall=13041
2023-08-25 15:31:18 | INFO | train_inner | epoch 012:    907 / 1191 loss=1.873, trans_loss=3.264, nll_loss=1.344, w2v_ctc_loss=0.916, task_loss=0, contrastive_loss=0.176, total=6656.61, n_correct=4591.58, ppl=2.54, accuracy=68.978, wps=22094.7, ups=1.15, wpb=19280.3, bsz=657.1, num_updates=14000, lr=0.000119523, gnorm=0.328, clip=0, loss_scale=16, train_wall=87, gb_free=13.8, wall=13129
2023-08-25 15:31:18 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 15:31:49 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.899 | trans_loss 4.933 | nll_loss 2.165 | w2v_ctc_loss 1.309 | task_loss 0 | contrastive_loss 0.268 | total 6138.43 | n_correct 4309.71 | ppl 4.49 | accuracy 70.209 | uer 18.167 | wer 19.87 | raw_wer 19.87 | bleu 27.61 | wps 1847 | wpb 6138.4 | bsz 201.1 | num_updates 14000 | best_bleu 27.82
2023-08-25 15:31:49 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14000 updates
2023-08-25 15:31:49 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_12_14000.pt
2023-08-25 15:31:51 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_12_14000.pt
2023-08-25 15:31:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_12_14000.pt (epoch 12 @ 14000 updates, score 27.61) (writing took 7.2471219200015184 seconds)
2023-08-25 15:33:23 | INFO | train_inner | epoch 012:   1007 / 1191 loss=1.869, trans_loss=3.258, nll_loss=1.339, w2v_ctc_loss=0.925, task_loss=0, contrastive_loss=0.14, total=6593.96, n_correct=4547.82, ppl=2.53, accuracy=68.969, wps=15317.1, ups=0.8, wpb=19121.5, bsz=661.7, num_updates=14100, lr=0.000119098, gnorm=0.325, clip=0, loss_scale=16, train_wall=85, gb_free=14.9, wall=13254
2023-08-25 15:34:50 | INFO | train_inner | epoch 012:   1107 / 1191 loss=1.87, trans_loss=3.26, nll_loss=1.339, w2v_ctc_loss=0.91, task_loss=0, contrastive_loss=0.194, total=6662.47, n_correct=4602.82, ppl=2.53, accuracy=69.086, wps=22231.6, ups=1.15, wpb=19297.1, bsz=674.6, num_updates=14200, lr=0.000118678, gnorm=0.321, clip=0, loss_scale=16, train_wall=86, gb_free=14.1, wall=13340
2023-08-25 15:36:03 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 15:36:34 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.87 | trans_loss 4.923 | nll_loss 2.155 | w2v_ctc_loss 1.237 | task_loss 0 | contrastive_loss 0.263 | total 6138.43 | n_correct 4319.14 | ppl 4.45 | accuracy 70.362 | uer 17.632 | wer 19.338 | raw_wer 19.338 | bleu 27.97 | wps 1859.2 | wpb 6138.4 | bsz 201.1 | num_updates 14284 | best_bleu 27.97
2023-08-25 15:36:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14284 updates
2023-08-25 15:36:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 15:36:40 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 15:36:45 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 12 @ 14284 updates, score 27.97) (writing took 10.805217986999196 seconds)
2023-08-25 15:36:46 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-08-25 15:36:46 | INFO | train | epoch 012 | loss 1.864 | trans_loss 3.258 | nll_loss 1.336 | w2v_ctc_loss 0.91 | task_loss 0 | contrastive_loss 0.168 | total 6703.69 | n_correct 4631.04 | ppl 2.53 | accuracy 69.082 | wps 20601.9 | ups 1.06 | wpb 19422.7 | bsz 678.2 | num_updates 14284 | lr 0.000118329 | gnorm 0.322 | clip 0 | loss_scale 16 | train_wall 1026 | gb_free 14.3 | wall 13456
2023-08-25 15:36:46 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 15:36:46 | INFO | fairseq.trainer | begin training epoch 13
2023-08-25 15:36:46 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 15:37:08 | INFO | train_inner | epoch 013:     16 / 1191 loss=1.85, trans_loss=3.256, nll_loss=1.333, w2v_ctc_loss=0.91, task_loss=0, contrastive_loss=0.109, total=6695.08, n_correct=4635.37, ppl=2.52, accuracy=69.235, wps=14092.2, ups=0.73, wpb=19387.8, bsz=667.7, num_updates=14300, lr=0.000118262, gnorm=0.318, clip=0, loss_scale=16, train_wall=87, gb_free=12.1, wall=13478
2023-08-25 15:38:35 | INFO | train_inner | epoch 013:    116 / 1191 loss=1.832, trans_loss=3.237, nll_loss=1.31, w2v_ctc_loss=0.882, task_loss=0, contrastive_loss=0.167, total=6709.84, n_correct=4674.9, ppl=2.48, accuracy=69.672, wps=22264, ups=1.15, wpb=19443.8, bsz=663.9, num_updates=14400, lr=0.000117851, gnorm=0.317, clip=0, loss_scale=16, train_wall=87, gb_free=12.2, wall=13565
2023-08-25 15:40:02 | INFO | train_inner | epoch 013:    216 / 1191 loss=1.848, trans_loss=3.247, nll_loss=1.323, w2v_ctc_loss=0.883, task_loss=0, contrastive_loss=0.209, total=6635.65, n_correct=4609, ppl=2.5, accuracy=69.458, wps=22148.8, ups=1.15, wpb=19225.6, bsz=687.8, num_updates=14500, lr=0.000117444, gnorm=0.323, clip=0, loss_scale=16, train_wall=86, gb_free=14.6, wall=13652
2023-08-25 15:41:29 | INFO | train_inner | epoch 013:    316 / 1191 loss=1.864, trans_loss=3.243, nll_loss=1.318, w2v_ctc_loss=0.871, task_loss=0, contrastive_loss=0.307, total=6732.12, n_correct=4688.66, ppl=2.49, accuracy=69.646, wps=22400.5, ups=1.15, wpb=19501.5, bsz=716.2, num_updates=14600, lr=0.000117041, gnorm=0.324, clip=0, loss_scale=16, train_wall=86, gb_free=13.5, wall=13739
2023-08-25 15:42:55 | INFO | train_inner | epoch 013:    416 / 1191 loss=1.826, trans_loss=3.246, nll_loss=1.322, w2v_ctc_loss=0.89, task_loss=0, contrastive_loss=0.088, total=6753.67, n_correct=4695.23, ppl=2.5, accuracy=69.521, wps=22609, ups=1.16, wpb=19572.6, bsz=678.7, num_updates=14700, lr=0.000116642, gnorm=0.32, clip=0, loss_scale=16, train_wall=86, gb_free=13.6, wall=13826
2023-08-25 15:44:22 | INFO | train_inner | epoch 013:    516 / 1191 loss=1.847, trans_loss=3.248, nll_loss=1.325, w2v_ctc_loss=0.891, task_loss=0, contrastive_loss=0.183, total=6638.04, n_correct=4602.73, ppl=2.5, accuracy=69.339, wps=22131.8, ups=1.15, wpb=19233.6, bsz=655.6, num_updates=14800, lr=0.000116248, gnorm=0.326, clip=0, loss_scale=32, train_wall=86, gb_free=15, wall=13913
2023-08-25 15:45:49 | INFO | train_inner | epoch 013:    616 / 1191 loss=1.84, trans_loss=3.248, nll_loss=1.323, w2v_ctc_loss=0.898, task_loss=0, contrastive_loss=0.135, total=6702.58, n_correct=4650.23, ppl=2.5, accuracy=69.38, wps=22336.6, ups=1.15, wpb=19417.2, bsz=654.1, num_updates=14900, lr=0.000115857, gnorm=0.32, clip=0, loss_scale=32, train_wall=86, gb_free=13.9, wall=14000
2023-08-25 15:47:16 | INFO | train_inner | epoch 013:    716 / 1191 loss=1.826, trans_loss=3.245, nll_loss=1.32, w2v_ctc_loss=0.89, task_loss=0, contrastive_loss=0.094, total=6640, n_correct=4616.72, ppl=2.5, accuracy=69.529, wps=22082.7, ups=1.15, wpb=19234, bsz=654.1, num_updates=15000, lr=0.00011547, gnorm=0.334, clip=0, loss_scale=32, train_wall=86, gb_free=15.2, wall=14087
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 15:48:13 | INFO | train_inner | epoch 013:    816 / 1191 loss=1.948, trans_loss=4.682, nll_loss=1.909, w2v_ctc_loss=0.645, task_loss=0, contrastive_loss=0.115, total=6754.21, n_correct=4691.99, ppl=3.75, accuracy=69.468, wps=23796.2, ups=1.75, wpb=13574.6, bsz=462.3, num_updates=15100, lr=0.000115087, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=14.4, wall=14144
2023-08-25 15:49:10 | INFO | train_inner | epoch 013:    916 / 1191 loss=1.953, trans_loss=4.703, nll_loss=1.915, w2v_ctc_loss=0.661, task_loss=0, contrastive_loss=0.095, total=6564.2, n_correct=4551.95, ppl=3.77, accuracy=69.345, wps=23161.1, ups=1.76, wpb=13128.4, bsz=422.2, num_updates=15200, lr=0.000114708, gnorm=0.422, clip=0, loss_scale=32, train_wall=56, gb_free=13.6, wall=14200
2023-08-25 15:50:07 | INFO | train_inner | epoch 013:   1016 / 1191 loss=1.945, trans_loss=4.699, nll_loss=1.911, w2v_ctc_loss=0.644, task_loss=0, contrastive_loss=0.078, total=6796.22, n_correct=4730.33, ppl=3.76, accuracy=69.602, wps=23756.5, ups=1.75, wpb=13592.4, bsz=468.6, num_updates=15300, lr=0.000114332, gnorm=0.419, clip=0, loss_scale=32, train_wall=57, gb_free=12.8, wall=14258
2023-08-25 15:51:04 | INFO | train_inner | epoch 013:   1116 / 1191 loss=1.955, trans_loss=4.702, nll_loss=1.915, w2v_ctc_loss=0.654, task_loss=0, contrastive_loss=0.139, total=6753.73, n_correct=4693.42, ppl=3.77, accuracy=69.494, wps=23702.9, ups=1.75, wpb=13507.5, bsz=465.1, num_updates=15400, lr=0.000113961, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=14315
2023-08-25 15:51:47 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
2023-08-25 15:52:18 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 3.87 | trans_loss 4.91 | nll_loss 2.137 | w2v_ctc_loss 1.264 | task_loss 0 | contrastive_loss 0.269 | total 6138.43 | n_correct 4332.71 | ppl 4.4 | accuracy 70.583 | uer 17.669 | wer 19.491 | raw_wer 19.491 | bleu 28.18 | wps 1863.9 | wpb 6138.4 | bsz 201.1 | num_updates 15475 | best_bleu 28.18
2023-08-25 15:52:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 15475 updates
2023-08-25 15:52:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 15:52:23 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 15:52:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 13 @ 15475 updates, score 28.18) (writing took 10.740199914002005 seconds)
2023-08-25 15:52:29 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-08-25 15:52:29 | INFO | train | epoch 013 | loss 1.876 | trans_loss 3.703 | nll_loss 1.507 | w2v_ctc_loss 0.812 | task_loss 0 | contrastive_loss 0.154 | total 6703.69 | n_correct 4658.88 | ppl 2.84 | accuracy 69.497 | wps 21490.3 | ups 1.26 | wpb 17022.9 | bsz 587.5 | num_updates 15475 | lr 0.000113684 | gnorm 0.361 | clip 0 | loss_scale 32 | train_wall 885 | gb_free 10.4 | wall 14400
2023-08-25 15:52:29 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 15:52:29 | INFO | fairseq.trainer | begin training epoch 14
2023-08-25 15:52:29 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 15:52:51 | INFO | train_inner | epoch 014:     25 / 1191 loss=1.953, trans_loss=4.7, nll_loss=1.913, w2v_ctc_loss=0.652, task_loss=0, contrastive_loss=0.132, total=6745.72, n_correct=4694.4, ppl=3.77, accuracy=69.591, wps=12663.4, ups=0.94, wpb=13491.4, bsz=465.6, num_updates=15500, lr=0.000113592, gnorm=0.42, clip=0, loss_scale=32, train_wall=56, gb_free=14.1, wall=14421
2023-08-25 15:53:47 | INFO | train_inner | epoch 014:    125 / 1191 loss=1.943, trans_loss=4.684, nll_loss=1.89, w2v_ctc_loss=0.642, task_loss=0, contrastive_loss=0.147, total=6649.06, n_correct=4648.85, ppl=3.71, accuracy=69.917, wps=23601.7, ups=1.77, wpb=13298.1, bsz=449.5, num_updates=15600, lr=0.000113228, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=14.6, wall=14478
2023-08-25 15:54:43 | INFO | train_inner | epoch 014:    225 / 1191 loss=1.936, trans_loss=4.688, nll_loss=1.896, w2v_ctc_loss=0.636, task_loss=0, contrastive_loss=0.081, total=6640.19, n_correct=4633.67, ppl=3.72, accuracy=69.782, wps=23606.1, ups=1.78, wpb=13280.4, bsz=445.2, num_updates=15700, lr=0.000112867, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=14534
2023-08-25 15:55:40 | INFO | train_inner | epoch 014:    325 / 1191 loss=1.945, trans_loss=4.687, nll_loss=1.895, w2v_ctc_loss=0.643, task_loss=0, contrastive_loss=0.147, total=6727.18, n_correct=4691.25, ppl=3.72, accuracy=69.736, wps=23585.4, ups=1.75, wpb=13454.4, bsz=448.4, num_updates=15800, lr=0.000112509, gnorm=0.419, clip=0, loss_scale=32, train_wall=56, gb_free=15.5, wall=14591
2023-08-25 15:56:37 | INFO | train_inner | epoch 014:    425 / 1191 loss=1.932, trans_loss=4.681, nll_loss=1.888, w2v_ctc_loss=0.632, task_loss=0, contrastive_loss=0.084, total=6815.51, n_correct=4768.65, ppl=3.7, accuracy=69.968, wps=23919.3, ups=1.75, wpb=13631, bsz=469.3, num_updates=15900, lr=0.000112154, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=10.6, wall=14648
2023-08-25 15:57:34 | INFO | train_inner | epoch 014:    525 / 1191 loss=1.948, trans_loss=4.683, nll_loss=1.891, w2v_ctc_loss=0.642, task_loss=0, contrastive_loss=0.173, total=6712.88, n_correct=4686.88, ppl=3.71, accuracy=69.819, wps=23665.9, ups=1.76, wpb=13425.8, bsz=457.4, num_updates=16000, lr=0.000111803, gnorm=0.422, clip=0, loss_scale=32, train_wall=56, gb_free=11.8, wall=14705
2023-08-25 15:57:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 15:58:05 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.854 | trans_loss 4.908 | nll_loss 2.136 | w2v_ctc_loss 1.218 | task_loss 0 | contrastive_loss 0.264 | total 6138.43 | n_correct 4333.14 | ppl 4.4 | accuracy 70.59 | uer 17.747 | wer 19.524 | raw_wer 19.524 | bleu 28.01 | wps 1855.4 | wpb 6138.4 | bsz 201.1 | num_updates 16000 | best_bleu 28.18
2023-08-25 15:58:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16000 updates
2023-08-25 15:58:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_14_16000.pt
2023-08-25 15:58:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_14_16000.pt
2023-08-25 15:58:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_14_16000.pt (epoch 14 @ 16000 updates, score 28.01) (writing took 7.961868662001507 seconds)
2023-08-25 15:59:11 | INFO | train_inner | epoch 014:    625 / 1191 loss=1.941, trans_loss=4.686, nll_loss=1.895, w2v_ctc_loss=0.647, task_loss=0, contrastive_loss=0.105, total=6813.07, n_correct=4758.47, ppl=3.72, accuracy=69.843, wps=14098.8, ups=1.03, wpb=13626.1, bsz=465.5, num_updates=16100, lr=0.000111456, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=13.4, wall=14801
2023-08-25 16:00:07 | INFO | train_inner | epoch 014:    725 / 1191 loss=1.949, trans_loss=4.688, nll_loss=1.896, w2v_ctc_loss=0.649, task_loss=0, contrastive_loss=0.158, total=6696.46, n_correct=4671.19, ppl=3.72, accuracy=69.756, wps=23651, ups=1.77, wpb=13392.9, bsz=448.9, num_updates=16200, lr=0.000111111, gnorm=0.418, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=14858
2023-08-25 16:01:04 | INFO | train_inner | epoch 014:    825 / 1191 loss=1.952, trans_loss=4.692, nll_loss=1.903, w2v_ctc_loss=0.647, task_loss=0, contrastive_loss=0.193, total=6693.66, n_correct=4662.46, ppl=3.74, accuracy=69.655, wps=23503, ups=1.76, wpb=13387.3, bsz=458.7, num_updates=16300, lr=0.00011077, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=13.2, wall=14915
2023-08-25 16:02:01 | INFO | train_inner | epoch 014:    925 / 1191 loss=1.938, trans_loss=4.687, nll_loss=1.896, w2v_ctc_loss=0.644, task_loss=0, contrastive_loss=0.077, total=6650.35, n_correct=4641.77, ppl=3.72, accuracy=69.797, wps=23492.6, ups=1.77, wpb=13300.7, bsz=446.5, num_updates=16400, lr=0.000110432, gnorm=0.417, clip=0, loss_scale=32, train_wall=56, gb_free=14.6, wall=14971
2023-08-25 16:02:58 | INFO | train_inner | epoch 014:   1025 / 1191 loss=1.945, trans_loss=4.695, nll_loss=1.906, w2v_ctc_loss=0.659, task_loss=0, contrastive_loss=0.067, total=6555.51, n_correct=4563.32, ppl=3.75, accuracy=69.61, wps=22956.2, ups=1.75, wpb=13111, bsz=417.3, num_updates=16500, lr=0.000110096, gnorm=0.422, clip=0, loss_scale=32, train_wall=56, gb_free=14.3, wall=15029
2023-08-25 16:03:55 | INFO | train_inner | epoch 014:   1125 / 1191 loss=1.941, trans_loss=4.685, nll_loss=1.895, w2v_ctc_loss=0.642, task_loss=0, contrastive_loss=0.117, total=6806.29, n_correct=4762.68, ppl=3.72, accuracy=69.975, wps=24040.7, ups=1.77, wpb=13612.6, bsz=476.8, num_updates=16600, lr=0.000109764, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=15085
2023-08-25 16:04:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:05:03 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.854 | trans_loss 4.898 | nll_loss 2.121 | w2v_ctc_loss 1.243 | task_loss 0 | contrastive_loss 0.264 | total 6138.43 | n_correct 4340.14 | ppl 4.35 | accuracy 70.704 | uer 17.589 | wer 19.431 | raw_wer 19.431 | bleu 28.16 | wps 1865.1 | wpb 6138.4 | bsz 201.1 | num_updates 16666 | best_bleu 28.18
2023-08-25 16:05:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16666 updates
2023-08-25 16:05:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.1606.pt
2023-08-25 16:05:06 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.1606.pt
2023-08-25 16:05:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.1606.pt (epoch 14 @ 16666 updates, score 28.16) (writing took 6.2495834740002465 seconds)
2023-08-25 16:05:10 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2023-08-25 16:05:10 | INFO | train | epoch 014 | loss 1.942 | trans_loss 4.687 | nll_loss 1.895 | w2v_ctc_loss 0.644 | task_loss 0 | contrastive_loss 0.121 | total 6703.69 | n_correct 4680.09 | ppl 3.72 | accuracy 69.814 | wps 20981.6 | ups 1.56 | wpb 13407.4 | bsz 452.1 | num_updates 16666 | lr 0.000109547 | gnorm 0.417 | clip 0 | loss_scale 32 | train_wall 669 | gb_free 14.7 | wall 15161
2023-08-25 16:05:11 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 16:05:11 | INFO | fairseq.trainer | begin training epoch 15
2023-08-25 16:05:11 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 16:05:37 | INFO | train_inner | epoch 015:     34 / 1191 loss=1.94, trans_loss=4.679, nll_loss=1.886, w2v_ctc_loss=0.643, task_loss=0, contrastive_loss=0.126, total=6697.04, n_correct=4686.18, ppl=3.7, accuracy=69.974, wps=13067.4, ups=0.98, wpb=13394.1, bsz=449.8, num_updates=16700, lr=0.000109435, gnorm=0.419, clip=0, loss_scale=32, train_wall=56, gb_free=11.2, wall=15188
2023-08-25 16:06:34 | INFO | train_inner | epoch 015:    134 / 1191 loss=1.932, trans_loss=4.673, nll_loss=1.878, w2v_ctc_loss=0.635, task_loss=0, contrastive_loss=0.117, total=6739.18, n_correct=4731.43, ppl=3.68, accuracy=70.208, wps=23791.9, ups=1.77, wpb=13478.4, bsz=457.1, num_updates=16800, lr=0.000109109, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=10.9, wall=15244
2023-08-25 16:07:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-25 16:07:31 | INFO | train_inner | epoch 015:    235 / 1191 loss=1.929, trans_loss=4.669, nll_loss=1.872, w2v_ctc_loss=0.636, task_loss=0, contrastive_loss=0.093, total=6688.93, n_correct=4697.64, ppl=3.66, accuracy=70.23, wps=23481.8, ups=1.76, wpb=13377.9, bsz=448, num_updates=16900, lr=0.000108786, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=14.7, wall=15301
2023-08-25 16:08:27 | INFO | train_inner | epoch 015:    335 / 1191 loss=1.922, trans_loss=4.662, nll_loss=1.864, w2v_ctc_loss=0.628, task_loss=0, contrastive_loss=0.086, total=6665.88, n_correct=4689.2, ppl=3.64, accuracy=70.346, wps=23591.3, ups=1.77, wpb=13331.8, bsz=446.9, num_updates=17000, lr=0.000108465, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=15358
2023-08-25 16:09:24 | INFO | train_inner | epoch 015:    435 / 1191 loss=1.938, trans_loss=4.679, nll_loss=1.886, w2v_ctc_loss=0.642, task_loss=0, contrastive_loss=0.113, total=6733.73, n_correct=4715.9, ppl=3.69, accuracy=70.034, wps=23695.7, ups=1.76, wpb=13467.5, bsz=456.4, num_updates=17100, lr=0.000108148, gnorm=0.417, clip=0, loss_scale=32, train_wall=56, gb_free=13.8, wall=15415
2023-08-25 16:10:21 | INFO | train_inner | epoch 015:    535 / 1191 loss=1.938, trans_loss=4.673, nll_loss=1.878, w2v_ctc_loss=0.642, task_loss=0, contrastive_loss=0.123, total=6700.53, n_correct=4699.15, ppl=3.68, accuracy=70.131, wps=23665.2, ups=1.77, wpb=13401.1, bsz=460.4, num_updates=17200, lr=0.000107833, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=14.8, wall=15471
2023-08-25 16:11:17 | INFO | train_inner | epoch 015:    635 / 1191 loss=1.938, trans_loss=4.678, nll_loss=1.884, w2v_ctc_loss=0.649, task_loss=0, contrastive_loss=0.108, total=6598.77, n_correct=4612.93, ppl=3.69, accuracy=69.906, wps=23445.7, ups=1.78, wpb=13197.5, bsz=410.4, num_updates=17300, lr=0.000107521, gnorm=0.42, clip=0, loss_scale=32, train_wall=56, gb_free=12.3, wall=15528
2023-08-25 16:12:14 | INFO | train_inner | epoch 015:    735 / 1191 loss=1.938, trans_loss=4.671, nll_loss=1.875, w2v_ctc_loss=0.633, task_loss=0, contrastive_loss=0.195, total=6644.1, n_correct=4662.3, ppl=3.67, accuracy=70.172, wps=23383.9, ups=1.76, wpb=13288.2, bsz=454.2, num_updates=17400, lr=0.000107211, gnorm=0.421, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=15584
2023-08-25 16:13:11 | INFO | train_inner | epoch 015:    835 / 1191 loss=1.926, trans_loss=4.669, nll_loss=1.873, w2v_ctc_loss=0.639, task_loss=0, contrastive_loss=0.069, total=6725.66, n_correct=4725.53, ppl=3.66, accuracy=70.261, wps=23654.1, ups=1.76, wpb=13451.3, bsz=448.3, num_updates=17500, lr=0.000106904, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=15641
2023-08-25 16:14:08 | INFO | train_inner | epoch 015:    935 / 1191 loss=1.934, trans_loss=4.669, nll_loss=1.874, w2v_ctc_loss=0.631, task_loss=0, contrastive_loss=0.173, total=6750.02, n_correct=4743.47, ppl=3.66, accuracy=70.273, wps=23758.7, ups=1.76, wpb=13500, bsz=473.6, num_updates=17600, lr=0.0001066, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=15698
2023-08-25 16:15:05 | INFO | train_inner | epoch 015:   1035 / 1191 loss=1.928, trans_loss=4.672, nll_loss=1.877, w2v_ctc_loss=0.633, task_loss=0, contrastive_loss=0.091, total=6700.78, n_correct=4708.28, ppl=3.67, accuracy=70.265, wps=23458.3, ups=1.75, wpb=13401.6, bsz=454.3, num_updates=17700, lr=0.000106299, gnorm=0.414, clip=0, loss_scale=32, train_wall=57, gb_free=12.7, wall=15755
2023-08-25 16:16:02 | INFO | train_inner | epoch 015:   1135 / 1191 loss=1.934, trans_loss=4.677, nll_loss=1.884, w2v_ctc_loss=0.64, task_loss=0, contrastive_loss=0.107, total=6753.24, n_correct=4727.04, ppl=3.69, accuracy=69.997, wps=23764.1, ups=1.76, wpb=13506.5, bsz=446, num_updates=17800, lr=0.000106, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=13.1, wall=15812
2023-08-25 16:16:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:17:05 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 3.861 | trans_loss 4.898 | nll_loss 2.122 | w2v_ctc_loss 1.266 | task_loss 0 | contrastive_loss 0.263 | total 6138.43 | n_correct 4338.86 | ppl 4.35 | accuracy 70.684 | uer 17.725 | wer 19.39 | raw_wer 19.39 | bleu 27.97 | wps 1865.7 | wpb 6138.4 | bsz 201.1 | num_updates 17856 | best_bleu 28.18
2023-08-25 16:17:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 17856 updates
2023-08-25 16:17:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.9704.pt
2023-08-25 16:17:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.9704.pt
2023-08-25 16:17:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_27.9704.pt (epoch 15 @ 17856 updates, score 27.97) (writing took 7.3974986630018975 seconds)
2023-08-25 16:17:13 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2023-08-25 16:17:13 | INFO | train | epoch 015 | loss 1.933 | trans_loss 4.672 | nll_loss 1.877 | w2v_ctc_loss 0.637 | task_loss 0 | contrastive_loss 0.12 | total 6703.73 | n_correct 4703.75 | ppl 3.67 | accuracy 70.166 | wps 22091.1 | ups 1.65 | wpb 13407.5 | bsz 452.2 | num_updates 17856 | lr 0.000105833 | gnorm 0.415 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 12 | wall 15883
2023-08-25 16:17:13 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 16:17:13 | INFO | fairseq.trainer | begin training epoch 16
2023-08-25 16:17:13 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 16:17:45 | INFO | train_inner | epoch 016:     44 / 1191 loss=1.931, trans_loss=4.667, nll_loss=1.87, w2v_ctc_loss=0.624, task_loss=0, contrastive_loss=0.181, total=6683.77, n_correct=4701.34, ppl=3.66, accuracy=70.34, wps=12941.8, ups=0.97, wpb=13367.5, bsz=454.6, num_updates=17900, lr=0.000105703, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=14.3, wall=15915
2023-08-25 16:18:42 | INFO | train_inner | epoch 016:    144 / 1191 loss=1.921, trans_loss=4.659, nll_loss=1.859, w2v_ctc_loss=0.629, task_loss=0, contrastive_loss=0.102, total=6721.68, n_correct=4738.11, ppl=3.63, accuracy=70.49, wps=23434.3, ups=1.74, wpb=13443.4, bsz=446.2, num_updates=18000, lr=0.000105409, gnorm=0.408, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=15973
2023-08-25 16:18:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:19:13 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.865 | trans_loss 4.895 | nll_loss 2.117 | w2v_ctc_loss 1.284 | task_loss 0 | contrastive_loss 0.263 | total 6138.43 | n_correct 4346.71 | ppl 4.34 | accuracy 70.812 | uer 17.586 | wer 19.383 | raw_wer 19.383 | bleu 28.24 | wps 1853 | wpb 6138.4 | bsz 201.1 | num_updates 18000 | best_bleu 28.24
2023-08-25 16:19:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 18000 updates
2023-08-25 16:19:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_16_18000.pt
2023-08-25 16:19:15 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_16_18000.pt
2023-08-25 16:19:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_16_18000.pt (epoch 16 @ 18000 updates, score 28.24) (writing took 11.883938950999436 seconds)
2023-08-25 16:20:22 | INFO | train_inner | epoch 016:    244 / 1191 loss=1.924, trans_loss=4.66, nll_loss=1.861, w2v_ctc_loss=0.629, task_loss=0, contrastive_loss=0.119, total=6694.44, n_correct=4712.35, ppl=3.63, accuracy=70.392, wps=13466.5, ups=1.01, wpb=13388.9, bsz=440.6, num_updates=18100, lr=0.000105118, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=16072
2023-08-25 16:21:19 | INFO | train_inner | epoch 016:    344 / 1191 loss=1.925, trans_loss=4.663, nll_loss=1.866, w2v_ctc_loss=0.628, task_loss=0, contrastive_loss=0.117, total=6766.61, n_correct=4765.05, ppl=3.65, accuracy=70.42, wps=23825.3, ups=1.76, wpb=13533.2, bsz=461.2, num_updates=18200, lr=0.000104828, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=16129
2023-08-25 16:22:15 | INFO | train_inner | epoch 016:    444 / 1191 loss=1.92, trans_loss=4.66, nll_loss=1.862, w2v_ctc_loss=0.632, task_loss=0, contrastive_loss=0.071, total=6682.58, n_correct=4707.05, ppl=3.63, accuracy=70.438, wps=23912.4, ups=1.79, wpb=13365.2, bsz=450, num_updates=18300, lr=0.000104542, gnorm=0.412, clip=0, loss_scale=32, train_wall=55, gb_free=13.5, wall=16185
2023-08-25 16:23:11 | INFO | train_inner | epoch 016:    544 / 1191 loss=1.919, trans_loss=4.654, nll_loss=1.854, w2v_ctc_loss=0.622, task_loss=0, contrastive_loss=0.121, total=6679.83, n_correct=4712.43, ppl=3.61, accuracy=70.547, wps=23490.3, ups=1.76, wpb=13359.7, bsz=445.7, num_updates=18400, lr=0.000104257, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=12.7, wall=16242
2023-08-25 16:24:09 | INFO | train_inner | epoch 016:    644 / 1191 loss=1.926, trans_loss=4.659, nll_loss=1.86, w2v_ctc_loss=0.629, task_loss=0, contrastive_loss=0.137, total=6709.38, n_correct=4726.06, ppl=3.63, accuracy=70.44, wps=23242.7, ups=1.73, wpb=13418.8, bsz=455.6, num_updates=18500, lr=0.000103975, gnorm=0.413, clip=0, loss_scale=32, train_wall=57, gb_free=14, wall=16300
2023-08-25 16:25:05 | INFO | train_inner | epoch 016:    744 / 1191 loss=1.919, trans_loss=4.652, nll_loss=1.852, w2v_ctc_loss=0.628, task_loss=0, contrastive_loss=0.099, total=6649.58, n_correct=4692.48, ppl=3.61, accuracy=70.568, wps=23630.7, ups=1.78, wpb=13299.2, bsz=447.6, num_updates=18600, lr=0.000103695, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=15.6, wall=16356
2023-08-25 16:26:02 | INFO | train_inner | epoch 016:    844 / 1191 loss=1.924, trans_loss=4.664, nll_loss=1.866, w2v_ctc_loss=0.635, task_loss=0, contrastive_loss=0.099, total=6697.41, n_correct=4713.67, ppl=3.65, accuracy=70.38, wps=23527.3, ups=1.76, wpb=13394.8, bsz=439.9, num_updates=18700, lr=0.000103418, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=15, wall=16413
2023-08-25 16:26:59 | INFO | train_inner | epoch 016:    944 / 1191 loss=1.923, trans_loss=4.661, nll_loss=1.864, w2v_ctc_loss=0.626, task_loss=0, contrastive_loss=0.112, total=6750.33, n_correct=4754.43, ppl=3.64, accuracy=70.433, wps=23886.7, ups=1.77, wpb=13500.7, bsz=468.6, num_updates=18800, lr=0.000103142, gnorm=0.424, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=16469
2023-08-25 16:27:56 | INFO | train_inner | epoch 016:   1044 / 1191 loss=1.927, trans_loss=4.659, nll_loss=1.86, w2v_ctc_loss=0.634, task_loss=0, contrastive_loss=0.134, total=6671.1, n_correct=4696.71, ppl=3.63, accuracy=70.404, wps=23424, ups=1.76, wpb=13342.2, bsz=455.1, num_updates=18900, lr=0.000102869, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=12.1, wall=16526
2023-08-25 16:28:54 | INFO | train_inner | epoch 016:   1144 / 1191 loss=1.926, trans_loss=4.662, nll_loss=1.865, w2v_ctc_loss=0.628, task_loss=0, contrastive_loss=0.131, total=6800.42, n_correct=4791.24, ppl=3.64, accuracy=70.455, wps=23551, ups=1.73, wpb=13600.8, bsz=479.2, num_updates=19000, lr=0.000102598, gnorm=0.409, clip=0, loss_scale=64, train_wall=57, gb_free=13.7, wall=16584
2023-08-25 16:29:20 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:29:51 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.85 | trans_loss 4.899 | nll_loss 2.127 | w2v_ctc_loss 1.225 | task_loss 0 | contrastive_loss 0.263 | total 6138.43 | n_correct 4340.43 | ppl 4.37 | accuracy 70.709 | uer 17.862 | wer 19.598 | raw_wer 19.598 | bleu 28.27 | wps 1865.8 | wpb 6138.4 | bsz 201.1 | num_updates 19047 | best_bleu 28.27
2023-08-25 16:29:51 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 19047 updates
2023-08-25 16:29:51 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 16:29:56 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 16:30:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 16 @ 19047 updates, score 28.27) (writing took 9.461039008001535 seconds)
2023-08-25 16:30:01 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2023-08-25 16:30:01 | INFO | train | epoch 016 | loss 1.923 | trans_loss 4.659 | nll_loss 1.86 | w2v_ctc_loss 0.629 | task_loss 0 | contrastive_loss 0.118 | total 6703.69 | n_correct 4722.99 | ppl 3.63 | accuracy 70.454 | wps 20789.4 | ups 1.55 | wpb 13407.4 | bsz 452.1 | num_updates 19047 | lr 0.000102471 | gnorm 0.413 | clip 0 | loss_scale 64 | train_wall 669 | gb_free 14 | wall 16651
2023-08-25 16:30:01 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 16:30:01 | INFO | fairseq.trainer | begin training epoch 17
2023-08-25 16:30:01 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 16:30:38 | INFO | train_inner | epoch 017:     53 / 1191 loss=1.921, trans_loss=4.656, nll_loss=1.856, w2v_ctc_loss=0.624, task_loss=0, contrastive_loss=0.14, total=6599.44, n_correct=4650.41, ppl=3.62, accuracy=70.467, wps=12595, ups=0.95, wpb=13198.9, bsz=438, num_updates=19100, lr=0.000102329, gnorm=0.417, clip=0, loss_scale=64, train_wall=56, gb_free=14, wall=16689
2023-08-25 16:31:35 | INFO | train_inner | epoch 017:    153 / 1191 loss=1.913, trans_loss=4.646, nll_loss=1.843, w2v_ctc_loss=0.62, task_loss=0, contrastive_loss=0.124, total=6686.83, n_correct=4728.98, ppl=3.59, accuracy=70.721, wps=23687.2, ups=1.77, wpb=13373.7, bsz=447.9, num_updates=19200, lr=0.000102062, gnorm=0.411, clip=0, loss_scale=64, train_wall=56, gb_free=14.7, wall=16745
2023-08-25 16:32:31 | INFO | train_inner | epoch 017:    253 / 1191 loss=1.905, trans_loss=4.635, nll_loss=1.831, w2v_ctc_loss=0.617, task_loss=0, contrastive_loss=0.076, total=6836.91, n_correct=4857.51, ppl=3.56, accuracy=71.048, wps=24183.6, ups=1.77, wpb=13673.8, bsz=477.7, num_updates=19300, lr=0.000101797, gnorm=0.406, clip=0, loss_scale=64, train_wall=56, gb_free=14.1, wall=16802
2023-08-25 16:33:28 | INFO | train_inner | epoch 017:    353 / 1191 loss=1.912, trans_loss=4.65, nll_loss=1.848, w2v_ctc_loss=0.624, task_loss=0, contrastive_loss=0.075, total=6636.25, n_correct=4688.73, ppl=3.6, accuracy=70.653, wps=23431.1, ups=1.77, wpb=13272.5, bsz=441.6, num_updates=19400, lr=0.000101535, gnorm=0.412, clip=0, loss_scale=64, train_wall=56, gb_free=14, wall=16858
2023-08-25 16:34:25 | INFO | train_inner | epoch 017:    453 / 1191 loss=1.918, trans_loss=4.648, nll_loss=1.846, w2v_ctc_loss=0.625, task_loss=0, contrastive_loss=0.125, total=6699.29, n_correct=4732.24, ppl=3.6, accuracy=70.638, wps=23511.9, ups=1.75, wpb=13398.6, bsz=443.3, num_updates=19500, lr=0.000101274, gnorm=0.421, clip=0, loss_scale=64, train_wall=56, gb_free=10.7, wall=16915
2023-08-25 16:35:19 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-25 16:35:23 | INFO | train_inner | epoch 017:    554 / 1191 loss=1.922, trans_loss=4.655, nll_loss=1.855, w2v_ctc_loss=0.623, task_loss=0, contrastive_loss=0.154, total=6681.86, n_correct=4716.41, ppl=3.62, accuracy=70.585, wps=23178.5, ups=1.73, wpb=13363.7, bsz=442.7, num_updates=19600, lr=0.000101015, gnorm=0.415, clip=0, loss_scale=32, train_wall=57, gb_free=14.6, wall=16973
2023-08-25 16:36:19 | INFO | train_inner | epoch 017:    654 / 1191 loss=1.914, trans_loss=4.646, nll_loss=1.844, w2v_ctc_loss=0.622, task_loss=0, contrastive_loss=0.096, total=6687.04, n_correct=4727.21, ppl=3.59, accuracy=70.692, wps=23760.1, ups=1.78, wpb=13374.1, bsz=458.1, num_updates=19700, lr=0.000100759, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=17029
2023-08-25 16:37:16 | INFO | train_inner | epoch 017:    754 / 1191 loss=1.912, trans_loss=4.651, nll_loss=1.85, w2v_ctc_loss=0.626, task_loss=0, contrastive_loss=0.064, total=6671.22, n_correct=4711.15, ppl=3.61, accuracy=70.619, wps=23605.1, ups=1.77, wpb=13342.4, bsz=434.6, num_updates=19800, lr=0.000100504, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=14.7, wall=17086
2023-08-25 16:38:13 | INFO | train_inner | epoch 017:    854 / 1191 loss=1.921, trans_loss=4.649, nll_loss=1.847, w2v_ctc_loss=0.626, task_loss=0, contrastive_loss=0.157, total=6600.69, n_correct=4661.73, ppl=3.6, accuracy=70.625, wps=23127, ups=1.75, wpb=13201.4, bsz=434.3, num_updates=19900, lr=0.000100251, gnorm=0.424, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=17143
2023-08-25 16:39:09 | INFO | train_inner | epoch 017:    954 / 1191 loss=1.918, trans_loss=4.642, nll_loss=1.839, w2v_ctc_loss=0.605, task_loss=0, contrastive_loss=0.212, total=6821.56, n_correct=4836.75, ppl=3.58, accuracy=70.904, wps=24257, ups=1.78, wpb=13643.1, bsz=498.7, num_updates=20000, lr=0.0001, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=14.6, wall=17199
2023-08-25 16:39:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:39:40 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.844 | trans_loss 4.89 | nll_loss 2.111 | w2v_ctc_loss 1.231 | task_loss 0 | contrastive_loss 0.259 | total 6138.43 | n_correct 4351.43 | ppl 4.32 | accuracy 70.888 | uer 17.244 | wer 18.988 | raw_wer 18.988 | bleu 28.23 | wps 1876.4 | wpb 6138.4 | bsz 201.1 | num_updates 20000 | best_bleu 28.27
2023-08-25 16:39:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20000 updates
2023-08-25 16:39:40 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_17_20000.pt
2023-08-25 16:39:42 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_17_20000.pt
2023-08-25 16:39:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_17_20000.pt (epoch 17 @ 20000 updates, score 28.23) (writing took 8.836778242002765 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 16:40:46 | INFO | train_inner | epoch 017:   1054 / 1191 loss=1.91, trans_loss=4.641, nll_loss=1.839, w2v_ctc_loss=0.62, task_loss=0, contrastive_loss=0.108, total=6652.48, n_correct=4713.63, ppl=3.58, accuracy=70.855, wps=13749.9, ups=1.03, wpb=13305, bsz=441.9, num_updates=20100, lr=9.97509e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=56, gb_free=13.2, wall=17296
2023-08-25 16:41:43 | INFO | train_inner | epoch 017:   1154 / 1191 loss=1.911, trans_loss=4.644, nll_loss=1.841, w2v_ctc_loss=0.623, task_loss=0, contrastive_loss=0.093, total=6757.28, n_correct=4787.71, ppl=3.58, accuracy=70.853, wps=23724.5, ups=1.76, wpb=13514.6, bsz=451.7, num_updates=20200, lr=9.95037e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=14.1, wall=17353
2023-08-25 16:42:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
2023-08-25 16:42:35 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.853 | trans_loss 4.89 | nll_loss 2.112 | w2v_ctc_loss 1.256 | task_loss 0 | contrastive_loss 0.268 | total 6138.43 | n_correct 4353.14 | ppl 4.32 | accuracy 70.916 | uer 17.431 | wer 19.238 | raw_wer 19.238 | bleu 28.43 | wps 1874.5 | wpb 6138.4 | bsz 201.1 | num_updates 20237 | best_bleu 28.43
2023-08-25 16:42:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20237 updates
2023-08-25 16:42:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 16:42:43 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 16:42:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 17 @ 20237 updates, score 28.43) (writing took 14.222394438002084 seconds)
2023-08-25 16:42:49 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2023-08-25 16:42:49 | INFO | train | epoch 017 | loss 1.914 | trans_loss 4.646 | nll_loss 1.844 | w2v_ctc_loss 0.621 | task_loss 0 | contrastive_loss 0.116 | total 6703.79 | n_correct 4742.67 | ppl 3.59 | accuracy 70.746 | wps 20761.3 | ups 1.55 | wpb 13407.6 | bsz 452.2 | num_updates 20237 | lr 9.94127e-05 | gnorm 0.414 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 14.5 | wall 17420
2023-08-25 16:42:49 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 16:42:49 | INFO | fairseq.trainer | begin training epoch 18
2023-08-25 16:42:49 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 16:43:32 | INFO | train_inner | epoch 018:     63 / 1191 loss=1.9, trans_loss=4.63, nll_loss=1.824, w2v_ctc_loss=0.604, task_loss=0, contrastive_loss=0.109, total=6803.5, n_correct=4838.7, ppl=3.54, accuracy=71.121, wps=12445.4, ups=0.91, wpb=13607, bsz=464.9, num_updates=20300, lr=9.92583e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=56, gb_free=13.8, wall=17462
2023-08-25 16:44:29 | INFO | train_inner | epoch 018:    163 / 1191 loss=1.905, trans_loss=4.639, nll_loss=1.835, w2v_ctc_loss=0.619, task_loss=0, contrastive_loss=0.073, total=6645.84, n_correct=4710.81, ppl=3.57, accuracy=70.884, wps=23259.6, ups=1.75, wpb=13291.7, bsz=424, num_updates=20400, lr=9.90148e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=57, gb_free=13.9, wall=17519
2023-08-25 16:45:26 | INFO | train_inner | epoch 018:    263 / 1191 loss=1.913, trans_loss=4.638, nll_loss=1.833, w2v_ctc_loss=0.613, task_loss=0, contrastive_loss=0.178, total=6609.1, n_correct=4689.86, ppl=3.56, accuracy=70.961, wps=23334.7, ups=1.77, wpb=13218.2, bsz=445.1, num_updates=20500, lr=9.8773e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=17576
2023-08-25 16:46:23 | INFO | train_inner | epoch 018:    363 / 1191 loss=1.906, trans_loss=4.632, nll_loss=1.826, w2v_ctc_loss=0.609, task_loss=0, contrastive_loss=0.144, total=6738.43, n_correct=4788.54, ppl=3.55, accuracy=71.063, wps=23698.8, ups=1.76, wpb=13476.9, bsz=459.9, num_updates=20600, lr=9.85329e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=12.3, wall=17633
2023-08-25 16:47:19 | INFO | train_inner | epoch 018:    463 / 1191 loss=1.902, trans_loss=4.635, nll_loss=1.83, w2v_ctc_loss=0.608, task_loss=0, contrastive_loss=0.091, total=6707.38, n_correct=4767.09, ppl=3.56, accuracy=71.072, wps=23644, ups=1.76, wpb=13414.8, bsz=456.1, num_updates=20700, lr=9.82946e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=13.4, wall=17690
2023-08-25 16:48:16 | INFO | train_inner | epoch 018:    563 / 1191 loss=1.903, trans_loss=4.632, nll_loss=1.827, w2v_ctc_loss=0.609, task_loss=0, contrastive_loss=0.107, total=6841.12, n_correct=4863.12, ppl=3.55, accuracy=71.087, wps=24290.4, ups=1.78, wpb=13682.2, bsz=482, num_updates=20800, lr=9.80581e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=13.1, wall=17746
2023-08-25 16:49:12 | INFO | train_inner | epoch 018:    663 / 1191 loss=1.902, trans_loss=4.633, nll_loss=1.827, w2v_ctc_loss=0.614, task_loss=0, contrastive_loss=0.091, total=6567.35, n_correct=4663.24, ppl=3.55, accuracy=71.006, wps=23341, ups=1.78, wpb=13134.7, bsz=427.3, num_updates=20900, lr=9.78232e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=56, gb_free=6.9, wall=17802
2023-08-25 16:50:09 | INFO | train_inner | epoch 018:    763 / 1191 loss=1.904, trans_loss=4.638, nll_loss=1.835, w2v_ctc_loss=0.615, task_loss=0, contrastive_loss=0.079, total=6835.85, n_correct=4854.19, ppl=3.57, accuracy=71.011, wps=23859.6, ups=1.75, wpb=13671.7, bsz=472.2, num_updates=21000, lr=9.759e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=17860
2023-08-25 16:51:06 | INFO | train_inner | epoch 018:    863 / 1191 loss=1.913, trans_loss=4.642, nll_loss=1.839, w2v_ctc_loss=0.621, task_loss=0, contrastive_loss=0.128, total=6702.18, n_correct=4745, ppl=3.58, accuracy=70.798, wps=23438.7, ups=1.75, wpb=13404.4, bsz=448.9, num_updates=21100, lr=9.73585e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=17917
2023-08-25 16:52:03 | INFO | train_inner | epoch 018:    963 / 1191 loss=1.901, trans_loss=4.632, nll_loss=1.826, w2v_ctc_loss=0.617, task_loss=0, contrastive_loss=0.067, total=6702.56, n_correct=4764.13, ppl=3.55, accuracy=71.079, wps=23794.7, ups=1.78, wpb=13405.1, bsz=452.7, num_updates=21200, lr=9.71286e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=11.9, wall=17973
2023-08-25 16:52:59 | INFO | train_inner | epoch 018:   1063 / 1191 loss=1.911, trans_loss=4.639, nll_loss=1.835, w2v_ctc_loss=0.621, task_loss=0, contrastive_loss=0.127, total=6587.43, n_correct=4669.52, ppl=3.57, accuracy=70.885, wps=23274.8, ups=1.77, wpb=13174.9, bsz=434.9, num_updates=21300, lr=9.69003e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=56, gb_free=14.8, wall=18030
2023-08-25 16:53:57 | INFO | train_inner | epoch 018:   1163 / 1191 loss=1.912, trans_loss=4.636, nll_loss=1.831, w2v_ctc_loss=0.617, task_loss=0, contrastive_loss=0.14, total=6769.67, n_correct=4806.81, ppl=3.56, accuracy=71.005, wps=23701.9, ups=1.75, wpb=13539.3, bsz=466.9, num_updates=21400, lr=9.66736e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=57, gb_free=15.3, wall=18087
2023-08-25 16:54:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 16:54:43 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 3.85 | trans_loss 4.884 | nll_loss 2.103 | w2v_ctc_loss 1.267 | task_loss 0 | contrastive_loss 0.252 | total 6138.43 | n_correct 4358.71 | ppl 4.3 | accuracy 71.007 | uer 17.356 | wer 19.2 | raw_wer 19.2 | bleu 28.27 | wps 1862.2 | wpb 6138.4 | bsz 201.1 | num_updates 21428 | best_bleu 28.43
2023-08-25 16:54:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 21428 updates
2023-08-25 16:54:43 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2701.pt
2023-08-25 16:54:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2701.pt
2023-08-25 16:54:51 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2701.pt (epoch 18 @ 21428 updates, score 28.27) (writing took 7.37491605300238 seconds)
2023-08-25 16:54:51 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2023-08-25 16:54:51 | INFO | train | epoch 018 | loss 1.906 | trans_loss 4.635 | nll_loss 1.83 | w2v_ctc_loss 0.613 | task_loss 0 | contrastive_loss 0.114 | total 6703.69 | n_correct 4760.21 | ppl 3.56 | accuracy 71.009 | wps 22111.5 | ups 1.65 | wpb 13407.4 | bsz 452.1 | num_updates 21428 | lr 9.66105e-05 | gnorm 0.413 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 14.1 | wall 18142
2023-08-25 16:54:52 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 16:54:52 | INFO | fairseq.trainer | begin training epoch 19
2023-08-25 16:54:52 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 16:55:40 | INFO | train_inner | epoch 019:     72 / 1191 loss=1.894, trans_loss=4.622, nll_loss=1.813, w2v_ctc_loss=0.603, task_loss=0, contrastive_loss=0.118, total=6585.47, n_correct=4694.85, ppl=3.51, accuracy=71.291, wps=12738.2, ups=0.97, wpb=13170.9, bsz=425.2, num_updates=21500, lr=9.64486e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=18190
2023-08-25 16:56:36 | INFO | train_inner | epoch 019:    172 / 1191 loss=1.885, trans_loss=4.615, nll_loss=1.805, w2v_ctc_loss=0.594, task_loss=0, contrastive_loss=0.066, total=6683.38, n_correct=4777.73, ppl=3.49, accuracy=71.487, wps=23779.8, ups=1.78, wpb=13366.8, bsz=446.6, num_updates=21600, lr=9.6225e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=12.7, wall=18247
2023-08-25 16:57:33 | INFO | train_inner | epoch 019:    272 / 1191 loss=1.895, trans_loss=4.617, nll_loss=1.808, w2v_ctc_loss=0.602, task_loss=0, contrastive_loss=0.12, total=6766.59, n_correct=4830.33, ppl=3.5, accuracy=71.385, wps=23911.4, ups=1.77, wpb=13533.2, bsz=464.3, num_updates=21700, lr=9.60031e-05, gnorm=0.412, clip=0, loss_scale=64, train_wall=56, gb_free=13.4, wall=18303
2023-08-25 16:58:29 | INFO | train_inner | epoch 019:    372 / 1191 loss=1.89, trans_loss=4.625, nll_loss=1.817, w2v_ctc_loss=0.6, task_loss=0, contrastive_loss=0.058, total=6694.81, n_correct=4768.53, ppl=3.52, accuracy=71.227, wps=23767.4, ups=1.78, wpb=13389.6, bsz=444.8, num_updates=21800, lr=9.57826e-05, gnorm=0.411, clip=0, loss_scale=64, train_wall=56, gb_free=14.6, wall=18359
2023-08-25 16:58:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-25 16:59:27 | INFO | train_inner | epoch 019:    473 / 1191 loss=1.906, trans_loss=4.627, nll_loss=1.82, w2v_ctc_loss=0.608, task_loss=0, contrastive_loss=0.157, total=6772.28, n_correct=4817.31, ppl=3.53, accuracy=71.133, wps=23536.1, ups=1.74, wpb=13544.6, bsz=473.6, num_updates=21900, lr=9.55637e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=57, gb_free=12.6, wall=18417
2023-08-25 17:00:24 | INFO | train_inner | epoch 019:    573 / 1191 loss=1.896, trans_loss=4.629, nll_loss=1.823, w2v_ctc_loss=0.607, task_loss=0, contrastive_loss=0.084, total=6753.74, n_correct=4812.18, ppl=3.54, accuracy=71.252, wps=23668.7, ups=1.75, wpb=13507.5, bsz=462.6, num_updates=22000, lr=9.53463e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=56, gb_free=12.1, wall=18474
2023-08-25 17:00:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:00:55 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.842 | trans_loss 4.881 | nll_loss 2.1 | w2v_ctc_loss 1.246 | task_loss 0 | contrastive_loss 0.262 | total 6138.43 | n_correct 4357.14 | ppl 4.29 | accuracy 70.981 | uer 17.062 | wer 18.914 | raw_wer 18.914 | bleu 28.43 | wps 1871.6 | wpb 6138.4 | bsz 201.1 | num_updates 22000 | best_bleu 28.43
2023-08-25 17:00:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22000 updates
2023-08-25 17:00:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_19_22000.pt
2023-08-25 17:00:56 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_19_22000.pt
2023-08-25 17:01:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_19_22000.pt (epoch 19 @ 22000 updates, score 28.43) (writing took 12.7237065349982 seconds)
2023-08-25 17:02:05 | INFO | train_inner | epoch 019:    673 / 1191 loss=1.898, trans_loss=4.619, nll_loss=1.81, w2v_ctc_loss=0.595, task_loss=0, contrastive_loss=0.178, total=6649.95, n_correct=4745.16, ppl=3.51, accuracy=71.356, wps=13182.4, ups=0.99, wpb=13299.9, bsz=451.5, num_updates=22100, lr=9.51303e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=18575
2023-08-25 17:03:01 | INFO | train_inner | epoch 019:    773 / 1191 loss=1.899, trans_loss=4.625, nll_loss=1.818, w2v_ctc_loss=0.611, task_loss=0, contrastive_loss=0.09, total=6758.75, n_correct=4814.1, ppl=3.53, accuracy=71.228, wps=23853.1, ups=1.76, wpb=13517.5, bsz=461.1, num_updates=22200, lr=9.49158e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=12.4, wall=18632
2023-08-25 17:03:58 | INFO | train_inner | epoch 019:    873 / 1191 loss=1.907, trans_loss=4.627, nll_loss=1.82, w2v_ctc_loss=0.615, task_loss=0, contrastive_loss=0.153, total=6623.8, n_correct=4709.53, ppl=3.53, accuracy=71.1, wps=23368.2, ups=1.76, wpb=13247.6, bsz=440.7, num_updates=22300, lr=9.47027e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=14.6, wall=18688
2023-08-25 17:04:55 | INFO | train_inner | epoch 019:    973 / 1191 loss=1.895, trans_loss=4.621, nll_loss=1.812, w2v_ctc_loss=0.609, task_loss=0, contrastive_loss=0.092, total=6611.17, n_correct=4711.6, ppl=3.51, accuracy=71.267, wps=23268.6, ups=1.76, wpb=13222.3, bsz=434.3, num_updates=22400, lr=9.44911e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=13.5, wall=18745
2023-08-25 17:05:51 | INFO | train_inner | epoch 019:   1073 / 1191 loss=1.901, trans_loss=4.625, nll_loss=1.819, w2v_ctc_loss=0.611, task_loss=0, contrastive_loss=0.114, total=6738.74, n_correct=4799.51, ppl=3.53, accuracy=71.223, wps=23909.8, ups=1.77, wpb=13477.5, bsz=455.1, num_updates=22500, lr=9.42809e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=14.4, wall=18802
2023-08-25 17:06:48 | INFO | train_inner | epoch 019:   1173 / 1191 loss=1.907, trans_loss=4.637, nll_loss=1.833, w2v_ctc_loss=0.61, task_loss=0, contrastive_loss=0.137, total=6789.71, n_correct=4821.16, ppl=3.56, accuracy=71.007, wps=23700.9, ups=1.75, wpb=13579.4, bsz=457.9, num_updates=22600, lr=9.40721e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=18859
2023-08-25 17:06:59 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:07:30 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.842 | trans_loss 4.881 | nll_loss 2.102 | w2v_ctc_loss 1.247 | task_loss 0 | contrastive_loss 0.254 | total 6138.43 | n_correct 4355.86 | ppl 4.29 | accuracy 70.96 | uer 17.319 | wer 19.107 | raw_wer 19.107 | bleu 28.28 | wps 1815.8 | wpb 6138.4 | bsz 201.1 | num_updates 22618 | best_bleu 28.43
2023-08-25 17:07:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22618 updates
2023-08-25 17:07:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2809.pt
2023-08-25 17:07:32 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2809.pt
2023-08-25 17:07:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.2809.pt (epoch 19 @ 22618 updates, score 28.28) (writing took 8.016665528000885 seconds)
2023-08-25 17:07:39 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2023-08-25 17:07:39 | INFO | train | epoch 019 | loss 1.898 | trans_loss 4.624 | nll_loss 1.817 | w2v_ctc_loss 0.606 | task_loss 0 | contrastive_loss 0.112 | total 6702.51 | n_correct 4775.12 | ppl 3.52 | accuracy 71.244 | wps 20779 | ups 1.55 | wpb 13405 | bsz 451.8 | num_updates 22618 | lr 9.40346e-05 | gnorm 0.411 | clip 0 | loss_scale 32 | train_wall 667 | gb_free 14.6 | wall 18909
2023-08-25 17:07:39 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 17:07:39 | INFO | fairseq.trainer | begin training epoch 20
2023-08-25 17:07:39 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 17:08:33 | INFO | train_inner | epoch 020:     82 / 1191 loss=1.888, trans_loss=4.61, nll_loss=1.798, w2v_ctc_loss=0.599, task_loss=0, contrastive_loss=0.096, total=6693.71, n_correct=4785.64, ppl=3.48, accuracy=71.495, wps=12833.3, ups=0.96, wpb=13387.4, bsz=451.9, num_updates=22700, lr=9.38647e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=56, gb_free=13.8, wall=18963
2023-08-25 17:09:29 | INFO | train_inner | epoch 020:    182 / 1191 loss=1.888, trans_loss=4.609, nll_loss=1.796, w2v_ctc_loss=0.596, task_loss=0, contrastive_loss=0.114, total=6599.88, n_correct=4720.71, ppl=3.47, accuracy=71.527, wps=23530.1, ups=1.78, wpb=13199.8, bsz=438.3, num_updates=22800, lr=9.36586e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=15.4, wall=19019
2023-08-25 17:10:25 | INFO | train_inner | epoch 020:    282 / 1191 loss=1.892, trans_loss=4.617, nll_loss=1.807, w2v_ctc_loss=0.597, task_loss=0, contrastive_loss=0.123, total=6767.67, n_correct=4836.23, ppl=3.5, accuracy=71.461, wps=23985.5, ups=1.77, wpb=13535.3, bsz=457.2, num_updates=22900, lr=9.34539e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=13.2, wall=19076
2023-08-25 17:11:22 | INFO | train_inner | epoch 020:    382 / 1191 loss=1.889, trans_loss=4.618, nll_loss=1.808, w2v_ctc_loss=0.602, task_loss=0, contrastive_loss=0.069, total=6794.56, n_correct=4853.89, ppl=3.5, accuracy=71.438, wps=24072.4, ups=1.77, wpb=13589.1, bsz=468.7, num_updates=23000, lr=9.32505e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=14.4, wall=19132
2023-08-25 17:12:19 | INFO | train_inner | epoch 020:    482 / 1191 loss=1.886, trans_loss=4.609, nll_loss=1.797, w2v_ctc_loss=0.596, task_loss=0, contrastive_loss=0.104, total=6694, n_correct=4788.33, ppl=3.48, accuracy=71.532, wps=23605, ups=1.76, wpb=13388, bsz=446.1, num_updates=23100, lr=9.30484e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=12.1, wall=19189
2023-08-25 17:13:15 | INFO | train_inner | epoch 020:    582 / 1191 loss=1.906, trans_loss=4.618, nll_loss=1.809, w2v_ctc_loss=0.607, task_loss=0, contrastive_loss=0.21, total=6622.52, n_correct=4718.87, ppl=3.5, accuracy=71.255, wps=23406.3, ups=1.77, wpb=13245, bsz=442.4, num_updates=23200, lr=9.28477e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=56, gb_free=13.3, wall=19245
2023-08-25 17:14:12 | INFO | train_inner | epoch 020:    682 / 1191 loss=1.889, trans_loss=4.612, nll_loss=1.801, w2v_ctc_loss=0.584, task_loss=0, contrastive_loss=0.15, total=6711.24, n_correct=4803.64, ppl=3.48, accuracy=71.576, wps=23797.4, ups=1.77, wpb=13422.5, bsz=470.5, num_updates=23300, lr=9.26482e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=19302
2023-08-25 17:15:08 | INFO | train_inner | epoch 020:    782 / 1191 loss=1.89, trans_loss=4.615, nll_loss=1.805, w2v_ctc_loss=0.598, task_loss=0, contrastive_loss=0.112, total=6749.91, n_correct=4826.48, ppl=3.5, accuracy=71.504, wps=23894.4, ups=1.77, wpb=13499.8, bsz=458.6, num_updates=23400, lr=9.245e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=19358
2023-08-25 17:16:05 | INFO | train_inner | epoch 020:    882 / 1191 loss=1.887, trans_loss=4.614, nll_loss=1.803, w2v_ctc_loss=0.601, task_loss=0, contrastive_loss=0.072, total=6725.15, n_correct=4808.92, ppl=3.49, accuracy=71.507, wps=23659.3, ups=1.76, wpb=13450.3, bsz=447.2, num_updates=23500, lr=9.22531e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=19415
2023-08-25 17:17:02 | INFO | train_inner | epoch 020:    982 / 1191 loss=1.882, trans_loss=4.613, nll_loss=1.802, w2v_ctc_loss=0.593, task_loss=0, contrastive_loss=0.066, total=6666.28, n_correct=4765.9, ppl=3.49, accuracy=71.493, wps=23330.4, ups=1.75, wpb=13332.6, bsz=433.5, num_updates=23600, lr=9.20575e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=57, gb_free=13.5, wall=19472
2023-08-25 17:17:59 | INFO | train_inner | epoch 020:   1082 / 1191 loss=1.888, trans_loss=4.615, nll_loss=1.805, w2v_ctc_loss=0.606, task_loss=0, contrastive_loss=0.062, total=6748.86, n_correct=4821.64, ppl=3.49, accuracy=71.444, wps=23845.2, ups=1.77, wpb=13497.7, bsz=458, num_updates=23700, lr=9.1863e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=19529
2023-08-25 17:18:55 | INFO | train_inner | epoch 020:   1182 / 1191 loss=1.893, trans_loss=4.621, nll_loss=1.813, w2v_ctc_loss=0.601, task_loss=0, contrastive_loss=0.102, total=6683.47, n_correct=4767.9, ppl=3.51, accuracy=71.339, wps=23522.6, ups=1.76, wpb=13366.9, bsz=452.7, num_updates=23800, lr=9.16698e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=14.4, wall=19586
2023-08-25 17:19:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:19:31 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 3.84 | trans_loss 4.877 | nll_loss 2.092 | w2v_ctc_loss 1.248 | task_loss 0 | contrastive_loss 0.26 | total 6138.43 | n_correct 4370.86 | ppl 4.26 | accuracy 71.205 | uer 17.113 | wer 18.758 | raw_wer 18.758 | bleu 28.72 | wps 1849.8 | wpb 6138.4 | bsz 201.1 | num_updates 23809 | best_bleu 28.72
2023-08-25 17:19:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 23809 updates
2023-08-25 17:19:31 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 17:19:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 17:19:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 20 @ 23809 updates, score 28.72) (writing took 12.918985919000988 seconds)
2023-08-25 17:19:45 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2023-08-25 17:19:45 | INFO | train | epoch 020 | loss 1.89 | trans_loss 4.614 | nll_loss 1.804 | w2v_ctc_loss 0.598 | task_loss 0 | contrastive_loss 0.111 | total 6703.69 | n_correct 4790.56 | ppl 3.49 | accuracy 71.461 | wps 21999.8 | ups 1.64 | wpb 13407.4 | bsz 452.1 | num_updates 23809 | lr 9.16525e-05 | gnorm 0.411 | clip 0 | loss_scale 32 | train_wall 667 | gb_free 15.7 | wall 19635
2023-08-25 17:19:45 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 17:19:45 | INFO | fairseq.trainer | begin training epoch 21
2023-08-25 17:19:45 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 17:20:44 | INFO | train_inner | epoch 021:     91 / 1191 loss=1.889, trans_loss=4.601, nll_loss=1.787, w2v_ctc_loss=0.581, task_loss=0, contrastive_loss=0.219, total=6760.63, n_correct=4852.58, ppl=3.45, accuracy=71.777, wps=12488.4, ups=0.92, wpb=13521.3, bsz=474.7, num_updates=23900, lr=9.14779e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=56, gb_free=12.8, wall=19694
2023-08-25 17:21:40 | INFO | train_inner | epoch 021:    191 / 1191 loss=1.874, trans_loss=4.595, nll_loss=1.78, w2v_ctc_loss=0.584, task_loss=0, contrastive_loss=0.089, total=6783.08, n_correct=4879.16, ppl=3.43, accuracy=71.931, wps=23922.4, ups=1.76, wpb=13566.2, bsz=471.6, num_updates=24000, lr=9.12871e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=56, gb_free=14.6, wall=19751
2023-08-25 17:21:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:22:11 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.849 | trans_loss 4.882 | nll_loss 2.103 | w2v_ctc_loss 1.265 | task_loss 0 | contrastive_loss 0.261 | total 6138.43 | n_correct 4364 | ppl 4.3 | accuracy 71.093 | uer 17.009 | wer 18.873 | raw_wer 18.873 | bleu 28.44 | wps 1853.4 | wpb 6138.4 | bsz 201.1 | num_updates 24000 | best_bleu 28.72
2023-08-25 17:22:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24000 updates
2023-08-25 17:22:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_21_24000.pt
2023-08-25 17:22:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_21_24000.pt
2023-08-25 17:22:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_21_24000.pt (epoch 21 @ 24000 updates, score 28.44) (writing took 6.627469895000104 seconds)
2023-08-25 17:22:35 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-25 17:23:16 | INFO | train_inner | epoch 021:    292 / 1191 loss=1.876, trans_loss=4.601, nll_loss=1.786, w2v_ctc_loss=0.591, task_loss=0, contrastive_loss=0.056, total=6641.56, n_correct=4768.33, ppl=3.45, accuracy=71.795, wps=13960.6, ups=1.05, wpb=13283.1, bsz=435, num_updates=24100, lr=9.10975e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=56, gb_free=12.5, wall=19846
2023-08-25 17:24:13 | INFO | train_inner | epoch 021:    392 / 1191 loss=1.878, trans_loss=4.606, nll_loss=1.793, w2v_ctc_loss=0.587, task_loss=0, contrastive_loss=0.076, total=6668.27, n_correct=4783.75, ppl=3.47, accuracy=71.739, wps=23422.5, ups=1.76, wpb=13336.5, bsz=449.4, num_updates=24200, lr=9.09091e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=19903
2023-08-25 17:25:09 | INFO | train_inner | epoch 021:    492 / 1191 loss=1.882, trans_loss=4.601, nll_loss=1.787, w2v_ctc_loss=0.596, task_loss=0, contrastive_loss=0.095, total=6689.7, n_correct=4794.82, ppl=3.45, accuracy=71.675, wps=23776.2, ups=1.78, wpb=13379.4, bsz=438.4, num_updates=24300, lr=9.07218e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=19959
2023-08-25 17:26:06 | INFO | train_inner | epoch 021:    592 / 1191 loss=1.882, trans_loss=4.607, nll_loss=1.794, w2v_ctc_loss=0.599, task_loss=0, contrastive_loss=0.057, total=6614.82, n_correct=4737.01, ppl=3.47, accuracy=71.612, wps=23330.4, ups=1.76, wpb=13229.6, bsz=423.7, num_updates=24400, lr=9.05357e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=56, gb_free=15.4, wall=20016
2023-08-25 17:27:03 | INFO | train_inner | epoch 021:    692 / 1191 loss=1.891, trans_loss=4.61, nll_loss=1.799, w2v_ctc_loss=0.599, task_loss=0, contrastive_loss=0.122, total=6722.88, n_correct=4811.97, ppl=3.48, accuracy=71.576, wps=23560.9, ups=1.75, wpb=13445.8, bsz=466.8, num_updates=24500, lr=9.03508e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=57, gb_free=13.1, wall=20073
2023-08-25 17:27:07 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 17:28:00 | INFO | train_inner | epoch 021:    793 / 1191 loss=1.892, trans_loss=4.609, nll_loss=1.797, w2v_ctc_loss=0.593, task_loss=0, contrastive_loss=0.172, total=6637.54, n_correct=4747.94, ppl=3.47, accuracy=71.532, wps=23167.3, ups=1.75, wpb=13275.1, bsz=443.4, num_updates=24600, lr=9.0167e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=57, gb_free=13.9, wall=20130
2023-08-25 17:28:57 | INFO | train_inner | epoch 021:    893 / 1191 loss=1.888, trans_loss=4.607, nll_loss=1.795, w2v_ctc_loss=0.597, task_loss=0, contrastive_loss=0.117, total=6733.33, n_correct=4820.89, ppl=3.47, accuracy=71.597, wps=23627.7, ups=1.75, wpb=13466.7, bsz=452.6, num_updates=24700, lr=8.99843e-05, gnorm=0.407, clip=0, loss_scale=16, train_wall=56, gb_free=12.3, wall=20187
2023-08-25 17:29:54 | INFO | train_inner | epoch 021:    993 / 1191 loss=1.886, trans_loss=4.613, nll_loss=1.802, w2v_ctc_loss=0.588, task_loss=0, contrastive_loss=0.12, total=6800.18, n_correct=4863.86, ppl=3.49, accuracy=71.525, wps=23953.8, ups=1.76, wpb=13600.4, bsz=465.1, num_updates=24800, lr=8.98027e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=56, gb_free=14.8, wall=20244
2023-08-25 17:30:51 | INFO | train_inner | epoch 021:   1093 / 1191 loss=1.888, trans_loss=4.611, nll_loss=1.8, w2v_ctc_loss=0.597, task_loss=0, contrastive_loss=0.105, total=6741.65, n_correct=4820.46, ppl=3.48, accuracy=71.503, wps=23628.1, ups=1.75, wpb=13483.3, bsz=460.7, num_updates=24900, lr=8.96221e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=57, gb_free=14, wall=20301
2023-08-25 17:31:47 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:32:18 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.839 | trans_loss 4.875 | nll_loss 2.089 | w2v_ctc_loss 1.254 | task_loss 0 | contrastive_loss 0.254 | total 6138.43 | n_correct 4372 | ppl 4.26 | accuracy 71.223 | uer 17.006 | wer 18.847 | raw_wer 18.847 | bleu 28.56 | wps 1843.5 | wpb 6138.4 | bsz 201.1 | num_updates 24998 | best_bleu 28.72
2023-08-25 17:32:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24998 updates
2023-08-25 17:32:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5603.pt
2023-08-25 17:32:20 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5603.pt
2023-08-25 17:32:24 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5603.pt (epoch 21 @ 24998 updates, score 28.56) (writing took 5.954564810999727 seconds)
2023-08-25 17:32:25 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2023-08-25 17:32:25 | INFO | train | epoch 021 | loss 1.884 | trans_loss 4.605 | nll_loss 1.792 | w2v_ctc_loss 0.592 | task_loss 0 | contrastive_loss 0.11 | total 6704.23 | n_correct 4804.72 | ppl 3.46 | accuracy 71.667 | wps 20988.9 | ups 1.57 | wpb 13408.5 | bsz 452.2 | num_updates 24998 | lr 8.94463e-05 | gnorm 0.411 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 13.7 | wall 20395
2023-08-25 17:32:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 17:32:25 | INFO | fairseq.trainer | begin training epoch 22
2023-08-25 17:32:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 17:32:33 | INFO | train_inner | epoch 022:      2 / 1191 loss=1.883, trans_loss=4.603, nll_loss=1.79, w2v_ctc_loss=0.589, task_loss=0, contrastive_loss=0.118, total=6648.83, n_correct=4766.72, ppl=3.46, accuracy=71.693, wps=13049.1, ups=0.98, wpb=13297.7, bsz=449.7, num_updates=25000, lr=8.94427e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=57, gb_free=14.1, wall=20403
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 17:33:29 | INFO | train_inner | epoch 022:    102 / 1191 loss=1.866, trans_loss=4.59, nll_loss=1.773, w2v_ctc_loss=0.572, task_loss=0, contrastive_loss=0.076, total=6773.05, n_correct=4883.34, ppl=3.42, accuracy=72.1, wps=23908.3, ups=1.76, wpb=13546.1, bsz=458.9, num_updates=25100, lr=8.92644e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=20460
2023-08-25 17:34:26 | INFO | train_inner | epoch 022:    202 / 1191 loss=1.875, trans_loss=4.595, nll_loss=1.779, w2v_ctc_loss=0.585, task_loss=0, contrastive_loss=0.098, total=6652.79, n_correct=4782.1, ppl=3.43, accuracy=71.881, wps=23277.7, ups=1.75, wpb=13305.6, bsz=442.9, num_updates=25200, lr=8.90871e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=57, gb_free=13.1, wall=20517
2023-08-25 17:35:23 | INFO | train_inner | epoch 022:    302 / 1191 loss=1.877, trans_loss=4.593, nll_loss=1.777, w2v_ctc_loss=0.581, task_loss=0, contrastive_loss=0.135, total=6748.6, n_correct=4858.84, ppl=3.43, accuracy=71.998, wps=23991.9, ups=1.78, wpb=13497.2, bsz=467.9, num_updates=25300, lr=8.89108e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14.2, wall=20573
2023-08-25 17:36:20 | INFO | train_inner | epoch 022:    402 / 1191 loss=1.874, trans_loss=4.595, nll_loss=1.779, w2v_ctc_loss=0.588, task_loss=0, contrastive_loss=0.068, total=6667.46, n_correct=4793.38, ppl=3.43, accuracy=71.892, wps=23409.5, ups=1.76, wpb=13334.9, bsz=457.5, num_updates=25400, lr=8.87357e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14.3, wall=20630
2023-08-25 17:37:17 | INFO | train_inner | epoch 022:    502 / 1191 loss=1.885, trans_loss=4.602, nll_loss=1.789, w2v_ctc_loss=0.595, task_loss=0, contrastive_loss=0.125, total=6717.05, n_correct=4820.82, ppl=3.45, accuracy=71.77, wps=23523.9, ups=1.75, wpb=13434.1, bsz=457, num_updates=25500, lr=8.85615e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=12.7, wall=20687
2023-08-25 17:38:13 | INFO | train_inner | epoch 022:    602 / 1191 loss=1.873, trans_loss=4.595, nll_loss=1.78, w2v_ctc_loss=0.586, task_loss=0, contrastive_loss=0.067, total=6709.73, n_correct=4824.34, ppl=3.43, accuracy=71.901, wps=23697.2, ups=1.77, wpb=13419.5, bsz=447.6, num_updates=25600, lr=8.83883e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=12.5, wall=20744
2023-08-25 17:39:10 | INFO | train_inner | epoch 022:    702 / 1191 loss=1.877, trans_loss=4.597, nll_loss=1.782, w2v_ctc_loss=0.579, task_loss=0, contrastive_loss=0.132, total=6715.16, n_correct=4826.42, ppl=3.44, accuracy=71.873, wps=23738.3, ups=1.77, wpb=13430.3, bsz=456.1, num_updates=25700, lr=8.82162e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=12.3, wall=20800
2023-08-25 17:40:06 | INFO | train_inner | epoch 022:    802 / 1191 loss=1.873, trans_loss=4.591, nll_loss=1.774, w2v_ctc_loss=0.582, task_loss=0, contrastive_loss=0.121, total=6554.59, n_correct=4717.49, ppl=3.42, accuracy=71.972, wps=23295.8, ups=1.78, wpb=13109.2, bsz=431.9, num_updates=25800, lr=8.80451e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=55, gb_free=14, wall=20857
2023-08-25 17:41:04 | INFO | train_inner | epoch 022:    902 / 1191 loss=1.894, trans_loss=4.606, nll_loss=1.793, w2v_ctc_loss=0.595, task_loss=0, contrastive_loss=0.185, total=6717.82, n_correct=4802.14, ppl=3.47, accuracy=71.484, wps=23329.7, ups=1.74, wpb=13435.6, bsz=455.3, num_updates=25900, lr=8.7875e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=57, gb_free=13.8, wall=20914
2023-08-25 17:42:01 | INFO | train_inner | epoch 022:   1002 / 1191 loss=1.875, trans_loss=4.596, nll_loss=1.781, w2v_ctc_loss=0.585, task_loss=0, contrastive_loss=0.09, total=6836.61, n_correct=4914.32, ppl=3.44, accuracy=71.882, wps=24046.6, ups=1.76, wpb=13673.2, bsz=466.1, num_updates=26000, lr=8.77058e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=20971
2023-08-25 17:42:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
2023-08-25 17:42:32 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.823 | trans_loss 4.871 | nll_loss 2.089 | w2v_ctc_loss 1.203 | task_loss 0 | contrastive_loss 0.265 | total 6138.43 | n_correct 4373.57 | ppl 4.26 | accuracy 71.249 | uer 16.795 | wer 18.684 | raw_wer 18.684 | bleu 28.67 | wps 1847.1 | wpb 6138.4 | bsz 201.1 | num_updates 26000 | best_bleu 28.72
2023-08-25 17:42:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26000 updates
2023-08-25 17:42:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_22_26000.pt
2023-08-25 17:42:35 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_22_26000.pt
2023-08-25 17:42:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_22_26000.pt (epoch 22 @ 26000 updates, score 28.67) (writing took 7.912150481999561 seconds)
2023-08-25 17:43:37 | INFO | train_inner | epoch 022:   1102 / 1191 loss=1.873, trans_loss=4.595, nll_loss=1.78, w2v_ctc_loss=0.583, task_loss=0, contrastive_loss=0.094, total=6701.53, n_correct=4816.1, ppl=3.43, accuracy=71.866, wps=13957, ups=1.04, wpb=13403.1, bsz=447.4, num_updates=26100, lr=8.75376e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=55, gb_free=12.2, wall=21067
2023-08-25 17:44:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:44:59 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.834 | trans_loss 4.873 | nll_loss 2.089 | w2v_ctc_loss 1.237 | task_loss 0 | contrastive_loss 0.261 | total 6138.43 | n_correct 4376.71 | ppl 4.25 | accuracy 71.3 | uer 17.019 | wer 18.829 | raw_wer 18.829 | bleu 28.49 | wps 1846.8 | wpb 6138.4 | bsz 201.1 | num_updates 26189 | best_bleu 28.72
2023-08-25 17:44:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26189 updates
2023-08-25 17:44:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.4907.pt
2023-08-25 17:45:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.4907.pt
2023-08-25 17:45:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.4907.pt (epoch 22 @ 26189 updates, score 28.49) (writing took 6.122242080000433 seconds)
2023-08-25 17:45:05 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2023-08-25 17:45:05 | INFO | train | epoch 022 | loss 1.877 | trans_loss 4.596 | nll_loss 1.781 | w2v_ctc_loss 0.586 | task_loss 0 | contrastive_loss 0.108 | total 6703.69 | n_correct 4817.55 | ppl 3.44 | accuracy 71.864 | wps 20988.4 | ups 1.57 | wpb 13407.4 | bsz 452.1 | num_updates 26189 | lr 8.73888e-05 | gnorm 0.413 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 13.9 | wall 21156
2023-08-25 17:45:05 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 17:45:05 | INFO | fairseq.trainer | begin training epoch 23
2023-08-25 17:45:05 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 17:45:19 | INFO | train_inner | epoch 023:     11 / 1191 loss=1.88, trans_loss=4.601, nll_loss=1.787, w2v_ctc_loss=0.592, task_loss=0, contrastive_loss=0.095, total=6652.47, n_correct=4774.76, ppl=3.45, accuracy=71.774, wps=12976.9, ups=0.98, wpb=13304.9, bsz=433.4, num_updates=26200, lr=8.73704e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=57, gb_free=13.2, wall=21170
2023-08-25 17:46:16 | INFO | train_inner | epoch 023:    111 / 1191 loss=1.866, trans_loss=4.582, nll_loss=1.762, w2v_ctc_loss=0.579, task_loss=0, contrastive_loss=0.087, total=6652.39, n_correct=4802.2, ppl=3.39, accuracy=72.188, wps=23642.2, ups=1.78, wpb=13304.8, bsz=438.7, num_updates=26300, lr=8.72041e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=56, gb_free=13.9, wall=21226
2023-08-25 17:47:13 | INFO | train_inner | epoch 023:    211 / 1191 loss=1.868, trans_loss=4.587, nll_loss=1.769, w2v_ctc_loss=0.579, task_loss=0, contrastive_loss=0.079, total=6813.04, n_correct=4913.39, ppl=3.41, accuracy=72.117, wps=23765.5, ups=1.74, wpb=13626.1, bsz=474, num_updates=26400, lr=8.70388e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=57, gb_free=13.3, wall=21283
2023-08-25 17:48:10 | INFO | train_inner | epoch 023:    311 / 1191 loss=1.863, trans_loss=4.581, nll_loss=1.762, w2v_ctc_loss=0.569, task_loss=0, contrastive_loss=0.089, total=6827.7, n_correct=4934.25, ppl=3.39, accuracy=72.268, wps=24053.2, ups=1.76, wpb=13655.4, bsz=466.9, num_updates=26500, lr=8.68744e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=56, gb_free=10.5, wall=21340
2023-08-25 17:49:07 | INFO | train_inner | epoch 023:    411 / 1191 loss=1.875, trans_loss=4.593, nll_loss=1.777, w2v_ctc_loss=0.582, task_loss=0, contrastive_loss=0.125, total=6708.92, n_correct=4825.8, ppl=3.43, accuracy=71.931, wps=23572.5, ups=1.76, wpb=13417.8, bsz=437.8, num_updates=26600, lr=8.6711e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=11.9, wall=21397
2023-08-25 17:50:03 | INFO | train_inner | epoch 023:    511 / 1191 loss=1.869, trans_loss=4.586, nll_loss=1.768, w2v_ctc_loss=0.573, task_loss=0, contrastive_loss=0.122, total=6708.89, n_correct=4838.14, ppl=3.4, accuracy=72.115, wps=23839.4, ups=1.78, wpb=13417.8, bsz=453.5, num_updates=26700, lr=8.65485e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=56, gb_free=12.3, wall=21453
2023-08-25 17:51:00 | INFO | train_inner | epoch 023:    611 / 1191 loss=1.877, trans_loss=4.594, nll_loss=1.778, w2v_ctc_loss=0.585, task_loss=0, contrastive_loss=0.114, total=6678.91, n_correct=4807.37, ppl=3.43, accuracy=71.978, wps=23503.2, ups=1.76, wpb=13357.8, bsz=454.7, num_updates=26800, lr=8.63868e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=21510
2023-08-25 17:51:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 17:51:57 | INFO | train_inner | epoch 023:    712 / 1191 loss=1.874, trans_loss=4.588, nll_loss=1.77, w2v_ctc_loss=0.573, task_loss=0, contrastive_loss=0.165, total=6635.6, n_correct=4782.2, ppl=3.41, accuracy=72.069, wps=23261, ups=1.75, wpb=13271.2, bsz=437.8, num_updates=26900, lr=8.62261e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=57, gb_free=13.8, wall=21567
2023-08-25 17:52:54 | INFO | train_inner | epoch 023:    812 / 1191 loss=1.87, trans_loss=4.592, nll_loss=1.776, w2v_ctc_loss=0.582, task_loss=0, contrastive_loss=0.07, total=6719.39, n_correct=4831.22, ppl=3.43, accuracy=71.9, wps=23427, ups=1.74, wpb=13438.8, bsz=446.1, num_updates=27000, lr=8.60663e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=57, gb_free=14.8, wall=21625
2023-08-25 17:53:50 | INFO | train_inner | epoch 023:    912 / 1191 loss=1.864, trans_loss=4.579, nll_loss=1.759, w2v_ctc_loss=0.581, task_loss=0, contrastive_loss=0.064, total=6716.94, n_correct=4855.68, ppl=3.39, accuracy=72.29, wps=23889.7, ups=1.78, wpb=13433.9, bsz=465.5, num_updates=27100, lr=8.59074e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=12.5, wall=21681
2023-08-25 17:54:47 | INFO | train_inner | epoch 023:   1012 / 1191 loss=1.872, trans_loss=4.587, nll_loss=1.77, w2v_ctc_loss=0.582, task_loss=0, contrastive_loss=0.109, total=6674.89, n_correct=4814.15, ppl=3.41, accuracy=72.123, wps=23711.1, ups=1.78, wpb=13349.8, bsz=465.5, num_updates=27200, lr=8.57493e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=21737
2023-08-25 17:55:44 | INFO | train_inner | epoch 023:   1112 / 1191 loss=1.873, trans_loss=4.593, nll_loss=1.778, w2v_ctc_loss=0.58, task_loss=0, contrastive_loss=0.106, total=6640.69, n_correct=4778.64, ppl=3.43, accuracy=71.96, wps=23403.8, ups=1.76, wpb=13281.4, bsz=441.7, num_updates=27300, lr=8.55921e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=15.5, wall=21794
2023-08-25 17:56:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 17:56:59 | INFO | dev_st | epoch 023 | valid on 'dev_st' subset | loss 3.839 | trans_loss 4.869 | nll_loss 2.086 | w2v_ctc_loss 1.266 | task_loss 0 | contrastive_loss 0.258 | total 6138.43 | n_correct 4372.71 | ppl 4.25 | accuracy 71.235 | uer 16.939 | wer 18.55 | raw_wer 18.55 | bleu 27.96 | wps 1842 | wpb 6138.4 | bsz 201.1 | num_updates 27379 | best_bleu 28.72
2023-08-25 17:56:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 27379 updates
2023-08-25 17:56:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 17:57:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 17:57:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt (epoch 23 @ 27379 updates, score 27.96) (writing took 5.915796635999868 seconds)
2023-08-25 17:57:05 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2023-08-25 17:57:05 | INFO | train | epoch 023 | loss 1.871 | trans_loss 4.588 | nll_loss 1.77 | w2v_ctc_loss 0.579 | task_loss 0 | contrastive_loss 0.107 | total 6702.1 | n_correct 4830.38 | ppl 3.41 | accuracy 72.073 | wps 22154 | ups 1.65 | wpb 13404.2 | bsz 451.8 | num_updates 27379 | lr 8.54685e-05 | gnorm 0.412 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 15.1 | wall 21876
2023-08-25 17:57:05 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 17:57:06 | INFO | fairseq.trainer | begin training epoch 24
2023-08-25 17:57:06 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 17:57:24 | INFO | train_inner | epoch 024:     21 / 1191 loss=1.878, trans_loss=4.591, nll_loss=1.774, w2v_ctc_loss=0.584, task_loss=0, contrastive_loss=0.151, total=6654.23, n_correct=4785.76, ppl=3.42, accuracy=71.921, wps=13187.4, ups=0.99, wpb=13308.5, bsz=438.6, num_updates=27400, lr=8.54358e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=21895
2023-08-25 17:58:22 | INFO | train_inner | epoch 024:    121 / 1191 loss=1.864, trans_loss=4.579, nll_loss=1.76, w2v_ctc_loss=0.571, task_loss=0, contrastive_loss=0.104, total=6760.22, n_correct=4888.69, ppl=3.39, accuracy=72.316, wps=23651.7, ups=1.75, wpb=13520.4, bsz=474.5, num_updates=27500, lr=8.52803e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=57, gb_free=10.7, wall=21952
2023-08-25 17:59:18 | INFO | train_inner | epoch 024:    221 / 1191 loss=1.864, trans_loss=4.576, nll_loss=1.755, w2v_ctc_loss=0.558, task_loss=0, contrastive_loss=0.174, total=6827.56, n_correct=4942.24, ppl=3.38, accuracy=72.387, wps=24337.4, ups=1.78, wpb=13655.1, bsz=483, num_updates=27600, lr=8.51257e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=56, gb_free=15.1, wall=22008
2023-08-25 18:00:14 | INFO | train_inner | epoch 024:    321 / 1191 loss=1.866, trans_loss=4.581, nll_loss=1.761, w2v_ctc_loss=0.575, task_loss=0, contrastive_loss=0.118, total=6731.61, n_correct=4860.77, ppl=3.39, accuracy=72.208, wps=23724.5, ups=1.76, wpb=13463.2, bsz=449.9, num_updates=27700, lr=8.49719e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=56, gb_free=12.6, wall=22065
2023-08-25 18:01:12 | INFO | train_inner | epoch 024:    421 / 1191 loss=1.861, trans_loss=4.58, nll_loss=1.759, w2v_ctc_loss=0.572, task_loss=0, contrastive_loss=0.077, total=6661.95, n_correct=4817.86, ppl=3.39, accuracy=72.319, wps=23337.2, ups=1.75, wpb=13323.9, bsz=436.1, num_updates=27800, lr=8.48189e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=57, gb_free=14.8, wall=22122
2023-08-25 18:02:08 | INFO | train_inner | epoch 024:    521 / 1191 loss=1.875, trans_loss=4.583, nll_loss=1.764, w2v_ctc_loss=0.579, task_loss=0, contrastive_loss=0.169, total=6652.29, n_correct=4796.61, ppl=3.4, accuracy=72.105, wps=23540.4, ups=1.77, wpb=13304.6, bsz=454, num_updates=27900, lr=8.46668e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=56, gb_free=12.6, wall=22178
2023-08-25 18:03:05 | INFO | train_inner | epoch 024:    621 / 1191 loss=1.862, trans_loss=4.581, nll_loss=1.761, w2v_ctc_loss=0.58, task_loss=0, contrastive_loss=0.049, total=6541.99, n_correct=4720.28, ppl=3.39, accuracy=72.154, wps=23150.7, ups=1.77, wpb=13084, bsz=418.2, num_updates=28000, lr=8.45154e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=22235
2023-08-25 18:03:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:03:36 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.842 | trans_loss 4.87 | nll_loss 2.085 | w2v_ctc_loss 1.273 | task_loss 0 | contrastive_loss 0.258 | total 6138.43 | n_correct 4372.71 | ppl 4.24 | accuracy 71.235 | uer 16.797 | wer 18.62 | raw_wer 18.62 | bleu 28.45 | wps 1844.9 | wpb 6138.4 | bsz 201.1 | num_updates 28000 | best_bleu 28.72
2023-08-25 18:03:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28000 updates
2023-08-25 18:03:36 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_24_28000.pt
2023-08-25 18:03:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_24_28000.pt
2023-08-25 18:03:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_24_28000.pt (epoch 24 @ 28000 updates, score 28.45) (writing took 6.983196608998696 seconds)
2023-08-25 18:04:40 | INFO | train_inner | epoch 024:    721 / 1191 loss=1.866, trans_loss=4.578, nll_loss=1.759, w2v_ctc_loss=0.575, task_loss=0, contrastive_loss=0.103, total=6743.6, n_correct=4875.26, ppl=3.38, accuracy=72.295, wps=14189.4, ups=1.05, wpb=13487.2, bsz=470.3, num_updates=28100, lr=8.43649e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=15.1, wall=22330
2023-08-25 18:05:36 | INFO | train_inner | epoch 024:    821 / 1191 loss=1.861, trans_loss=4.576, nll_loss=1.756, w2v_ctc_loss=0.577, task_loss=0, contrastive_loss=0.066, total=6731.47, n_correct=4866.2, ppl=3.38, accuracy=72.29, wps=23951.1, ups=1.78, wpb=13462.9, bsz=448.3, num_updates=28200, lr=8.42152e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=56, gb_free=13.9, wall=22386
2023-08-25 18:06:33 | INFO | train_inner | epoch 024:    921 / 1191 loss=1.861, trans_loss=4.581, nll_loss=1.761, w2v_ctc_loss=0.573, task_loss=0, contrastive_loss=0.066, total=6730.81, n_correct=4867.25, ppl=3.39, accuracy=72.313, wps=23649.8, ups=1.76, wpb=13461.6, bsz=457.7, num_updates=28300, lr=8.40663e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=22443
2023-08-25 18:07:29 | INFO | train_inner | epoch 024:   1021 / 1191 loss=1.874, trans_loss=4.584, nll_loss=1.766, w2v_ctc_loss=0.574, task_loss=0, contrastive_loss=0.17, total=6590.6, n_correct=4753.8, ppl=3.4, accuracy=72.13, wps=23263.4, ups=1.76, wpb=13181.2, bsz=440.9, num_updates=28400, lr=8.39181e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=22500
2023-08-25 18:08:27 | INFO | train_inner | epoch 024:   1121 / 1191 loss=1.862, trans_loss=4.581, nll_loss=1.762, w2v_ctc_loss=0.576, task_loss=0, contrastive_loss=0.056, total=6706.32, n_correct=4842.15, ppl=3.39, accuracy=72.203, wps=23118.4, ups=1.72, wpb=13412.6, bsz=434.9, num_updates=28500, lr=8.37708e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=58, gb_free=12.8, wall=22558
2023-08-25 18:09:07 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:09:38 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.826 | trans_loss 4.864 | nll_loss 2.08 | w2v_ctc_loss 1.234 | task_loss 0 | contrastive_loss 0.257 | total 6138.43 | n_correct 4370.86 | ppl 4.23 | accuracy 71.205 | uer 16.714 | wer 18.464 | raw_wer 18.464 | bleu 28.89 | wps 1867 | wpb 6138.4 | bsz 201.1 | num_updates 28570 | best_bleu 28.89
2023-08-25 18:09:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28570 updates
2023-08-25 18:09:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 18:09:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 18:09:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 24 @ 28570 updates, score 28.89) (writing took 10.769883932000084 seconds)
2023-08-25 18:09:50 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2023-08-25 18:09:50 | INFO | train | epoch 024 | loss 1.865 | trans_loss 4.58 | nll_loss 1.76 | w2v_ctc_loss 0.574 | task_loss 0 | contrastive_loss 0.105 | total 6703.69 | n_correct 4843.15 | ppl 3.39 | accuracy 72.246 | wps 20891.9 | ups 1.56 | wpb 13407.4 | bsz 452.1 | num_updates 28570 | lr 8.36681e-05 | gnorm 0.413 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 15.4 | wall 22640
2023-08-25 18:09:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 18:09:50 | INFO | fairseq.trainer | begin training epoch 25
2023-08-25 18:09:50 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 18:10:14 | INFO | train_inner | epoch 025:     30 / 1191 loss=1.866, trans_loss=4.578, nll_loss=1.758, w2v_ctc_loss=0.577, task_loss=0, contrastive_loss=0.102, total=6700.77, n_correct=4840.78, ppl=3.38, accuracy=72.242, wps=12566, ups=0.94, wpb=13401.5, bsz=448.4, num_updates=28600, lr=8.36242e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=14.9, wall=22665
2023-08-25 18:11:11 | INFO | train_inner | epoch 025:    130 / 1191 loss=1.857, trans_loss=4.561, nll_loss=1.736, w2v_ctc_loss=0.561, task_loss=0, contrastive_loss=0.153, total=6590.97, n_correct=4789.46, ppl=3.33, accuracy=72.667, wps=23262.2, ups=1.76, wpb=13181.9, bsz=437.3, num_updates=28700, lr=8.34784e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=22721
2023-08-25 18:12:08 | INFO | train_inner | epoch 025:    230 / 1191 loss=1.853, trans_loss=4.572, nll_loss=1.75, w2v_ctc_loss=0.561, task_loss=0, contrastive_loss=0.065, total=6796.21, n_correct=4923.95, ppl=3.36, accuracy=72.451, wps=23857.9, ups=1.76, wpb=13592.4, bsz=475, num_updates=28800, lr=8.33333e-05, gnorm=0.407, clip=0, loss_scale=16, train_wall=56, gb_free=14.3, wall=22778
2023-08-25 18:13:04 | INFO | train_inner | epoch 025:    330 / 1191 loss=1.859, trans_loss=4.569, nll_loss=1.746, w2v_ctc_loss=0.576, task_loss=0, contrastive_loss=0.084, total=6610.56, n_correct=4787.03, ppl=3.35, accuracy=72.415, wps=23473.6, ups=1.78, wpb=13221.1, bsz=431.2, num_updates=28900, lr=8.3189e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=13.6, wall=22835
2023-08-25 18:14:01 | INFO | train_inner | epoch 025:    430 / 1191 loss=1.857, trans_loss=4.574, nll_loss=1.752, w2v_ctc_loss=0.571, task_loss=0, contrastive_loss=0.066, total=6559.76, n_correct=4744.45, ppl=3.37, accuracy=72.327, wps=22955.4, ups=1.75, wpb=13119.5, bsz=417.2, num_updates=29000, lr=8.30455e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=57, gb_free=13.8, wall=22892
2023-08-25 18:14:58 | INFO | train_inner | epoch 025:    530 / 1191 loss=1.857, trans_loss=4.572, nll_loss=1.75, w2v_ctc_loss=0.565, task_loss=0, contrastive_loss=0.083, total=6860.11, n_correct=4974.76, ppl=3.36, accuracy=72.517, wps=24226.9, ups=1.77, wpb=13720.2, bsz=485.7, num_updates=29100, lr=8.29027e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=56, gb_free=13.3, wall=22948
2023-08-25 18:15:54 | INFO | train_inner | epoch 025:    630 / 1191 loss=1.853, trans_loss=4.567, nll_loss=1.744, w2v_ctc_loss=0.563, task_loss=0, contrastive_loss=0.088, total=6752.55, n_correct=4899.74, ppl=3.35, accuracy=72.561, wps=24049.7, ups=1.78, wpb=13505.1, bsz=450.4, num_updates=29200, lr=8.27606e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=56, gb_free=15.2, wall=23004
2023-08-25 18:16:51 | INFO | train_inner | epoch 025:    730 / 1191 loss=1.87, trans_loss=4.576, nll_loss=1.756, w2v_ctc_loss=0.572, task_loss=0, contrastive_loss=0.18, total=6689.05, n_correct=4834.88, ppl=3.38, accuracy=72.281, wps=23412.3, ups=1.75, wpb=13378.1, bsz=451.1, num_updates=29300, lr=8.26192e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=57, gb_free=14.2, wall=23062
2023-08-25 18:17:48 | INFO | train_inner | epoch 025:    830 / 1191 loss=1.861, trans_loss=4.575, nll_loss=1.755, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.102, total=6731.35, n_correct=4869.63, ppl=3.37, accuracy=72.343, wps=23882.7, ups=1.77, wpb=13462.7, bsz=460.3, num_updates=29400, lr=8.24786e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=12.6, wall=23118
2023-08-25 18:18:45 | INFO | train_inner | epoch 025:    930 / 1191 loss=1.859, trans_loss=4.572, nll_loss=1.75, w2v_ctc_loss=0.568, task_loss=0, contrastive_loss=0.088, total=6765.8, n_correct=4897.49, ppl=3.36, accuracy=72.386, wps=23678, ups=1.75, wpb=13531.6, bsz=466.3, num_updates=29500, lr=8.23387e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=57, gb_free=12.9, wall=23175
2023-08-25 18:19:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 18:19:42 | INFO | train_inner | epoch 025:   1031 / 1191 loss=1.863, trans_loss=4.581, nll_loss=1.762, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.109, total=6687.48, n_correct=4831.82, ppl=3.39, accuracy=72.252, wps=23555.7, ups=1.76, wpb=13375, bsz=458.5, num_updates=29600, lr=8.21995e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=23232
2023-08-25 18:20:38 | INFO | train_inner | epoch 025:   1131 / 1191 loss=1.86, trans_loss=4.572, nll_loss=1.75, w2v_ctc_loss=0.576, task_loss=0, contrastive_loss=0.095, total=6657.56, n_correct=4823.12, ppl=3.36, accuracy=72.446, wps=23568.5, ups=1.77, wpb=13315.1, bsz=439.5, num_updates=29700, lr=8.2061e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=11.5, wall=23288
2023-08-25 18:21:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:21:43 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 3.841 | trans_loss 4.863 | nll_loss 2.077 | w2v_ctc_loss 1.286 | task_loss 0 | contrastive_loss 0.257 | total 6138.43 | n_correct 4380.29 | ppl 4.22 | accuracy 71.358 | uer 16.706 | wer 18.453 | raw_wer 18.453 | bleu 28.57 | wps 1864.9 | wpb 6138.4 | bsz 201.1 | num_updates 29760 | best_bleu 28.89
2023-08-25 18:21:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 29760 updates
2023-08-25 18:21:43 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5708.pt
2023-08-25 18:21:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5708.pt
2023-08-25 18:21:50 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.5708.pt (epoch 25 @ 29760 updates, score 28.57) (writing took 6.875061323997215 seconds)
2023-08-25 18:21:50 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2023-08-25 18:21:50 | INFO | train | epoch 025 | loss 1.86 | trans_loss 4.572 | nll_loss 1.751 | w2v_ctc_loss 0.568 | task_loss 0 | contrastive_loss 0.104 | total 6703.5 | n_correct 4853.94 | ppl 3.37 | accuracy 72.409 | wps 22136.6 | ups 1.65 | wpb 13407 | bsz 452.2 | num_updates 29760 | lr 8.19782e-05 | gnorm 0.411 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 12.1 | wall 23361
2023-08-25 18:21:51 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 18:21:51 | INFO | fairseq.trainer | begin training epoch 26
2023-08-25 18:21:51 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 18:22:21 | INFO | train_inner | epoch 026:     40 / 1191 loss=1.863, trans_loss=4.575, nll_loss=1.754, w2v_ctc_loss=0.565, task_loss=0, contrastive_loss=0.132, total=6826.83, n_correct=4940.98, ppl=3.37, accuracy=72.376, wps=13301.7, ups=0.97, wpb=13653.7, bsz=465.3, num_updates=29800, lr=8.19232e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14.8, wall=23391
2023-08-25 18:23:18 | INFO | train_inner | epoch 026:    140 / 1191 loss=1.848, trans_loss=4.562, nll_loss=1.737, w2v_ctc_loss=0.556, task_loss=0, contrastive_loss=0.084, total=6711.69, n_correct=4877.11, ppl=3.33, accuracy=72.666, wps=23625.6, ups=1.76, wpb=13423.4, bsz=455.5, num_updates=29900, lr=8.17861e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=23448
2023-08-25 18:24:14 | INFO | train_inner | epoch 026:    240 / 1191 loss=1.852, trans_loss=4.558, nll_loss=1.732, w2v_ctc_loss=0.564, task_loss=0, contrastive_loss=0.112, total=6682.85, n_correct=4858.08, ppl=3.32, accuracy=72.695, wps=23599.5, ups=1.77, wpb=13365.7, bsz=451.9, num_updates=30000, lr=8.16497e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=23505
2023-08-25 18:24:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:24:45 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.834 | trans_loss 4.865 | nll_loss 2.079 | w2v_ctc_loss 1.256 | task_loss 0 | contrastive_loss 0.261 | total 6138.43 | n_correct 4375 | ppl 4.23 | accuracy 71.272 | uer 16.688 | wer 18.498 | raw_wer 18.498 | bleu 28.51 | wps 1842.3 | wpb 6138.4 | bsz 201.1 | num_updates 30000 | best_bleu 28.89
2023-08-25 18:24:45 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30000 updates
2023-08-25 18:24:45 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_26_30000.pt
2023-08-25 18:24:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_26_30000.pt
2023-08-25 18:24:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_26_30000.pt (epoch 26 @ 30000 updates, score 28.51) (writing took 8.099544756998512 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 18:25:51 | INFO | train_inner | epoch 026:    340 / 1191 loss=1.856, trans_loss=4.565, nll_loss=1.742, w2v_ctc_loss=0.556, task_loss=0, contrastive_loss=0.145, total=6881.88, n_correct=4998.37, ppl=3.34, accuracy=72.631, wps=14273.5, ups=1.04, wpb=13763.8, bsz=497.4, num_updates=30100, lr=8.15139e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=23601
2023-08-25 18:26:47 | INFO | train_inner | epoch 026:    440 / 1191 loss=1.858, trans_loss=4.563, nll_loss=1.739, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.136, total=6582.99, n_correct=4774.49, ppl=3.34, accuracy=72.528, wps=23363.4, ups=1.77, wpb=13166, bsz=427.7, num_updates=30200, lr=8.13788e-05, gnorm=0.428, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=23657
2023-08-25 18:27:44 | INFO | train_inner | epoch 026:    540 / 1191 loss=1.852, trans_loss=4.561, nll_loss=1.736, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.097, total=6677.39, n_correct=4853.42, ppl=3.33, accuracy=72.684, wps=23281.7, ups=1.74, wpb=13354.8, bsz=449.1, num_updates=30300, lr=8.12444e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=57, gb_free=14.4, wall=23715
2023-08-25 18:28:41 | INFO | train_inner | epoch 026:    640 / 1191 loss=1.854, trans_loss=4.564, nll_loss=1.739, w2v_ctc_loss=0.562, task_loss=0, contrastive_loss=0.114, total=6608.63, n_correct=4797.72, ppl=3.34, accuracy=72.598, wps=23474.4, ups=1.78, wpb=13217.3, bsz=425.8, num_updates=30400, lr=8.11107e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=23771
2023-08-25 18:29:37 | INFO | train_inner | epoch 026:    740 / 1191 loss=1.852, trans_loss=4.567, nll_loss=1.744, w2v_ctc_loss=0.564, task_loss=0, contrastive_loss=0.066, total=6784.49, n_correct=4921.44, ppl=3.35, accuracy=72.54, wps=23868, ups=1.76, wpb=13569, bsz=448.6, num_updates=30500, lr=8.09776e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=56, gb_free=9, wall=23828
2023-08-25 18:30:34 | INFO | train_inner | epoch 026:    840 / 1191 loss=1.853, trans_loss=4.56, nll_loss=1.735, w2v_ctc_loss=0.559, task_loss=0, contrastive_loss=0.119, total=6663.29, n_correct=4846.23, ppl=3.33, accuracy=72.73, wps=23657.1, ups=1.78, wpb=13326.6, bsz=452.4, num_updates=30600, lr=8.08452e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=23884
2023-08-25 18:31:30 | INFO | train_inner | epoch 026:    940 / 1191 loss=1.863, trans_loss=4.57, nll_loss=1.748, w2v_ctc_loss=0.57, task_loss=0, contrastive_loss=0.132, total=6698.83, n_correct=4857.37, ppl=3.36, accuracy=72.511, wps=23763, ups=1.77, wpb=13397.7, bsz=452.2, num_updates=30700, lr=8.07134e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=23941
2023-08-25 18:32:27 | INFO | train_inner | epoch 026:   1040 / 1191 loss=1.858, trans_loss=4.572, nll_loss=1.75, w2v_ctc_loss=0.575, task_loss=0, contrastive_loss=0.067, total=6684.83, n_correct=4834.12, ppl=3.36, accuracy=72.315, wps=23347.6, ups=1.75, wpb=13369.7, bsz=443.7, num_updates=30800, lr=8.05823e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=57, gb_free=11.8, wall=23998
2023-08-25 18:33:25 | INFO | train_inner | epoch 026:   1140 / 1191 loss=1.858, trans_loss=4.572, nll_loss=1.751, w2v_ctc_loss=0.565, task_loss=0, contrastive_loss=0.093, total=6799.05, n_correct=4926.83, ppl=3.37, accuracy=72.464, wps=23817.3, ups=1.75, wpb=13598.1, bsz=477.3, num_updates=30900, lr=8.04518e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=14.2, wall=24055
2023-08-25 18:33:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
2023-08-25 18:34:25 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.822 | trans_loss 4.857 | nll_loss 2.071 | w2v_ctc_loss 1.237 | task_loss 0 | contrastive_loss 0.254 | total 6138.43 | n_correct 4382.71 | ppl 4.2 | accuracy 71.398 | uer 16.522 | wer 18.263 | raw_wer 18.263 | bleu 28.82 | wps 1860.1 | wpb 6138.4 | bsz 201.1 | num_updates 30951 | best_bleu 28.89
2023-08-25 18:34:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30951 updates
2023-08-25 18:34:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8202.pt
2023-08-25 18:34:27 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8202.pt
2023-08-25 18:34:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8202.pt (epoch 26 @ 30951 updates, score 28.82) (writing took 7.158153039003082 seconds)
2023-08-25 18:34:33 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2023-08-25 18:34:33 | INFO | train | epoch 026 | loss 1.855 | trans_loss 4.566 | nll_loss 1.742 | w2v_ctc_loss 0.564 | task_loss 0 | contrastive_loss 0.103 | total 6703.69 | n_correct 4864.08 | ppl 3.35 | accuracy 72.558 | wps 20947.9 | ups 1.56 | wpb 13407.4 | bsz 452.1 | num_updates 30951 | lr 8.03855e-05 | gnorm 0.415 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 12.9 | wall 24123
2023-08-25 18:34:33 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 18:34:33 | INFO | fairseq.trainer | begin training epoch 27
2023-08-25 18:34:33 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 18:35:08 | INFO | train_inner | epoch 027:     49 / 1191 loss=1.852, trans_loss=4.566, nll_loss=1.742, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.062, total=6623.22, n_correct=4801.65, ppl=3.35, accuracy=72.497, wps=12843.4, ups=0.97, wpb=13246.4, bsz=438.8, num_updates=31000, lr=8.03219e-05, gnorm=0.45, clip=0, loss_scale=16, train_wall=56, gb_free=10.4, wall=24158
2023-08-25 18:36:05 | INFO | train_inner | epoch 027:    149 / 1191 loss=1.855, trans_loss=4.555, nll_loss=1.728, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.148, total=6716.13, n_correct=4886.81, ppl=3.31, accuracy=72.762, wps=23511, ups=1.75, wpb=13432.3, bsz=463.1, num_updates=31100, lr=8.01927e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=24215
2023-08-25 18:37:01 | INFO | train_inner | epoch 027:    249 / 1191 loss=1.844, trans_loss=4.552, nll_loss=1.724, w2v_ctc_loss=0.548, task_loss=0, contrastive_loss=0.119, total=6828.06, n_correct=4976.77, ppl=3.3, accuracy=72.887, wps=24130.6, ups=1.77, wpb=13656.1, bsz=483.7, num_updates=31200, lr=8.00641e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=12.4, wall=24272
2023-08-25 18:37:58 | INFO | train_inner | epoch 027:    349 / 1191 loss=1.841, trans_loss=4.55, nll_loss=1.723, w2v_ctc_loss=0.549, task_loss=0, contrastive_loss=0.088, total=6735.45, n_correct=4914.96, ppl=3.3, accuracy=72.972, wps=23655.5, ups=1.76, wpb=13470.9, bsz=468.3, num_updates=31300, lr=7.99361e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14.2, wall=24329
2023-08-25 18:38:55 | INFO | train_inner | epoch 027:    449 / 1191 loss=1.856, trans_loss=4.567, nll_loss=1.744, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.1, total=6615.51, n_correct=4802.38, ppl=3.35, accuracy=72.593, wps=23238, ups=1.76, wpb=13231, bsz=437.7, num_updates=31400, lr=7.98087e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=24386
2023-08-25 18:39:52 | INFO | train_inner | epoch 027:    549 / 1191 loss=1.847, trans_loss=4.556, nll_loss=1.73, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.077, total=6772.35, n_correct=4927.74, ppl=3.32, accuracy=72.763, wps=23874.4, ups=1.76, wpb=13544.7, bsz=464.2, num_updates=31500, lr=7.96819e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=24442
2023-08-25 18:40:49 | INFO | train_inner | epoch 027:    649 / 1191 loss=1.854, trans_loss=4.559, nll_loss=1.734, w2v_ctc_loss=0.556, task_loss=0, contrastive_loss=0.149, total=6684.99, n_correct=4858.87, ppl=3.33, accuracy=72.683, wps=23529.5, ups=1.76, wpb=13370, bsz=444.5, num_updates=31600, lr=7.95557e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=11.1, wall=24499
2023-08-25 18:41:45 | INFO | train_inner | epoch 027:    749 / 1191 loss=1.848, trans_loss=4.56, nll_loss=1.734, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.077, total=6680.05, n_correct=4860.46, ppl=3.33, accuracy=72.761, wps=23697.1, ups=1.77, wpb=13360.1, bsz=443.5, num_updates=31700, lr=7.94301e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=24556
2023-08-25 18:42:42 | INFO | train_inner | epoch 027:    849 / 1191 loss=1.85, trans_loss=4.56, nll_loss=1.734, w2v_ctc_loss=0.564, task_loss=0, contrastive_loss=0.07, total=6647.72, n_correct=4829.23, ppl=3.33, accuracy=72.645, wps=23432, ups=1.76, wpb=13295.4, bsz=440.9, num_updates=31800, lr=7.93052e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=13.1, wall=24612
2023-08-25 18:43:39 | INFO | train_inner | epoch 027:    949 / 1191 loss=1.855, trans_loss=4.568, nll_loss=1.746, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.087, total=6634.42, n_correct=4811.04, ppl=3.35, accuracy=72.516, wps=23172.6, ups=1.75, wpb=13268.8, bsz=422.9, num_updates=31900, lr=7.91808e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=57, gb_free=13.2, wall=24670
2023-08-25 18:44:36 | INFO | train_inner | epoch 027:   1049 / 1191 loss=1.857, trans_loss=4.568, nll_loss=1.745, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.139, total=6652.45, n_correct=4823.73, ppl=3.35, accuracy=72.511, wps=23422.5, ups=1.76, wpb=13304.9, bsz=450.6, num_updates=32000, lr=7.90569e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=13.2, wall=24726
2023-08-25 18:44:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:45:07 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.802 | trans_loss 4.857 | nll_loss 2.07 | w2v_ctc_loss 1.175 | task_loss 0 | contrastive_loss 0.252 | total 6138.43 | n_correct 4383 | ppl 4.2 | accuracy 71.403 | uer 16.284 | wer 17.955 | raw_wer 17.955 | bleu 28.95 | wps 1860.6 | wpb 6138.4 | bsz 201.1 | num_updates 32000 | best_bleu 28.95
2023-08-25 18:45:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32000 updates
2023-08-25 18:45:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_27_32000.pt
2023-08-25 18:45:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_27_32000.pt
2023-08-25 18:45:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_27_32000.pt (epoch 27 @ 32000 updates, score 28.95) (writing took 13.272181365999131 seconds)
2023-08-25 18:46:17 | INFO | train_inner | epoch 027:   1149 / 1191 loss=1.852, trans_loss=4.563, nll_loss=1.739, w2v_ctc_loss=0.558, task_loss=0, contrastive_loss=0.109, total=6753.53, n_correct=4908.02, ppl=3.34, accuracy=72.673, wps=13330.8, ups=0.99, wpb=13507.1, bsz=452.5, num_updates=32100, lr=7.89337e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=56, gb_free=11.3, wall=24828
2023-08-25 18:46:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:47:12 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.827 | trans_loss 4.857 | nll_loss 2.07 | w2v_ctc_loss 1.256 | task_loss 0 | contrastive_loss 0.252 | total 6138.43 | n_correct 4383.14 | ppl 4.2 | accuracy 71.405 | uer 16.313 | wer 18.022 | raw_wer 18.022 | bleu 29 | wps 1866.1 | wpb 6138.4 | bsz 201.1 | num_updates 32142 | best_bleu 29
2023-08-25 18:47:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32142 updates
2023-08-25 18:47:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 18:47:18 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt
2023-08-25 18:47:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_best.pt (epoch 27 @ 32142 updates, score 29.0) (writing took 12.960106135000387 seconds)
2023-08-25 18:47:25 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2023-08-25 18:47:25 | INFO | train | epoch 027 | loss 1.85 | trans_loss 4.559 | nll_loss 1.734 | w2v_ctc_loss 0.558 | task_loss 0 | contrastive_loss 0.102 | total 6703.69 | n_correct 4875.11 | ppl 3.33 | accuracy 72.723 | wps 20667.8 | ups 1.54 | wpb 13407.4 | bsz 452.1 | num_updates 32142 | lr 7.88821e-05 | gnorm 0.414 | clip 0 | loss_scale 32 | train_wall 669 | gb_free 13.4 | wall 24896
2023-08-25 18:47:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 18:47:25 | INFO | fairseq.trainer | begin training epoch 28
2023-08-25 18:47:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 18:48:05 | INFO | train_inner | epoch 028:     58 / 1191 loss=1.84, trans_loss=4.547, nll_loss=1.719, w2v_ctc_loss=0.549, task_loss=0, contrastive_loss=0.096, total=6702.18, n_correct=4891, ppl=3.29, accuracy=72.976, wps=12441, ups=0.93, wpb=13404.4, bsz=456.4, num_updates=32200, lr=7.8811e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=55, gb_free=14.7, wall=24936
2023-08-25 18:49:02 | INFO | train_inner | epoch 028:    158 / 1191 loss=1.845, trans_loss=4.554, nll_loss=1.726, w2v_ctc_loss=0.567, task_loss=0, contrastive_loss=0.051, total=6676.02, n_correct=4859.16, ppl=3.31, accuracy=72.785, wps=23589.7, ups=1.77, wpb=13352, bsz=432.6, num_updates=32300, lr=7.86889e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=24992
2023-08-25 18:49:49 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 18:49:59 | INFO | train_inner | epoch 028:    259 / 1191 loss=1.842, trans_loss=4.552, nll_loss=1.724, w2v_ctc_loss=0.549, task_loss=0, contrastive_loss=0.093, total=6687.67, n_correct=4873.72, ppl=3.3, accuracy=72.876, wps=23385.6, ups=1.75, wpb=13375.3, bsz=451.2, num_updates=32400, lr=7.85674e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=57, gb_free=13.6, wall=25049
2023-08-25 18:50:55 | INFO | train_inner | epoch 028:    359 / 1191 loss=1.84, trans_loss=4.548, nll_loss=1.72, w2v_ctc_loss=0.553, task_loss=0, contrastive_loss=0.063, total=6746.39, n_correct=4921.5, ppl=3.29, accuracy=72.95, wps=23887.2, ups=1.77, wpb=13492.8, bsz=461.3, num_updates=32500, lr=7.84465e-05, gnorm=0.407, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=25106
2023-08-25 18:51:53 | INFO | train_inner | epoch 028:    459 / 1191 loss=1.854, trans_loss=4.553, nll_loss=1.727, w2v_ctc_loss=0.552, task_loss=0, contrastive_loss=0.18, total=6774.31, n_correct=4938.38, ppl=3.31, accuracy=72.899, wps=23697.6, ups=1.75, wpb=13548.6, bsz=472.3, num_updates=32600, lr=7.8326e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=10, wall=25163
2023-08-25 18:52:48 | INFO | train_inner | epoch 028:    559 / 1191 loss=1.836, trans_loss=4.549, nll_loss=1.721, w2v_ctc_loss=0.547, task_loss=0, contrastive_loss=0.052, total=6708.83, n_correct=4895.3, ppl=3.3, accuracy=72.968, wps=24052, ups=1.79, wpb=13417.7, bsz=454.3, num_updates=32700, lr=7.82062e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=55, gb_free=13.1, wall=25219
2023-08-25 18:53:45 | INFO | train_inner | epoch 028:    659 / 1191 loss=1.842, trans_loss=4.549, nll_loss=1.721, w2v_ctc_loss=0.549, task_loss=0, contrastive_loss=0.116, total=6752.22, n_correct=4927.28, ppl=3.3, accuracy=72.973, wps=23983, ups=1.78, wpb=13504.4, bsz=457.5, num_updates=32800, lr=7.80869e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=15.2, wall=25275
2023-08-25 18:54:41 | INFO | train_inner | epoch 028:    759 / 1191 loss=1.845, trans_loss=4.552, nll_loss=1.725, w2v_ctc_loss=0.557, task_loss=0, contrastive_loss=0.079, total=6685.78, n_correct=4868.15, ppl=3.31, accuracy=72.813, wps=23571.7, ups=1.76, wpb=13371.6, bsz=452, num_updates=32900, lr=7.79681e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=12.1, wall=25332
2023-08-25 18:55:38 | INFO | train_inner | epoch 028:    859 / 1191 loss=1.843, trans_loss=4.553, nll_loss=1.726, w2v_ctc_loss=0.554, task_loss=0, contrastive_loss=0.084, total=6647.97, n_correct=4848.12, ppl=3.31, accuracy=72.926, wps=23439.1, ups=1.76, wpb=13295.9, bsz=453, num_updates=33000, lr=7.78499e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=25389
2023-08-25 18:56:35 | INFO | train_inner | epoch 028:    959 / 1191 loss=1.851, trans_loss=4.558, nll_loss=1.732, w2v_ctc_loss=0.56, task_loss=0, contrastive_loss=0.115, total=6648.94, n_correct=4838.3, ppl=3.32, accuracy=72.768, wps=23388.5, ups=1.76, wpb=13297.9, bsz=437.2, num_updates=33100, lr=7.77322e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=12.2, wall=25445
2023-08-25 18:57:32 | INFO | train_inner | epoch 028:   1059 / 1191 loss=1.854, trans_loss=4.559, nll_loss=1.734, w2v_ctc_loss=0.55, task_loss=0, contrastive_loss=0.177, total=6682.03, n_correct=4855.99, ppl=3.33, accuracy=72.672, wps=23596.7, ups=1.77, wpb=13364.1, bsz=441.3, num_updates=33200, lr=7.76151e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=12.2, wall=25502
2023-08-25 18:58:28 | INFO | train_inner | epoch 028:   1159 / 1191 loss=1.844, trans_loss=4.554, nll_loss=1.727, w2v_ctc_loss=0.553, task_loss=0, contrastive_loss=0.086, total=6682.91, n_correct=4863.65, ppl=3.31, accuracy=72.777, wps=23557.6, ups=1.76, wpb=13365.8, bsz=444.7, num_updates=33300, lr=7.74984e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=12.4, wall=25559
2023-08-25 18:58:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 18:59:18 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 3.821 | trans_loss 4.864 | nll_loss 2.077 | w2v_ctc_loss 1.219 | task_loss 0 | contrastive_loss 0.256 | total 6138.43 | n_correct 4383.43 | ppl 4.22 | accuracy 71.41 | uer 16.76 | wer 18.512 | raw_wer 18.512 | bleu 28.74 | wps 1841.7 | wpb 6138.4 | bsz 201.1 | num_updates 33332 | best_bleu 29
2023-08-25 18:59:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 33332 updates
2023-08-25 18:59:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7400.pt
2023-08-25 18:59:20 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7400.pt
2023-08-25 18:59:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7400.pt (epoch 28 @ 33332 updates, score 28.74) (writing took 7.647563730999536 seconds)
2023-08-25 18:59:26 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2023-08-25 18:59:26 | INFO | train | epoch 028 | loss 1.845 | trans_loss 4.552 | nll_loss 1.725 | w2v_ctc_loss 0.554 | task_loss 0 | contrastive_loss 0.101 | total 6704.76 | n_correct 4886.06 | ppl 3.31 | accuracy 72.875 | wps 22154.1 | ups 1.65 | wpb 13409.5 | bsz 452.3 | num_updates 33332 | lr 7.74612e-05 | gnorm 0.412 | clip 0 | loss_scale 16 | train_wall 666 | gb_free 13.6 | wall 25616
2023-08-25 18:59:26 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 18:59:26 | INFO | fairseq.trainer | begin training epoch 29
2023-08-25 18:59:26 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 19:00:12 | INFO | train_inner | epoch 029:     68 / 1191 loss=1.835, trans_loss=4.537, nll_loss=1.705, w2v_ctc_loss=0.544, task_loss=0, contrastive_loss=0.095, total=6796.88, n_correct=4978.05, ppl=3.26, accuracy=73.24, wps=13146.4, ups=0.97, wpb=13593.8, bsz=474.6, num_updates=33400, lr=7.73823e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=25662
2023-08-25 19:01:09 | INFO | train_inner | epoch 029:    168 / 1191 loss=1.83, trans_loss=4.54, nll_loss=1.709, w2v_ctc_loss=0.54, task_loss=0, contrastive_loss=0.053, total=6679.94, n_correct=4881.06, ppl=3.27, accuracy=73.07, wps=23455.2, ups=1.76, wpb=13359.9, bsz=438.3, num_updates=33500, lr=7.72667e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=13.4, wall=25719
2023-08-25 19:02:06 | INFO | train_inner | epoch 029:    268 / 1191 loss=1.847, trans_loss=4.546, nll_loss=1.717, w2v_ctc_loss=0.538, task_loss=0, contrastive_loss=0.188, total=6662.13, n_correct=4862.48, ppl=3.29, accuracy=72.987, wps=23348.6, ups=1.75, wpb=13324.3, bsz=452.1, num_updates=33600, lr=7.71517e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=12.4, wall=25776
2023-08-25 19:03:03 | INFO | train_inner | epoch 029:    368 / 1191 loss=1.834, trans_loss=4.545, nll_loss=1.715, w2v_ctc_loss=0.548, task_loss=0, contrastive_loss=0.054, total=6765.23, n_correct=4942.96, ppl=3.28, accuracy=73.064, wps=23766.6, ups=1.76, wpb=13530.5, bsz=455, num_updates=33700, lr=7.70371e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=56, gb_free=15.1, wall=25833
2023-08-25 19:04:00 | INFO | train_inner | epoch 029:    468 / 1191 loss=1.837, trans_loss=4.544, nll_loss=1.714, w2v_ctc_loss=0.542, task_loss=0, contrastive_loss=0.105, total=6766.98, n_correct=4947.24, ppl=3.28, accuracy=73.109, wps=23729.2, ups=1.75, wpb=13534, bsz=464.7, num_updates=33800, lr=7.69231e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=56, gb_free=15.1, wall=25890
2023-08-25 19:04:56 | INFO | train_inner | epoch 029:    568 / 1191 loss=1.845, trans_loss=4.551, nll_loss=1.723, w2v_ctc_loss=0.563, task_loss=0, contrastive_loss=0.089, total=6588.51, n_correct=4799.46, ppl=3.3, accuracy=72.846, wps=23283, ups=1.77, wpb=13177, bsz=423.7, num_updates=33900, lr=7.68095e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=14.1, wall=25947
2023-08-25 19:05:53 | INFO | train_inner | epoch 029:    668 / 1191 loss=1.836, trans_loss=4.54, nll_loss=1.709, w2v_ctc_loss=0.546, task_loss=0, contrastive_loss=0.083, total=6747.88, n_correct=4935.82, ppl=3.27, accuracy=73.146, wps=23824, ups=1.77, wpb=13495.8, bsz=466.6, num_updates=34000, lr=7.66965e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=26003
2023-08-25 19:05:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:06:24 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.829 | trans_loss 4.865 | nll_loss 2.079 | w2v_ctc_loss 1.247 | task_loss 0 | contrastive_loss 0.251 | total 6138.43 | n_correct 4378 | ppl 4.22 | accuracy 71.321 | uer 16.746 | wer 18.486 | raw_wer 18.486 | bleu 29.1 | wps 1871.1 | wpb 6138.4 | bsz 201.1 | num_updates 34000 | best_bleu 29.1
2023-08-25 19:06:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34000 updates
2023-08-25 19:06:24 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_29_34000.pt
2023-08-25 19:06:26 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_29_34000.pt
2023-08-25 19:06:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_29_34000.pt (epoch 29 @ 34000 updates, score 29.1) (writing took 12.311070456002199 seconds)
2023-08-25 19:07:33 | INFO | train_inner | epoch 029:    768 / 1191 loss=1.835, trans_loss=4.543, nll_loss=1.713, w2v_ctc_loss=0.546, task_loss=0, contrastive_loss=0.083, total=6665.46, n_correct=4872.78, ppl=3.28, accuracy=73.105, wps=13342.4, ups=1, wpb=13330.9, bsz=450.3, num_updates=34100, lr=7.6584e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=12.8, wall=26103
2023-08-25 19:08:30 | INFO | train_inner | epoch 029:    868 / 1191 loss=1.841, trans_loss=4.553, nll_loss=1.726, w2v_ctc_loss=0.557, task_loss=0, contrastive_loss=0.057, total=6653.55, n_correct=4842.38, ppl=3.31, accuracy=72.779, wps=23473.3, ups=1.76, wpb=13307.1, bsz=434.6, num_updates=34200, lr=7.64719e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14.2, wall=26160
2023-08-25 19:09:26 | INFO | train_inner | epoch 029:    968 / 1191 loss=1.854, trans_loss=4.55, nll_loss=1.723, w2v_ctc_loss=0.555, task_loss=0, contrastive_loss=0.174, total=6724.42, n_correct=4897.3, ppl=3.3, accuracy=72.829, wps=23698.1, ups=1.76, wpb=13448.8, bsz=460.8, num_updates=34300, lr=7.63604e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=26217
2023-08-25 19:10:23 | INFO | train_inner | epoch 029:   1068 / 1191 loss=1.843, trans_loss=4.547, nll_loss=1.719, w2v_ctc_loss=0.547, task_loss=0, contrastive_loss=0.125, total=6722.03, n_correct=4904.45, ppl=3.29, accuracy=72.961, wps=23883.3, ups=1.78, wpb=13444.1, bsz=457.9, num_updates=34400, lr=7.62493e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=26273
2023-08-25 19:11:21 | INFO | train_inner | epoch 029:   1168 / 1191 loss=1.838, trans_loss=4.547, nll_loss=1.719, w2v_ctc_loss=0.543, task_loss=0, contrastive_loss=0.096, total=6758.08, n_correct=4939.45, ppl=3.29, accuracy=73.09, wps=23397.7, ups=1.73, wpb=13516.2, bsz=463.1, num_updates=34500, lr=7.61387e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=57, gb_free=10.5, wall=26331
2023-08-25 19:11:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:12:05 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.829 | trans_loss 4.864 | nll_loss 2.079 | w2v_ctc_loss 1.249 | task_loss 0 | contrastive_loss 0.251 | total 6138.43 | n_correct 4378 | ppl 4.22 | accuracy 71.321 | uer 16.645 | wer 18.531 | raw_wer 18.531 | bleu 28.81 | wps 1857.5 | wpb 6138.4 | bsz 201.1 | num_updates 34523 | best_bleu 29.1
2023-08-25 19:12:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34523 updates
2023-08-25 19:12:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8106.pt
2023-08-25 19:12:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8106.pt
2023-08-25 19:12:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8106.pt (epoch 29 @ 34523 updates, score 28.81) (writing took 7.482403461999638 seconds)
2023-08-25 19:12:12 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2023-08-25 19:12:12 | INFO | train | epoch 029 | loss 1.839 | trans_loss 4.545 | nll_loss 1.716 | w2v_ctc_loss 0.547 | task_loss 0 | contrastive_loss 0.1 | total 6703.69 | n_correct 4894.85 | ppl 3.29 | accuracy 73.017 | wps 20826.3 | ups 1.55 | wpb 13407.4 | bsz 452.1 | num_updates 34523 | lr 7.61133e-05 | gnorm 0.41 | clip 0 | loss_scale 32 | train_wall 670 | gb_free 13.9 | wall 26383
2023-08-25 19:12:13 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 19:12:13 | INFO | fairseq.trainer | begin training epoch 30
2023-08-25 19:12:13 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 19:13:03 | INFO | train_inner | epoch 030:     77 / 1191 loss=1.828, trans_loss=4.533, nll_loss=1.701, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.091, total=6834.34, n_correct=5013.29, ppl=3.25, accuracy=73.354, wps=13318.8, ups=0.97, wpb=13668.7, bsz=482.5, num_updates=34600, lr=7.60286e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=55, gb_free=14.2, wall=26434
2023-08-25 19:13:59 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 19:14:00 | INFO | train_inner | epoch 030:    178 / 1191 loss=1.831, trans_loss=4.535, nll_loss=1.703, w2v_ctc_loss=0.538, task_loss=0, contrastive_loss=0.093, total=6679.76, n_correct=4891.93, ppl=3.26, accuracy=73.235, wps=23616.7, ups=1.77, wpb=13359.5, bsz=445.8, num_updates=34700, lr=7.5919e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=13.9, wall=26490
2023-08-25 19:14:56 | INFO | train_inner | epoch 030:    278 / 1191 loss=1.832, trans_loss=4.532, nll_loss=1.699, w2v_ctc_loss=0.539, task_loss=0, contrastive_loss=0.097, total=6754.94, n_correct=4950.25, ppl=3.25, accuracy=73.283, wps=23904.6, ups=1.77, wpb=13509.9, bsz=459.9, num_updates=34800, lr=7.58098e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=12.1, wall=26547
2023-08-25 19:15:53 | INFO | train_inner | epoch 030:    378 / 1191 loss=1.83, trans_loss=4.536, nll_loss=1.704, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.094, total=6859.61, n_correct=5029.26, ppl=3.26, accuracy=73.317, wps=23973.8, ups=1.75, wpb=13719.2, bsz=488, num_updates=34900, lr=7.57011e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=57, gb_free=12.3, wall=26604
2023-08-25 19:16:50 | INFO | train_inner | epoch 030:    478 / 1191 loss=1.833, trans_loss=4.537, nll_loss=1.706, w2v_ctc_loss=0.544, task_loss=0, contrastive_loss=0.088, total=6645.7, n_correct=4862.38, ppl=3.26, accuracy=73.166, wps=23362.1, ups=1.76, wpb=13291.4, bsz=444.7, num_updates=35000, lr=7.55929e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=14.1, wall=26661
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 19:17:47 | INFO | train_inner | epoch 030:    578 / 1191 loss=1.838, trans_loss=4.541, nll_loss=1.71, w2v_ctc_loss=0.546, task_loss=0, contrastive_loss=0.107, total=6672.87, n_correct=4876.11, ppl=3.27, accuracy=73.074, wps=23618.3, ups=1.77, wpb=13345.7, bsz=443.6, num_updates=35100, lr=7.54851e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=15, wall=26717
2023-08-25 19:18:43 | INFO | train_inner | epoch 030:    678 / 1191 loss=1.836, trans_loss=4.539, nll_loss=1.707, w2v_ctc_loss=0.552, task_loss=0, contrastive_loss=0.075, total=6565.21, n_correct=4793.83, ppl=3.27, accuracy=73.019, wps=23212.5, ups=1.77, wpb=13130.4, bsz=421.9, num_updates=35200, lr=7.53778e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=11.6, wall=26774
2023-08-25 19:19:40 | INFO | train_inner | epoch 030:    778 / 1191 loss=1.846, trans_loss=4.54, nll_loss=1.709, w2v_ctc_loss=0.547, task_loss=0, contrastive_loss=0.168, total=6657.47, n_correct=4864.22, ppl=3.27, accuracy=73.064, wps=23427.4, ups=1.76, wpb=13314.9, bsz=440.1, num_updates=35300, lr=7.5271e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=26831
2023-08-25 19:20:38 | INFO | train_inner | epoch 030:    878 / 1191 loss=1.836, trans_loss=4.543, nll_loss=1.714, w2v_ctc_loss=0.542, task_loss=0, contrastive_loss=0.101, total=6666.67, n_correct=4875.43, ppl=3.28, accuracy=73.131, wps=23304.4, ups=1.75, wpb=13333.3, bsz=443.1, num_updates=35400, lr=7.51646e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=57, gb_free=14.8, wall=26888
2023-08-25 19:21:35 | INFO | train_inner | epoch 030:    978 / 1191 loss=1.838, trans_loss=4.541, nll_loss=1.711, w2v_ctc_loss=0.548, task_loss=0, contrastive_loss=0.103, total=6645.69, n_correct=4858.81, ppl=3.27, accuracy=73.112, wps=23243.5, ups=1.75, wpb=13291.4, bsz=445.1, num_updates=35500, lr=7.50587e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=15, wall=26945
2023-08-25 19:22:32 | INFO | train_inner | epoch 030:   1078 / 1191 loss=1.835, trans_loss=4.545, nll_loss=1.716, w2v_ctc_loss=0.548, task_loss=0, contrastive_loss=0.057, total=6766.02, n_correct=4946.62, ppl=3.29, accuracy=73.11, wps=23785.7, ups=1.76, wpb=13532, bsz=457.1, num_updates=35600, lr=7.49532e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=15.7, wall=27002
2023-08-25 19:23:28 | INFO | train_inner | epoch 030:   1178 / 1191 loss=1.843, trans_loss=4.552, nll_loss=1.725, w2v_ctc_loss=0.546, task_loss=0, contrastive_loss=0.115, total=6709.38, n_correct=4890.95, ppl=3.31, accuracy=72.897, wps=23606.1, ups=1.76, wpb=13418.8, bsz=457, num_updates=35700, lr=7.48481e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=10.7, wall=27059
2023-08-25 19:23:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
2023-08-25 19:24:07 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 3.816 | trans_loss 4.856 | nll_loss 2.07 | w2v_ctc_loss 1.223 | task_loss 0 | contrastive_loss 0.253 | total 6138.43 | n_correct 4390.29 | ppl 4.2 | accuracy 71.521 | uer 16.49 | wer 18.248 | raw_wer 18.248 | bleu 28.71 | wps 1856.4 | wpb 6138.4 | bsz 201.1 | num_updates 35713 | best_bleu 29.1
2023-08-25 19:24:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 35713 updates
2023-08-25 19:24:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7101.pt
2023-08-25 19:24:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7101.pt
2023-08-25 19:24:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7101.pt (epoch 30 @ 35713 updates, score 28.71) (writing took 6.50684764199832 seconds)
2023-08-25 19:24:14 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2023-08-25 19:24:14 | INFO | train | epoch 030 | loss 1.835 | trans_loss 4.54 | nll_loss 1.709 | w2v_ctc_loss 0.543 | task_loss 0 | contrastive_loss 0.099 | total 6703.69 | n_correct 4903.43 | ppl 3.27 | accuracy 73.145 | wps 22116.6 | ups 1.65 | wpb 13407.4 | bsz 452 | num_updates 35713 | lr 7.48345e-05 | gnorm 0.411 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 14.7 | wall 27104
2023-08-25 19:24:14 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 19:24:14 | INFO | fairseq.trainer | begin training epoch 31
2023-08-25 19:24:14 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 19:25:10 | INFO | train_inner | epoch 031:     87 / 1191 loss=1.83, trans_loss=4.532, nll_loss=1.699, w2v_ctc_loss=0.545, task_loss=0, contrastive_loss=0.073, total=6586.06, n_correct=4827.97, ppl=3.25, accuracy=73.306, wps=12937.9, ups=0.98, wpb=13172.1, bsz=416.6, num_updates=35800, lr=7.47435e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=12.7, wall=27161
2023-08-25 19:26:08 | INFO | train_inner | epoch 031:    187 / 1191 loss=1.823, trans_loss=4.529, nll_loss=1.695, w2v_ctc_loss=0.531, task_loss=0, contrastive_loss=0.07, total=6738.97, n_correct=4948.98, ppl=3.24, accuracy=73.438, wps=23504.9, ups=1.74, wpb=13477.9, bsz=458.5, num_updates=35900, lr=7.46393e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=57, gb_free=13.9, wall=27218
2023-08-25 19:27:04 | INFO | train_inner | epoch 031:    287 / 1191 loss=1.835, trans_loss=4.531, nll_loss=1.697, w2v_ctc_loss=0.546, task_loss=0, contrastive_loss=0.107, total=6546.21, n_correct=4795.84, ppl=3.24, accuracy=73.261, wps=23083, ups=1.76, wpb=13092.4, bsz=430.8, num_updates=36000, lr=7.45356e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=27275
2023-08-25 19:27:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:27:36 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.818 | trans_loss 4.863 | nll_loss 2.077 | w2v_ctc_loss 1.212 | task_loss 0 | contrastive_loss 0.255 | total 6138.43 | n_correct 4381.71 | ppl 4.22 | accuracy 71.382 | uer 16.613 | wer 18.457 | raw_wer 18.457 | bleu 28.6 | wps 1841 | wpb 6138.4 | bsz 201.1 | num_updates 36000 | best_bleu 29.1
2023-08-25 19:27:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36000 updates
2023-08-25 19:27:36 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_31_36000.pt
2023-08-25 19:27:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_31_36000.pt
2023-08-25 19:27:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_31_36000.pt (epoch 31 @ 36000 updates, score 28.6) (writing took 6.502005762002227 seconds)
2023-08-25 19:28:39 | INFO | train_inner | epoch 031:    387 / 1191 loss=1.824, trans_loss=4.532, nll_loss=1.699, w2v_ctc_loss=0.535, task_loss=0, contrastive_loss=0.051, total=6748.95, n_correct=4952.15, ppl=3.25, accuracy=73.377, wps=14295.9, ups=1.06, wpb=13497.9, bsz=458.1, num_updates=36100, lr=7.44323e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=15, wall=27369
2023-08-25 19:29:35 | INFO | train_inner | epoch 031:    487 / 1191 loss=1.832, trans_loss=4.542, nll_loss=1.711, w2v_ctc_loss=0.543, task_loss=0, contrastive_loss=0.073, total=6661.78, n_correct=4871.25, ppl=3.27, accuracy=73.122, wps=23583.3, ups=1.77, wpb=13323.6, bsz=426.6, num_updates=36200, lr=7.43294e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=27426
2023-08-25 19:30:32 | INFO | train_inner | epoch 031:    587 / 1191 loss=1.833, trans_loss=4.532, nll_loss=1.7, w2v_ctc_loss=0.536, task_loss=0, contrastive_loss=0.132, total=6681.68, n_correct=4896.99, ppl=3.25, accuracy=73.29, wps=23581.4, ups=1.76, wpb=13363.4, bsz=451.8, num_updates=36300, lr=7.4227e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=12.7, wall=27482
2023-08-25 19:31:29 | INFO | train_inner | epoch 031:    687 / 1191 loss=1.833, trans_loss=4.531, nll_loss=1.699, w2v_ctc_loss=0.538, task_loss=0, contrastive_loss=0.12, total=6839.98, n_correct=5016.86, ppl=3.25, accuracy=73.346, wps=24001.8, ups=1.75, wpb=13680, bsz=478.1, num_updates=36400, lr=7.41249e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=56, gb_free=14.1, wall=27539
2023-08-25 19:32:26 | INFO | train_inner | epoch 031:    787 / 1191 loss=1.833, trans_loss=4.534, nll_loss=1.703, w2v_ctc_loss=0.539, task_loss=0, contrastive_loss=0.102, total=6796.23, n_correct=4978.57, ppl=3.25, accuracy=73.255, wps=23850.6, ups=1.75, wpb=13592.5, bsz=476.2, num_updates=36500, lr=7.40233e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=13, wall=27596
2023-08-25 19:33:23 | INFO | train_inner | epoch 031:    887 / 1191 loss=1.837, trans_loss=4.539, nll_loss=1.708, w2v_ctc_loss=0.542, task_loss=0, contrastive_loss=0.127, total=6613.41, n_correct=4841.17, ppl=3.27, accuracy=73.202, wps=23320.1, ups=1.76, wpb=13226.8, bsz=445.6, num_updates=36600, lr=7.39221e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=56, gb_free=14.3, wall=27653
2023-08-25 19:34:19 | INFO | train_inner | epoch 031:    987 / 1191 loss=1.835, trans_loss=4.534, nll_loss=1.702, w2v_ctc_loss=0.544, task_loss=0, contrastive_loss=0.11, total=6712.51, n_correct=4917.96, ppl=3.25, accuracy=73.266, wps=23779.6, ups=1.77, wpb=13425, bsz=455.1, num_updates=36700, lr=7.38213e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=14.8, wall=27709
2023-08-25 19:35:16 | INFO | train_inner | epoch 031:   1087 / 1191 loss=1.827, trans_loss=4.533, nll_loss=1.702, w2v_ctc_loss=0.531, task_loss=0, contrastive_loss=0.091, total=6884.21, n_correct=5050.72, ppl=3.25, accuracy=73.367, wps=24400.5, ups=1.77, wpb=13768.4, bsz=489.3, num_updates=36800, lr=7.3721e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=56, gb_free=12.6, wall=27766
2023-08-25 19:36:12 | INFO | train_inner | epoch 031:   1187 / 1191 loss=1.835, trans_loss=4.537, nll_loss=1.706, w2v_ctc_loss=0.542, task_loss=0, contrastive_loss=0.117, total=6656.88, n_correct=4870.78, ppl=3.26, accuracy=73.169, wps=23511.3, ups=1.77, wpb=13313.8, bsz=445.6, num_updates=36900, lr=7.3621e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=27823
2023-08-25 19:36:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:36:46 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.824 | trans_loss 4.856 | nll_loss 2.071 | w2v_ctc_loss 1.245 | task_loss 0 | contrastive_loss 0.259 | total 6138.43 | n_correct 4388.29 | ppl 4.2 | accuracy 71.489 | uer 16.597 | wer 18.345 | raw_wer 18.345 | bleu 28.7 | wps 1858 | wpb 6138.4 | bsz 201.1 | num_updates 36904 | best_bleu 29.1
2023-08-25 19:36:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36904 updates
2023-08-25 19:36:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7004.pt
2023-08-25 19:36:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7004.pt
2023-08-25 19:36:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.7004.pt (epoch 31 @ 36904 updates, score 28.7) (writing took 6.916081542003667 seconds)
2023-08-25 19:36:53 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2023-08-25 19:36:53 | INFO | train | epoch 031 | loss 1.831 | trans_loss 4.534 | nll_loss 1.702 | w2v_ctc_loss 0.539 | task_loss 0 | contrastive_loss 0.098 | total 6703.69 | n_correct 4912.72 | ppl 3.25 | accuracy 73.284 | wps 21033.1 | ups 1.57 | wpb 13407.4 | bsz 452.1 | num_updates 36904 | lr 7.3617e-05 | gnorm 0.413 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 10.7 | wall 27863
2023-08-25 19:36:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 19:36:53 | INFO | fairseq.trainer | begin training epoch 32
2023-08-25 19:36:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 19:37:54 | INFO | train_inner | epoch 032:     96 / 1191 loss=1.82, trans_loss=4.518, nll_loss=1.681, w2v_ctc_loss=0.532, task_loss=0, contrastive_loss=0.073, total=6689.32, n_correct=4924.83, ppl=3.21, accuracy=73.622, wps=13132.3, ups=0.98, wpb=13378.6, bsz=452.4, num_updates=37000, lr=7.35215e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=12.7, wall=27924
2023-08-25 19:38:51 | INFO | train_inner | epoch 032:    196 / 1191 loss=1.835, trans_loss=4.529, nll_loss=1.695, w2v_ctc_loss=0.534, task_loss=0, contrastive_loss=0.17, total=6806.67, n_correct=4993.69, ppl=3.24, accuracy=73.365, wps=24032.4, ups=1.77, wpb=13613.3, bsz=466.5, num_updates=37100, lr=7.34223e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=11.3, wall=27981
2023-08-25 19:39:48 | INFO | train_inner | epoch 032:    296 / 1191 loss=1.824, trans_loss=4.527, nll_loss=1.694, w2v_ctc_loss=0.535, task_loss=0, contrastive_loss=0.065, total=6678.58, n_correct=4906.03, ppl=3.23, accuracy=73.459, wps=23438.7, ups=1.75, wpb=13357.2, bsz=446.2, num_updates=37200, lr=7.33236e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=28038
2023-08-25 19:40:45 | INFO | train_inner | epoch 032:    396 / 1191 loss=1.819, trans_loss=4.519, nll_loss=1.682, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.07, total=6758.65, n_correct=4973.29, ppl=3.21, accuracy=73.584, wps=23783.2, ups=1.76, wpb=13517.3, bsz=458.9, num_updates=37300, lr=7.32252e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=8.6, wall=28095
2023-08-25 19:41:42 | INFO | train_inner | epoch 032:    496 / 1191 loss=1.824, trans_loss=4.53, nll_loss=1.697, w2v_ctc_loss=0.537, task_loss=0, contrastive_loss=0.058, total=6744.1, n_correct=4951.21, ppl=3.24, accuracy=73.415, wps=23612.6, ups=1.75, wpb=13488.2, bsz=454.9, num_updates=37400, lr=7.31272e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=28152
2023-08-25 19:42:38 | INFO | train_inner | epoch 032:    596 / 1191 loss=1.821, trans_loss=4.528, nll_loss=1.694, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.051, total=6688.42, n_correct=4913.33, ppl=3.24, accuracy=73.46, wps=23595.6, ups=1.76, wpb=13376.8, bsz=444.7, num_updates=37500, lr=7.30297e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=12.5, wall=28209
2023-08-25 19:43:36 | INFO | train_inner | epoch 032:    696 / 1191 loss=1.825, trans_loss=4.524, nll_loss=1.689, w2v_ctc_loss=0.534, task_loss=0, contrastive_loss=0.097, total=6670, n_correct=4901.04, ppl=3.22, accuracy=73.479, wps=23152.8, ups=1.74, wpb=13340, bsz=436.6, num_updates=37600, lr=7.29325e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=28266
2023-08-25 19:44:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 19:44:34 | INFO | train_inner | epoch 032:    797 / 1191 loss=1.837, trans_loss=4.53, nll_loss=1.697, w2v_ctc_loss=0.537, task_loss=0, contrastive_loss=0.153, total=6766.34, n_correct=4962.29, ppl=3.24, accuracy=73.338, wps=23488.2, ups=1.74, wpb=13532.7, bsz=465.9, num_updates=37700, lr=7.28357e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=57, gb_free=12.2, wall=28324
2023-08-25 19:45:30 | INFO | train_inner | epoch 032:    897 / 1191 loss=1.833, trans_loss=4.533, nll_loss=1.7, w2v_ctc_loss=0.539, task_loss=0, contrastive_loss=0.114, total=6701.03, n_correct=4909.34, ppl=3.25, accuracy=73.262, wps=23580.2, ups=1.76, wpb=13402.1, bsz=447.7, num_updates=37800, lr=7.27393e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=13, wall=28381
2023-08-25 19:46:27 | INFO | train_inner | epoch 032:    997 / 1191 loss=1.824, trans_loss=4.528, nll_loss=1.694, w2v_ctc_loss=0.534, task_loss=0, contrastive_loss=0.08, total=6605, n_correct=4850.8, ppl=3.24, accuracy=73.441, wps=23286.4, ups=1.76, wpb=13210, bsz=438.4, num_updates=37900, lr=7.26433e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=13.1, wall=28438
2023-08-25 19:47:24 | INFO | train_inner | epoch 032:   1097 / 1191 loss=1.823, trans_loss=4.53, nll_loss=1.697, w2v_ctc_loss=0.537, task_loss=0, contrastive_loss=0.047, total=6604.34, n_correct=4844.16, ppl=3.24, accuracy=73.348, wps=23429.2, ups=1.77, wpb=13208.7, bsz=429.9, num_updates=38000, lr=7.25476e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=13.4, wall=28494
2023-08-25 19:47:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:47:55 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.83 | trans_loss 4.853 | nll_loss 2.064 | w2v_ctc_loss 1.273 | task_loss 0 | contrastive_loss 0.256 | total 6138.43 | n_correct 4391.43 | ppl 4.18 | accuracy 71.54 | uer 16.546 | wer 18.204 | raw_wer 18.204 | bleu 28.95 | wps 1844 | wpb 6138.4 | bsz 201.1 | num_updates 38000 | best_bleu 29.1
2023-08-25 19:47:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38000 updates
2023-08-25 19:47:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_32_38000.pt
2023-08-25 19:47:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_32_38000.pt
2023-08-25 19:48:02 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_32_38000.pt (epoch 32 @ 38000 updates, score 28.95) (writing took 6.897184132001712 seconds)
2023-08-25 19:48:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 19:49:26 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.83 | trans_loss 4.857 | nll_loss 2.07 | w2v_ctc_loss 1.263 | task_loss 0 | contrastive_loss 0.256 | total 6138.43 | n_correct 4387.29 | ppl 4.2 | accuracy 71.472 | uer 16.559 | wer 18.371 | raw_wer 18.371 | bleu 28.96 | wps 1858.5 | wpb 6138.4 | bsz 201.1 | num_updates 38094 | best_bleu 29.1
2023-08-25 19:49:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38094 updates
2023-08-25 19:49:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9605.pt
2023-08-25 19:49:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9605.pt
2023-08-25 19:49:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9605.pt (epoch 32 @ 38094 updates, score 28.96) (writing took 6.211914850995527 seconds)
2023-08-25 19:49:33 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2023-08-25 19:49:33 | INFO | train | epoch 032 | loss 1.827 | trans_loss 4.528 | nll_loss 1.694 | w2v_ctc_loss 0.534 | task_loss 0 | contrastive_loss 0.098 | total 6704.25 | n_correct 4922.75 | ppl 3.23 | accuracy 73.427 | wps 20985.9 | ups 1.57 | wpb 13408.5 | bsz 452.3 | num_updates 38094 | lr 7.24581e-05 | gnorm 0.412 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 11.6 | wall 28624
2023-08-25 19:49:33 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 19:49:33 | INFO | fairseq.trainer | begin training epoch 33
2023-08-25 19:49:33 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 19:49:44 | INFO | train_inner | epoch 033:      6 / 1191 loss=1.838, trans_loss=4.534, nll_loss=1.703, w2v_ctc_loss=0.53, task_loss=0, contrastive_loss=0.208, total=6730.9, n_correct=4937.48, ppl=3.25, accuracy=73.355, wps=9598.9, ups=0.71, wpb=13461.8, bsz=489.7, num_updates=38100, lr=7.24524e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=28634
2023-08-25 19:50:41 | INFO | train_inner | epoch 033:    106 / 1191 loss=1.815, trans_loss=4.519, nll_loss=1.683, w2v_ctc_loss=0.52, task_loss=0, contrastive_loss=0.061, total=6784.26, n_correct=4997.54, ppl=3.21, accuracy=73.664, wps=23750.8, ups=1.75, wpb=13568.5, bsz=461.4, num_updates=38200, lr=7.23575e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=57, gb_free=13.8, wall=28691
2023-08-25 19:51:37 | INFO | train_inner | epoch 033:    206 / 1191 loss=1.814, trans_loss=4.513, nll_loss=1.675, w2v_ctc_loss=0.52, task_loss=0, contrastive_loss=0.083, total=6769.39, n_correct=4994.27, ppl=3.19, accuracy=73.777, wps=24069.5, ups=1.78, wpb=13538.8, bsz=459.3, num_updates=38300, lr=7.22629e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=28748
2023-08-25 19:52:34 | INFO | train_inner | epoch 033:    306 / 1191 loss=1.826, trans_loss=4.523, nll_loss=1.687, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.114, total=6593.73, n_correct=4847.91, ppl=3.22, accuracy=73.523, wps=23301.9, ups=1.77, wpb=13187.5, bsz=430.7, num_updates=38400, lr=7.21688e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=56, gb_free=11.3, wall=28804
2023-08-25 19:53:30 | INFO | train_inner | epoch 033:    406 / 1191 loss=1.823, trans_loss=4.524, nll_loss=1.688, w2v_ctc_loss=0.531, task_loss=0, contrastive_loss=0.096, total=6588.62, n_correct=4845.1, ppl=3.22, accuracy=73.537, wps=23476.2, ups=1.78, wpb=13177.2, bsz=432.4, num_updates=38500, lr=7.2075e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=55, gb_free=14.6, wall=28860
2023-08-25 19:54:26 | INFO | train_inner | epoch 033:    506 / 1191 loss=1.825, trans_loss=4.522, nll_loss=1.687, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.095, total=6687.16, n_correct=4915.44, ppl=3.22, accuracy=73.506, wps=23728.2, ups=1.77, wpb=13374.3, bsz=455.4, num_updates=38600, lr=7.19816e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=11.3, wall=28917
2023-08-25 19:55:23 | INFO | train_inner | epoch 033:    606 / 1191 loss=1.823, trans_loss=4.517, nll_loss=1.68, w2v_ctc_loss=0.54, task_loss=0, contrastive_loss=0.073, total=6681.27, n_correct=4913.45, ppl=3.2, accuracy=73.541, wps=23591.1, ups=1.77, wpb=13362.5, bsz=449.6, num_updates=38700, lr=7.18885e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=28973
2023-08-25 19:56:20 | INFO | train_inner | epoch 033:    706 / 1191 loss=1.821, trans_loss=4.523, nll_loss=1.688, w2v_ctc_loss=0.532, task_loss=0, contrastive_loss=0.081, total=6692.25, n_correct=4919.69, ppl=3.22, accuracy=73.513, wps=23464.6, ups=1.75, wpb=13384.5, bsz=443.1, num_updates=38800, lr=7.17958e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=29030
2023-08-25 19:57:16 | INFO | train_inner | epoch 033:    806 / 1191 loss=1.823, trans_loss=4.521, nll_loss=1.685, w2v_ctc_loss=0.523, task_loss=0, contrastive_loss=0.135, total=6777.99, n_correct=4992.48, ppl=3.22, accuracy=73.657, wps=24063.4, ups=1.78, wpb=13556, bsz=465, num_updates=38900, lr=7.17035e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=14.2, wall=29087
2023-08-25 19:58:13 | INFO | train_inner | epoch 033:    906 / 1191 loss=1.827, trans_loss=4.527, nll_loss=1.693, w2v_ctc_loss=0.538, task_loss=0, contrastive_loss=0.077, total=6752.91, n_correct=4957.72, ppl=3.23, accuracy=73.416, wps=23743.4, ups=1.76, wpb=13505.8, bsz=462.9, num_updates=39000, lr=7.16115e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=56, gb_free=6.4, wall=29144
2023-08-25 19:59:11 | INFO | train_inner | epoch 033:   1006 / 1191 loss=1.827, trans_loss=4.531, nll_loss=1.698, w2v_ctc_loss=0.535, task_loss=0, contrastive_loss=0.076, total=6696.09, n_correct=4915.6, ppl=3.25, accuracy=73.41, wps=23271.2, ups=1.74, wpb=13392.2, bsz=444.1, num_updates=39100, lr=7.15199e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=57, gb_free=12.7, wall=29201
2023-08-25 20:00:08 | INFO | train_inner | epoch 033:   1106 / 1191 loss=1.835, trans_loss=4.53, nll_loss=1.697, w2v_ctc_loss=0.543, task_loss=0, contrastive_loss=0.121, total=6736.67, n_correct=4939.95, ppl=3.24, accuracy=73.329, wps=23702.7, ups=1.76, wpb=13473.3, bsz=460.7, num_updates=39200, lr=7.14286e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=29258
2023-08-25 20:00:56 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:01:27 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 3.826 | trans_loss 4.852 | nll_loss 2.064 | w2v_ctc_loss 1.266 | task_loss 0 | contrastive_loss 0.252 | total 6138.43 | n_correct 4393.71 | ppl 4.18 | accuracy 71.577 | uer 16.447 | wer 18.308 | raw_wer 18.308 | bleu 29.04 | wps 1839.6 | wpb 6138.4 | bsz 201.1 | num_updates 39285 | best_bleu 29.1
2023-08-25 20:01:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 39285 updates
2023-08-25 20:01:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0406.pt
2023-08-25 20:01:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0406.pt
2023-08-25 20:01:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0406.pt (epoch 33 @ 39285 updates, score 29.04) (writing took 6.6794626520058955 seconds)
2023-08-25 20:01:34 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2023-08-25 20:01:34 | INFO | train | epoch 033 | loss 1.824 | trans_loss 4.523 | nll_loss 1.687 | w2v_ctc_loss 0.531 | task_loss 0 | contrastive_loss 0.097 | total 6703.69 | n_correct 4929.86 | ppl 3.22 | accuracy 73.539 | wps 22148.3 | ups 1.65 | wpb 13407.4 | bsz 452.1 | num_updates 39285 | lr 7.13513e-05 | gnorm 0.413 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 11.2 | wall 29345
2023-08-25 20:01:34 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 20:01:34 | INFO | fairseq.trainer | begin training epoch 34
2023-08-25 20:01:34 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 20:01:50 | INFO | train_inner | epoch 034:     15 / 1191 loss=1.827, trans_loss=4.522, nll_loss=1.687, w2v_ctc_loss=0.529, task_loss=0, contrastive_loss=0.148, total=6725.75, n_correct=4952.43, ppl=3.22, accuracy=73.634, wps=13096.8, ups=0.97, wpb=13451.5, bsz=470.8, num_updates=39300, lr=7.13376e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=13.8, wall=29361
2023-08-25 20:02:47 | INFO | train_inner | epoch 034:    115 / 1191 loss=1.824, trans_loss=4.515, nll_loss=1.677, w2v_ctc_loss=0.519, task_loss=0, contrastive_loss=0.171, total=6791.28, n_correct=5007.39, ppl=3.2, accuracy=73.733, wps=24048.4, ups=1.77, wpb=13582.6, bsz=475.8, num_updates=39400, lr=7.1247e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=29417
2023-08-25 20:03:44 | INFO | train_inner | epoch 034:    215 / 1191 loss=1.821, trans_loss=4.515, nll_loss=1.677, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.111, total=6678.61, n_correct=4923.92, ppl=3.2, accuracy=73.727, wps=23519.8, ups=1.76, wpb=13357.2, bsz=450.2, num_updates=39500, lr=7.11568e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=13.9, wall=29474
2023-08-25 20:04:41 | INFO | train_inner | epoch 034:    315 / 1191 loss=1.814, trans_loss=4.515, nll_loss=1.678, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.047, total=6608.68, n_correct=4869.03, ppl=3.2, accuracy=73.676, wps=23141.8, ups=1.75, wpb=13217.4, bsz=433.2, num_updates=39600, lr=7.10669e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=57, gb_free=12.3, wall=29531
2023-08-25 20:05:38 | INFO | train_inner | epoch 034:    415 / 1191 loss=1.817, trans_loss=4.519, nll_loss=1.682, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.057, total=6649.36, n_correct=4893.4, ppl=3.21, accuracy=73.592, wps=23261.5, ups=1.75, wpb=13298.7, bsz=430.9, num_updates=39700, lr=7.09773e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=57, gb_free=14.7, wall=29588
2023-08-25 20:06:35 | INFO | train_inner | epoch 034:    515 / 1191 loss=1.813, trans_loss=4.514, nll_loss=1.676, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.084, total=6704.45, n_correct=4947.05, ppl=3.2, accuracy=73.788, wps=23660.8, ups=1.76, wpb=13408.9, bsz=443.4, num_updates=39800, lr=7.08881e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=56, gb_free=14.2, wall=29645
2023-08-25 20:07:32 | INFO | train_inner | epoch 034:    615 / 1191 loss=1.827, trans_loss=4.521, nll_loss=1.685, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.122, total=6737.48, n_correct=4957.54, ppl=3.22, accuracy=73.582, wps=23614.6, ups=1.75, wpb=13475, bsz=465.8, num_updates=39900, lr=7.07992e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=56, gb_free=14.3, wall=29702
2023-08-25 20:08:28 | INFO | train_inner | epoch 034:    715 / 1191 loss=1.818, trans_loss=4.519, nll_loss=1.683, w2v_ctc_loss=0.527, task_loss=0, contrastive_loss=0.078, total=6608.91, n_correct=4864.36, ppl=3.21, accuracy=73.603, wps=23453.9, ups=1.77, wpb=13217.8, bsz=435.2, num_updates=40000, lr=7.07107e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=13, wall=29758
2023-08-25 20:08:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:08:59 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.829 | trans_loss 4.854 | nll_loss 2.066 | w2v_ctc_loss 1.271 | task_loss 0 | contrastive_loss 0.253 | total 6138.43 | n_correct 4391 | ppl 4.19 | accuracy 71.533 | uer 16.621 | wer 18.353 | raw_wer 18.353 | bleu 28.9 | wps 1847.1 | wpb 6138.4 | bsz 201.1 | num_updates 40000 | best_bleu 29.1
2023-08-25 20:08:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40000 updates
2023-08-25 20:08:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_34_40000.pt
2023-08-25 20:09:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_34_40000.pt
2023-08-25 20:09:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_34_40000.pt (epoch 34 @ 40000 updates, score 28.9) (writing took 6.953340327003389 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 20:10:04 | INFO | train_inner | epoch 034:    815 / 1191 loss=1.818, trans_loss=4.515, nll_loss=1.677, w2v_ctc_loss=0.531, task_loss=0, contrastive_loss=0.074, total=6668.41, n_correct=4918.62, ppl=3.2, accuracy=73.76, wps=13883.1, ups=1.04, wpb=13336.8, bsz=455.6, num_updates=40100, lr=7.06225e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=57, gb_free=13.8, wall=29854
2023-08-25 20:11:01 | INFO | train_inner | epoch 034:    915 / 1191 loss=1.818, trans_loss=4.516, nll_loss=1.678, w2v_ctc_loss=0.533, task_loss=0, contrastive_loss=0.068, total=6650.22, n_correct=4896.88, ppl=3.2, accuracy=73.635, wps=23533.9, ups=1.77, wpb=13300.4, bsz=427.8, num_updates=40200, lr=7.05346e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=29911
2023-08-25 20:11:57 | INFO | train_inner | epoch 034:   1015 / 1191 loss=1.816, trans_loss=4.521, nll_loss=1.686, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.056, total=6680.01, n_correct=4919.54, ppl=3.22, accuracy=73.646, wps=23703.2, ups=1.77, wpb=13360, bsz=442.6, num_updates=40300, lr=7.0447e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=13.6, wall=29967
2023-08-25 20:12:53 | INFO | train_inner | epoch 034:   1115 / 1191 loss=1.814, trans_loss=4.516, nll_loss=1.679, w2v_ctc_loss=0.517, task_loss=0, contrastive_loss=0.091, total=6848.4, n_correct=5049.13, ppl=3.2, accuracy=73.727, wps=24281.2, ups=1.77, wpb=13696.8, bsz=477.6, num_updates=40400, lr=7.03598e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=14.5, wall=30024
2023-08-25 20:13:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
2023-08-25 20:14:07 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.821 | trans_loss 4.854 | nll_loss 2.068 | w2v_ctc_loss 1.244 | task_loss 0 | contrastive_loss 0.25 | total 6138.43 | n_correct 4392.29 | ppl 4.19 | accuracy 71.554 | uer 16.396 | wer 18.141 | raw_wer 18.141 | bleu 28.88 | wps 1863.1 | wpb 6138.4 | bsz 201.1 | num_updates 40476 | best_bleu 29.1
2023-08-25 20:14:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40476 updates
2023-08-25 20:14:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8808.pt
2023-08-25 20:14:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8808.pt
2023-08-25 20:14:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.8808.pt (epoch 34 @ 40476 updates, score 28.88) (writing took 6.491201619995991 seconds)
2023-08-25 20:14:14 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2023-08-25 20:14:14 | INFO | train | epoch 034 | loss 1.819 | trans_loss 4.517 | nll_loss 1.68 | w2v_ctc_loss 0.527 | task_loss 0 | contrastive_loss 0.096 | total 6703.69 | n_correct 4939.17 | ppl 3.2 | accuracy 73.678 | wps 21007.2 | ups 1.57 | wpb 13407.4 | bsz 452.1 | num_updates 40476 | lr 7.02937e-05 | gnorm 0.414 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 14.3 | wall 30105
2023-08-25 20:14:15 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 20:14:15 | INFO | fairseq.trainer | begin training epoch 35
2023-08-25 20:14:15 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 20:14:35 | INFO | train_inner | epoch 035:     24 / 1191 loss=1.825, trans_loss=4.518, nll_loss=1.682, w2v_ctc_loss=0.525, task_loss=0, contrastive_loss=0.157, total=6771.92, n_correct=4985.63, ppl=3.21, accuracy=73.622, wps=13300.4, ups=0.98, wpb=13543.8, bsz=471.7, num_updates=40500, lr=7.02728e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=13.8, wall=30126
2023-08-25 20:15:32 | INFO | train_inner | epoch 035:    124 / 1191 loss=1.81, trans_loss=4.509, nll_loss=1.669, w2v_ctc_loss=0.522, task_loss=0, contrastive_loss=0.056, total=6711.06, n_correct=4958.83, ppl=3.18, accuracy=73.89, wps=23750.5, ups=1.77, wpb=13422.1, bsz=452.8, num_updates=40600, lr=7.01862e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=56, gb_free=12.3, wall=30182
2023-08-25 20:16:28 | INFO | train_inner | epoch 035:    224 / 1191 loss=1.82, trans_loss=4.508, nll_loss=1.669, w2v_ctc_loss=0.522, task_loss=0, contrastive_loss=0.172, total=6627.11, n_correct=4892.75, ppl=3.18, accuracy=73.829, wps=23451, ups=1.77, wpb=13254.2, bsz=444, num_updates=40700, lr=7.01e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=15.3, wall=30239
2023-08-25 20:17:25 | INFO | train_inner | epoch 035:    324 / 1191 loss=1.814, trans_loss=4.506, nll_loss=1.666, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.109, total=6768.12, n_correct=5006.78, ppl=3.17, accuracy=73.976, wps=23906.6, ups=1.77, wpb=13536.2, bsz=463.6, num_updates=40800, lr=7.0014e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=56, gb_free=13.7, wall=30295
2023-08-25 20:18:22 | INFO | train_inner | epoch 035:    424 / 1191 loss=1.813, trans_loss=4.513, nll_loss=1.674, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.045, total=6573.32, n_correct=4846.36, ppl=3.19, accuracy=73.728, wps=23146, ups=1.76, wpb=13146.6, bsz=420.1, num_updates=40900, lr=6.99284e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=56, gb_free=14, wall=30352
2023-08-25 20:19:18 | INFO | train_inner | epoch 035:    524 / 1191 loss=1.814, trans_loss=4.508, nll_loss=1.668, w2v_ctc_loss=0.526, task_loss=0, contrastive_loss=0.072, total=6718.03, n_correct=4960.76, ppl=3.18, accuracy=73.842, wps=23828, ups=1.77, wpb=13436.1, bsz=456.1, num_updates=41000, lr=6.9843e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=56, gb_free=12.9, wall=30408
2023-08-25 20:20:15 | INFO | train_inner | epoch 035:    624 / 1191 loss=1.812, trans_loss=4.509, nll_loss=1.67, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.082, total=6702.8, n_correct=4945.63, ppl=3.18, accuracy=73.785, wps=23450.9, ups=1.75, wpb=13405.6, bsz=446.4, num_updates=41100, lr=6.9758e-05, gnorm=0.445, clip=0, loss_scale=32, train_wall=56, gb_free=10.2, wall=30466
2023-08-25 20:21:12 | INFO | train_inner | epoch 035:    724 / 1191 loss=1.823, trans_loss=4.518, nll_loss=1.682, w2v_ctc_loss=0.528, task_loss=0, contrastive_loss=0.116, total=6709.59, n_correct=4938.93, ppl=3.21, accuracy=73.61, wps=23580, ups=1.76, wpb=13419.2, bsz=453.6, num_updates=41200, lr=6.96733e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=56, gb_free=13.5, wall=30523
2023-08-25 20:21:41 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 20:22:09 | INFO | train_inner | epoch 035:    825 / 1191 loss=1.818, trans_loss=4.517, nll_loss=1.68, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.107, total=6753.79, n_correct=4977.45, ppl=3.2, accuracy=73.699, wps=23645.9, ups=1.75, wpb=13507.6, bsz=459.9, num_updates=41300, lr=6.95889e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=30580
2023-08-25 20:23:06 | INFO | train_inner | epoch 035:    925 / 1191 loss=1.817, trans_loss=4.512, nll_loss=1.674, w2v_ctc_loss=0.514, task_loss=0, contrastive_loss=0.131, total=6786.76, n_correct=5009.34, ppl=3.19, accuracy=73.81, wps=24038.4, ups=1.77, wpb=13573.5, bsz=475.3, num_updates=41400, lr=6.95048e-05, gnorm=0.406, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=30636
2023-08-25 20:24:02 | INFO | train_inner | epoch 035:   1025 / 1191 loss=1.813, trans_loss=4.509, nll_loss=1.669, w2v_ctc_loss=0.527, task_loss=0, contrastive_loss=0.06, total=6732.07, n_correct=4965.04, ppl=3.18, accuracy=73.752, wps=23758.6, ups=1.76, wpb=13464.1, bsz=445.3, num_updates=41500, lr=6.9421e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=56, gb_free=14.8, wall=30693
2023-08-25 20:25:00 | INFO | train_inner | epoch 035:   1125 / 1191 loss=1.817, trans_loss=4.52, nll_loss=1.684, w2v_ctc_loss=0.53, task_loss=0, contrastive_loss=0.057, total=6620.76, n_correct=4874.74, ppl=3.21, accuracy=73.628, wps=23166.6, ups=1.75, wpb=13241.5, bsz=440.4, num_updates=41600, lr=6.93375e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=56, gb_free=12.1, wall=30750
2023-08-25 20:25:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:26:09 | INFO | dev_st | epoch 035 | valid on 'dev_st' subset | loss 3.833 | trans_loss 4.859 | nll_loss 2.075 | w2v_ctc_loss 1.272 | task_loss 0 | contrastive_loss 0.251 | total 6138.43 | n_correct 4390 | ppl 4.21 | accuracy 71.517 | uer 16.682 | wer 18.349 | raw_wer 18.349 | bleu 28.81 | wps 1850.3 | wpb 6138.4 | bsz 201.1 | num_updates 41666 | best_bleu 29.1
2023-08-25 20:26:09 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 35 @ 41666 updates
2023-08-25 20:26:09 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 20:26:16 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 20:26:16 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt (epoch 35 @ 41666 updates, score 28.81) (writing took 7.2928431239997735 seconds)
2023-08-25 20:26:16 | INFO | fairseq_cli.train | end of epoch 35 (average epoch stats below)
2023-08-25 20:26:16 | INFO | train | epoch 035 | loss 1.816 | trans_loss 4.512 | nll_loss 1.674 | w2v_ctc_loss 0.524 | task_loss 0 | contrastive_loss 0.095 | total 6703.83 | n_correct 4945.72 | ppl 3.19 | accuracy 73.774 | wps 22106.1 | ups 1.65 | wpb 13407.7 | bsz 452.2 | num_updates 41666 | lr 6.92826e-05 | gnorm 0.417 | clip 0 | loss_scale 16 | train_wall 668 | gb_free 14.4 | wall 30826
2023-08-25 20:26:16 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 20:26:16 | INFO | fairseq.trainer | begin training epoch 36
2023-08-25 20:26:16 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 20:26:43 | INFO | train_inner | epoch 036:     34 / 1191 loss=1.819, trans_loss=4.511, nll_loss=1.673, w2v_ctc_loss=0.519, task_loss=0, contrastive_loss=0.125, total=6723.46, n_correct=4963.35, ppl=3.19, accuracy=73.821, wps=12971.8, ups=0.96, wpb=13446.9, bsz=466.6, num_updates=41700, lr=6.92543e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=57, gb_free=13, wall=30854
2023-08-25 20:27:39 | INFO | train_inner | epoch 036:    134 / 1191 loss=1.812, trans_loss=4.499, nll_loss=1.657, w2v_ctc_loss=0.518, task_loss=0, contrastive_loss=0.14, total=6615.18, n_correct=4895.81, ppl=3.15, accuracy=74.009, wps=23638, ups=1.79, wpb=13230.4, bsz=439.7, num_updates=41800, lr=6.91714e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=55, gb_free=13.7, wall=30910
2023-08-25 20:28:36 | INFO | train_inner | epoch 036:    234 / 1191 loss=1.799, trans_loss=4.494, nll_loss=1.65, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.054, total=6741.47, n_correct=5002.25, ppl=3.14, accuracy=74.201, wps=23822.9, ups=1.77, wpb=13482.9, bsz=470.3, num_updates=41900, lr=6.90889e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=9.3, wall=30966
2023-08-25 20:29:32 | INFO | train_inner | epoch 036:    334 / 1191 loss=1.803, trans_loss=4.504, nll_loss=1.662, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.058, total=6788.68, n_correct=5028.09, ppl=3.17, accuracy=74.066, wps=24148.9, ups=1.78, wpb=13577.4, bsz=468.7, num_updates=42000, lr=6.90066e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=56, gb_free=14.3, wall=31022
2023-08-25 20:29:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:30:03 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.829 | trans_loss 4.856 | nll_loss 2.069 | w2v_ctc_loss 1.263 | task_loss 0 | contrastive_loss 0.254 | total 6138.43 | n_correct 4399.29 | ppl 4.19 | accuracy 71.668 | uer 16.385 | wer 18.215 | raw_wer 18.215 | bleu 28.85 | wps 1819.5 | wpb 6138.4 | bsz 201.1 | num_updates 42000 | best_bleu 29.1
2023-08-25 20:30:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42000 updates
2023-08-25 20:30:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_36_42000.pt
2023-08-25 20:30:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_36_42000.pt
2023-08-25 20:30:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_36_42000.pt (epoch 36 @ 42000 updates, score 28.85) (writing took 8.184532982995734 seconds)
2023-08-25 20:31:09 | INFO | train_inner | epoch 036:    434 / 1191 loss=1.813, trans_loss=4.506, nll_loss=1.666, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.104, total=6801.05, n_correct=5030.38, ppl=3.17, accuracy=73.965, wps=14023, ups=1.03, wpb=13602.1, bsz=473.4, num_updates=42100, lr=6.89246e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=31119
2023-08-25 20:32:06 | INFO | train_inner | epoch 036:    534 / 1191 loss=1.824, trans_loss=4.514, nll_loss=1.677, w2v_ctc_loss=0.52, task_loss=0, contrastive_loss=0.17, total=6792.76, n_correct=5010.58, ppl=3.2, accuracy=73.764, wps=23716.6, ups=1.75, wpb=13585.5, bsz=472.4, num_updates=42200, lr=6.88428e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=57, gb_free=13.1, wall=31177
2023-08-25 20:33:03 | INFO | train_inner | epoch 036:    634 / 1191 loss=1.808, trans_loss=4.505, nll_loss=1.665, w2v_ctc_loss=0.523, task_loss=0, contrastive_loss=0.05, total=6667.35, n_correct=4924.76, ppl=3.17, accuracy=73.864, wps=23556.4, ups=1.77, wpb=13334.7, bsz=440.8, num_updates=42300, lr=6.87614e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=14.9, wall=31233
2023-08-25 20:34:00 | INFO | train_inner | epoch 036:    734 / 1191 loss=1.816, trans_loss=4.509, nll_loss=1.67, w2v_ctc_loss=0.523, task_loss=0, contrastive_loss=0.116, total=6721.83, n_correct=4962.84, ppl=3.18, accuracy=73.832, wps=23748.5, ups=1.77, wpb=13443.7, bsz=450.1, num_updates=42400, lr=6.86803e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=31290
2023-08-25 20:34:56 | INFO | train_inner | epoch 036:    834 / 1191 loss=1.813, trans_loss=4.516, nll_loss=1.679, w2v_ctc_loss=0.524, task_loss=0, contrastive_loss=0.054, total=6678.35, n_correct=4925.12, ppl=3.2, accuracy=73.748, wps=23549.1, ups=1.76, wpb=13356.7, bsz=447.4, num_updates=42500, lr=6.85994e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=31347
2023-08-25 20:35:53 | INFO | train_inner | epoch 036:    934 / 1191 loss=1.82, trans_loss=4.512, nll_loss=1.674, w2v_ctc_loss=0.525, task_loss=0, contrastive_loss=0.136, total=6679.59, n_correct=4922.94, ppl=3.19, accuracy=73.701, wps=23466.7, ups=1.76, wpb=13359.2, bsz=429.9, num_updates=42600, lr=6.85189e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=13.7, wall=31404
2023-08-25 20:36:50 | INFO | train_inner | epoch 036:   1034 / 1191 loss=1.814, trans_loss=4.513, nll_loss=1.675, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.078, total=6715.41, n_correct=4956.11, ppl=3.19, accuracy=73.802, wps=23613.3, ups=1.76, wpb=13430.8, bsz=465.8, num_updates=42700, lr=6.84386e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=15.3, wall=31460
2023-08-25 20:37:47 | INFO | train_inner | epoch 036:   1134 / 1191 loss=1.813, trans_loss=4.509, nll_loss=1.669, w2v_ctc_loss=0.532, task_loss=0, contrastive_loss=0.052, total=6605.28, n_correct=4872.35, ppl=3.18, accuracy=73.764, wps=23307.7, ups=1.76, wpb=13210.6, bsz=432.4, num_updates=42800, lr=6.83586e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=56, gb_free=13.8, wall=31517
2023-08-25 20:38:19 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:38:50 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.843 | trans_loss 4.858 | nll_loss 2.071 | w2v_ctc_loss 1.304 | task_loss 0 | contrastive_loss 0.261 | total 6138.43 | n_correct 4388.86 | ppl 4.2 | accuracy 71.498 | uer 16.792 | wer 18.557 | raw_wer 18.557 | bleu 28.91 | wps 1852.1 | wpb 6138.4 | bsz 201.1 | num_updates 42857 | best_bleu 29.1
2023-08-25 20:38:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42857 updates
2023-08-25 20:38:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9108.pt
2023-08-25 20:38:52 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9108.pt
2023-08-25 20:38:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9108.pt (epoch 36 @ 42857 updates, score 28.91) (writing took 6.149278012999275 seconds)
2023-08-25 20:38:57 | INFO | fairseq_cli.train | end of epoch 36 (average epoch stats below)
2023-08-25 20:38:57 | INFO | train | epoch 036 | loss 1.813 | trans_loss 4.508 | nll_loss 1.668 | w2v_ctc_loss 0.521 | task_loss 0 | contrastive_loss 0.094 | total 6703.69 | n_correct 4951.8 | ppl 3.18 | accuracy 73.867 | wps 20994.9 | ups 1.57 | wpb 13407.4 | bsz 452.1 | num_updates 42857 | lr 6.83131e-05 | gnorm 0.414 | clip 0 | loss_scale 16 | train_wall 667 | gb_free 13.2 | wall 31587
2023-08-25 20:38:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 20:38:57 | INFO | fairseq.trainer | begin training epoch 37
2023-08-25 20:38:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 20:39:29 | INFO | train_inner | epoch 037:     43 / 1191 loss=1.813, trans_loss=4.507, nll_loss=1.667, w2v_ctc_loss=0.52, task_loss=0, contrastive_loss=0.099, total=6672.81, n_correct=4929.39, ppl=3.18, accuracy=73.873, wps=13042.1, ups=0.98, wpb=13345.6, bsz=440.3, num_updates=42900, lr=6.82789e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=15.5, wall=31619
2023-08-25 20:40:26 | INFO | train_inner | epoch 037:    143 / 1191 loss=1.816, trans_loss=4.501, nll_loss=1.66, w2v_ctc_loss=0.514, task_loss=0, contrastive_loss=0.171, total=6762.6, n_correct=5007.08, ppl=3.16, accuracy=74.041, wps=23904.5, ups=1.77, wpb=13525.2, bsz=464, num_updates=43000, lr=6.81994e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=13.2, wall=31676
2023-08-25 20:41:23 | INFO | train_inner | epoch 037:    243 / 1191 loss=1.806, trans_loss=4.497, nll_loss=1.654, w2v_ctc_loss=0.516, task_loss=0, contrastive_loss=0.081, total=6696.92, n_correct=4960.93, ppl=3.15, accuracy=74.078, wps=23528.1, ups=1.76, wpb=13393.8, bsz=449.2, num_updates=43100, lr=6.81203e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=56, gb_free=12.1, wall=31733
2023-08-25 20:42:20 | INFO | train_inner | epoch 037:    343 / 1191 loss=1.808, trans_loss=4.501, nll_loss=1.66, w2v_ctc_loss=0.519, task_loss=0, contrastive_loss=0.074, total=6637.72, n_correct=4910.76, ppl=3.16, accuracy=73.983, wps=23307.7, ups=1.76, wpb=13275.4, bsz=440.5, num_updates=43200, lr=6.80414e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=31790
2023-08-25 20:43:16 | INFO | train_inner | epoch 037:    443 / 1191 loss=1.8, trans_loss=4.495, nll_loss=1.652, w2v_ctc_loss=0.508, task_loss=0, contrastive_loss=0.072, total=6703.75, n_correct=4973.71, ppl=3.14, accuracy=74.193, wps=23937.6, ups=1.79, wpb=13407.5, bsz=446.8, num_updates=43300, lr=6.79628e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=55, gb_free=14.8, wall=31846
2023-08-25 20:44:12 | INFO | train_inner | epoch 037:    543 / 1191 loss=1.809, trans_loss=4.501, nll_loss=1.659, w2v_ctc_loss=0.521, task_loss=0, contrastive_loss=0.088, total=6639.95, n_correct=4910.69, ppl=3.16, accuracy=73.957, wps=23456, ups=1.77, wpb=13279.9, bsz=449.3, num_updates=43400, lr=6.78844e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=31903
2023-08-25 20:45:09 | INFO | train_inner | epoch 037:    643 / 1191 loss=1.81, trans_loss=4.508, nll_loss=1.668, w2v_ctc_loss=0.517, task_loss=0, contrastive_loss=0.081, total=6631.82, n_correct=4898.3, ppl=3.18, accuracy=73.861, wps=23332.2, ups=1.76, wpb=13263.6, bsz=428.1, num_updates=43500, lr=6.78064e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=56, gb_free=12.6, wall=31959
2023-08-25 20:46:06 | INFO | train_inner | epoch 037:    743 / 1191 loss=1.809, trans_loss=4.5, nll_loss=1.658, w2v_ctc_loss=0.515, task_loss=0, contrastive_loss=0.097, total=6719.07, n_correct=4977.03, ppl=3.16, accuracy=74.073, wps=23702.8, ups=1.76, wpb=13438.1, bsz=451.8, num_updates=43600, lr=6.77285e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=56, gb_free=13.9, wall=32016
2023-08-25 20:47:03 | INFO | train_inner | epoch 037:    843 / 1191 loss=1.809, trans_loss=4.507, nll_loss=1.668, w2v_ctc_loss=0.514, task_loss=0, contrastive_loss=0.097, total=6808.88, n_correct=5035.8, ppl=3.18, accuracy=73.959, wps=23732.7, ups=1.74, wpb=13617.8, bsz=466.8, num_updates=43700, lr=6.7651e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=57, gb_free=14.5, wall=32074
2023-08-25 20:48:00 | INFO | train_inner | epoch 037:    943 / 1191 loss=1.811, trans_loss=4.502, nll_loss=1.661, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.13, total=6855.49, n_correct=5076.53, ppl=3.16, accuracy=74.051, wps=23929.8, ups=1.75, wpb=13711, bsz=499.9, num_updates=43800, lr=6.75737e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=57, gb_free=13.3, wall=32131
2023-08-25 20:48:57 | INFO | train_inner | epoch 037:   1043 / 1191 loss=1.803, trans_loss=4.5, nll_loss=1.659, w2v_ctc_loss=0.516, task_loss=0, contrastive_loss=0.047, total=6689.96, n_correct=4955.34, ppl=3.16, accuracy=74.071, wps=23652.1, ups=1.77, wpb=13379.9, bsz=441.4, num_updates=43900, lr=6.74967e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=56, gb_free=14.1, wall=32187
2023-08-25 20:49:54 | INFO | train_inner | epoch 037:   1143 / 1191 loss=1.82, trans_loss=4.512, nll_loss=1.674, w2v_ctc_loss=0.527, task_loss=0, contrastive_loss=0.118, total=6631.9, n_correct=4890.76, ppl=3.19, accuracy=73.746, wps=23486, ups=1.77, wpb=13263.8, bsz=443.6, num_updates=44000, lr=6.742e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=56, gb_free=14.9, wall=32244
2023-08-25 20:49:54 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:50:25 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.824 | trans_loss 4.856 | nll_loss 2.07 | w2v_ctc_loss 1.249 | task_loss 0 | contrastive_loss 0.253 | total 6138.43 | n_correct 4387.71 | ppl 4.2 | accuracy 71.479 | uer 16.511 | wer 18.137 | raw_wer 18.137 | bleu 28.77 | wps 1855.7 | wpb 6138.4 | bsz 201.1 | num_updates 44000 | best_bleu 29.1
2023-08-25 20:50:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44000 updates
2023-08-25 20:50:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_37_44000.pt
2023-08-25 20:50:27 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_37_44000.pt
2023-08-25 20:50:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_37_44000.pt (epoch 37 @ 44000 updates, score 28.77) (writing took 6.123507743999653 seconds)
2023-08-25 20:50:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 20:51:29 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.84 | trans_loss 4.858 | nll_loss 2.072 | w2v_ctc_loss 1.296 | task_loss 0 | contrastive_loss 0.257 | total 6138.43 | n_correct 4390.57 | ppl 4.2 | accuracy 71.526 | uer 16.492 | wer 18.144 | raw_wer 18.144 | bleu 28.97 | wps 1883.4 | wpb 6138.4 | bsz 201.1 | num_updates 44048 | best_bleu 29.1
2023-08-25 20:51:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44048 updates
2023-08-25 20:51:29 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9708.pt
2023-08-25 20:51:31 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9708.pt
2023-08-25 20:51:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9708.pt (epoch 37 @ 44048 updates, score 28.97) (writing took 7.704235221004637 seconds)
2023-08-25 20:51:37 | INFO | fairseq_cli.train | end of epoch 37 (average epoch stats below)
2023-08-25 20:51:37 | INFO | train | epoch 037 | loss 1.809 | trans_loss 4.502 | nll_loss 1.661 | w2v_ctc_loss 0.516 | task_loss 0 | contrastive_loss 0.094 | total 6703.69 | n_correct 4961.14 | ppl 3.16 | accuracy 74.006 | wps 21007.1 | ups 1.57 | wpb 13407.4 | bsz 452.1 | num_updates 44048 | lr 6.73832e-05 | gnorm 0.415 | clip 0 | loss_scale 32 | train_wall 668 | gb_free 13.8 | wall 32347
2023-08-25 20:51:37 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 20:51:37 | INFO | fairseq.trainer | begin training epoch 38
2023-08-25 20:51:37 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 20:52:14 | INFO | train_inner | epoch 038:     52 / 1191 loss=1.803, trans_loss=4.504, nll_loss=1.662, w2v_ctc_loss=0.513, task_loss=0, contrastive_loss=0.052, total=6590.11, n_correct=4877.6, ppl=3.17, accuracy=74.014, wps=9409.3, ups=0.71, wpb=13180.2, bsz=432.1, num_updates=44100, lr=6.73435e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=55, gb_free=12.3, wall=32384
2023-08-25 20:53:11 | INFO | train_inner | epoch 038:    152 / 1191 loss=1.8, trans_loss=4.491, nll_loss=1.646, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.071, total=6707.39, n_correct=4981.68, ppl=3.13, accuracy=74.272, wps=23494, ups=1.75, wpb=13414.8, bsz=449.4, num_updates=44200, lr=6.72673e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=56, gb_free=9, wall=32441
2023-08-25 20:53:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-25 20:54:08 | INFO | train_inner | epoch 038:    253 / 1191 loss=1.815, trans_loss=4.497, nll_loss=1.654, w2v_ctc_loss=0.512, task_loss=0, contrastive_loss=0.185, total=6691.72, n_correct=4957.13, ppl=3.15, accuracy=74.079, wps=23339.5, ups=1.74, wpb=13383.4, bsz=456.9, num_updates=44300, lr=6.71913e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=57, gb_free=13.9, wall=32498
2023-08-25 20:55:05 | INFO | train_inner | epoch 038:    353 / 1191 loss=1.799, trans_loss=4.491, nll_loss=1.646, w2v_ctc_loss=0.513, task_loss=0, contrastive_loss=0.054, total=6693.52, n_correct=4967.6, ppl=3.13, accuracy=74.215, wps=23530.2, ups=1.76, wpb=13387, bsz=441.1, num_updates=44400, lr=6.71156e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=13.1, wall=32555
2023-08-25 20:56:02 | INFO | train_inner | epoch 038:    453 / 1191 loss=1.807, trans_loss=4.498, nll_loss=1.656, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.113, total=6746.4, n_correct=4997.95, ppl=3.15, accuracy=74.083, wps=23693.2, ups=1.76, wpb=13492.8, bsz=475.5, num_updates=44500, lr=6.70402e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=13.8, wall=32612
2023-08-25 20:56:59 | INFO | train_inner | epoch 038:    553 / 1191 loss=1.806, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.108, total=6803.05, n_correct=5045.86, ppl=3.15, accuracy=74.171, wps=23889.5, ups=1.76, wpb=13606.1, bsz=464, num_updates=44600, lr=6.6965e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=11.3, wall=32669
2023-08-25 20:57:56 | INFO | train_inner | epoch 038:    653 / 1191 loss=1.811, trans_loss=4.506, nll_loss=1.666, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.118, total=6824.05, n_correct=5049.65, ppl=3.17, accuracy=73.998, wps=23917.5, ups=1.75, wpb=13648.1, bsz=474.9, num_updates=44700, lr=6.689e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=14, wall=32726
2023-08-25 20:58:52 | INFO | train_inner | epoch 038:    753 / 1191 loss=1.809, trans_loss=4.501, nll_loss=1.659, w2v_ctc_loss=0.515, task_loss=0, contrastive_loss=0.109, total=6730.05, n_correct=4986.85, ppl=3.16, accuracy=74.098, wps=23859.5, ups=1.77, wpb=13460.1, bsz=464, num_updates=44800, lr=6.68153e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=56, gb_free=10.7, wall=32783
2023-08-25 20:59:49 | INFO | train_inner | epoch 038:    853 / 1191 loss=1.802, trans_loss=4.497, nll_loss=1.654, w2v_ctc_loss=0.516, task_loss=0, contrastive_loss=0.048, total=6694.88, n_correct=4954.74, ppl=3.15, accuracy=74.008, wps=23708.5, ups=1.77, wpb=13389.8, bsz=437.1, num_updates=44900, lr=6.67409e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=12, wall=32839
2023-08-25 21:00:46 | INFO | train_inner | epoch 038:    953 / 1191 loss=1.805, trans_loss=4.5, nll_loss=1.659, w2v_ctc_loss=0.512, task_loss=0, contrastive_loss=0.07, total=6679.76, n_correct=4945.59, ppl=3.16, accuracy=74.038, wps=23552.3, ups=1.76, wpb=13359.5, bsz=443.9, num_updates=45000, lr=6.66667e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=56, gb_free=14.1, wall=32896
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:0')
2023-08-25 21:01:42 | INFO | train_inner | epoch 038:   1053 / 1191 loss=1.809, trans_loss=4.498, nll_loss=1.656, w2v_ctc_loss=0.517, task_loss=0, contrastive_loss=0.101, total=6639.95, n_correct=4915.05, ppl=3.15, accuracy=74.022, wps=23548.6, ups=1.77, wpb=13279.9, bsz=445, num_updates=45100, lr=6.65927e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=56, gb_free=12.8, wall=32952
2023-08-25 21:02:39 | INFO | train_inner | epoch 038:   1153 / 1191 loss=1.804, trans_loss=4.501, nll_loss=1.659, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.078, total=6664.09, n_correct=4930.68, ppl=3.16, accuracy=73.989, wps=23329.9, ups=1.75, wpb=13328.2, bsz=442.3, num_updates=45200, lr=6.6519e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=57, gb_free=15.2, wall=33009
2023-08-25 21:03:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2251, device='cuda:3')
2023-08-25 21:03:32 | INFO | dev_st | epoch 038 | valid on 'dev_st' subset | loss 3.831 | trans_loss 4.855 | nll_loss 2.068 | w2v_ctc_loss 1.275 | task_loss 0 | contrastive_loss 0.254 | total 6138.43 | n_correct 4391.71 | ppl 4.19 | accuracy 71.545 | uer 16.492 | wer 18.159 | raw_wer 18.159 | bleu 28.99 | wps 1856.9 | wpb 6138.4 | bsz 201.1 | num_updates 45238 | best_bleu 29.1
2023-08-25 21:03:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 38 @ 45238 updates
2023-08-25 21:03:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9908.pt
2023-08-25 21:03:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9908.pt
2023-08-25 21:03:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9908.pt (epoch 38 @ 45238 updates, score 28.99) (writing took 7.000249689001066 seconds)
2023-08-25 21:03:39 | INFO | fairseq_cli.train | end of epoch 38 (average epoch stats below)
2023-08-25 21:03:39 | INFO | train | epoch 038 | loss 1.805 | trans_loss 4.498 | nll_loss 1.655 | w2v_ctc_loss 0.512 | task_loss 0 | contrastive_loss 0.094 | total 6704.11 | n_correct 4967.49 | ppl 3.15 | accuracy 74.096 | wps 22094.1 | ups 1.65 | wpb 13408.2 | bsz 452.1 | num_updates 45238 | lr 6.64911e-05 | gnorm 0.416 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 14.3 | wall 33069
2023-08-25 21:03:39 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 21:03:39 | INFO | fairseq.trainer | begin training epoch 39
2023-08-25 21:03:39 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 21:04:22 | INFO | train_inner | epoch 039:     62 / 1191 loss=1.8, trans_loss=4.497, nll_loss=1.654, w2v_ctc_loss=0.512, task_loss=0, contrastive_loss=0.054, total=6535.5, n_correct=4846.86, ppl=3.15, accuracy=74.162, wps=12687.8, ups=0.97, wpb=13071, bsz=422.2, num_updates=45300, lr=6.64455e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=33113
2023-08-25 21:05:19 | INFO | train_inner | epoch 039:    162 / 1191 loss=1.793, trans_loss=4.485, nll_loss=1.639, w2v_ctc_loss=0.505, task_loss=0, contrastive_loss=0.052, total=6693.26, n_correct=4980.48, ppl=3.12, accuracy=74.41, wps=23569.7, ups=1.76, wpb=13386.5, bsz=442.6, num_updates=45400, lr=6.63723e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=12.5, wall=33169
2023-08-25 21:06:15 | INFO | train_inner | epoch 039:    262 / 1191 loss=1.805, trans_loss=4.497, nll_loss=1.653, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.122, total=6667.98, n_correct=4941.12, ppl=3.15, accuracy=74.102, wps=23585, ups=1.77, wpb=13336, bsz=443.1, num_updates=45500, lr=6.62994e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=33226
2023-08-25 21:07:12 | INFO | train_inner | epoch 039:    362 / 1191 loss=1.801, trans_loss=4.494, nll_loss=1.651, w2v_ctc_loss=0.513, task_loss=0, contrastive_loss=0.073, total=6598.38, n_correct=4893.77, ppl=3.14, accuracy=74.166, wps=23178.4, ups=1.76, wpb=13196.8, bsz=427.5, num_updates=45600, lr=6.62266e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=56, gb_free=11, wall=33283
2023-08-25 21:08:09 | INFO | train_inner | epoch 039:    462 / 1191 loss=1.804, trans_loss=4.492, nll_loss=1.647, w2v_ctc_loss=0.504, task_loss=0, contrastive_loss=0.128, total=6750.43, n_correct=5007.64, ppl=3.13, accuracy=74.183, wps=23873, ups=1.77, wpb=13500.9, bsz=462.1, num_updates=45700, lr=6.61541e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14.1, wall=33339
2023-08-25 21:08:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-25 21:09:07 | INFO | train_inner | epoch 039:    563 / 1191 loss=1.799, trans_loss=4.49, nll_loss=1.647, w2v_ctc_loss=0.502, task_loss=0, contrastive_loss=0.082, total=6702.75, n_correct=4975.7, ppl=3.13, accuracy=74.234, wps=23077.9, ups=1.72, wpb=13405.5, bsz=451.3, num_updates=45800, lr=6.60819e-05, gnorm=0.417, clip=0, loss_scale=8, train_wall=57, gb_free=13.9, wall=33397
2023-08-25 21:10:04 | INFO | train_inner | epoch 039:    663 / 1191 loss=1.807, trans_loss=4.496, nll_loss=1.653, w2v_ctc_loss=0.51, task_loss=0, contrastive_loss=0.112, total=6734.41, n_correct=4991.93, ppl=3.14, accuracy=74.126, wps=23795.3, ups=1.77, wpb=13468.8, bsz=465.8, num_updates=45900, lr=6.60098e-05, gnorm=0.416, clip=0, loss_scale=8, train_wall=56, gb_free=14.1, wall=33454
2023-08-25 21:11:00 | INFO | train_inner | epoch 039:    763 / 1191 loss=1.803, trans_loss=4.497, nll_loss=1.654, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.097, total=6731.49, n_correct=4989.78, ppl=3.15, accuracy=74.126, wps=23794.4, ups=1.77, wpb=13463, bsz=454.5, num_updates=46000, lr=6.5938e-05, gnorm=0.411, clip=0, loss_scale=8, train_wall=56, gb_free=13.3, wall=33511
2023-08-25 21:11:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:11:31 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.83 | trans_loss 4.855 | nll_loss 2.068 | w2v_ctc_loss 1.267 | task_loss 0 | contrastive_loss 0.257 | total 6138.43 | n_correct 4394.57 | ppl 4.19 | accuracy 71.591 | uer 16.5 | wer 18.263 | raw_wer 18.263 | bleu 28.97 | wps 1860.1 | wpb 6138.4 | bsz 201.1 | num_updates 46000 | best_bleu 29.1
2023-08-25 21:11:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46000 updates
2023-08-25 21:11:31 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_39_46000.pt
2023-08-25 21:11:33 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_39_46000.pt
2023-08-25 21:11:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_39_46000.pt (epoch 39 @ 46000 updates, score 28.97) (writing took 7.4370439349950175 seconds)
2023-08-25 21:12:35 | INFO | train_inner | epoch 039:    863 / 1191 loss=1.803, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.508, task_loss=0, contrastive_loss=0.089, total=6803.59, n_correct=5048.27, ppl=3.15, accuracy=74.2, wps=14319.8, ups=1.05, wpb=13607.2, bsz=475, num_updates=46100, lr=6.58665e-05, gnorm=0.413, clip=0, loss_scale=8, train_wall=56, gb_free=14.2, wall=33606
2023-08-25 21:13:32 | INFO | train_inner | epoch 039:    963 / 1191 loss=1.803, trans_loss=4.488, nll_loss=1.643, w2v_ctc_loss=0.507, task_loss=0, contrastive_loss=0.116, total=6838.45, n_correct=5079.29, ppl=3.12, accuracy=74.275, wps=24000.6, ups=1.75, wpb=13676.9, bsz=481.5, num_updates=46200, lr=6.57952e-05, gnorm=0.412, clip=0, loss_scale=8, train_wall=56, gb_free=15.5, wall=33663
2023-08-25 21:14:29 | INFO | train_inner | epoch 039:   1063 / 1191 loss=1.801, trans_loss=4.493, nll_loss=1.649, w2v_ctc_loss=0.505, task_loss=0, contrastive_loss=0.1, total=6742.68, n_correct=5006.72, ppl=3.14, accuracy=74.254, wps=23682.5, ups=1.76, wpb=13485.4, bsz=454.7, num_updates=46300, lr=6.57241e-05, gnorm=0.419, clip=0, loss_scale=8, train_wall=56, gb_free=12.8, wall=33720
2023-08-25 21:15:25 | INFO | train_inner | epoch 039:   1163 / 1191 loss=1.807, trans_loss=4.498, nll_loss=1.655, w2v_ctc_loss=0.52, task_loss=0, contrastive_loss=0.077, total=6588.05, n_correct=4877.13, ppl=3.15, accuracy=74.03, wps=23467.4, ups=1.78, wpb=13176.1, bsz=431, num_updates=46400, lr=6.56532e-05, gnorm=0.421, clip=0, loss_scale=8, train_wall=56, gb_free=14.5, wall=33776
2023-08-25 21:15:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:16:12 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.832 | trans_loss 4.858 | nll_loss 2.07 | w2v_ctc_loss 1.274 | task_loss 0 | contrastive_loss 0.25 | total 6138.43 | n_correct 4389.71 | ppl 4.2 | accuracy 71.512 | uer 16.353 | wer 18.092 | raw_wer 18.092 | bleu 29 | wps 1834.7 | wpb 6138.4 | bsz 201.1 | num_updates 46428 | best_bleu 29.1
2023-08-25 21:16:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46428 updates
2023-08-25 21:16:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0006.pt
2023-08-25 21:16:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0006.pt
2023-08-25 21:16:24 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.0006.pt (epoch 39 @ 46428 updates, score 29.0) (writing took 11.315855677996296 seconds)
2023-08-25 21:16:24 | INFO | fairseq_cli.train | end of epoch 39 (average epoch stats below)
2023-08-25 21:16:24 | INFO | train | epoch 039 | loss 1.802 | trans_loss 4.493 | nll_loss 1.649 | w2v_ctc_loss 0.509 | task_loss 0 | contrastive_loss 0.093 | total 6704.32 | n_correct 4974.53 | ppl 3.14 | accuracy 74.199 | wps 20863.3 | ups 1.56 | wpb 13408.6 | bsz 452.2 | num_updates 46428 | lr 6.56334e-05 | gnorm 0.415 | clip 0 | loss_scale 8 | train_wall 668 | gb_free 13.7 | wall 33834
2023-08-25 21:16:24 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 21:16:24 | INFO | fairseq.trainer | begin training epoch 40
2023-08-25 21:16:24 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 21:17:11 | INFO | train_inner | epoch 040:     72 / 1191 loss=1.794, trans_loss=4.482, nll_loss=1.635, w2v_ctc_loss=0.502, task_loss=0, contrastive_loss=0.079, total=6774.45, n_correct=5042.97, ppl=3.11, accuracy=74.441, wps=12769.8, ups=0.94, wpb=13548.9, bsz=470.5, num_updates=46500, lr=6.55826e-05, gnorm=0.411, clip=0, loss_scale=8, train_wall=56, gb_free=14.3, wall=33882
2023-08-25 21:18:08 | INFO | train_inner | epoch 040:    172 / 1191 loss=1.793, trans_loss=4.486, nll_loss=1.64, w2v_ctc_loss=0.507, task_loss=0, contrastive_loss=0.045, total=6714.86, n_correct=4995.34, ppl=3.12, accuracy=74.392, wps=23809.6, ups=1.77, wpb=13429.7, bsz=446.3, num_updates=46600, lr=6.55122e-05, gnorm=0.415, clip=0, loss_scale=8, train_wall=56, gb_free=7.7, wall=33938
2023-08-25 21:19:05 | INFO | train_inner | epoch 040:    272 / 1191 loss=1.79, trans_loss=4.48, nll_loss=1.632, w2v_ctc_loss=0.496, task_loss=0, contrastive_loss=0.076, total=6758.58, n_correct=5035.24, ppl=3.1, accuracy=74.501, wps=23816.9, ups=1.76, wpb=13517.2, bsz=469.3, num_updates=46700, lr=6.5442e-05, gnorm=0.41, clip=0, loss_scale=8, train_wall=56, gb_free=13.8, wall=33995
2023-08-25 21:20:02 | INFO | train_inner | epoch 040:    372 / 1191 loss=1.8, trans_loss=4.486, nll_loss=1.64, w2v_ctc_loss=0.506, task_loss=0, contrastive_loss=0.101, total=6606.29, n_correct=4911.96, ppl=3.12, accuracy=74.353, wps=23037.3, ups=1.74, wpb=13212.6, bsz=434.7, num_updates=46800, lr=6.5372e-05, gnorm=0.416, clip=0, loss_scale=8, train_wall=57, gb_free=15.4, wall=34052
2023-08-25 21:20:58 | INFO | train_inner | epoch 040:    472 / 1191 loss=1.791, trans_loss=4.487, nll_loss=1.642, w2v_ctc_loss=0.5, task_loss=0, contrastive_loss=0.047, total=6731.67, n_correct=5011.81, ppl=3.12, accuracy=74.451, wps=23977, ups=1.78, wpb=13463.3, bsz=458, num_updates=46900, lr=6.53023e-05, gnorm=0.411, clip=0, loss_scale=8, train_wall=56, gb_free=14.1, wall=34109
2023-08-25 21:21:55 | INFO | train_inner | epoch 040:    572 / 1191 loss=1.798, trans_loss=4.485, nll_loss=1.639, w2v_ctc_loss=0.495, task_loss=0, contrastive_loss=0.153, total=6676.16, n_correct=4967.16, ppl=3.12, accuracy=74.401, wps=23630.6, ups=1.77, wpb=13352.3, bsz=454.3, num_updates=47000, lr=6.52328e-05, gnorm=0.41, clip=0, loss_scale=8, train_wall=56, gb_free=15.3, wall=34165
2023-08-25 21:22:52 | INFO | train_inner | epoch 040:    672 / 1191 loss=1.808, trans_loss=4.49, nll_loss=1.645, w2v_ctc_loss=0.51, task_loss=0, contrastive_loss=0.156, total=6714.1, n_correct=4983.89, ppl=3.13, accuracy=74.23, wps=23523.5, ups=1.75, wpb=13428.2, bsz=449.9, num_updates=47100, lr=6.51635e-05, gnorm=0.417, clip=0, loss_scale=8, train_wall=56, gb_free=14, wall=34222
2023-08-25 21:23:49 | INFO | train_inner | epoch 040:    772 / 1191 loss=1.799, trans_loss=4.49, nll_loss=1.646, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.058, total=6645.63, n_correct=4931.7, ppl=3.13, accuracy=74.21, wps=23227.7, ups=1.75, wpb=13291.3, bsz=440.4, num_updates=47200, lr=6.50945e-05, gnorm=0.418, clip=0, loss_scale=8, train_wall=57, gb_free=13.6, wall=34279
2023-08-25 21:24:46 | INFO | train_inner | epoch 040:    872 / 1191 loss=1.803, trans_loss=4.494, nll_loss=1.651, w2v_ctc_loss=0.514, task_loss=0, contrastive_loss=0.087, total=6695.84, n_correct=4969.44, ppl=3.14, accuracy=74.217, wps=23479.1, ups=1.75, wpb=13391.7, bsz=442.3, num_updates=47300, lr=6.50256e-05, gnorm=0.422, clip=0, loss_scale=8, train_wall=56, gb_free=13.7, wall=34336
2023-08-25 21:25:43 | INFO | train_inner | epoch 040:    972 / 1191 loss=1.804, trans_loss=4.494, nll_loss=1.651, w2v_ctc_loss=0.506, task_loss=0, contrastive_loss=0.121, total=6689.77, n_correct=4969.15, ppl=3.14, accuracy=74.28, wps=23600.2, ups=1.76, wpb=13379.5, bsz=454, num_updates=47400, lr=6.4957e-05, gnorm=0.421, clip=0, loss_scale=8, train_wall=56, gb_free=13.7, wall=34393
2023-08-25 21:26:40 | INFO | train_inner | epoch 040:   1072 / 1191 loss=1.799, trans_loss=4.489, nll_loss=1.644, w2v_ctc_loss=0.51, task_loss=0, contrastive_loss=0.077, total=6761.55, n_correct=5022.25, ppl=3.13, accuracy=74.277, wps=23727.1, ups=1.75, wpb=13523.1, bsz=459.1, num_updates=47500, lr=6.48886e-05, gnorm=0.41, clip=0, loss_scale=8, train_wall=56, gb_free=14.5, wall=34450
2023-08-25 21:27:36 | INFO | train_inner | epoch 040:   1172 / 1191 loss=1.801, trans_loss=4.492, nll_loss=1.648, w2v_ctc_loss=0.502, task_loss=0, contrastive_loss=0.109, total=6688.64, n_correct=4963.37, ppl=3.13, accuracy=74.206, wps=23638.6, ups=1.77, wpb=13377.3, bsz=458.8, num_updates=47600, lr=6.48204e-05, gnorm=0.416, clip=0, loss_scale=8, train_wall=56, gb_free=13.2, wall=34507
2023-08-25 21:27:47 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:28:18 | INFO | dev_st | epoch 040 | valid on 'dev_st' subset | loss 3.844 | trans_loss 4.856 | nll_loss 2.069 | w2v_ctc_loss 1.313 | task_loss 0 | contrastive_loss 0.253 | total 6138.43 | n_correct 4393 | ppl 4.2 | accuracy 71.566 | uer 16.546 | wer 18.26 | raw_wer 18.26 | bleu 28.81 | wps 1841.3 | wpb 6138.4 | bsz 201.1 | num_updates 47619 | best_bleu 29.1
2023-08-25 21:28:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 40 @ 47619 updates
2023-08-25 21:28:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 21:28:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt
2023-08-25 21:28:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_last.pt (epoch 40 @ 47619 updates, score 28.81) (writing took 7.24403869699745 seconds)
2023-08-25 21:28:25 | INFO | fairseq_cli.train | end of epoch 40 (average epoch stats below)
2023-08-25 21:28:25 | INFO | train | epoch 040 | loss 1.799 | trans_loss 4.488 | nll_loss 1.643 | w2v_ctc_loss 0.505 | task_loss 0 | contrastive_loss 0.093 | total 6703.69 | n_correct 4982.12 | ppl 3.12 | accuracy 74.319 | wps 22133.2 | ups 1.65 | wpb 13407.4 | bsz 452.1 | num_updates 47619 | lr 6.48074e-05 | gnorm 0.415 | clip 0 | loss_scale 8 | train_wall 668 | gb_free 12.6 | wall 34556
2023-08-25 21:28:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 21:28:25 | INFO | fairseq.trainer | begin training epoch 41
2023-08-25 21:28:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 21:29:19 | INFO | train_inner | epoch 041:     81 / 1191 loss=1.798, trans_loss=4.486, nll_loss=1.64, w2v_ctc_loss=0.502, task_loss=0, contrastive_loss=0.111, total=6722.93, n_correct=5000.04, ppl=3.12, accuracy=74.373, wps=13136.5, ups=0.98, wpb=13445.9, bsz=464.5, num_updates=47700, lr=6.47524e-05, gnorm=0.419, clip=0, loss_scale=8, train_wall=56, gb_free=14.5, wall=34609
2023-08-25 21:30:16 | INFO | train_inner | epoch 041:    181 / 1191 loss=1.8, trans_loss=4.481, nll_loss=1.634, w2v_ctc_loss=0.5, task_loss=0, contrastive_loss=0.14, total=6672.05, n_correct=4963.24, ppl=3.1, accuracy=74.389, wps=23468.6, ups=1.76, wpb=13344.1, bsz=445, num_updates=47800, lr=6.46846e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=56, gb_free=12.1, wall=34666
2023-08-25 21:31:13 | INFO | train_inner | epoch 041:    281 / 1191 loss=1.793, trans_loss=4.481, nll_loss=1.634, w2v_ctc_loss=0.493, task_loss=0, contrastive_loss=0.099, total=6804.18, n_correct=5068.59, ppl=3.1, accuracy=74.492, wps=23809.8, ups=1.75, wpb=13608.4, bsz=478.8, num_updates=47900, lr=6.46171e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=57, gb_free=13.5, wall=34723
2023-08-25 21:32:09 | INFO | train_inner | epoch 041:    381 / 1191 loss=1.789, trans_loss=4.483, nll_loss=1.636, w2v_ctc_loss=0.501, task_loss=0, contrastive_loss=0.048, total=6779.91, n_correct=5052.14, ppl=3.11, accuracy=74.516, wps=24004.9, ups=1.77, wpb=13559.8, bsz=459.7, num_updates=48000, lr=6.45497e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=56, gb_free=14.3, wall=34780
2023-08-25 21:32:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:32:40 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.825 | trans_loss 4.859 | nll_loss 2.073 | w2v_ctc_loss 1.243 | task_loss 0 | contrastive_loss 0.258 | total 6138.43 | n_correct 4393.14 | ppl 4.21 | accuracy 71.568 | uer 16.289 | wer 18.044 | raw_wer 18.044 | bleu 29.29 | wps 1854 | wpb 6138.4 | bsz 201.1 | num_updates 48000 | best_bleu 29.29
2023-08-25 21:32:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48000 updates
2023-08-25 21:32:40 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_41_48000.pt
2023-08-25 21:32:42 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_41_48000.pt
2023-08-25 21:32:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint_41_48000.pt (epoch 41 @ 48000 updates, score 29.29) (writing took 12.511834985998576 seconds)
2023-08-25 21:33:50 | INFO | train_inner | epoch 041:    481 / 1191 loss=1.789, trans_loss=4.481, nll_loss=1.634, w2v_ctc_loss=0.503, task_loss=0, contrastive_loss=0.044, total=6790.05, n_correct=5066.33, ppl=3.1, accuracy=74.614, wps=13461.8, ups=0.99, wpb=13580.1, bsz=461.9, num_updates=48100, lr=6.44826e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=56, gb_free=12.9, wall=34880
2023-08-25 21:34:47 | INFO | train_inner | epoch 041:    581 / 1191 loss=1.788, trans_loss=4.478, nll_loss=1.629, w2v_ctc_loss=0.493, task_loss=0, contrastive_loss=0.065, total=6773.53, n_correct=5051.61, ppl=3.09, accuracy=74.579, wps=23908.3, ups=1.76, wpb=13547.1, bsz=458, num_updates=48200, lr=6.44157e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=56, gb_free=11.7, wall=34937
2023-08-25 21:35:43 | INFO | train_inner | epoch 041:    681 / 1191 loss=1.796, trans_loss=4.484, nll_loss=1.638, w2v_ctc_loss=0.507, task_loss=0, contrastive_loss=0.089, total=6677.75, n_correct=4969.84, ppl=3.11, accuracy=74.424, wps=23550.1, ups=1.76, wpb=13355.5, bsz=448.7, num_updates=48300, lr=6.43489e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=56, gb_free=11.1, wall=34994
2023-08-25 21:36:40 | INFO | train_inner | epoch 041:    781 / 1191 loss=1.795, trans_loss=4.483, nll_loss=1.637, w2v_ctc_loss=0.507, task_loss=0, contrastive_loss=0.078, total=6547.43, n_correct=4867.83, ppl=3.11, accuracy=74.347, wps=23043.4, ups=1.76, wpb=13094.9, bsz=422.4, num_updates=48400, lr=6.42824e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=56, gb_free=13.4, wall=35051
2023-08-25 21:37:37 | INFO | train_inner | epoch 041:    881 / 1191 loss=1.798, trans_loss=4.484, nll_loss=1.638, w2v_ctc_loss=0.511, task_loss=0, contrastive_loss=0.084, total=6581.95, n_correct=4895.36, ppl=3.11, accuracy=74.376, wps=23130.5, ups=1.76, wpb=13163.9, bsz=427.6, num_updates=48500, lr=6.42161e-05, gnorm=0.435, clip=0, loss_scale=16, train_wall=56, gb_free=11.2, wall=35108
2023-08-25 21:38:35 | INFO | train_inner | epoch 041:    981 / 1191 loss=1.804, trans_loss=4.492, nll_loss=1.648, w2v_ctc_loss=0.509, task_loss=0, contrastive_loss=0.11, total=6677.96, n_correct=4952.72, ppl=3.13, accuracy=74.165, wps=23264.7, ups=1.74, wpb=13355.9, bsz=444.6, num_updates=48600, lr=6.415e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=57, gb_free=13.9, wall=35165
2023-08-25 21:39:31 | INFO | train_inner | epoch 041:   1081 / 1191 loss=1.796, trans_loss=4.487, nll_loss=1.643, w2v_ctc_loss=0.499, task_loss=0, contrastive_loss=0.102, total=6841.34, n_correct=5091.81, ppl=3.12, accuracy=74.427, wps=24051.9, ups=1.76, wpb=13682.7, bsz=478.7, num_updates=48700, lr=6.40841e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=56, gb_free=14.6, wall=35222
2023-08-25 21:40:28 | INFO | train_inner | epoch 041:   1181 / 1191 loss=1.8, trans_loss=4.488, nll_loss=1.644, w2v_ctc_loss=0.505, task_loss=0, contrastive_loss=0.128, total=6589.42, n_correct=4897.3, ppl=3.12, accuracy=74.321, wps=23366.2, ups=1.77, wpb=13178.8, bsz=431.4, num_updates=48800, lr=6.40184e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=35278
2023-08-25 21:40:33 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:41:05 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.838 | trans_loss 4.86 | nll_loss 2.073 | w2v_ctc_loss 1.286 | task_loss 0 | contrastive_loss 0.255 | total 6138.43 | n_correct 4388 | ppl 4.21 | accuracy 71.484 | uer 16.436 | wer 18.096 | raw_wer 18.096 | bleu 29.23 | wps 1848.8 | wpb 6138.4 | bsz 201.1 | num_updates 48810 | best_bleu 29.29
2023-08-25 21:41:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48810 updates
2023-08-25 21:41:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.2309.pt
2023-08-25 21:41:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.2309.pt
2023-08-25 21:41:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_29.2309.pt (epoch 41 @ 48810 updates, score 29.23) (writing took 7.985633229996893 seconds)
2023-08-25 21:41:13 | INFO | fairseq_cli.train | end of epoch 41 (average epoch stats below)
2023-08-25 21:41:13 | INFO | train | epoch 041 | loss 1.795 | trans_loss 4.484 | nll_loss 1.638 | w2v_ctc_loss 0.502 | task_loss 0 | contrastive_loss 0.092 | total 6703.69 | n_correct 4989.38 | ppl 3.11 | accuracy 74.427 | wps 20802.7 | ups 1.55 | wpb 13407.4 | bsz 452.1 | num_updates 48810 | lr 6.40119e-05 | gnorm 0.418 | clip 0 | loss_scale 16 | train_wall 669 | gb_free 12 | wall 35323
2023-08-25 21:41:13 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-25 21:41:13 | INFO | fairseq.trainer | begin training epoch 42
2023-08-25 21:41:13 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-25 21:42:11 | INFO | train_inner | epoch 042:     90 / 1191 loss=1.79, trans_loss=4.475, nll_loss=1.626, w2v_ctc_loss=0.489, task_loss=0, contrastive_loss=0.112, total=6824.86, n_correct=5096.79, ppl=3.09, accuracy=74.68, wps=13226.8, ups=0.97, wpb=13649.7, bsz=483.3, num_updates=48900, lr=6.39529e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=55, gb_free=14.1, wall=35381
2023-08-25 21:43:08 | INFO | train_inner | epoch 042:    190 / 1191 loss=1.8, trans_loss=4.481, nll_loss=1.634, w2v_ctc_loss=0.499, task_loss=0, contrastive_loss=0.162, total=6671.53, n_correct=4967.34, ppl=3.1, accuracy=74.456, wps=23606.7, ups=1.77, wpb=13343.1, bsz=441.1, num_updates=49000, lr=6.38877e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=56, gb_free=13.9, wall=35438
2023-08-25 21:44:05 | INFO | train_inner | epoch 042:    290 / 1191 loss=1.794, trans_loss=4.475, nll_loss=1.626, w2v_ctc_loss=0.506, task_loss=0, contrastive_loss=0.093, total=6650.86, n_correct=4960.82, ppl=3.09, accuracy=74.589, wps=23343.2, ups=1.75, wpb=13301.7, bsz=445.5, num_updates=49100, lr=6.38226e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14.7, wall=35495
2023-08-25 21:45:01 | INFO | train_inner | epoch 042:    390 / 1191 loss=1.788, trans_loss=4.475, nll_loss=1.626, w2v_ctc_loss=0.496, task_loss=0, contrastive_loss=0.083, total=6626.36, n_correct=4946.83, ppl=3.09, accuracy=74.654, wps=23313.9, ups=1.76, wpb=13252.7, bsz=447.3, num_updates=49200, lr=6.37577e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=14.4, wall=35552
2023-08-25 21:45:59 | INFO | train_inner | epoch 042:    490 / 1191 loss=1.79, trans_loss=4.484, nll_loss=1.636, w2v_ctc_loss=0.503, task_loss=0, contrastive_loss=0.042, total=6622.87, n_correct=4927.24, ppl=3.11, accuracy=74.397, wps=23213.2, ups=1.75, wpb=13245.7, bsz=418.4, num_updates=49300, lr=6.3693e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=56, gb_free=14.5, wall=35609
2023-08-25 21:46:55 | INFO | train_inner | epoch 042:    590 / 1191 loss=1.801, trans_loss=4.485, nll_loss=1.639, w2v_ctc_loss=0.508, task_loss=0, contrastive_loss=0.12, total=6598.24, n_correct=4903.45, ppl=3.11, accuracy=74.315, wps=23237.3, ups=1.76, wpb=13196.5, bsz=431.9, num_updates=49400, lr=6.36285e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=56, gb_free=12.7, wall=35666
2023-08-25 21:47:52 | INFO | train_inner | epoch 042:    690 / 1191 loss=1.793, trans_loss=4.481, nll_loss=1.634, w2v_ctc_loss=0.493, task_loss=0, contrastive_loss=0.102, total=6827.49, n_correct=5089.9, ppl=3.1, accuracy=74.55, wps=24111.6, ups=1.77, wpb=13655, bsz=480.8, num_updates=49500, lr=6.35642e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=56, gb_free=9.3, wall=35722
2023-08-25 21:48:49 | INFO | train_inner | epoch 042:    790 / 1191 loss=1.796, trans_loss=4.485, nll_loss=1.639, w2v_ctc_loss=0.502, task_loss=0, contrastive_loss=0.09, total=6715.54, n_correct=4998.43, ppl=3.11, accuracy=74.431, wps=23757.1, ups=1.77, wpb=13431.1, bsz=463.9, num_updates=49600, lr=6.35001e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=35779
2023-08-25 21:49:45 | INFO | train_inner | epoch 042:    890 / 1191 loss=1.786, trans_loss=4.475, nll_loss=1.626, w2v_ctc_loss=0.497, task_loss=0, contrastive_loss=0.051, total=6567.62, n_correct=4901.64, ppl=3.09, accuracy=74.633, wps=23175.9, ups=1.76, wpb=13135.2, bsz=440.7, num_updates=49700, lr=6.34361e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=56, gb_free=13.5, wall=35836
2023-08-25 21:50:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-25 21:50:43 | INFO | train_inner | epoch 042:    991 / 1191 loss=1.796, trans_loss=4.483, nll_loss=1.636, w2v_ctc_loss=0.497, task_loss=0, contrastive_loss=0.122, total=6812.89, n_correct=5073.26, ppl=3.11, accuracy=74.466, wps=23654.2, ups=1.74, wpb=13625.8, bsz=481.8, num_updates=49800, lr=6.33724e-05, gnorm=0.422, clip=0, loss_scale=8, train_wall=57, gb_free=13.9, wall=35893
2023-08-25 21:51:40 | INFO | train_inner | epoch 042:   1091 / 1191 loss=1.79, trans_loss=4.485, nll_loss=1.638, w2v_ctc_loss=0.504, task_loss=0, contrastive_loss=0.039, total=6659.37, n_correct=4953.57, ppl=3.11, accuracy=74.385, wps=23424, ups=1.76, wpb=13318.7, bsz=420.2, num_updates=49900, lr=6.33089e-05, gnorm=0.415, clip=0, loss_scale=8, train_wall=56, gb_free=15.4, wall=35950
2023-08-25 21:52:36 | INFO | train_inner | epoch 042:   1191 / 1191 loss=1.789, trans_loss=4.478, nll_loss=1.631, w2v_ctc_loss=0.497, task_loss=0, contrastive_loss=0.068, total=6806.95, n_correct=5077.67, ppl=3.1, accuracy=74.595, wps=23997.6, ups=1.76, wpb=13613.9, bsz=463.1, num_updates=50000, lr=6.32456e-05, gnorm=0.405, clip=0, loss_scale=8, train_wall=56, gb_free=11.6, wall=36007
2023-08-25 21:52:36 | INFO | fairseq_cli.train | Stopping training due to num_updates: 50000 >= max_update: 50000
2023-08-25 21:52:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-25 21:53:08 | INFO | dev_st | epoch 042 | valid on 'dev_st' subset | loss 3.847 | trans_loss 4.859 | nll_loss 2.074 | w2v_ctc_loss 1.318 | task_loss 0 | contrastive_loss 0.253 | total 6138.43 | n_correct 4392.71 | ppl 4.21 | accuracy 71.561 | uer 16.476 | wer 18.23 | raw_wer 18.23 | bleu 28.98 | wps 1845.9 | wpb 6138.4 | bsz 201.1 | num_updates 50000 | best_bleu 29.29
2023-08-25 21:53:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 42 @ 50000 updates
2023-08-25 21:53:08 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9802.pt
2023-08-25 21:53:10 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9802.pt
2023-08-25 21:53:16 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0825_baseline_alpha1.5_mt0.5/checkpoint.best_bleu_28.9802.pt (epoch 42 @ 50000 updates, score 28.98) (writing took 8.45774430900201 seconds)
2023-08-25 21:53:16 | INFO | fairseq_cli.train | end of epoch 42 (average epoch stats below)
2023-08-25 21:53:16 | INFO | train | epoch 042 | loss 1.793 | trans_loss 4.48 | nll_loss 1.633 | w2v_ctc_loss 0.499 | task_loss 0 | contrastive_loss 0.091 | total 6702.43 | n_correct 4994.21 | ppl 3.1 | accuracy 74.513 | wps 22051.6 | ups 1.65 | wpb 13404.9 | bsz 452 | num_updates 50000 | lr 6.32456e-05 | gnorm 0.417 | clip 0 | loss_scale 8 | train_wall 668 | gb_free 11.6 | wall 36047
2023-08-25 21:53:16 | INFO | fairseq_cli.train | done training in 35991.8 seconds
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
    raise EOFError
EOFError
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1728 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
