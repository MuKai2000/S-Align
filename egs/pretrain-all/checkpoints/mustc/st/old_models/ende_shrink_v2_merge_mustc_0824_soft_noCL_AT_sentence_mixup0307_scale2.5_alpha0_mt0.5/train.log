2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:18103
2023-08-24 02:14:18 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-24 02:14:18 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-24 02:14:19 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-24 02:14:22 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:18103', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 15000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 15000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=0.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_ende_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/ende-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=0.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_ende_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/ende-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=0.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_ende_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/ende-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-24 02:14:22 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 10,000
2023-08-24 02:14:22 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 10,000
2023-08-24 02:14:22 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-24 02:14:22 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-24 02:14:22 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_ende_baseline
2023-08-24 02:14:27 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-24 02:14:27 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_ende_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-24 02:14:27 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-24 02:14:29 | INFO | root | load pretrained hubert
2023-08-24 02:14:37 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_ende_baseline
2023-08-24 02:14:43 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/ende-baseline/last8.ensemble.pt
2023-08-24 02:14:49 | INFO | root | load pretrained decoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/ende-baseline/last8.ensemble.pt
2023-08-24 02:14:49 | INFO | root | share the sematic adapter and textual encoder
2023-08-24 02:14:49 | INFO | fairseq_cli.train | S2TJoint(
  (acoustic_encoder): AcousticEncoder(
    (compress_ffn): Linear(in_features=768, out_features=512, bias=True)
    (proj): Linear(in_features=512, out_features=10000, bias=False)
    (w2v_model): HubertModel(
      (feature_extractor): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Fp32GroupNorm(512, 512, eps=1e-05, affine=True)
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
        )
      )
      (post_extract_proj): Linear(in_features=512, out_features=768, bias=True)
      (dropout_input): Dropout(p=0.0, inplace=False)
      (dropout_features): Dropout(p=0.1, inplace=False)
      (encoder): TransformerEncoder(
        (pos_conv): Sequential(
          (0): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
          (1): SamePad()
          (2): GELU(approximate='none')
        )
        (layers): ModuleList(
          (0-11): 12 x TransformerSentenceEncoderLayer(
            (self_attn): MultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
            (dropout3): Dropout(p=0.1, inplace=False)
            (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
          )
        )
        (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      (final_proj): None
    )
    (noad): NormalAdapter(
      (subsample): Conv1dSubsampler(
        (conv_layers): ModuleList(
          (0): Conv1d(512, 512, kernel_size=(5,), stride=(2,), padding=(2,))
          (1): Conv1d(256, 1024, kernel_size=(5,), stride=(2,), padding=(2,))
        )
      )
      (layers): ModuleList()
    )
    (sead): SemanticAdapter(
      (embed_positions): SinusoidalPositionalEmbedding()
      (layers): ModuleList(
        (0-5): 6 x TransformerEncoderLayerBase(
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (fc1): Linear(in_features=512, out_features=1024, bias=True)
          (fc2): Linear(in_features=1024, out_features=512, bias=True)
          (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        )
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    )
    (final_dropout): Dropout(p=0.1, inplace=False)
    (shrink_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (textual_encoder): MTModelEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(10000, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayerBase(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoderScriptable(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(10000, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=512, out_features=10000, bias=False)
  )
  (task_net): TaskNetwork(
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (down_proj): Linear(in_features=512, out_features=256, bias=True)
    (up_proj): Linear(in_features=256, out_features=512, bias=True)
    (dropout_module): FairseqDropout()
    (task_proj): Linear(in_features=512, out_features=1, bias=False)
  )
)
2023-08-24 02:14:49 | INFO | fairseq_cli.train | task: JointTriplePretrainingMergeTask
2023-08-24 02:14:49 | INFO | fairseq_cli.train | model: S2TJoint
2023-08-24 02:14:49 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropywithW2vCtcShrinkJointATMerge
2023-08-24 02:14:49 | INFO | fairseq_cli.train | num. shared model params: 134,449,280 (num. trained: 134,449,280)
2023-08-24 02:14:49 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2023-08-24 02:14:49 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-24 02:14:49 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_ende_lcrm/sentencepiece.bpe.model'}
2023-08-24 02:14:49 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_ende_lcrm/sentencepiece.bpe.model'}
2023-08-24 02:14:49 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="dev_st", n_samples=1418, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-24 02:15:05 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:2 to store for rank: 0
2023-08-24 02:15:05 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- textual_encoder.embed_tokens.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.embed_tokens.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.output_projection.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.0.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.1.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.2.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.3.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.4.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.5.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.6.0.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- decoder.output_projection.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- task_net.task_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.weight <- textual_encoder.layers.0.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.bias <- textual_encoder.layers.0.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.weight <- textual_encoder.layers.0.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.bias <- textual_encoder.layers.0.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.weight <- textual_encoder.layers.0.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.bias <- textual_encoder.layers.0.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.weight <- textual_encoder.layers.0.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.bias <- textual_encoder.layers.0.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.weight <- textual_encoder.layers.0.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.bias <- textual_encoder.layers.0.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.weight <- textual_encoder.layers.0.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.bias <- textual_encoder.layers.0.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.weight <- textual_encoder.layers.0.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.bias <- textual_encoder.layers.0.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.weight <- textual_encoder.layers.0.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.bias <- textual_encoder.layers.0.final_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.weight <- textual_encoder.layers.1.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.bias <- textual_encoder.layers.1.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.weight <- textual_encoder.layers.1.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.bias <- textual_encoder.layers.1.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.weight <- textual_encoder.layers.1.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.bias <- textual_encoder.layers.1.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.weight <- textual_encoder.layers.1.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.bias <- textual_encoder.layers.1.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.weight <- textual_encoder.layers.1.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.bias <- textual_encoder.layers.1.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.weight <- textual_encoder.layers.1.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.bias <- textual_encoder.layers.1.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.weight <- textual_encoder.layers.1.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.bias <- textual_encoder.layers.1.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.weight <- textual_encoder.layers.1.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.bias <- textual_encoder.layers.1.final_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.weight <- textual_encoder.layers.2.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.bias <- textual_encoder.layers.2.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.weight <- textual_encoder.layers.2.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.bias <- textual_encoder.layers.2.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.weight <- textual_encoder.layers.2.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.bias <- textual_encoder.layers.2.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.weight <- textual_encoder.layers.2.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.bias <- textual_encoder.layers.2.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.weight <- textual_encoder.layers.2.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.bias <- textual_encoder.layers.2.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.weight <- textual_encoder.layers.2.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.bias <- textual_encoder.layers.2.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.weight <- textual_encoder.layers.2.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.bias <- textual_encoder.layers.2.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.weight <- textual_encoder.layers.2.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.bias <- textual_encoder.layers.2.final_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.weight <- textual_encoder.layers.3.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.bias <- textual_encoder.layers.3.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.weight <- textual_encoder.layers.3.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.bias <- textual_encoder.layers.3.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.weight <- textual_encoder.layers.3.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.bias <- textual_encoder.layers.3.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.weight <- textual_encoder.layers.3.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.bias <- textual_encoder.layers.3.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.weight <- textual_encoder.layers.3.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.bias <- textual_encoder.layers.3.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.weight <- textual_encoder.layers.3.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.bias <- textual_encoder.layers.3.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.weight <- textual_encoder.layers.3.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.bias <- textual_encoder.layers.3.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.weight <- textual_encoder.layers.3.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.bias <- textual_encoder.layers.3.final_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.weight <- textual_encoder.layers.4.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.bias <- textual_encoder.layers.4.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.weight <- textual_encoder.layers.4.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.bias <- textual_encoder.layers.4.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.weight <- textual_encoder.layers.4.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.bias <- textual_encoder.layers.4.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.weight <- textual_encoder.layers.4.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.bias <- textual_encoder.layers.4.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.weight <- textual_encoder.layers.4.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.bias <- textual_encoder.layers.4.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.weight <- textual_encoder.layers.4.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.bias <- textual_encoder.layers.4.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.weight <- textual_encoder.layers.4.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.bias <- textual_encoder.layers.4.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.weight <- textual_encoder.layers.4.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.bias <- textual_encoder.layers.4.final_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.weight <- textual_encoder.layers.5.self_attn.k_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.bias <- textual_encoder.layers.5.self_attn.k_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.weight <- textual_encoder.layers.5.self_attn.v_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.bias <- textual_encoder.layers.5.self_attn.v_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.weight <- textual_encoder.layers.5.self_attn.q_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.bias <- textual_encoder.layers.5.self_attn.q_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.weight <- textual_encoder.layers.5.self_attn.out_proj.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.bias <- textual_encoder.layers.5.self_attn.out_proj.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.weight <- textual_encoder.layers.5.self_attn_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.bias <- textual_encoder.layers.5.self_attn_layer_norm.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.weight <- textual_encoder.layers.5.fc1.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.bias <- textual_encoder.layers.5.fc1.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.weight <- textual_encoder.layers.5.fc2.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.bias <- textual_encoder.layers.5.fc2.bias
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.weight <- textual_encoder.layers.5.final_layer_norm.weight
2023-08-24 02:15:05 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.bias <- textual_encoder.layers.5.final_layer_norm.bias
2023-08-24 02:15:06 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   1: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   2: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   3: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   4: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   5: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   6: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | rank   7: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-24 02:15:06 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-24 02:15:06 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)
2023-08-24 02:15:06 | INFO | fairseq_cli.train | max tokens per device = 15000 and max sentences per device = None
2023-08-24 02:15:06 | INFO | fairseq.trainer | Preparing to load checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 02:15:06 | INFO | fairseq.trainer | No existing checkpoint found ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 02:15:06 | INFO | fairseq.trainer | loading train data for epoch 1
2023-08-24 02:15:06 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-24 02:15:06 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_ende_lcrm/sentencepiece.bpe.model'}
2023-08-24 02:15:06 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_ende_lcrm/sentencepiece.bpe.model'}
2023-08-24 02:15:07 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_asr", n_samples=225277, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-24 02:15:09 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_st", n_samples=225277, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-24 02:15:50 | INFO | fairseq.optim.adam | using FusedAdam
2023-08-24 02:15:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 02:15:50 | INFO | fairseq.trainer | begin training epoch 1
2023-08-24 02:15:50 | INFO | fairseq_cli.train | Start iterating over samples
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
2023-08-24 02:16:59 | INFO | train_inner | epoch 001:    100 / 1474 loss=17.34, trans_loss=5.619, nll_loss=4.189, w2v_ctc_loss=22.483, task_loss=4.162, contrastive_loss=0, total=4207.04, n_correct=204.94, ppl=18.24, accuracy=4.871, wps=21677.7, ups=1.72, wpb=12551.1, bsz=471.4, num_updates=100, lr=4.098e-06, gnorm=0.856, clip=0, loss_scale=128, train_wall=61, gb_free=19.4, wall=113
2023-08-24 02:17:48 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-24 02:17:57 | INFO | train_inner | epoch 001:    201 / 1474 loss=15.246, trans_loss=5.584, nll_loss=4.199, w2v_ctc_loss=19.282, task_loss=4.036, contrastive_loss=0, total=4121.36, n_correct=205.85, ppl=18.37, accuracy=4.995, wps=21238.7, ups=1.73, wpb=12305.5, bsz=461.4, num_updates=200, lr=8.096e-06, gnorm=3.682, clip=0, loss_scale=64, train_wall=57, gb_free=19.2, wall=171
2023-08-24 02:18:56 | INFO | train_inner | epoch 001:    301 / 1474 loss=8.396, trans_loss=5.576, nll_loss=4.242, w2v_ctc_loss=8.737, task_loss=4.013, contrastive_loss=0, total=4079.62, n_correct=200.17, ppl=18.92, accuracy=4.907, wps=20719.8, ups=1.7, wpb=12186.7, bsz=438.2, num_updates=300, lr=1.2094e-05, gnorm=4.573, clip=0, loss_scale=64, train_wall=58, gb_free=19.9, wall=230
2023-08-24 02:19:54 | INFO | train_inner | epoch 001:    401 / 1474 loss=7.121, trans_loss=5.561, nll_loss=4.247, w2v_ctc_loss=6.796, task_loss=3.535, contrastive_loss=0, total=4174.14, n_correct=184.85, ppl=18.99, accuracy=4.428, wps=21514.4, ups=1.73, wpb=12463.5, bsz=460.4, num_updates=400, lr=1.6092e-05, gnorm=2.926, clip=0, loss_scale=64, train_wall=57, gb_free=18.9, wall=288
2023-08-24 02:20:51 | INFO | train_inner | epoch 001:    501 / 1474 loss=6.671, trans_loss=5.506, nll_loss=4.197, w2v_ctc_loss=6.159, task_loss=3.275, contrastive_loss=0, total=4176.18, n_correct=193.71, ppl=18.34, accuracy=4.638, wps=21840, ups=1.75, wpb=12479.7, bsz=477.4, num_updates=500, lr=2.009e-05, gnorm=1.386, clip=0, loss_scale=64, train_wall=56, gb_free=19.2, wall=345
2023-08-24 02:21:49 | INFO | train_inner | epoch 001:    601 / 1474 loss=6.427, trans_loss=5.511, nll_loss=4.214, w2v_ctc_loss=5.782, task_loss=3.059, contrastive_loss=0, total=4147.79, n_correct=199.58, ppl=18.55, accuracy=4.812, wps=21531.2, ups=1.74, wpb=12371.6, bsz=484.2, num_updates=600, lr=2.4088e-05, gnorm=0.647, clip=0, loss_scale=64, train_wall=57, gb_free=18.9, wall=403
2023-08-24 02:22:46 | INFO | train_inner | epoch 001:    701 / 1474 loss=6.354, trans_loss=5.534, nll_loss=4.254, w2v_ctc_loss=5.641, task_loss=3.154, contrastive_loss=0, total=4152.1, n_correct=205.12, ppl=19.08, accuracy=4.94, wps=21590.5, ups=1.74, wpb=12395.5, bsz=456.2, num_updates=700, lr=2.8086e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=57, gb_free=19.5, wall=460
2023-08-24 02:23:43 | INFO | train_inner | epoch 001:    801 / 1474 loss=6.178, trans_loss=5.553, nll_loss=4.281, w2v_ctc_loss=5.349, task_loss=3.047, contrastive_loss=0, total=4123.83, n_correct=205.36, ppl=19.45, accuracy=4.98, wps=21589.2, ups=1.75, wpb=12306.1, bsz=464.1, num_updates=800, lr=3.2084e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=56, gb_free=19.1, wall=517
2023-08-24 02:24:41 | INFO | train_inner | epoch 001:    901 / 1474 loss=5.981, trans_loss=5.56, nll_loss=4.297, w2v_ctc_loss=5.038, task_loss=3.097, contrastive_loss=0, total=4163.61, n_correct=204.65, ppl=19.66, accuracy=4.915, wps=21402.1, ups=1.72, wpb=12433.9, bsz=457.1, num_updates=900, lr=3.6082e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=57, gb_free=18.8, wall=575
2023-08-24 02:25:39 | INFO | train_inner | epoch 001:   1001 / 1474 loss=5.755, trans_loss=5.563, nll_loss=4.302, w2v_ctc_loss=4.685, task_loss=3.119, contrastive_loss=0, total=4135.34, n_correct=208.3, ppl=19.72, accuracy=5.037, wps=21503.2, ups=1.74, wpb=12353.2, bsz=456.8, num_updates=1000, lr=4.008e-05, gnorm=0.542, clip=0, loss_scale=64, train_wall=57, gb_free=19, wall=633
2023-08-24 02:26:36 | INFO | train_inner | epoch 001:   1101 / 1474 loss=5.554, trans_loss=5.561, nll_loss=4.295, w2v_ctc_loss=4.383, task_loss=3.148, contrastive_loss=0, total=4147.38, n_correct=219.66, ppl=19.63, accuracy=5.296, wps=21711.4, ups=1.76, wpb=12367, bsz=454.9, num_updates=1100, lr=4.4078e-05, gnorm=0.583, clip=0, loss_scale=64, train_wall=56, gb_free=18.8, wall=690
2023-08-24 02:26:54 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 02:27:33 | INFO | train_inner | epoch 001:   1202 / 1474 loss=5.411, trans_loss=5.559, nll_loss=4.294, w2v_ctc_loss=4.158, task_loss=3.354, contrastive_loss=0, total=4119.73, n_correct=228.79, ppl=19.62, accuracy=5.554, wps=21353.5, ups=1.74, wpb=12305.9, bsz=431.8, num_updates=1200, lr=4.8076e-05, gnorm=0.668, clip=0, loss_scale=32, train_wall=57, gb_free=19.6, wall=748
2023-08-24 02:28:30 | INFO | train_inner | epoch 001:   1302 / 1474 loss=5.262, trans_loss=5.555, nll_loss=4.288, w2v_ctc_loss=3.939, task_loss=3.128, contrastive_loss=0, total=4055.44, n_correct=226.33, ppl=19.53, accuracy=5.581, wps=21318.2, ups=1.76, wpb=12107.5, bsz=442.9, num_updates=1300, lr=5.2074e-05, gnorm=0.681, clip=0, loss_scale=32, train_wall=56, gb_free=19.3, wall=804
2023-08-24 02:29:27 | INFO | train_inner | epoch 001:   1402 / 1474 loss=5.129, trans_loss=5.536, nll_loss=4.266, w2v_ctc_loss=3.754, task_loss=3.152, contrastive_loss=0, total=4125.61, n_correct=239.92, ppl=19.24, accuracy=5.815, wps=21541.2, ups=1.75, wpb=12328.1, bsz=452, num_updates=1400, lr=5.6072e-05, gnorm=0.759, clip=0, loss_scale=32, train_wall=57, gb_free=18.8, wall=862
2023-08-24 02:30:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2023-08-24 02:30:56 | INFO | dev_st | epoch 001 | valid on 'dev_st' subset | loss 9.321 | trans_loss 11.67 | nll_loss 10.779 | w2v_ctc_loss 4.77 | task_loss 18.863 | contrastive_loss 0 | total 4003.4 | n_correct 274.7 | ppl 1756.89 | accuracy 6.862 | uer 62.605 | wer 60.855 | raw_wer 60.855 | bleu 0 | wps 1043.1 | wpb 4003.4 | bsz 141.8 | num_updates 1472
2023-08-24 02:30:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 1472 updates
2023-08-24 02:30:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 02:30:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 02:31:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 1 @ 1472 updates, score 0.0) (writing took 4.5339794820174575 seconds)
2023-08-24 02:31:01 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-08-24 02:31:01 | INFO | train | epoch 001 | loss 7.514 | trans_loss 5.555 | nll_loss 4.255 | w2v_ctc_loss 7.408 | task_loss 3.359 | contrastive_loss 0 | total 4137.26 | n_correct 210.751 | ppl 19.09 | accuracy 5.094 | wps 20211.3 | ups 1.64 | wpb 12351.7 | bsz 458 | num_updates 1472 | lr 5.89506e-05 | gnorm 1.316 | clip 0 | loss_scale 32 | train_wall 842 | gb_free 19.2 | wall 955
2023-08-24 02:31:01 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 02:31:01 | INFO | fairseq.trainer | begin training epoch 2
2023-08-24 02:31:01 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 02:31:25 | INFO | train_inner | epoch 002:     28 / 1474 loss=5.016, trans_loss=5.534, nll_loss=4.256, w2v_ctc_loss=3.585, task_loss=2.96, contrastive_loss=0, total=4164.65, n_correct=243.81, ppl=19.1, accuracy=5.854, wps=10580.9, ups=0.85, wpb=12421.6, bsz=471.6, num_updates=1500, lr=6.007e-05, gnorm=0.876, clip=0, loss_scale=32, train_wall=57, gb_free=18.9, wall=979
2023-08-24 02:32:22 | INFO | train_inner | epoch 002:    128 / 1474 loss=4.949, trans_loss=5.529, nll_loss=4.248, w2v_ctc_loss=3.482, task_loss=3.191, contrastive_loss=0, total=4153.14, n_correct=240.18, ppl=19, accuracy=5.783, wps=21706.6, ups=1.75, wpb=12386.1, bsz=450.6, num_updates=1600, lr=6.4068e-05, gnorm=0.868, clip=0, loss_scale=32, train_wall=56, gb_free=19.8, wall=1036
2023-08-24 02:33:18 | INFO | train_inner | epoch 002:    228 / 1474 loss=4.825, trans_loss=5.502, nll_loss=4.218, w2v_ctc_loss=3.324, task_loss=2.717, contrastive_loss=0, total=4192.9, n_correct=240.8, ppl=18.61, accuracy=5.743, wps=22092.7, ups=1.76, wpb=12523.7, bsz=493, num_updates=1700, lr=6.8066e-05, gnorm=0.794, clip=0, loss_scale=32, train_wall=56, gb_free=19.2, wall=1093
2023-08-24 02:34:16 | INFO | train_inner | epoch 002:    328 / 1474 loss=4.791, trans_loss=5.505, nll_loss=4.22, w2v_ctc_loss=3.261, task_loss=3.208, contrastive_loss=0, total=4132.45, n_correct=239.96, ppl=18.64, accuracy=5.807, wps=21596.6, ups=1.75, wpb=12335.7, bsz=443.2, num_updates=1800, lr=7.2064e-05, gnorm=0.858, clip=0, loss_scale=32, train_wall=56, gb_free=19.4, wall=1150
2023-08-24 02:35:12 | INFO | train_inner | epoch 002:    428 / 1474 loss=4.738, trans_loss=5.495, nll_loss=4.209, w2v_ctc_loss=3.191, task_loss=3.471, contrastive_loss=0, total=4037.61, n_correct=235.27, ppl=18.49, accuracy=5.827, wps=21273.3, ups=1.76, wpb=12068.2, bsz=415.8, num_updates=1900, lr=7.6062e-05, gnorm=0.747, clip=0, loss_scale=32, train_wall=56, gb_free=19.9, wall=1207
2023-08-24 02:36:09 | INFO | train_inner | epoch 002:    528 / 1474 loss=4.643, trans_loss=5.48, nll_loss=4.187, w2v_ctc_loss=3.066, task_loss=3.008, contrastive_loss=0, total=4183.4, n_correct=239.87, ppl=18.21, accuracy=5.734, wps=21877.6, ups=1.75, wpb=12481.5, bsz=470.3, num_updates=2000, lr=8.006e-05, gnorm=0.747, clip=0, loss_scale=32, train_wall=56, gb_free=19, wall=1264
2023-08-24 02:36:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 02:36:56 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 8.96 | trans_loss 11.49 | nll_loss 10.529 | w2v_ctc_loss 3.974 | task_loss 18.863 | contrastive_loss 0 | total 4003.4 | n_correct 268.1 | ppl 1477.34 | accuracy 6.697 | uer 55.326 | wer 53.988 | raw_wer 53.988 | bleu 0 | wps 1042.6 | wpb 4003.4 | bsz 141.8 | num_updates 2000 | best_bleu 0
2023-08-24 02:36:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2000 updates
2023-08-24 02:36:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_2_2000.pt
2023-08-24 02:36:58 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_2_2000.pt
2023-08-24 02:37:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.0) (writing took 13.134084079996683 seconds)
2023-08-24 02:38:07 | INFO | train_inner | epoch 002:    628 / 1474 loss=4.595, trans_loss=5.481, nll_loss=4.187, w2v_ctc_loss=2.993, task_loss=3.11, contrastive_loss=0, total=4126.46, n_correct=238.46, ppl=18.22, accuracy=5.779, wps=10467.1, ups=0.85, wpb=12316, bsz=446.7, num_updates=2100, lr=8.4058e-05, gnorm=0.865, clip=0, loss_scale=32, train_wall=57, gb_free=19.3, wall=1381
2023-08-24 02:39:04 | INFO | train_inner | epoch 002:    728 / 1474 loss=4.545, trans_loss=5.458, nll_loss=4.16, w2v_ctc_loss=2.943, task_loss=3.084, contrastive_loss=0, total=4148.66, n_correct=242.73, ppl=17.88, accuracy=5.851, wps=21789, ups=1.76, wpb=12384.1, bsz=462.9, num_updates=2200, lr=8.8056e-05, gnorm=0.764, clip=0, loss_scale=32, train_wall=56, gb_free=19.7, wall=1438
2023-08-24 02:40:01 | INFO | train_inner | epoch 002:    828 / 1474 loss=4.512, trans_loss=5.451, nll_loss=4.155, w2v_ctc_loss=2.898, task_loss=3.161, contrastive_loss=0, total=4164.61, n_correct=244.55, ppl=17.81, accuracy=5.872, wps=21763.6, ups=1.75, wpb=12439.5, bsz=459.2, num_updates=2300, lr=9.2054e-05, gnorm=0.653, clip=0, loss_scale=32, train_wall=57, gb_free=19.5, wall=1495
2023-08-24 02:40:58 | INFO | train_inner | epoch 002:    928 / 1474 loss=4.477, trans_loss=5.466, nll_loss=4.172, w2v_ctc_loss=2.829, task_loss=3.183, contrastive_loss=0, total=4109.63, n_correct=242.8, ppl=18.03, accuracy=5.908, wps=21685.3, ups=1.77, wpb=12270.1, bsz=447.9, num_updates=2400, lr=9.6052e-05, gnorm=0.745, clip=0, loss_scale=32, train_wall=56, gb_free=18.9, wall=1552
2023-08-24 02:41:55 | INFO | train_inner | epoch 002:   1028 / 1474 loss=4.444, trans_loss=5.462, nll_loss=4.169, w2v_ctc_loss=2.783, task_loss=3.146, contrastive_loss=0, total=4101.19, n_correct=241.5, ppl=17.99, accuracy=5.889, wps=21449.7, ups=1.75, wpb=12245.2, bsz=454.5, num_updates=2500, lr=0.00010005, gnorm=0.646, clip=0, loss_scale=32, train_wall=56, gb_free=19, wall=1609
2023-08-24 02:42:53 | INFO | train_inner | epoch 002:   1128 / 1474 loss=4.406, trans_loss=5.476, nll_loss=4.186, w2v_ctc_loss=2.718, task_loss=2.81, contrastive_loss=0, total=4192.73, n_correct=239.83, ppl=18.2, accuracy=5.72, wps=21650.6, ups=1.73, wpb=12513.6, bsz=488.9, num_updates=2600, lr=0.000104048, gnorm=0.608, clip=0, loss_scale=32, train_wall=57, gb_free=18.9, wall=1667
2023-08-24 02:43:50 | INFO | train_inner | epoch 002:   1228 / 1474 loss=4.375, trans_loss=5.456, nll_loss=4.16, w2v_ctc_loss=2.691, task_loss=2.859, contrastive_loss=0, total=4219.96, n_correct=249.96, ppl=17.88, accuracy=5.923, wps=22039.7, ups=1.75, wpb=12591.9, bsz=491.8, num_updates=2700, lr=0.000108046, gnorm=0.567, clip=0, loss_scale=32, train_wall=57, gb_free=18.9, wall=1724
2023-08-24 02:44:46 | INFO | train_inner | epoch 002:   1328 / 1474 loss=4.366, trans_loss=5.464, nll_loss=4.172, w2v_ctc_loss=2.665, task_loss=2.988, contrastive_loss=0, total=4163.26, n_correct=244.93, ppl=18.02, accuracy=5.883, wps=21942, ups=1.76, wpb=12441.6, bsz=463, num_updates=2800, lr=0.000112044, gnorm=0.523, clip=0, loss_scale=32, train_wall=56, gb_free=19, wall=1781
2023-08-24 02:45:43 | INFO | train_inner | epoch 002:   1428 / 1474 loss=4.344, trans_loss=5.452, nll_loss=4.157, w2v_ctc_loss=2.646, task_loss=3.386, contrastive_loss=0, total=4049.42, n_correct=238.38, ppl=17.84, accuracy=5.887, wps=21316.5, ups=1.76, wpb=12091.6, bsz=437.6, num_updates=2900, lr=0.000116042, gnorm=0.664, clip=0, loss_scale=32, train_wall=56, gb_free=19.2, wall=1837
2023-08-24 02:46:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 02:46:56 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 8.606 | trans_loss 11.217 | nll_loss 10.201 | w2v_ctc_loss 3.408 | task_loss 18.863 | contrastive_loss 0 | total 4003.4 | n_correct 281.2 | ppl 1176.71 | accuracy 7.024 | uer 49.372 | wer 47.884 | raw_wer 47.884 | bleu 0.01 | wps 1045.7 | wpb 4003.4 | bsz 141.8 | num_updates 2946 | best_bleu 0.01
2023-08-24 02:46:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2946 updates
2023-08-24 02:46:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 02:47:03 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 02:47:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 2 @ 2946 updates, score 0.01) (writing took 13.694104020949453 seconds)
2023-08-24 02:47:09 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-08-24 02:47:09 | INFO | train | epoch 002 | loss 4.573 | trans_loss 5.478 | nll_loss 4.187 | w2v_ctc_loss 2.964 | task_loss 3.084 | contrastive_loss 0 | total 4138.65 | n_correct 241.246 | ppl 18.21 | accuracy 5.829 | wps 18800 | ups 1.52 | wpb 12355.8 | bsz 458.5 | num_updates 2946 | lr 0.000117881 | gnorm 0.715 | clip 0 | loss_scale 32 | train_wall 830 | gb_free 19.3 | wall 1924
2023-08-24 02:47:10 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 02:47:10 | INFO | fairseq.trainer | begin training epoch 3
2023-08-24 02:47:10 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 02:47:47 | INFO | train_inner | epoch 003:     54 / 1474 loss=4.316, trans_loss=5.452, nll_loss=4.155, w2v_ctc_loss=2.594, task_loss=3.172, contrastive_loss=0, total=4067, n_correct=242.88, ppl=17.82, accuracy=5.972, wps=9766, ups=0.8, wpb=12142, bsz=441.4, num_updates=3000, lr=0.00012004, gnorm=0.585, clip=0, loss_scale=32, train_wall=56, gb_free=19.2, wall=1962
2023-08-24 02:47:48 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-24 02:48:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-24 02:49:14 | INFO | train_inner | epoch 003:    156 / 1474 loss=3.364, trans_loss=4.367, nll_loss=2.783, w2v_ctc_loss=2.276, task_loss=2.245, contrastive_loss=0, total=4114.98, n_correct=1070.64, ppl=6.88, accuracy=26.018, wps=14268.7, ups=1.16, wpb=12285.9, bsz=445.6, num_updates=3100, lr=0.000124038, gnorm=1.225, clip=0, loss_scale=8, train_wall=85, gb_free=16.2, wall=2048
2023-08-24 02:50:39 | INFO | train_inner | epoch 003:    256 / 1474 loss=3.061, trans_loss=4.176, nll_loss=2.534, w2v_ctc_loss=2.012, task_loss=2.164, contrastive_loss=0, total=4148.62, n_correct=1322.65, ppl=5.79, accuracy=31.882, wps=14458.5, ups=1.17, wpb=12396.7, bsz=463.7, num_updates=3200, lr=0.000128036, gnorm=0.872, clip=0, loss_scale=8, train_wall=85, gb_free=16.4, wall=2134
2023-08-24 02:52:04 | INFO | train_inner | epoch 003:    356 / 1474 loss=2.93, trans_loss=4.078, nll_loss=2.4, w2v_ctc_loss=1.922, task_loss=2.121, contrastive_loss=0, total=4171.73, n_correct=1495.58, ppl=5.28, accuracy=35.85, wps=14785, ups=1.19, wpb=12449.7, bsz=468.2, num_updates=3300, lr=0.000132034, gnorm=0.93, clip=0, loss_scale=8, train_wall=84, gb_free=15.3, wall=2218
2023-08-24 02:53:28 | INFO | train_inner | epoch 003:    456 / 1474 loss=2.831, trans_loss=3.997, nll_loss=2.293, w2v_ctc_loss=1.853, task_loss=2.1, contrastive_loss=0, total=4197.48, n_correct=1643.29, ppl=4.9, accuracy=39.149, wps=14831, ups=1.18, wpb=12527.9, bsz=474.4, num_updates=3400, lr=0.000136032, gnorm=0.865, clip=0, loss_scale=8, train_wall=84, gb_free=12.2, wall=2302
2023-08-24 02:54:52 | INFO | train_inner | epoch 003:    556 / 1474 loss=2.751, trans_loss=3.953, nll_loss=2.236, w2v_ctc_loss=1.783, task_loss=2.29, contrastive_loss=0, total=4095.16, n_correct=1677.18, ppl=4.71, accuracy=40.955, wps=14566.3, ups=1.19, wpb=12233.8, bsz=440.6, num_updates=3500, lr=0.00014003, gnorm=0.843, clip=0, loss_scale=8, train_wall=83, gb_free=15.7, wall=2386
2023-08-24 02:56:18 | INFO | train_inner | epoch 003:    656 / 1474 loss=2.676, trans_loss=3.906, nll_loss=2.169, w2v_ctc_loss=1.721, task_loss=2.048, contrastive_loss=0, total=4223.37, n_correct=1816.19, ppl=4.5, accuracy=43.003, wps=14689.6, ups=1.17, wpb=12593.2, bsz=484, num_updates=3600, lr=0.000144028, gnorm=0.804, clip=0, loss_scale=8, train_wall=85, gb_free=16.4, wall=2472
2023-08-24 02:57:42 | INFO | train_inner | epoch 003:    756 / 1474 loss=2.641, trans_loss=3.872, nll_loss=2.129, w2v_ctc_loss=1.701, task_loss=2.073, contrastive_loss=0, total=4165.36, n_correct=1839.27, ppl=4.37, accuracy=44.156, wps=14747.9, ups=1.19, wpb=12442.1, bsz=470.9, num_updates=3700, lr=0.000148026, gnorm=0.825, clip=0, loss_scale=8, train_wall=84, gb_free=15, wall=2556
2023-08-24 02:59:06 | INFO | train_inner | epoch 003:    856 / 1474 loss=2.599, trans_loss=3.858, nll_loss=2.109, w2v_ctc_loss=1.657, task_loss=2.159, contrastive_loss=0, total=4164.94, n_correct=1874.16, ppl=4.31, accuracy=44.998, wps=14861.4, ups=1.2, wpb=12434.8, bsz=457.9, num_updates=3800, lr=0.000152024, gnorm=0.793, clip=0, loss_scale=8, train_wall=83, gb_free=14.9, wall=2640
2023-08-24 03:00:31 | INFO | train_inner | epoch 003:    956 / 1474 loss=2.571, trans_loss=3.835, nll_loss=2.077, w2v_ctc_loss=1.638, task_loss=2.122, contrastive_loss=0, total=4156.71, n_correct=1917.69, ppl=4.22, accuracy=46.135, wps=14613.1, ups=1.18, wpb=12401.4, bsz=465.4, num_updates=3900, lr=0.000156022, gnorm=0.797, clip=0, loss_scale=8, train_wall=84, gb_free=16.9, wall=2725
2023-08-24 03:01:55 | INFO | train_inner | epoch 003:   1056 / 1474 loss=2.559, trans_loss=3.819, nll_loss=2.059, w2v_ctc_loss=1.629, task_loss=2.331, contrastive_loss=0, total=4063.38, n_correct=1892.55, ppl=4.17, accuracy=46.576, wps=14439.5, ups=1.19, wpb=12134.6, bsz=439.1, num_updates=4000, lr=0.00016002, gnorm=0.809, clip=0, loss_scale=8, train_wall=83, gb_free=17.4, wall=2809
2023-08-24 03:01:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 03:02:30 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 4.806 | trans_loss 6.269 | nll_loss 3.769 | w2v_ctc_loss 1.893 | task_loss 10.859 | contrastive_loss 0 | total 4003.4 | n_correct 2048.6 | ppl 13.63 | accuracy 51.172 | uer 28.609 | wer 29.402 | raw_wer 29.402 | bleu 12.23 | wps 1468.7 | wpb 4003.4 | bsz 141.8 | num_updates 4000 | best_bleu 12.23
2023-08-24 03:02:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 4000 updates
2023-08-24 03:02:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_3_4000.pt
2023-08-24 03:02:32 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_3_4000.pt
2023-08-24 03:02:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_3_4000.pt (epoch 3 @ 4000 updates, score 12.23) (writing took 13.89308838301804 seconds)
2023-08-24 03:04:07 | INFO | train_inner | epoch 003:   1156 / 1474 loss=2.522, trans_loss=3.81, nll_loss=2.044, w2v_ctc_loss=1.591, task_loss=2.312, contrastive_loss=0, total=4049.57, n_correct=1910.5, ppl=4.12, accuracy=47.178, wps=9124.2, ups=0.76, wpb=12084.5, bsz=438, num_updates=4100, lr=0.000164018, gnorm=0.784, clip=0, loss_scale=8, train_wall=83, gb_free=16.7, wall=2941
2023-08-24 03:05:31 | INFO | train_inner | epoch 003:   1256 / 1474 loss=2.492, trans_loss=3.792, nll_loss=2.023, w2v_ctc_loss=1.564, task_loss=2.294, contrastive_loss=0, total=4061.36, n_correct=1944.88, ppl=4.06, accuracy=47.887, wps=14529.2, ups=1.2, wpb=12130, bsz=433.6, num_updates=4200, lr=0.000168016, gnorm=0.771, clip=0, loss_scale=8, train_wall=83, gb_free=16.3, wall=3025
2023-08-24 03:06:55 | INFO | train_inner | epoch 003:   1356 / 1474 loss=2.458, trans_loss=3.773, nll_loss=1.999, w2v_ctc_loss=1.53, task_loss=2.164, contrastive_loss=0, total=4141.12, n_correct=2011.07, ppl=4, accuracy=48.563, wps=14657.7, ups=1.19, wpb=12364.3, bsz=463.2, num_updates=4300, lr=0.000172014, gnorm=0.771, clip=0, loss_scale=8, train_wall=84, gb_free=14.7, wall=3109
2023-08-24 03:08:19 | INFO | train_inner | epoch 003:   1456 / 1474 loss=2.441, trans_loss=3.767, nll_loss=1.992, w2v_ctc_loss=1.517, task_loss=2.062, contrastive_loss=0, total=4211.06, n_correct=2059.7, ppl=3.98, accuracy=48.912, wps=14890.9, ups=1.18, wpb=12576.2, bsz=477.6, num_updates=4400, lr=0.000176012, gnorm=0.769, clip=0, loss_scale=8, train_wall=84, gb_free=17.2, wall=3194
2023-08-24 03:08:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 03:09:08 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 4.659 | trans_loss 6.13 | nll_loss 3.583 | w2v_ctc_loss 1.716 | task_loss 10.795 | contrastive_loss 0 | total 4003.4 | n_correct 2133 | ppl 11.98 | accuracy 53.28 | uer 27.11 | wer 28.097 | raw_wer 28.097 | bleu 14.58 | wps 1578.3 | wpb 4003.4 | bsz 141.8 | num_updates 4418 | best_bleu 14.58
2023-08-24 03:09:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 4418 updates
2023-08-24 03:09:08 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:09:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:09:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 3 @ 4418 updates, score 14.58) (writing took 10.676908669061959 seconds)
2023-08-24 03:09:18 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-08-24 03:09:18 | INFO | train | epoch 003 | loss 2.762 | trans_loss 3.982 | nll_loss 2.272 | w2v_ctc_loss 1.77 | task_loss 2.211 | contrastive_loss 0 | total 4137.67 | n_correct 1695.41 | ppl 4.83 | accuracy 40.975 | wps 13682 | ups 1.11 | wpb 12353 | bsz 458.1 | num_updates 4418 | lr 0.000176732 | gnorm 0.837 | clip 0 | loss_scale 8 | train_wall 1219 | gb_free 16.4 | wall 3253
2023-08-24 03:09:19 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 03:09:19 | INFO | fairseq.trainer | begin training epoch 4
2023-08-24 03:09:19 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 03:10:34 | INFO | train_inner | epoch 004:     82 / 1474 loss=2.396, trans_loss=3.735, nll_loss=1.947, w2v_ctc_loss=1.47, task_loss=2.265, contrastive_loss=0, total=4090.08, n_correct=2041.38, ppl=3.86, accuracy=49.911, wps=9069.9, ups=0.74, wpb=12208.2, bsz=437, num_updates=4500, lr=0.00018001, gnorm=0.759, clip=0, loss_scale=8, train_wall=83, gb_free=16.5, wall=3328
2023-08-24 03:11:57 | INFO | train_inner | epoch 004:    182 / 1474 loss=2.371, trans_loss=3.717, nll_loss=1.924, w2v_ctc_loss=1.451, task_loss=2.075, contrastive_loss=0, total=4179.17, n_correct=2115.35, ppl=3.8, accuracy=50.617, wps=14975.4, ups=1.2, wpb=12477, bsz=468, num_updates=4600, lr=0.000184008, gnorm=0.754, clip=0, loss_scale=8, train_wall=83, gb_free=10.6, wall=3412
2023-08-24 03:13:22 | INFO | train_inner | epoch 004:    282 / 1474 loss=2.37, trans_loss=3.719, nll_loss=1.93, w2v_ctc_loss=1.451, task_loss=2.174, contrastive_loss=0, total=4139.78, n_correct=2092.44, ppl=3.81, accuracy=50.545, wps=14649.1, ups=1.18, wpb=12367.7, bsz=462.4, num_updates=4700, lr=0.000188006, gnorm=0.746, clip=0, loss_scale=8, train_wall=84, gb_free=17, wall=3496
2023-08-24 03:14:46 | INFO | train_inner | epoch 004:    382 / 1474 loss=2.364, trans_loss=3.725, nll_loss=1.932, w2v_ctc_loss=1.439, task_loss=2.261, contrastive_loss=0, total=4132.58, n_correct=2097.73, ppl=3.82, accuracy=50.761, wps=14655.8, ups=1.19, wpb=12328, bsz=443.4, num_updates=4800, lr=0.000192004, gnorm=0.74, clip=0, loss_scale=8, train_wall=84, gb_free=16.1, wall=3580
2023-08-24 03:16:10 | INFO | train_inner | epoch 004:    482 / 1474 loss=2.331, trans_loss=3.705, nll_loss=1.91, w2v_ctc_loss=1.406, task_loss=2.017, contrastive_loss=0, total=4193.12, n_correct=2152.93, ppl=3.76, accuracy=51.344, wps=14903.5, ups=1.19, wpb=12516.7, bsz=487.4, num_updates=4900, lr=0.000196002, gnorm=0.743, clip=0, loss_scale=8, train_wall=83, gb_free=13.5, wall=3664
2023-08-24 03:17:34 | INFO | train_inner | epoch 004:    582 / 1474 loss=2.338, trans_loss=3.705, nll_loss=1.911, w2v_ctc_loss=1.42, task_loss=2.004, contrastive_loss=0, total=4234.09, n_correct=2178.83, ppl=3.76, accuracy=51.459, wps=14994.6, ups=1.19, wpb=12638.3, bsz=495.1, num_updates=5000, lr=0.0002, gnorm=0.73, clip=0, loss_scale=8, train_wall=84, gb_free=16.5, wall=3749
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:0')
2023-08-24 03:19:00 | INFO | train_inner | epoch 004:    682 / 1474 loss=2.317, trans_loss=3.707, nll_loss=1.91, w2v_ctc_loss=1.392, task_loss=2.216, contrastive_loss=0, total=4195.52, n_correct=2169.27, ppl=3.76, accuracy=51.704, wps=14630.2, ups=1.17, wpb=12507.9, bsz=461.1, num_updates=5100, lr=0.00019803, gnorm=0.475, clip=0, loss_scale=16, train_wall=85, gb_free=13.5, wall=3834
2023-08-24 03:20:24 | INFO | train_inner | epoch 004:    782 / 1474 loss=2.327, trans_loss=3.703, nll_loss=1.909, w2v_ctc_loss=1.407, task_loss=2.442, contrastive_loss=0, total=4009.24, n_correct=2076.34, ppl=3.75, accuracy=51.789, wps=14144.6, ups=1.18, wpb=11973.6, bsz=415.7, num_updates=5200, lr=0.000196116, gnorm=0.49, clip=0, loss_scale=16, train_wall=84, gb_free=17, wall=3919
2023-08-24 03:21:48 | INFO | train_inner | epoch 004:    882 / 1474 loss=2.312, trans_loss=3.688, nll_loss=1.89, w2v_ctc_loss=1.4, task_loss=2.173, contrastive_loss=0, total=4191.91, n_correct=2193.24, ppl=3.71, accuracy=52.321, wps=14897, ups=1.19, wpb=12517.7, bsz=467.3, num_updates=5300, lr=0.000194257, gnorm=0.48, clip=0, loss_scale=16, train_wall=83, gb_free=14.8, wall=4003
2023-08-24 03:23:12 | INFO | train_inner | epoch 004:    982 / 1474 loss=2.294, trans_loss=3.682, nll_loss=1.884, w2v_ctc_loss=1.378, task_loss=2.201, contrastive_loss=0, total=4129.3, n_correct=2171.11, ppl=3.69, accuracy=52.578, wps=14714.4, ups=1.19, wpb=12332.9, bsz=458.1, num_updates=5400, lr=0.00019245, gnorm=0.47, clip=0, loss_scale=16, train_wall=83, gb_free=17.8, wall=4087
2023-08-24 03:24:37 | INFO | train_inner | epoch 004:   1082 / 1474 loss=2.304, trans_loss=3.691, nll_loss=1.893, w2v_ctc_loss=1.387, task_loss=2.352, contrastive_loss=0, total=4072.56, n_correct=2136.07, ppl=3.71, accuracy=52.45, wps=14405.9, ups=1.19, wpb=12155.9, bsz=436.5, num_updates=5500, lr=0.000190693, gnorm=0.48, clip=0, loss_scale=16, train_wall=84, gb_free=16.3, wall=4171
2023-08-24 03:26:00 | INFO | train_inner | epoch 004:   1182 / 1474 loss=2.286, trans_loss=3.681, nll_loss=1.885, w2v_ctc_loss=1.376, task_loss=2.047, contrastive_loss=0, total=4164, n_correct=2193.11, ppl=3.69, accuracy=52.668, wps=14858.9, ups=1.19, wpb=12440.4, bsz=483.3, num_updates=5600, lr=0.000188982, gnorm=0.468, clip=0, loss_scale=16, train_wall=83, gb_free=15.9, wall=4255
2023-08-24 03:27:25 | INFO | train_inner | epoch 004:   1282 / 1474 loss=2.271, trans_loss=3.673, nll_loss=1.873, w2v_ctc_loss=1.362, task_loss=2.091, contrastive_loss=0, total=4155.14, n_correct=2206.34, ppl=3.66, accuracy=53.099, wps=14682.4, ups=1.18, wpb=12409.1, bsz=472.5, num_updates=5700, lr=0.000187317, gnorm=0.466, clip=0, loss_scale=16, train_wall=84, gb_free=16.4, wall=4339
2023-08-24 03:28:47 | INFO | train_inner | epoch 004:   1382 / 1474 loss=2.268, trans_loss=3.671, nll_loss=1.87, w2v_ctc_loss=1.356, task_loss=2.235, contrastive_loss=0, total=4101.03, n_correct=2184.65, ppl=3.66, accuracy=53.271, wps=14847.9, ups=1.21, wpb=12248.2, bsz=438, num_updates=5800, lr=0.000185695, gnorm=0.466, clip=0, loss_scale=16, train_wall=82, gb_free=16.9, wall=4422
2023-08-24 03:30:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.4633, device='cuda:2')
2023-08-24 03:30:37 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 4.421 | trans_loss 5.856 | nll_loss 3.212 | w2v_ctc_loss 1.539 | task_loss 11.243 | contrastive_loss 0 | total 4003.4 | n_correct 2293.8 | ppl 9.27 | accuracy 57.296 | uer 23.083 | wer 24.734 | raw_wer 24.734 | bleu 17.18 | wps 1604.7 | wpb 4003.4 | bsz 141.8 | num_updates 5892 | best_bleu 17.18
2023-08-24 03:30:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 5892 updates
2023-08-24 03:30:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:30:43 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:30:47 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 4 @ 5892 updates, score 17.18) (writing took 10.41041028208565 seconds)
2023-08-24 03:30:48 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-08-24 03:30:48 | INFO | train | epoch 004 | loss 2.32 | trans_loss 3.697 | nll_loss 1.902 | w2v_ctc_loss 1.402 | task_loss 2.181 | contrastive_loss 0 | total 4138.65 | n_correct 2147.22 | ppl 3.74 | accuracy 51.882 | wps 14128.2 | ups 1.14 | wpb 12355.8 | bsz 458.5 | num_updates 5892 | lr 0.00018424 | gnorm 0.581 | clip 0 | loss_scale 16 | train_wall 1229 | gb_free 14.8 | wall 4542
2023-08-24 03:30:48 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 03:30:48 | INFO | fairseq.trainer | begin training epoch 5
2023-08-24 03:30:48 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 03:31:01 | INFO | train_inner | epoch 005:      8 / 1474 loss=2.256, trans_loss=3.667, nll_loss=1.863, w2v_ctc_loss=1.339, task_loss=2.297, contrastive_loss=0, total=4036.88, n_correct=2157.65, ppl=3.64, accuracy=53.448, wps=8994.4, ups=0.75, wpb=12051.7, bsz=437.2, num_updates=5900, lr=0.000184115, gnorm=0.471, clip=0, loss_scale=16, train_wall=82, gb_free=16.6, wall=4556
2023-08-24 03:32:25 | INFO | train_inner | epoch 005:    108 / 1474 loss=2.172, trans_loss=3.607, nll_loss=1.787, w2v_ctc_loss=1.256, task_loss=1.976, contrastive_loss=0, total=4241.19, n_correct=2346.73, ppl=3.45, accuracy=55.332, wps=15074.4, ups=1.19, wpb=12664.5, bsz=494.6, num_updates=6000, lr=0.000182574, gnorm=0.449, clip=0, loss_scale=16, train_wall=83, gb_free=17, wall=4640
2023-08-24 03:32:25 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 03:32:59 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.412 | trans_loss 5.861 | nll_loss 3.219 | w2v_ctc_loss 1.497 | task_loss 11.259 | contrastive_loss 0 | total 4003.4 | n_correct 2290.4 | ppl 9.31 | accuracy 57.211 | uer 22.924 | wer 24.701 | raw_wer 24.701 | bleu 16.68 | wps 1539.8 | wpb 4003.4 | bsz 141.8 | num_updates 6000 | best_bleu 17.18
2023-08-24 03:32:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 6000 updates
2023-08-24 03:32:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_5_6000.pt
2023-08-24 03:33:02 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_5_6000.pt
2023-08-24 03:33:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_5_6000.pt (epoch 5 @ 6000 updates, score 16.68) (writing took 7.052294263034128 seconds)
2023-08-24 03:34:29 | INFO | train_inner | epoch 005:    208 / 1474 loss=2.188, trans_loss=3.621, nll_loss=1.802, w2v_ctc_loss=1.275, task_loss=2.016, contrastive_loss=0, total=4184.8, n_correct=2298.72, ppl=3.49, accuracy=54.93, wps=10106.7, ups=0.81, wpb=12486.5, bsz=486.4, num_updates=6100, lr=0.000181071, gnorm=0.457, clip=0, loss_scale=16, train_wall=82, gb_free=16.5, wall=4763
2023-08-24 03:35:52 | INFO | train_inner | epoch 005:    308 / 1474 loss=2.199, trans_loss=3.617, nll_loss=1.802, w2v_ctc_loss=1.292, task_loss=2.216, contrastive_loss=0, total=4104.88, n_correct=2251.34, ppl=3.49, accuracy=54.845, wps=14681.5, ups=1.2, wpb=12271.4, bsz=449.2, num_updates=6200, lr=0.000179605, gnorm=0.467, clip=0, loss_scale=16, train_wall=83, gb_free=15.5, wall=4847
2023-08-24 03:37:17 | INFO | train_inner | epoch 005:    408 / 1474 loss=2.171, trans_loss=3.607, nll_loss=1.791, w2v_ctc_loss=1.257, task_loss=2.103, contrastive_loss=0, total=4146.85, n_correct=2290.79, ppl=3.46, accuracy=55.242, wps=14672.7, ups=1.18, wpb=12393.9, bsz=473.3, num_updates=6300, lr=0.000178174, gnorm=0.466, clip=0, loss_scale=16, train_wall=84, gb_free=15.9, wall=4931
2023-08-24 03:38:40 | INFO | train_inner | epoch 005:    508 / 1474 loss=2.19, trans_loss=3.623, nll_loss=1.809, w2v_ctc_loss=1.273, task_loss=2.454, contrastive_loss=0, total=4030.36, n_correct=2209.33, ppl=3.5, accuracy=54.817, wps=14422.5, ups=1.2, wpb=12039.6, bsz=417.1, num_updates=6400, lr=0.000176777, gnorm=0.466, clip=0, loss_scale=16, train_wall=83, gb_free=14.7, wall=5015
2023-08-24 03:40:04 | INFO | train_inner | epoch 005:    608 / 1474 loss=2.182, trans_loss=3.626, nll_loss=1.81, w2v_ctc_loss=1.261, task_loss=2.267, contrastive_loss=0, total=4110.02, n_correct=2259.5, ppl=3.51, accuracy=54.975, wps=14626, ups=1.19, wpb=12261.7, bsz=450.3, num_updates=6500, lr=0.000175412, gnorm=0.467, clip=0, loss_scale=16, train_wall=83, gb_free=16.8, wall=5099
2023-08-24 03:41:28 | INFO | train_inner | epoch 005:    708 / 1474 loss=2.175, trans_loss=3.621, nll_loss=1.806, w2v_ctc_loss=1.26, task_loss=2.083, contrastive_loss=0, total=4163.49, n_correct=2299.14, ppl=3.5, accuracy=55.221, wps=14831.9, ups=1.19, wpb=12427.8, bsz=479, num_updates=6600, lr=0.000174078, gnorm=0.456, clip=0, loss_scale=16, train_wall=83, gb_free=11.6, wall=5182
2023-08-24 03:42:53 | INFO | train_inner | epoch 005:    808 / 1474 loss=2.172, trans_loss=3.622, nll_loss=1.805, w2v_ctc_loss=1.252, task_loss=2.253, contrastive_loss=0, total=4130.46, n_correct=2279.9, ppl=3.5, accuracy=55.197, wps=14540.2, ups=1.18, wpb=12327.4, bsz=448, num_updates=6700, lr=0.000172774, gnorm=0.457, clip=0, loss_scale=16, train_wall=84, gb_free=12.2, wall=5267
2023-08-24 03:44:16 | INFO | train_inner | epoch 005:    908 / 1474 loss=2.163, trans_loss=3.615, nll_loss=1.799, w2v_ctc_loss=1.248, task_loss=2.279, contrastive_loss=0, total=4091.87, n_correct=2266.66, ppl=3.48, accuracy=55.394, wps=14646.1, ups=1.2, wpb=12217.7, bsz=444, num_updates=6800, lr=0.000171499, gnorm=0.458, clip=0, loss_scale=16, train_wall=83, gb_free=15.1, wall=5351
2023-08-24 03:45:40 | INFO | train_inner | epoch 005:   1008 / 1474 loss=2.16, trans_loss=3.615, nll_loss=1.799, w2v_ctc_loss=1.245, task_loss=2.151, contrastive_loss=0, total=4164.94, n_correct=2311.69, ppl=3.48, accuracy=55.504, wps=14867.6, ups=1.2, wpb=12434.2, bsz=465, num_updates=6900, lr=0.000170251, gnorm=0.449, clip=0, loss_scale=16, train_wall=83, gb_free=15.7, wall=5434
2023-08-24 03:47:04 | INFO | train_inner | epoch 005:   1108 / 1474 loss=2.17, trans_loss=3.616, nll_loss=1.799, w2v_ctc_loss=1.257, task_loss=2.157, contrastive_loss=0, total=4176.06, n_correct=2319.21, ppl=3.48, accuracy=55.536, wps=14739.2, ups=1.18, wpb=12460.6, bsz=465.6, num_updates=7000, lr=0.000169031, gnorm=0.456, clip=0, loss_scale=16, train_wall=84, gb_free=16.8, wall=5519
2023-08-24 03:48:28 | INFO | train_inner | epoch 005:   1208 / 1474 loss=2.154, trans_loss=3.615, nll_loss=1.797, w2v_ctc_loss=1.235, task_loss=2.257, contrastive_loss=0, total=4160.61, n_correct=2321.67, ppl=3.47, accuracy=55.801, wps=14759.2, ups=1.19, wpb=12406.9, bsz=449.4, num_updates=7100, lr=0.000167836, gnorm=0.459, clip=0, loss_scale=16, train_wall=83, gb_free=16.6, wall=5603
2023-08-24 03:49:53 | INFO | train_inner | epoch 005:   1308 / 1474 loss=2.144, trans_loss=3.612, nll_loss=1.795, w2v_ctc_loss=1.221, task_loss=2.202, contrastive_loss=0, total=4145.72, n_correct=2306.32, ppl=3.47, accuracy=55.631, wps=14618.8, ups=1.18, wpb=12374.5, bsz=450.8, num_updates=7200, lr=0.000166667, gnorm=0.45, clip=0, loss_scale=32, train_wall=84, gb_free=17.5, wall=5687
2023-08-24 03:51:17 | INFO | train_inner | epoch 005:   1408 / 1474 loss=2.142, trans_loss=3.614, nll_loss=1.8, w2v_ctc_loss=1.219, task_loss=2.195, contrastive_loss=0, total=4134.3, n_correct=2301.52, ppl=3.48, accuracy=55.669, wps=14750.4, ups=1.19, wpb=12348.1, bsz=458.6, num_updates=7300, lr=0.000165521, gnorm=0.454, clip=0, loss_scale=32, train_wall=83, gb_free=17.5, wall=5771
2023-08-24 03:52:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 03:52:45 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.32 | trans_loss 5.78 | nll_loss 3.119 | w2v_ctc_loss 1.373 | task_loss 11.425 | contrastive_loss 0 | total 4003.4 | n_correct 2339.8 | ppl 8.69 | accuracy 58.445 | uer 21.238 | wer 22.844 | raw_wer 22.844 | bleu 17.82 | wps 1600.9 | wpb 4003.4 | bsz 141.8 | num_updates 7366 | best_bleu 17.82
2023-08-24 03:52:45 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 7366 updates
2023-08-24 03:52:45 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:52:51 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 03:52:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 5 @ 7366 updates, score 17.82) (writing took 10.778137260000221 seconds)
2023-08-24 03:52:56 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-08-24 03:52:56 | INFO | train | epoch 005 | loss 2.17 | trans_loss 3.616 | nll_loss 1.8 | w2v_ctc_loss 1.253 | task_loss 2.185 | contrastive_loss 0 | total 4138.65 | n_correct 2289 | ppl 3.48 | accuracy 55.308 | wps 13706.1 | ups 1.11 | wpb 12355.8 | bsz 458.5 | num_updates 7366 | lr 0.000164778 | gnorm 0.458 | clip 0 | loss_scale 32 | train_wall 1227 | gb_free 16.2 | wall 5871
2023-08-24 03:52:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 03:52:57 | INFO | fairseq.trainer | begin training epoch 6
2023-08-24 03:52:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 03:53:32 | INFO | train_inner | epoch 006:     34 / 1474 loss=2.128, trans_loss=3.59, nll_loss=1.766, w2v_ctc_loss=1.213, task_loss=2.224, contrastive_loss=0, total=4117.6, n_correct=2318.91, ppl=3.4, accuracy=56.317, wps=9079.1, ups=0.74, wpb=12284.3, bsz=450.3, num_updates=7400, lr=0.000164399, gnorm=0.46, clip=0, loss_scale=32, train_wall=83, gb_free=15.9, wall=5907
2023-08-24 03:54:56 | INFO | train_inner | epoch 006:    134 / 1474 loss=2.086, trans_loss=3.558, nll_loss=1.726, w2v_ctc_loss=1.17, task_loss=2.196, contrastive_loss=0, total=4143.22, n_correct=2365.73, ppl=3.31, accuracy=57.099, wps=14843, ups=1.2, wpb=12376.3, bsz=453.8, num_updates=7500, lr=0.000163299, gnorm=0.452, clip=0, loss_scale=32, train_wall=83, gb_free=16.4, wall=5990
2023-08-24 03:56:19 | INFO | train_inner | epoch 006:    234 / 1474 loss=2.111, trans_loss=3.571, nll_loss=1.744, w2v_ctc_loss=1.2, task_loss=2.351, contrastive_loss=0, total=4119.9, n_correct=2336.89, ppl=3.35, accuracy=56.722, wps=14807.5, ups=1.2, wpb=12310.3, bsz=438.5, num_updates=7600, lr=0.000162221, gnorm=0.453, clip=0, loss_scale=32, train_wall=83, gb_free=17, wall=6073
2023-08-24 03:57:44 | INFO | train_inner | epoch 006:    334 / 1474 loss=2.071, trans_loss=3.557, nll_loss=1.725, w2v_ctc_loss=1.151, task_loss=2.105, contrastive_loss=0, total=4147.01, n_correct=2375.55, ppl=3.31, accuracy=57.283, wps=14591.5, ups=1.18, wpb=12381.6, bsz=476, num_updates=7700, lr=0.000161165, gnorm=0.45, clip=0, loss_scale=32, train_wall=84, gb_free=17.3, wall=6158
2023-08-24 03:59:08 | INFO | train_inner | epoch 006:    434 / 1474 loss=2.074, trans_loss=3.561, nll_loss=1.732, w2v_ctc_loss=1.155, task_loss=2.028, contrastive_loss=0, total=4184.32, n_correct=2393.09, ppl=3.32, accuracy=57.192, wps=14805, ups=1.18, wpb=12495.1, bsz=485.6, num_updates=7800, lr=0.000160128, gnorm=0.451, clip=0, loss_scale=32, train_wall=84, gb_free=16.2, wall=6242
2023-08-24 04:00:31 | INFO | train_inner | epoch 006:    534 / 1474 loss=2.089, trans_loss=3.57, nll_loss=1.741, w2v_ctc_loss=1.173, task_loss=2.189, contrastive_loss=0, total=4170.23, n_correct=2387.01, ppl=3.34, accuracy=57.239, wps=14924.4, ups=1.2, wpb=12444.2, bsz=456, num_updates=7900, lr=0.000159111, gnorm=0.456, clip=0, loss_scale=32, train_wall=83, gb_free=16.4, wall=6326
2023-08-24 04:01:46 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-24 04:01:55 | INFO | train_inner | epoch 006:    635 / 1474 loss=2.082, trans_loss=3.571, nll_loss=1.744, w2v_ctc_loss=1.161, task_loss=2.101, contrastive_loss=0, total=4145.21, n_correct=2366.89, ppl=3.35, accuracy=57.099, wps=14726.7, ups=1.19, wpb=12373.6, bsz=466.4, num_updates=8000, lr=0.000158114, gnorm=0.448, clip=0, loss_scale=16, train_wall=83, gb_free=16.3, wall=6410
2023-08-24 04:01:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 04:02:28 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.304 | trans_loss 5.748 | nll_loss 3.073 | w2v_ctc_loss 1.393 | task_loss 11.28 | contrastive_loss 0 | total 4003.4 | n_correct 2353.2 | ppl 8.42 | accuracy 58.78 | uer 20.657 | wer 22.188 | raw_wer 22.188 | bleu 18 | wps 1665 | wpb 4003.4 | bsz 141.8 | num_updates 8000 | best_bleu 18
2023-08-24 04:02:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 8000 updates
2023-08-24 04:02:28 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_6_8000.pt
2023-08-24 04:02:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_6_8000.pt
2023-08-24 04:02:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_6_8000.pt (epoch 6 @ 8000 updates, score 18.0) (writing took 10.538525106967427 seconds)
2023-08-24 04:04:02 | INFO | train_inner | epoch 006:    735 / 1474 loss=2.089, trans_loss=3.573, nll_loss=1.747, w2v_ctc_loss=1.172, task_loss=2.213, contrastive_loss=0, total=4152.24, n_correct=2369.44, ppl=3.36, accuracy=57.064, wps=9759.7, ups=0.79, wpb=12398.2, bsz=455.7, num_updates=8100, lr=0.000157135, gnorm=0.452, clip=0, loss_scale=16, train_wall=83, gb_free=16.4, wall=6537
2023-08-24 04:05:26 | INFO | train_inner | epoch 006:    835 / 1474 loss=2.092, trans_loss=3.583, nll_loss=1.759, w2v_ctc_loss=1.167, task_loss=2.313, contrastive_loss=0, total=4110.55, n_correct=2337.13, ppl=3.39, accuracy=56.857, wps=14620.6, ups=1.19, wpb=12271.3, bsz=440.6, num_updates=8200, lr=0.000156174, gnorm=0.452, clip=0, loss_scale=16, train_wall=83, gb_free=15.7, wall=6621
2023-08-24 04:06:50 | INFO | train_inner | epoch 006:    935 / 1474 loss=2.092, trans_loss=3.583, nll_loss=1.76, w2v_ctc_loss=1.169, task_loss=2.272, contrastive_loss=0, total=4084.53, n_correct=2321.37, ppl=3.39, accuracy=56.833, wps=14513.7, ups=1.19, wpb=12190.9, bsz=445.3, num_updates=8300, lr=0.00015523, gnorm=0.455, clip=0, loss_scale=16, train_wall=83, gb_free=15.9, wall=6705
2023-08-24 04:08:14 | INFO | train_inner | epoch 006:   1035 / 1474 loss=2.07, trans_loss=3.567, nll_loss=1.74, w2v_ctc_loss=1.151, task_loss=2.088, contrastive_loss=0, total=4159.43, n_correct=2380.32, ppl=3.34, accuracy=57.227, wps=14830.4, ups=1.19, wpb=12417.6, bsz=475.9, num_updates=8400, lr=0.000154303, gnorm=0.456, clip=0, loss_scale=16, train_wall=83, gb_free=15.9, wall=6788
2023-08-24 04:09:37 | INFO | train_inner | epoch 006:   1135 / 1474 loss=2.09, trans_loss=3.575, nll_loss=1.75, w2v_ctc_loss=1.166, task_loss=2.415, contrastive_loss=0, total=4072.85, n_correct=2320.38, ppl=3.36, accuracy=56.972, wps=14589.6, ups=1.2, wpb=12158.5, bsz=428.8, num_updates=8500, lr=0.000153393, gnorm=0.457, clip=0, loss_scale=16, train_wall=83, gb_free=13.7, wall=6872
2023-08-24 04:11:02 | INFO | train_inner | epoch 006:   1235 / 1474 loss=2.071, trans_loss=3.566, nll_loss=1.741, w2v_ctc_loss=1.15, task_loss=2.14, contrastive_loss=0, total=4142.18, n_correct=2370.75, ppl=3.34, accuracy=57.234, wps=14649.1, ups=1.18, wpb=12371.6, bsz=473.3, num_updates=8600, lr=0.000152499, gnorm=0.452, clip=0, loss_scale=16, train_wall=84, gb_free=15.2, wall=6956
2023-08-24 04:12:24 | INFO | train_inner | epoch 006:   1335 / 1474 loss=2.07, trans_loss=3.573, nll_loss=1.746, w2v_ctc_loss=1.148, task_loss=2.165, contrastive_loss=0, total=4133.08, n_correct=2374.35, ppl=3.35, accuracy=57.447, wps=14942.8, ups=1.21, wpb=12329.2, bsz=455.6, num_updates=8700, lr=0.00015162, gnorm=0.449, clip=0, loss_scale=16, train_wall=82, gb_free=14.9, wall=7039
2023-08-24 04:13:49 | INFO | train_inner | epoch 006:   1435 / 1474 loss=2.067, trans_loss=3.566, nll_loss=1.74, w2v_ctc_loss=1.148, task_loss=2.198, contrastive_loss=0, total=4185.57, n_correct=2411.16, ppl=3.34, accuracy=57.606, wps=14777.2, ups=1.18, wpb=12495.1, bsz=459.6, num_updates=8800, lr=0.000150756, gnorm=0.445, clip=0, loss_scale=16, train_wall=84, gb_free=16.9, wall=7123
2023-08-24 04:14:21 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 04:14:54 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.27 | trans_loss 5.71 | nll_loss 3.028 | w2v_ctc_loss 1.366 | task_loss 11.451 | contrastive_loss 0 | total 4003.4 | n_correct 2380.7 | ppl 8.15 | accuracy 59.467 | uer 19.823 | wer 21.468 | raw_wer 21.468 | bleu 18.28 | wps 1613.9 | wpb 4003.4 | bsz 141.8 | num_updates 8839 | best_bleu 18.28
2023-08-24 04:14:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 8839 updates
2023-08-24 04:14:54 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 04:15:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 04:15:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 6 @ 8839 updates, score 18.28) (writing took 11.126752728014253 seconds)
2023-08-24 04:15:05 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-08-24 04:15:05 | INFO | train | epoch 006 | loss 2.082 | trans_loss 3.569 | nll_loss 1.742 | w2v_ctc_loss 1.162 | task_loss 2.19 | contrastive_loss 0 | total 4138.46 | n_correct 2365.33 | ppl 3.34 | accuracy 57.155 | wps 13694.8 | ups 1.11 | wpb 12355.3 | bsz 458.3 | num_updates 8839 | lr 0.000150423 | gnorm 0.452 | clip 0 | loss_scale 16 | train_wall 1225 | gb_free 15 | wall 7200
2023-08-24 04:15:05 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 04:15:05 | INFO | fairseq.trainer | begin training epoch 7
2023-08-24 04:15:05 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 04:16:04 | INFO | train_inner | epoch 007:     61 / 1474 loss=2.039, trans_loss=3.545, nll_loss=1.712, w2v_ctc_loss=1.12, task_loss=2.135, contrastive_loss=0, total=4110.58, n_correct=2387.62, ppl=3.28, accuracy=58.085, wps=9087, ups=0.74, wpb=12271.6, bsz=461.4, num_updates=8900, lr=0.000149906, gnorm=0.451, clip=0, loss_scale=16, train_wall=83, gb_free=11.9, wall=7258
2023-08-24 04:17:27 | INFO | train_inner | epoch 007:    161 / 1474 loss=2.025, trans_loss=3.532, nll_loss=1.694, w2v_ctc_loss=1.103, task_loss=2.209, contrastive_loss=0, total=4110.69, n_correct=2399.55, ppl=3.24, accuracy=58.373, wps=14754.4, ups=1.2, wpb=12273, bsz=456.8, num_updates=9000, lr=0.000149071, gnorm=0.453, clip=0, loss_scale=16, train_wall=83, gb_free=17.1, wall=7342
2023-08-24 04:18:51 | INFO | train_inner | epoch 007:    261 / 1474 loss=2.026, trans_loss=3.53, nll_loss=1.69, w2v_ctc_loss=1.109, task_loss=2.232, contrastive_loss=0, total=4124.47, n_correct=2413.25, ppl=3.23, accuracy=58.511, wps=14765.1, ups=1.2, wpb=12308.3, bsz=448.9, num_updates=9100, lr=0.00014825, gnorm=0.452, clip=0, loss_scale=16, train_wall=83, gb_free=17.7, wall=7425
2023-08-24 04:20:15 | INFO | train_inner | epoch 007:    361 / 1474 loss=2.023, trans_loss=3.537, nll_loss=1.701, w2v_ctc_loss=1.101, task_loss=2.09, contrastive_loss=0, total=4211.96, n_correct=2453.39, ppl=3.25, accuracy=58.248, wps=14953.9, ups=1.19, wpb=12570.9, bsz=483.3, num_updates=9200, lr=0.000147442, gnorm=0.453, clip=0, loss_scale=16, train_wall=83, gb_free=16.8, wall=7509
2023-08-24 04:21:38 | INFO | train_inner | epoch 007:    461 / 1474 loss=2.021, trans_loss=3.537, nll_loss=1.703, w2v_ctc_loss=1.098, task_loss=2.155, contrastive_loss=0, total=4148.75, n_correct=2416.47, ppl=3.25, accuracy=58.246, wps=14867.3, ups=1.2, wpb=12390.2, bsz=464, num_updates=9300, lr=0.000146647, gnorm=0.448, clip=0, loss_scale=16, train_wall=83, gb_free=15.6, wall=7592
2023-08-24 04:23:02 | INFO | train_inner | epoch 007:    561 / 1474 loss=2.022, trans_loss=3.538, nll_loss=1.7, w2v_ctc_loss=1.1, task_loss=2.156, contrastive_loss=0, total=4163.25, n_correct=2432.99, ppl=3.25, accuracy=58.44, wps=14860.8, ups=1.2, wpb=12419.4, bsz=458.1, num_updates=9400, lr=0.000145865, gnorm=0.449, clip=0, loss_scale=16, train_wall=83, gb_free=15.4, wall=7676
2023-08-24 04:24:25 | INFO | train_inner | epoch 007:    661 / 1474 loss=2.018, trans_loss=3.538, nll_loss=1.701, w2v_ctc_loss=1.094, task_loss=2.197, contrastive_loss=0, total=4148.73, n_correct=2426.16, ppl=3.25, accuracy=58.48, wps=14856, ups=1.2, wpb=12379.1, bsz=451.8, num_updates=9500, lr=0.000145095, gnorm=0.452, clip=0, loss_scale=16, train_wall=83, gb_free=16.1, wall=7759
2023-08-24 04:25:49 | INFO | train_inner | epoch 007:    761 / 1474 loss=2.02, trans_loss=3.532, nll_loss=1.696, w2v_ctc_loss=1.097, task_loss=2.272, contrastive_loss=0, total=4132.8, n_correct=2417.9, ppl=3.24, accuracy=58.505, wps=14601.1, ups=1.18, wpb=12341.2, bsz=449.9, num_updates=9600, lr=0.000144338, gnorm=0.449, clip=0, loss_scale=16, train_wall=84, gb_free=16.1, wall=7844
2023-08-24 04:27:14 | INFO | train_inner | epoch 007:    861 / 1474 loss=2.021, trans_loss=3.542, nll_loss=1.708, w2v_ctc_loss=1.098, task_loss=2.208, contrastive_loss=0, total=4150.73, n_correct=2424.87, ppl=3.27, accuracy=58.42, wps=14684.8, ups=1.19, wpb=12388.8, bsz=461.3, num_updates=9700, lr=0.000143592, gnorm=0.448, clip=0, loss_scale=16, train_wall=84, gb_free=10.8, wall=7928
2023-08-24 04:28:38 | INFO | train_inner | epoch 007:    961 / 1474 loss=2.011, trans_loss=3.536, nll_loss=1.702, w2v_ctc_loss=1.088, task_loss=2.099, contrastive_loss=0, total=4134.12, n_correct=2417.42, ppl=3.25, accuracy=58.475, wps=14722.9, ups=1.19, wpb=12340, bsz=471.7, num_updates=9800, lr=0.000142857, gnorm=0.451, clip=0, loss_scale=16, train_wall=83, gb_free=17.7, wall=8012
2023-08-24 04:30:01 | INFO | train_inner | epoch 007:   1061 / 1474 loss=2.022, trans_loss=3.546, nll_loss=1.714, w2v_ctc_loss=1.097, task_loss=2.259, contrastive_loss=0, total=4109.02, n_correct=2396.84, ppl=3.28, accuracy=58.331, wps=14659.6, ups=1.2, wpb=12266.8, bsz=441, num_updates=9900, lr=0.000142134, gnorm=0.452, clip=0, loss_scale=16, train_wall=83, gb_free=15.5, wall=8096
2023-08-24 04:31:25 | INFO | train_inner | epoch 007:   1161 / 1474 loss=2.015, trans_loss=3.535, nll_loss=1.704, w2v_ctc_loss=1.093, task_loss=2.144, contrastive_loss=0, total=4133.4, n_correct=2413.7, ppl=3.26, accuracy=58.395, wps=14699.3, ups=1.19, wpb=12352.8, bsz=469.7, num_updates=10000, lr=0.000141421, gnorm=0.46, clip=0, loss_scale=16, train_wall=83, gb_free=16.5, wall=8180
2023-08-24 04:31:25 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 04:31:58 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.238 | trans_loss 5.678 | nll_loss 2.982 | w2v_ctc_loss 1.331 | task_loss 11.453 | contrastive_loss 0 | total 4003.4 | n_correct 2400.1 | ppl 7.9 | accuracy 59.952 | uer 18.708 | wer 20.391 | raw_wer 20.391 | bleu 18.84 | wps 1642.4 | wpb 4003.4 | bsz 141.8 | num_updates 10000 | best_bleu 18.84
2023-08-24 04:31:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 10000 updates
2023-08-24 04:31:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_7_10000.pt
2023-08-24 04:32:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_7_10000.pt
2023-08-24 04:32:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_7_10000.pt (epoch 7 @ 10000 updates, score 18.84) (writing took 11.983996105962433 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 04:33:33 | INFO | train_inner | epoch 007:   1261 / 1474 loss=2.009, trans_loss=3.541, nll_loss=1.709, w2v_ctc_loss=1.082, task_loss=2.237, contrastive_loss=0, total=4122.48, n_correct=2407.24, ppl=3.27, accuracy=58.393, wps=9654.2, ups=0.78, wpb=12309.6, bsz=446.8, num_updates=10100, lr=0.00014072, gnorm=0.376, clip=0, loss_scale=32, train_wall=82, gb_free=17.3, wall=8307
2023-08-24 04:34:56 | INFO | train_inner | epoch 007:   1361 / 1474 loss=2.015, trans_loss=3.534, nll_loss=1.7, w2v_ctc_loss=1.096, task_loss=2.036, contrastive_loss=0, total=4184.94, n_correct=2460.16, ppl=3.25, accuracy=58.786, wps=14933.1, ups=1.2, wpb=12492.2, bsz=479.3, num_updates=10200, lr=0.000140028, gnorm=0.372, clip=0, loss_scale=32, train_wall=83, gb_free=15.7, wall=8391
2023-08-24 04:36:22 | INFO | train_inner | epoch 007:   1461 / 1474 loss=2.018, trans_loss=3.538, nll_loss=1.709, w2v_ctc_loss=1.094, task_loss=2.355, contrastive_loss=0, total=4105.52, n_correct=2395.8, ppl=3.27, accuracy=58.356, wps=14401.5, ups=1.17, wpb=12267.8, bsz=443.4, num_updates=10300, lr=0.000139347, gnorm=0.383, clip=0, loss_scale=32, train_wall=85, gb_free=16.1, wall=8476
2023-08-24 04:36:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
2023-08-24 04:37:05 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.233 | trans_loss 5.672 | nll_loss 2.978 | w2v_ctc_loss 1.327 | task_loss 11.432 | contrastive_loss 0 | total 4003.4 | n_correct 2403.3 | ppl 7.88 | accuracy 60.031 | uer 18.926 | wer 20.667 | raw_wer 20.667 | bleu 18.73 | wps 1616.3 | wpb 4003.4 | bsz 141.8 | num_updates 10313 | best_bleu 18.84
2023-08-24 04:37:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 10313 updates
2023-08-24 04:37:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_18.7303.pt
2023-08-24 04:37:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_18.7303.pt
2023-08-24 04:37:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_18.7303.pt (epoch 7 @ 10313 updates, score 18.73) (writing took 6.083382473094389 seconds)
2023-08-24 04:37:12 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-08-24 04:37:12 | INFO | train | epoch 007 | loss 2.019 | trans_loss 3.536 | nll_loss 1.702 | w2v_ctc_loss 1.097 | task_loss 2.189 | contrastive_loss 0 | total 4138.65 | n_correct 2418.15 | ppl 3.25 | accuracy 58.429 | wps 13731.3 | ups 1.11 | wpb 12355.8 | bsz 458.5 | num_updates 10313 | lr 0.000139259 | gnorm 0.436 | clip 0 | loss_scale 32 | train_wall 1225 | gb_free 13 | wall 8526
2023-08-24 04:37:12 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 04:37:12 | INFO | fairseq.trainer | begin training epoch 8
2023-08-24 04:37:12 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 04:38:33 | INFO | train_inner | epoch 008:     87 / 1474 loss=1.982, trans_loss=3.515, nll_loss=1.67, w2v_ctc_loss=1.058, task_loss=2.281, contrastive_loss=0, total=4123.81, n_correct=2447.27, ppl=3.18, accuracy=59.345, wps=9379.4, ups=0.76, wpb=12296.3, bsz=446.4, num_updates=10400, lr=0.000138675, gnorm=0.377, clip=0, loss_scale=32, train_wall=83, gb_free=15.1, wall=8607
2023-08-24 04:39:56 | INFO | train_inner | epoch 008:    187 / 1474 loss=1.979, trans_loss=3.509, nll_loss=1.662, w2v_ctc_loss=1.054, task_loss=2.42, contrastive_loss=0, total=4025.52, n_correct=2389.49, ppl=3.16, accuracy=59.359, wps=14387.4, ups=1.2, wpb=12006.1, bsz=423.4, num_updates=10500, lr=0.000138013, gnorm=0.384, clip=0, loss_scale=32, train_wall=83, gb_free=13.5, wall=8691
2023-08-24 04:41:20 | INFO | train_inner | epoch 008:    287 / 1474 loss=1.971, trans_loss=3.502, nll_loss=1.657, w2v_ctc_loss=1.052, task_loss=2.031, contrastive_loss=0, total=4211.24, n_correct=2508.89, ppl=3.15, accuracy=59.576, wps=15053.6, ups=1.2, wpb=12567.1, bsz=491.5, num_updates=10600, lr=0.000137361, gnorm=0.379, clip=0, loss_scale=32, train_wall=83, gb_free=16.6, wall=8774
2023-08-24 04:42:44 | INFO | train_inner | epoch 008:    387 / 1474 loss=1.992, trans_loss=3.514, nll_loss=1.671, w2v_ctc_loss=1.072, task_loss=2.34, contrastive_loss=0, total=4126.7, n_correct=2442.5, ppl=3.19, accuracy=59.188, wps=14583.3, ups=1.18, wpb=12315.4, bsz=439.4, num_updates=10700, lr=0.000136717, gnorm=0.379, clip=0, loss_scale=32, train_wall=84, gb_free=9.4, wall=8858
2023-08-24 04:44:08 | INFO | train_inner | epoch 008:    487 / 1474 loss=1.969, trans_loss=3.508, nll_loss=1.667, w2v_ctc_loss=1.045, task_loss=1.972, contrastive_loss=0, total=4196.99, n_correct=2493.62, ppl=3.17, accuracy=59.414, wps=14866.7, ups=1.19, wpb=12526, bsz=503, num_updates=10800, lr=0.000136083, gnorm=0.374, clip=0, loss_scale=32, train_wall=84, gb_free=16.5, wall=8943
2023-08-24 04:45:32 | INFO | train_inner | epoch 008:    587 / 1474 loss=1.986, trans_loss=3.508, nll_loss=1.67, w2v_ctc_loss=1.066, task_loss=2.333, contrastive_loss=0, total=4070.43, n_correct=2412.54, ppl=3.18, accuracy=59.27, wps=14488.9, ups=1.19, wpb=12169.7, bsz=433.3, num_updates=10900, lr=0.000135457, gnorm=0.383, clip=0, loss_scale=32, train_wall=83, gb_free=17.2, wall=9027
2023-08-24 04:46:57 | INFO | train_inner | epoch 008:    687 / 1474 loss=1.985, trans_loss=3.509, nll_loss=1.666, w2v_ctc_loss=1.067, task_loss=2.281, contrastive_loss=0, total=4143.18, n_correct=2463.52, ppl=3.17, accuracy=59.46, wps=14590.9, ups=1.18, wpb=12365.1, bsz=447.1, num_updates=11000, lr=0.00013484, gnorm=0.376, clip=0, loss_scale=32, train_wall=84, gb_free=12.8, wall=9111
2023-08-24 04:48:20 | INFO | train_inner | epoch 008:    787 / 1474 loss=1.976, trans_loss=3.506, nll_loss=1.668, w2v_ctc_loss=1.056, task_loss=2.258, contrastive_loss=0, total=4119.53, n_correct=2449.36, ppl=3.18, accuracy=59.457, wps=14776, ups=1.2, wpb=12314.2, bsz=446.2, num_updates=11100, lr=0.000134231, gnorm=0.38, clip=0, loss_scale=32, train_wall=83, gb_free=16.2, wall=9195
2023-08-24 04:49:44 | INFO | train_inner | epoch 008:    887 / 1474 loss=1.968, trans_loss=3.508, nll_loss=1.669, w2v_ctc_loss=1.046, task_loss=2.129, contrastive_loss=0, total=4154.7, n_correct=2473.31, ppl=3.18, accuracy=59.53, wps=14785.1, ups=1.19, wpb=12408, bsz=468.7, num_updates=11200, lr=0.000133631, gnorm=0.38, clip=0, loss_scale=32, train_wall=83, gb_free=16.3, wall=9279
2023-08-24 04:51:08 | INFO | train_inner | epoch 008:    987 / 1474 loss=1.967, trans_loss=3.508, nll_loss=1.668, w2v_ctc_loss=1.044, task_loss=2.05, contrastive_loss=0, total=4170.42, n_correct=2488.68, ppl=3.18, accuracy=59.675, wps=14972.9, ups=1.2, wpb=12451.9, bsz=471.9, num_updates=11300, lr=0.000133038, gnorm=0.375, clip=0, loss_scale=32, train_wall=83, gb_free=12.8, wall=9362
2023-08-24 04:52:32 | INFO | train_inner | epoch 008:   1087 / 1474 loss=1.975, trans_loss=3.518, nll_loss=1.68, w2v_ctc_loss=1.049, task_loss=2.186, contrastive_loss=0, total=4195.51, n_correct=2479.59, ppl=3.2, accuracy=59.101, wps=14811.4, ups=1.18, wpb=12522.2, bsz=464.1, num_updates=11400, lr=0.000132453, gnorm=0.382, clip=0, loss_scale=32, train_wall=84, gb_free=12, wall=9446
2023-08-24 04:53:55 | INFO | train_inner | epoch 008:   1187 / 1474 loss=1.971, trans_loss=3.509, nll_loss=1.67, w2v_ctc_loss=1.049, task_loss=2.107, contrastive_loss=0, total=4164.98, n_correct=2481.14, ppl=3.18, accuracy=59.571, wps=14951.3, ups=1.2, wpb=12440.1, bsz=466, num_updates=11500, lr=0.000131876, gnorm=0.374, clip=0, loss_scale=32, train_wall=83, gb_free=15.4, wall=9530
2023-08-24 04:55:18 | INFO | train_inner | epoch 008:   1287 / 1474 loss=1.98, trans_loss=3.512, nll_loss=1.675, w2v_ctc_loss=1.06, task_loss=2.235, contrastive_loss=0, total=4079.71, n_correct=2417.44, ppl=3.19, accuracy=59.255, wps=14684.8, ups=1.2, wpb=12187.6, bsz=446.2, num_updates=11600, lr=0.000131306, gnorm=0.383, clip=0, loss_scale=32, train_wall=82, gb_free=10.4, wall=9613
2023-08-24 04:56:42 | INFO | train_inner | epoch 008:   1387 / 1474 loss=1.978, trans_loss=3.518, nll_loss=1.683, w2v_ctc_loss=1.053, task_loss=2.177, contrastive_loss=0, total=4143.1, n_correct=2459.14, ppl=3.21, accuracy=59.355, wps=14821.2, ups=1.2, wpb=12373.5, bsz=459.8, num_updates=11700, lr=0.000130744, gnorm=0.377, clip=0, loss_scale=32, train_wall=83, gb_free=11.7, wall=9696
2023-08-24 04:57:54 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 04:58:27 | INFO | dev_st | epoch 008 | valid on 'dev_st' subset | loss 4.219 | trans_loss 5.642 | nll_loss 2.936 | w2v_ctc_loss 1.347 | task_loss 11.497 | contrastive_loss 0 | total 4003.4 | n_correct 2426.6 | ppl 7.65 | accuracy 60.613 | uer 18.342 | wer 20.119 | raw_wer 20.119 | bleu 19.21 | wps 1650.1 | wpb 4003.4 | bsz 141.8 | num_updates 11787 | best_bleu 19.21
2023-08-24 04:58:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 11787 updates
2023-08-24 04:58:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 04:58:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 04:58:41 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 8 @ 11787 updates, score 19.21) (writing took 13.714572317083366 seconds)
2023-08-24 04:58:41 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-08-24 04:58:41 | INFO | train | epoch 008 | loss 1.976 | trans_loss 3.511 | nll_loss 1.67 | w2v_ctc_loss 1.054 | task_loss 2.19 | contrastive_loss 0 | total 4138.65 | n_correct 2458.58 | ppl 3.18 | accuracy 59.405 | wps 14123.6 | ups 1.14 | wpb 12355.8 | bsz 458.5 | num_updates 11787 | lr 0.000130261 | gnorm 0.379 | clip 0 | loss_scale 32 | train_wall 1225 | gb_free 16.7 | wall 9815
2023-08-24 04:58:41 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 04:58:41 | INFO | fairseq.trainer | begin training epoch 9
2023-08-24 04:58:41 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 04:58:59 | INFO | train_inner | epoch 009:     13 / 1474 loss=1.96, trans_loss=3.512, nll_loss=1.671, w2v_ctc_loss=1.033, task_loss=2.162, contrastive_loss=0, total=4119.86, n_correct=2453.24, ppl=3.18, accuracy=59.547, wps=8946.5, ups=0.73, wpb=12291, bsz=465.6, num_updates=11800, lr=0.000130189, gnorm=0.381, clip=0, loss_scale=32, train_wall=83, gb_free=16.9, wall=9834
2023-08-24 05:00:23 | INFO | train_inner | epoch 009:    113 / 1474 loss=1.929, trans_loss=3.474, nll_loss=1.624, w2v_ctc_loss=1.01, task_loss=2.072, contrastive_loss=0, total=4182.81, n_correct=2537.16, ppl=3.08, accuracy=60.657, wps=14944.4, ups=1.2, wpb=12492, bsz=477.5, num_updates=11900, lr=0.000129641, gnorm=0.376, clip=0, loss_scale=32, train_wall=83, gb_free=16.8, wall=9917
2023-08-24 05:01:47 | INFO | train_inner | epoch 009:    213 / 1474 loss=1.936, trans_loss=3.479, nll_loss=1.63, w2v_ctc_loss=1.013, task_loss=2.326, contrastive_loss=0, total=4078.8, n_correct=2465.32, ppl=3.09, accuracy=60.442, wps=14544.7, ups=1.19, wpb=12179.2, bsz=438.1, num_updates=12000, lr=0.000129099, gnorm=0.384, clip=0, loss_scale=32, train_wall=83, gb_free=10.7, wall=10001
2023-08-24 05:01:47 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 05:02:19 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 4.21 | trans_loss 5.65 | nll_loss 2.948 | w2v_ctc_loss 1.299 | task_loss 11.474 | contrastive_loss 0 | total 4003.4 | n_correct 2418.1 | ppl 7.72 | accuracy 60.401 | uer 18.35 | wer 20.174 | raw_wer 20.174 | bleu 18.96 | wps 1664.2 | wpb 4003.4 | bsz 141.8 | num_updates 12000 | best_bleu 19.21
2023-08-24 05:02:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 12000 updates
2023-08-24 05:02:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_9_12000.pt
2023-08-24 05:02:22 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_9_12000.pt
2023-08-24 05:02:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_9_12000.pt (epoch 9 @ 12000 updates, score 18.96) (writing took 7.950542301055975 seconds)
2023-08-24 05:03:51 | INFO | train_inner | epoch 009:    313 / 1474 loss=1.92, trans_loss=3.469, nll_loss=1.619, w2v_ctc_loss=1.001, task_loss=2.053, contrastive_loss=0, total=4147, n_correct=2517.94, ppl=3.07, accuracy=60.717, wps=9996.2, ups=0.81, wpb=12390.6, bsz=475.2, num_updates=12100, lr=0.000128565, gnorm=0.377, clip=0, loss_scale=64, train_wall=82, gb_free=17.6, wall=10125
2023-08-24 05:05:15 | INFO | train_inner | epoch 009:    413 / 1474 loss=1.934, trans_loss=3.485, nll_loss=1.638, w2v_ctc_loss=1.011, task_loss=2.155, contrastive_loss=0, total=4199.03, n_correct=2530.33, ppl=3.11, accuracy=60.26, wps=14847.2, ups=1.18, wpb=12539.2, bsz=468.6, num_updates=12200, lr=0.000128037, gnorm=0.376, clip=0, loss_scale=64, train_wall=84, gb_free=16.7, wall=10209
2023-08-24 05:06:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 05:06:39 | INFO | train_inner | epoch 009:    514 / 1474 loss=1.952, trans_loss=3.49, nll_loss=1.642, w2v_ctc_loss=1.03, task_loss=2.325, contrastive_loss=0, total=4104.26, n_correct=2469.52, ppl=3.12, accuracy=60.17, wps=14612.5, ups=1.19, wpb=12248.8, bsz=432.2, num_updates=12300, lr=0.000127515, gnorm=0.38, clip=0, loss_scale=32, train_wall=83, gb_free=15.1, wall=10293
2023-08-24 05:08:03 | INFO | train_inner | epoch 009:    614 / 1474 loss=1.932, trans_loss=3.482, nll_loss=1.637, w2v_ctc_loss=1.009, task_loss=2.246, contrastive_loss=0, total=4124.71, n_correct=2487.85, ppl=3.11, accuracy=60.316, wps=14610.5, ups=1.19, wpb=12328.1, bsz=452.6, num_updates=12400, lr=0.000127, gnorm=0.378, clip=0, loss_scale=32, train_wall=84, gb_free=17.3, wall=10378
2023-08-24 05:09:27 | INFO | train_inner | epoch 009:    714 / 1474 loss=1.95, trans_loss=3.493, nll_loss=1.65, w2v_ctc_loss=1.029, task_loss=2.252, contrastive_loss=0, total=4077.28, n_correct=2449.92, ppl=3.14, accuracy=60.087, wps=14590.4, ups=1.2, wpb=12181.2, bsz=448.7, num_updates=12500, lr=0.000126491, gnorm=0.385, clip=0, loss_scale=32, train_wall=83, gb_free=17.1, wall=10461
2023-08-24 05:10:51 | INFO | train_inner | epoch 009:    814 / 1474 loss=1.937, trans_loss=3.484, nll_loss=1.642, w2v_ctc_loss=1.018, task_loss=1.962, contrastive_loss=0, total=4233.18, n_correct=2548.38, ppl=3.12, accuracy=60.2, wps=15046, ups=1.19, wpb=12650.2, bsz=504.7, num_updates=12600, lr=0.000125988, gnorm=0.374, clip=0, loss_scale=32, train_wall=83, gb_free=15.1, wall=10545
2023-08-24 05:12:15 | INFO | train_inner | epoch 009:    914 / 1474 loss=1.942, trans_loss=3.492, nll_loss=1.645, w2v_ctc_loss=1.018, task_loss=2.274, contrastive_loss=0, total=4136.02, n_correct=2487.94, ppl=3.13, accuracy=60.153, wps=14628.7, ups=1.19, wpb=12341.6, bsz=448.1, num_updates=12700, lr=0.000125491, gnorm=0.377, clip=0, loss_scale=32, train_wall=84, gb_free=12.8, wall=10629
2023-08-24 05:13:39 | INFO | train_inner | epoch 009:   1014 / 1474 loss=1.951, trans_loss=3.498, nll_loss=1.654, w2v_ctc_loss=1.025, task_loss=2.428, contrastive_loss=0, total=4101.79, n_correct=2458.09, ppl=3.15, accuracy=59.927, wps=14584.8, ups=1.19, wpb=12242.8, bsz=425.5, num_updates=12800, lr=0.000125, gnorm=0.387, clip=0, loss_scale=32, train_wall=83, gb_free=16.5, wall=10713
2023-08-24 05:15:02 | INFO | train_inner | epoch 009:   1114 / 1474 loss=1.94, trans_loss=3.496, nll_loss=1.649, w2v_ctc_loss=1.015, task_loss=2.066, contrastive_loss=0, total=4179.48, n_correct=2520.85, ppl=3.14, accuracy=60.315, wps=14959, ups=1.2, wpb=12459.2, bsz=475.5, num_updates=12900, lr=0.000124515, gnorm=0.378, clip=0, loss_scale=32, train_wall=83, gb_free=17.4, wall=10797
2023-08-24 05:16:27 | INFO | train_inner | epoch 009:   1214 / 1474 loss=1.956, trans_loss=3.498, nll_loss=1.656, w2v_ctc_loss=1.035, task_loss=2.323, contrastive_loss=0, total=4147.82, n_correct=2484.47, ppl=3.15, accuracy=59.898, wps=14642.7, ups=1.18, wpb=12380.9, bsz=447.6, num_updates=13000, lr=0.000124035, gnorm=0.38, clip=0, loss_scale=32, train_wall=84, gb_free=16.1, wall=10881
2023-08-24 05:17:50 | INFO | train_inner | epoch 009:   1314 / 1474 loss=1.932, trans_loss=3.491, nll_loss=1.648, w2v_ctc_loss=1.009, task_loss=1.983, contrastive_loss=0, total=4204.88, n_correct=2535.67, ppl=3.13, accuracy=60.303, wps=15097.4, ups=1.2, wpb=12549.3, bsz=493, num_updates=13100, lr=0.00012356, gnorm=0.375, clip=0, loss_scale=32, train_wall=82, gb_free=16.9, wall=10964
2023-08-24 05:19:13 | INFO | train_inner | epoch 009:   1414 / 1474 loss=1.952, trans_loss=3.504, nll_loss=1.662, w2v_ctc_loss=1.025, task_loss=2.384, contrastive_loss=0, total=4075, n_correct=2443.58, ppl=3.16, accuracy=59.965, wps=14584.9, ups=1.2, wpb=12158.5, bsz=427.2, num_updates=13200, lr=0.000123091, gnorm=0.381, clip=0, loss_scale=32, train_wall=83, gb_free=12.6, wall=11048
2023-08-24 05:20:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 05:20:35 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 4.198 | trans_loss 5.625 | nll_loss 2.92 | w2v_ctc_loss 1.318 | task_loss 11.506 | contrastive_loss 0 | total 4003.4 | n_correct 2429.4 | ppl 7.57 | accuracy 60.683 | uer 18.162 | wer 19.824 | raw_wer 19.824 | bleu 19.12 | wps 1655.7 | wpb 4003.4 | bsz 141.8 | num_updates 13260 | best_bleu 19.21
2023-08-24 05:20:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 13260 updates
2023-08-24 05:20:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.1200.pt
2023-08-24 05:20:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.1200.pt
2023-08-24 05:20:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.1200.pt (epoch 9 @ 13260 updates, score 19.12) (writing took 7.120951111079194 seconds)
2023-08-24 05:20:42 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-08-24 05:20:42 | INFO | train | epoch 009 | loss 1.94 | trans_loss 3.488 | nll_loss 1.643 | w2v_ctc_loss 1.018 | task_loss 2.195 | contrastive_loss 0 | total 4137.53 | n_correct 2492.73 | ppl 3.12 | accuracy 60.247 | wps 13770.7 | ups 1.11 | wpb 12352.5 | bsz 458 | num_updates 13260 | lr 0.000122813 | gnorm 0.379 | clip 0 | loss_scale 32 | train_wall 1222 | gb_free 11.4 | wall 11137
2023-08-24 05:20:43 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 05:20:43 | INFO | fairseq.trainer | begin training epoch 10
2023-08-24 05:20:43 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 05:21:23 | INFO | train_inner | epoch 010:     40 / 1474 loss=1.923, trans_loss=3.482, nll_loss=1.635, w2v_ctc_loss=1.001, task_loss=2.092, contrastive_loss=0, total=4088.59, n_correct=2478.15, ppl=3.11, accuracy=60.611, wps=9400.2, ups=0.77, wpb=12204, bsz=467.6, num_updates=13300, lr=0.000122628, gnorm=0.379, clip=0, loss_scale=32, train_wall=82, gb_free=16.8, wall=11178
2023-08-24 05:22:47 | INFO | train_inner | epoch 010:    140 / 1474 loss=1.895, trans_loss=3.454, nll_loss=1.6, w2v_ctc_loss=0.974, task_loss=2.068, contrastive_loss=0, total=4241, n_correct=2601.05, ppl=3.03, accuracy=61.331, wps=15092.5, ups=1.19, wpb=12666.9, bsz=480.3, num_updates=13400, lr=0.000122169, gnorm=0.37, clip=0, loss_scale=32, train_wall=83, gb_free=16, wall=11262
2023-08-24 05:24:11 | INFO | train_inner | epoch 010:    240 / 1474 loss=1.905, trans_loss=3.459, nll_loss=1.604, w2v_ctc_loss=0.985, task_loss=2.16, contrastive_loss=0, total=4135.58, n_correct=2531.33, ppl=3.04, accuracy=61.209, wps=14722.2, ups=1.19, wpb=12340.9, bsz=462.8, num_updates=13500, lr=0.000121716, gnorm=0.377, clip=0, loss_scale=32, train_wall=83, gb_free=12.6, wall=11345
2023-08-24 05:25:35 | INFO | train_inner | epoch 010:    340 / 1474 loss=1.899, trans_loss=3.458, nll_loss=1.608, w2v_ctc_loss=0.977, task_loss=2.215, contrastive_loss=0, total=4128.98, n_correct=2523.33, ppl=3.05, accuracy=61.113, wps=14670.2, ups=1.19, wpb=12340.4, bsz=453.3, num_updates=13600, lr=0.000121268, gnorm=0.379, clip=0, loss_scale=32, train_wall=84, gb_free=17.3, wall=11429
2023-08-24 05:26:59 | INFO | train_inner | epoch 010:    440 / 1474 loss=1.894, trans_loss=3.463, nll_loss=1.611, w2v_ctc_loss=0.967, task_loss=2.111, contrastive_loss=0, total=4204.32, n_correct=2569.16, ppl=3.06, accuracy=61.108, wps=14891.4, ups=1.19, wpb=12552.3, bsz=481.2, num_updates=13700, lr=0.000120824, gnorm=0.375, clip=0, loss_scale=32, train_wall=84, gb_free=15, wall=11514
2023-08-24 05:28:23 | INFO | train_inner | epoch 010:    540 / 1474 loss=1.925, trans_loss=3.478, nll_loss=1.625, w2v_ctc_loss=1.004, task_loss=2.337, contrastive_loss=0, total=4105.89, n_correct=2496.34, ppl=3.09, accuracy=60.799, wps=14564.4, ups=1.19, wpb=12242.4, bsz=439.7, num_updates=13800, lr=0.000120386, gnorm=0.381, clip=0, loss_scale=32, train_wall=83, gb_free=16.6, wall=11598
2023-08-24 05:29:47 | INFO | train_inner | epoch 010:    640 / 1474 loss=1.915, trans_loss=3.47, nll_loss=1.62, w2v_ctc_loss=0.994, task_loss=2.08, contrastive_loss=0, total=4173.95, n_correct=2544.85, ppl=3.07, accuracy=60.97, wps=14867.5, ups=1.19, wpb=12457.5, bsz=477.3, num_updates=13900, lr=0.000119952, gnorm=0.382, clip=0, loss_scale=32, train_wall=83, gb_free=17.6, wall=11682
2023-08-24 05:31:11 | INFO | train_inner | epoch 010:    740 / 1474 loss=1.926, trans_loss=3.475, nll_loss=1.625, w2v_ctc_loss=1.008, task_loss=2.217, contrastive_loss=0, total=4121.45, n_correct=2505.08, ppl=3.09, accuracy=60.782, wps=14709.2, ups=1.2, wpb=12301.6, bsz=451.9, num_updates=14000, lr=0.000119523, gnorm=0.386, clip=0, loss_scale=32, train_wall=83, gb_free=16.2, wall=11765
2023-08-24 05:31:11 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 05:31:43 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 4.193 | trans_loss 5.62 | nll_loss 2.913 | w2v_ctc_loss 1.311 | task_loss 11.472 | contrastive_loss 0 | total 4003.4 | n_correct 2444.2 | ppl 7.53 | accuracy 61.053 | uer 18.345 | wer 20.204 | raw_wer 20.204 | bleu 19.4 | wps 1667.4 | wpb 4003.4 | bsz 141.8 | num_updates 14000 | best_bleu 19.4
2023-08-24 05:31:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 14000 updates
2023-08-24 05:31:43 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_10_14000.pt
2023-08-24 05:31:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_10_14000.pt
2023-08-24 05:31:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_10_14000.pt (epoch 10 @ 14000 updates, score 19.4) (writing took 11.95630216889549 seconds)
2023-08-24 05:33:20 | INFO | train_inner | epoch 010:    840 / 1474 loss=1.904, trans_loss=3.468, nll_loss=1.62, w2v_ctc_loss=0.98, task_loss=2.162, contrastive_loss=0, total=4126.74, n_correct=2517.31, ppl=3.07, accuracy=61, wps=9551.1, ups=0.77, wpb=12324.6, bsz=456.3, num_updates=14100, lr=0.000119098, gnorm=0.375, clip=0, loss_scale=32, train_wall=83, gb_free=15.7, wall=11894
2023-08-24 05:34:43 | INFO | train_inner | epoch 010:    940 / 1474 loss=1.91, trans_loss=3.472, nll_loss=1.62, w2v_ctc_loss=0.988, task_loss=2.087, contrastive_loss=0, total=4169.25, n_correct=2541.85, ppl=3.07, accuracy=60.967, wps=15061.5, ups=1.21, wpb=12434.5, bsz=470.8, num_updates=14200, lr=0.000118678, gnorm=0.38, clip=0, loss_scale=32, train_wall=82, gb_free=17.2, wall=11977
2023-08-24 05:36:06 | INFO | train_inner | epoch 010:   1040 / 1474 loss=1.919, trans_loss=3.474, nll_loss=1.625, w2v_ctc_loss=0.995, task_loss=2.373, contrastive_loss=0, total=4076.84, n_correct=2473.83, ppl=3.09, accuracy=60.68, wps=14548.4, ups=1.2, wpb=12174.2, bsz=435.5, num_updates=14300, lr=0.000118262, gnorm=0.384, clip=0, loss_scale=32, train_wall=83, gb_free=16.5, wall=12061
2023-08-24 05:37:29 | INFO | train_inner | epoch 010:   1140 / 1474 loss=1.932, trans_loss=3.484, nll_loss=1.638, w2v_ctc_loss=1.008, task_loss=2.451, contrastive_loss=0, total=4035.21, n_correct=2438.8, ppl=3.11, accuracy=60.438, wps=14507.9, ups=1.2, wpb=12044.6, bsz=419.5, num_updates=14400, lr=0.000117851, gnorm=0.384, clip=0, loss_scale=64, train_wall=82, gb_free=16.8, wall=12144
2023-08-24 05:38:53 | INFO | train_inner | epoch 010:   1240 / 1474 loss=1.917, trans_loss=3.467, nll_loss=1.622, w2v_ctc_loss=0.998, task_loss=2.253, contrastive_loss=0, total=4099.89, n_correct=2497.06, ppl=3.08, accuracy=60.906, wps=14631.9, ups=1.19, wpb=12263, bsz=444.4, num_updates=14500, lr=0.000117444, gnorm=0.383, clip=0, loss_scale=64, train_wall=83, gb_free=17.2, wall=12227
2023-08-24 05:40:17 | INFO | train_inner | epoch 010:   1340 / 1474 loss=1.917, trans_loss=3.478, nll_loss=1.633, w2v_ctc_loss=0.994, task_loss=2.244, contrastive_loss=0, total=4126.18, n_correct=2506.09, ppl=3.1, accuracy=60.736, wps=14700.1, ups=1.19, wpb=12320.3, bsz=451, num_updates=14600, lr=0.000117041, gnorm=0.38, clip=0, loss_scale=64, train_wall=83, gb_free=16.4, wall=12311
2023-08-24 05:41:41 | INFO | train_inner | epoch 010:   1440 / 1474 loss=1.907, trans_loss=3.484, nll_loss=1.639, w2v_ctc_loss=0.978, task_loss=2.045, contrastive_loss=0, total=4198.18, n_correct=2546.36, ppl=3.11, accuracy=60.654, wps=14953.4, ups=1.19, wpb=12524.3, bsz=484.3, num_updates=14700, lr=0.000116642, gnorm=0.376, clip=0, loss_scale=64, train_wall=83, gb_free=12.2, wall=12395
2023-08-24 05:42:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 05:42:41 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 4.196 | trans_loss 5.608 | nll_loss 2.898 | w2v_ctc_loss 1.348 | task_loss 11.49 | contrastive_loss 0 | total 4003.4 | n_correct 2447 | ppl 7.45 | accuracy 61.123 | uer 17.88 | wer 19.727 | raw_wer 19.727 | bleu 19.61 | wps 1625 | wpb 4003.4 | bsz 141.8 | num_updates 14734 | best_bleu 19.61
2023-08-24 05:42:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 14734 updates
2023-08-24 05:42:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 05:42:47 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 05:42:52 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 10 @ 14734 updates, score 19.61) (writing took 10.953985142987221 seconds)
2023-08-24 05:42:53 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-08-24 05:42:53 | INFO | train | epoch 010 | loss 1.911 | trans_loss 3.47 | nll_loss 1.62 | w2v_ctc_loss 0.988 | task_loss 2.192 | contrastive_loss 0 | total 4138.65 | n_correct 2521.11 | ppl 3.07 | accuracy 60.916 | wps 13688.9 | ups 1.11 | wpb 12355.8 | bsz 458.5 | num_updates 14734 | lr 0.000116508 | gnorm 0.379 | clip 0 | loss_scale 64 | train_wall 1224 | gb_free 17.1 | wall 12467
2023-08-24 05:42:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 05:42:53 | INFO | fairseq.trainer | begin training epoch 11
2023-08-24 05:42:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 05:43:54 | INFO | train_inner | epoch 011:     66 / 1474 loss=1.884, trans_loss=3.448, nll_loss=1.591, w2v_ctc_loss=0.965, task_loss=2.046, contrastive_loss=0, total=4166.62, n_correct=2571.73, ppl=3.01, accuracy=61.722, wps=9302.3, ups=0.75, wpb=12438, bsz=477.4, num_updates=14800, lr=0.000116248, gnorm=0.378, clip=0, loss_scale=64, train_wall=81, gb_free=15.5, wall=12529
2023-08-24 05:45:17 | INFO | train_inner | epoch 011:    166 / 1474 loss=1.887, trans_loss=3.448, nll_loss=1.593, w2v_ctc_loss=0.967, task_loss=2.268, contrastive_loss=0, total=4086.7, n_correct=2517.74, ppl=3.02, accuracy=61.608, wps=14681.3, ups=1.2, wpb=12209.9, bsz=443.6, num_updates=14900, lr=0.000115857, gnorm=0.382, clip=0, loss_scale=64, train_wall=82, gb_free=15.1, wall=12612
2023-08-24 05:46:41 | INFO | train_inner | epoch 011:    266 / 1474 loss=1.875, trans_loss=3.444, nll_loss=1.588, w2v_ctc_loss=0.952, task_loss=2.239, contrastive_loss=0, total=4132.11, n_correct=2554.37, ppl=3.01, accuracy=61.818, wps=14738.6, ups=1.19, wpb=12339.9, bsz=449.7, num_updates=15000, lr=0.00011547, gnorm=0.374, clip=0, loss_scale=64, train_wall=83, gb_free=15.1, wall=12696
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 05:47:42 | INFO | train_inner | epoch 011:    366 / 1474 loss=2.076, trans_loss=5.135, nll_loss=2.376, w2v_ctc_loss=0.722, task_loss=3.405, contrastive_loss=0, total=4093.56, n_correct=2516.17, ppl=5.19, accuracy=61.467, wps=13596, ups=1.65, wpb=8217.8, bsz=295.7, num_updates=15100, lr=0.000115087, gnorm=0.504, clip=0, loss_scale=64, train_wall=60, gb_free=12.6, wall=12756
2023-08-24 05:48:42 | INFO | train_inner | epoch 011:    466 / 1474 loss=2.077, trans_loss=5.161, nll_loss=2.394, w2v_ctc_loss=0.71, task_loss=3.407, contrastive_loss=0, total=4117.22, n_correct=2522.5, ppl=5.26, accuracy=61.267, wps=13590.4, ups=1.65, wpb=8234.4, bsz=302.3, num_updates=15200, lr=0.000114708, gnorm=0.505, clip=0, loss_scale=64, train_wall=60, gb_free=17.7, wall=12817
2023-08-24 05:49:43 | INFO | train_inner | epoch 011:    566 / 1474 loss=2.083, trans_loss=5.162, nll_loss=2.395, w2v_ctc_loss=0.725, task_loss=3.567, contrastive_loss=0, total=4053.03, n_correct=2483.54, ppl=5.26, accuracy=61.276, wps=13396.4, ups=1.65, wpb=8106.1, bsz=290.3, num_updates=15300, lr=0.000114332, gnorm=0.518, clip=0, loss_scale=64, train_wall=60, gb_free=17.6, wall=12877
2023-08-24 05:50:43 | INFO | train_inner | epoch 011:    666 / 1474 loss=2.079, trans_loss=5.16, nll_loss=2.395, w2v_ctc_loss=0.718, task_loss=3.266, contrastive_loss=0, total=4152.19, n_correct=2542.81, ppl=5.26, accuracy=61.24, wps=13742.9, ups=1.65, wpb=8304.4, bsz=307.4, num_updates=15400, lr=0.000113961, gnorm=0.504, clip=0, loss_scale=64, train_wall=60, gb_free=17, wall=12938
2023-08-24 05:51:44 | INFO | train_inner | epoch 011:    766 / 1474 loss=2.083, trans_loss=5.168, nll_loss=2.405, w2v_ctc_loss=0.729, task_loss=3.304, contrastive_loss=0, total=4170.37, n_correct=2562.6, ppl=5.3, accuracy=61.448, wps=13732.3, ups=1.65, wpb=8340.7, bsz=305.8, num_updates=15500, lr=0.000113592, gnorm=0.506, clip=0, loss_scale=64, train_wall=60, gb_free=15.8, wall=12998
2023-08-24 05:52:45 | INFO | train_inner | epoch 011:    866 / 1474 loss=2.083, trans_loss=5.17, nll_loss=2.407, w2v_ctc_loss=0.724, task_loss=3.369, contrastive_loss=0, total=4134.37, n_correct=2531.18, ppl=5.31, accuracy=61.223, wps=13628.6, ups=1.65, wpb=8268.7, bsz=298.4, num_updates=15600, lr=0.000113228, gnorm=0.504, clip=0, loss_scale=64, train_wall=60, gb_free=15.5, wall=13059
2023-08-24 05:53:45 | INFO | train_inner | epoch 011:    966 / 1474 loss=2.085, trans_loss=5.171, nll_loss=2.41, w2v_ctc_loss=0.731, task_loss=3.346, contrastive_loss=0, total=4147.96, n_correct=2535.86, ppl=5.32, accuracy=61.135, wps=13718.2, ups=1.65, wpb=8295.9, bsz=302.3, num_updates=15700, lr=0.000112867, gnorm=0.515, clip=0, loss_scale=64, train_wall=60, gb_free=11.6, wall=13119
2023-08-24 05:54:45 | INFO | train_inner | epoch 011:   1066 / 1474 loss=2.081, trans_loss=5.164, nll_loss=2.401, w2v_ctc_loss=0.732, task_loss=3.242, contrastive_loss=0, total=4135.97, n_correct=2538.62, ppl=5.28, accuracy=61.379, wps=13734.1, ups=1.66, wpb=8271.9, bsz=309.4, num_updates=15800, lr=0.000112509, gnorm=0.506, clip=0, loss_scale=64, train_wall=59, gb_free=12.9, wall=13180
2023-08-24 05:55:46 | INFO | train_inner | epoch 011:   1166 / 1474 loss=2.083, trans_loss=5.172, nll_loss=2.411, w2v_ctc_loss=0.729, task_loss=3.32, contrastive_loss=0, total=4168.11, n_correct=2553.47, ppl=5.32, accuracy=61.262, wps=13833.4, ups=1.66, wpb=8336.2, bsz=306.2, num_updates=15900, lr=0.000112154, gnorm=0.506, clip=0, loss_scale=64, train_wall=60, gb_free=14.7, wall=13240
2023-08-24 05:56:46 | INFO | train_inner | epoch 011:   1266 / 1474 loss=2.085, trans_loss=5.169, nll_loss=2.41, w2v_ctc_loss=0.736, task_loss=3.118, contrastive_loss=0, total=4185.89, n_correct=2559.39, ppl=5.31, accuracy=61.143, wps=13844.7, ups=1.65, wpb=8371.8, bsz=317.9, num_updates=16000, lr=0.000111803, gnorm=0.501, clip=0, loss_scale=64, train_wall=60, gb_free=16, wall=13300
2023-08-24 05:56:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
2023-08-24 05:57:19 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 4.206 | trans_loss 5.609 | nll_loss 2.899 | w2v_ctc_loss 1.379 | task_loss 11.654 | contrastive_loss 0 | total 4003.4 | n_correct 2452.1 | ppl 7.46 | accuracy 61.25 | uer 17.854 | wer 19.451 | raw_wer 19.451 | bleu 19.42 | wps 1633.1 | wpb 4003.4 | bsz 141.8 | num_updates 16000 | best_bleu 19.61
2023-08-24 05:57:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 16000 updates
2023-08-24 05:57:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_11_16000.pt
2023-08-24 05:57:22 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_11_16000.pt
2023-08-24 05:57:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_11_16000.pt (epoch 11 @ 16000 updates, score 19.42) (writing took 7.674199994071387 seconds)
2023-08-24 05:57:53 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 05:58:30 | INFO | train_inner | epoch 011:   1367 / 1474 loss=2.078, trans_loss=5.168, nll_loss=2.408, w2v_ctc_loss=0.72, task_loss=3.04, contrastive_loss=0, total=4185.49, n_correct=2562.82, ppl=5.31, accuracy=61.231, wps=8078, ups=0.97, wpb=8371, bsz=326.8, num_updates=16100, lr=0.000111456, gnorm=0.5, clip=0, loss_scale=32, train_wall=61, gb_free=17.1, wall=13404
2023-08-24 05:59:30 | INFO | train_inner | epoch 011:   1467 / 1474 loss=2.081, trans_loss=5.171, nll_loss=2.412, w2v_ctc_loss=0.725, task_loss=3.211, contrastive_loss=0, total=4154.28, n_correct=2544.82, ppl=5.32, accuracy=61.258, wps=13729.5, ups=1.65, wpb=8308.6, bsz=310.4, num_updates=16200, lr=0.000111111, gnorm=0.506, clip=0, loss_scale=32, train_wall=60, gb_free=15.7, wall=13465
2023-08-24 05:59:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 06:00:07 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 4.187 | trans_loss 5.594 | nll_loss 2.88 | w2v_ctc_loss 1.352 | task_loss 11.633 | contrastive_loss 0 | total 4003.4 | n_correct 2455.4 | ppl 7.36 | accuracy 61.333 | uer 18.066 | wer 19.813 | raw_wer 19.813 | bleu 19.64 | wps 1636.4 | wpb 4003.4 | bsz 141.8 | num_updates 16207 | best_bleu 19.64
2023-08-24 06:00:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 16207 updates
2023-08-24 06:00:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:00:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:00:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 11 @ 16207 updates, score 19.64) (writing took 9.903887499007396 seconds)
2023-08-24 06:00:17 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-08-24 06:00:17 | INFO | train | epoch 011 | loss 2.032 | trans_loss 4.739 | nll_loss 2.201 | w2v_ctc_loss 0.783 | task_loss 3.019 | contrastive_loss 0 | total 4138.22 | n_correct 2539.65 | ppl 4.6 | accuracy 61.371 | wps 12714 | ups 1.41 | wpb 9014.8 | bsz 333.1 | num_updates 16207 | lr 0.000111087 | gnorm 0.483 | clip 0 | loss_scale 32 | train_wall 942 | gb_free 17.1 | wall 13512
2023-08-24 06:00:17 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 06:00:17 | INFO | fairseq.trainer | begin training epoch 12
2023-08-24 06:00:17 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 06:01:20 | INFO | train_inner | epoch 012:     93 / 1474 loss=2.052, trans_loss=5.114, nll_loss=2.335, w2v_ctc_loss=0.707, task_loss=3.113, contrastive_loss=0, total=4151.96, n_correct=2588.46, ppl=5.05, accuracy=62.343, wps=7574.5, ups=0.91, wpb=8303.9, bsz=315.5, num_updates=16300, lr=0.00011077, gnorm=0.502, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=13574
2023-08-24 06:02:20 | INFO | train_inner | epoch 012:    193 / 1474 loss=2.064, trans_loss=5.125, nll_loss=2.348, w2v_ctc_loss=0.718, task_loss=3.425, contrastive_loss=0, total=4115.75, n_correct=2552.73, ppl=5.09, accuracy=62.023, wps=13806, ups=1.68, wpb=8231.5, bsz=293.8, num_updates=16400, lr=0.000110432, gnorm=0.508, clip=0, loss_scale=32, train_wall=59, gb_free=17.4, wall=13634
2023-08-24 06:03:20 | INFO | train_inner | epoch 012:    293 / 1474 loss=2.052, trans_loss=5.12, nll_loss=2.343, w2v_ctc_loss=0.702, task_loss=3.075, contrastive_loss=0, total=4203.07, n_correct=2614.4, ppl=5.07, accuracy=62.202, wps=13952.1, ups=1.66, wpb=8406.1, bsz=321, num_updates=16500, lr=0.000110096, gnorm=0.497, clip=0, loss_scale=32, train_wall=60, gb_free=14.3, wall=13694
2023-08-24 06:04:21 | INFO | train_inner | epoch 012:    393 / 1474 loss=2.063, trans_loss=5.132, nll_loss=2.358, w2v_ctc_loss=0.716, task_loss=3.247, contrastive_loss=0, total=4148.54, n_correct=2571.07, ppl=5.13, accuracy=61.975, wps=13577, ups=1.64, wpb=8297.1, bsz=306.7, num_updates=16600, lr=0.000109764, gnorm=0.505, clip=0, loss_scale=32, train_wall=61, gb_free=15.8, wall=13755
2023-08-24 06:05:21 | INFO | train_inner | epoch 012:    493 / 1474 loss=2.074, trans_loss=5.149, nll_loss=2.381, w2v_ctc_loss=0.725, task_loss=3.257, contrastive_loss=0, total=4114.61, n_correct=2537.4, ppl=5.21, accuracy=61.668, wps=13750.3, ups=1.67, wpb=8229.2, bsz=303.7, num_updates=16700, lr=0.000109435, gnorm=0.503, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=13815
2023-08-24 06:06:22 | INFO | train_inner | epoch 012:    593 / 1474 loss=2.066, trans_loss=5.138, nll_loss=2.368, w2v_ctc_loss=0.718, task_loss=3.175, contrastive_loss=0, total=4193.09, n_correct=2592.53, ppl=5.16, accuracy=61.829, wps=13803.7, ups=1.65, wpb=8386.2, bsz=314.8, num_updates=16800, lr=0.000109109, gnorm=0.506, clip=0, loss_scale=32, train_wall=60, gb_free=16.3, wall=13876
2023-08-24 06:07:21 | INFO | train_inner | epoch 012:    693 / 1474 loss=2.053, trans_loss=5.133, nll_loss=2.362, w2v_ctc_loss=0.697, task_loss=3.063, contrastive_loss=0, total=4189.86, n_correct=2601.42, ppl=5.14, accuracy=62.088, wps=13982.1, ups=1.67, wpb=8379.7, bsz=321.2, num_updates=16900, lr=0.000108786, gnorm=0.495, clip=0, loss_scale=32, train_wall=59, gb_free=16.6, wall=13936
2023-08-24 06:08:22 | INFO | train_inner | epoch 012:    793 / 1474 loss=2.063, trans_loss=5.132, nll_loss=2.36, w2v_ctc_loss=0.719, task_loss=3.314, contrastive_loss=0, total=4099.87, n_correct=2543.31, ppl=5.13, accuracy=62.034, wps=13576.5, ups=1.66, wpb=8199.7, bsz=300.6, num_updates=17000, lr=0.000108465, gnorm=0.512, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=13996
2023-08-24 06:09:23 | INFO | train_inner | epoch 012:    893 / 1474 loss=2.066, trans_loss=5.143, nll_loss=2.374, w2v_ctc_loss=0.715, task_loss=3.37, contrastive_loss=0, total=4159.64, n_correct=2574.53, ppl=5.18, accuracy=61.893, wps=13589.2, ups=1.63, wpb=8319.3, bsz=305.7, num_updates=17100, lr=0.000108148, gnorm=0.508, clip=0, loss_scale=32, train_wall=61, gb_free=16, wall=14057
2023-08-24 06:10:23 | INFO | train_inner | epoch 012:    993 / 1474 loss=2.074, trans_loss=5.152, nll_loss=2.385, w2v_ctc_loss=0.724, task_loss=3.368, contrastive_loss=0, total=4115.42, n_correct=2536.5, ppl=5.22, accuracy=61.634, wps=13631.6, ups=1.66, wpb=8230.8, bsz=300.1, num_updates=17200, lr=0.000107833, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=17.7, wall=14118
2023-08-24 06:11:24 | INFO | train_inner | epoch 012:   1093 / 1474 loss=2.077, trans_loss=5.154, nll_loss=2.389, w2v_ctc_loss=0.726, task_loss=3.415, contrastive_loss=0, total=4049.99, n_correct=2492.58, ppl=5.24, accuracy=61.545, wps=13467.5, ups=1.66, wpb=8100, bsz=291.8, num_updates=17300, lr=0.000107521, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=16.8, wall=14178
2023-08-24 06:12:24 | INFO | train_inner | epoch 012:   1193 / 1474 loss=2.08, trans_loss=5.165, nll_loss=2.404, w2v_ctc_loss=0.734, task_loss=3.265, contrastive_loss=0, total=4185.54, n_correct=2567.76, ppl=5.29, accuracy=61.348, wps=13839.3, ups=1.65, wpb=8371.1, bsz=313.6, num_updates=17400, lr=0.000107211, gnorm=0.504, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=14238
2023-08-24 06:13:25 | INFO | train_inner | epoch 012:   1293 / 1474 loss=2.078, trans_loss=5.152, nll_loss=2.386, w2v_ctc_loss=0.733, task_loss=3.564, contrastive_loss=0, total=4092.3, n_correct=2518.94, ppl=5.23, accuracy=61.553, wps=13534.9, ups=1.65, wpb=8184.6, bsz=292.6, num_updates=17500, lr=0.000106904, gnorm=0.512, clip=0, loss_scale=32, train_wall=60, gb_free=16, wall=14299
2023-08-24 06:14:25 | INFO | train_inner | epoch 012:   1393 / 1474 loss=2.067, trans_loss=5.154, nll_loss=2.39, w2v_ctc_loss=0.709, task_loss=3.319, contrastive_loss=0, total=4134.01, n_correct=2547.98, ppl=5.24, accuracy=61.635, wps=13723.1, ups=1.66, wpb=8268, bsz=305.1, num_updates=17600, lr=0.0001066, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=17.6, wall=14359
2023-08-24 06:15:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 06:15:47 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 4.183 | trans_loss 5.59 | nll_loss 2.876 | w2v_ctc_loss 1.344 | task_loss 11.55 | contrastive_loss 0 | total 4003.4 | n_correct 2458 | ppl 7.34 | accuracy 61.398 | uer 17.798 | wer 19.492 | raw_wer 19.492 | bleu 19.27 | wps 1643.2 | wpb 4003.4 | bsz 141.8 | num_updates 17681 | best_bleu 19.64
2023-08-24 06:15:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 17681 updates
2023-08-24 06:15:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.2709.pt
2023-08-24 06:15:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.2709.pt
2023-08-24 06:15:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.2709.pt (epoch 12 @ 17681 updates, score 19.27) (writing took 6.729702991084196 seconds)
2023-08-24 06:15:54 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-08-24 06:15:54 | INFO | train | epoch 012 | loss 2.067 | trans_loss 5.141 | nll_loss 2.372 | w2v_ctc_loss 0.718 | task_loss 3.287 | contrastive_loss 0 | total 4138.65 | n_correct 2558.96 | ppl 5.18 | accuracy 61.831 | wps 13023.4 | ups 1.57 | wpb 8277.3 | bsz 305.7 | num_updates 17681 | lr 0.000106356 | gnorm 0.506 | clip 0 | loss_scale 32 | train_wall 880 | gb_free 12.7 | wall 14448
2023-08-24 06:15:54 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 06:15:54 | INFO | fairseq.trainer | begin training epoch 13
2023-08-24 06:15:54 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 06:16:14 | INFO | train_inner | epoch 013:     19 / 1474 loss=2.077, trans_loss=5.157, nll_loss=2.394, w2v_ctc_loss=0.73, task_loss=3.416, contrastive_loss=0, total=4100.58, n_correct=2528.02, ppl=5.26, accuracy=61.65, wps=7541.8, ups=0.92, wpb=8201.2, bsz=296, num_updates=17700, lr=0.000106299, gnorm=0.509, clip=0, loss_scale=32, train_wall=60, gb_free=17.5, wall=14468
2023-08-24 06:17:14 | INFO | train_inner | epoch 013:    119 / 1474 loss=2.048, trans_loss=5.106, nll_loss=2.324, w2v_ctc_loss=0.703, task_loss=3.284, contrastive_loss=0, total=4161.46, n_correct=2602.54, ppl=5.01, accuracy=62.539, wps=13821.5, ups=1.66, wpb=8322.9, bsz=302.8, num_updates=17800, lr=0.000106, gnorm=0.498, clip=0, loss_scale=32, train_wall=60, gb_free=16.1, wall=14528
2023-08-24 06:18:14 | INFO | train_inner | epoch 013:    219 / 1474 loss=2.051, trans_loss=5.12, nll_loss=2.346, w2v_ctc_loss=0.706, task_loss=3.04, contrastive_loss=0, total=4208.4, n_correct=2621.11, ppl=5.08, accuracy=62.283, wps=13887.4, ups=1.65, wpb=8416.8, bsz=328.7, num_updates=17900, lr=0.000105703, gnorm=0.505, clip=0, loss_scale=32, train_wall=60, gb_free=14, wall=14589
2023-08-24 06:19:15 | INFO | train_inner | epoch 013:    319 / 1474 loss=2.046, trans_loss=5.105, nll_loss=2.324, w2v_ctc_loss=0.698, task_loss=3.38, contrastive_loss=0, total=4109.49, n_correct=2576.28, ppl=5.01, accuracy=62.691, wps=13627, ups=1.66, wpb=8219, bsz=296.3, num_updates=18000, lr=0.000105409, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=16.1, wall=14649
2023-08-24 06:19:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 06:19:47 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 4.185 | trans_loss 5.602 | nll_loss 2.888 | w2v_ctc_loss 1.327 | task_loss 11.514 | contrastive_loss 0 | total 4003.4 | n_correct 2457.3 | ppl 7.4 | accuracy 61.38 | uer 17.88 | wer 19.664 | raw_wer 19.664 | bleu 19.42 | wps 1635 | wpb 4003.4 | bsz 141.8 | num_updates 18000 | best_bleu 19.64
2023-08-24 06:19:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 18000 updates
2023-08-24 06:19:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_13_18000.pt
2023-08-24 06:19:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_13_18000.pt
2023-08-24 06:19:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_13_18000.pt (epoch 13 @ 18000 updates, score 19.42) (writing took 7.387859735987149 seconds)
2023-08-24 06:20:55 | INFO | train_inner | epoch 013:    419 / 1474 loss=2.046, trans_loss=5.114, nll_loss=2.336, w2v_ctc_loss=0.703, task_loss=3.09, contrastive_loss=0, total=4181.75, n_correct=2616.27, ppl=5.05, accuracy=62.564, wps=8343.9, ups=1, wpb=8363.5, bsz=317.7, num_updates=18100, lr=0.000105118, gnorm=0.502, clip=0, loss_scale=64, train_wall=59, gb_free=16.6, wall=14749
2023-08-24 06:21:56 | INFO | train_inner | epoch 013:    519 / 1474 loss=2.054, trans_loss=5.122, nll_loss=2.347, w2v_ctc_loss=0.711, task_loss=3.233, contrastive_loss=0, total=4185.88, n_correct=2604.52, ppl=5.09, accuracy=62.222, wps=13655.8, ups=1.63, wpb=8371.8, bsz=315.4, num_updates=18200, lr=0.000104828, gnorm=0.503, clip=0, loss_scale=64, train_wall=60, gb_free=14.6, wall=14811
2023-08-24 06:22:56 | INFO | train_inner | epoch 013:    619 / 1474 loss=2.042, trans_loss=5.111, nll_loss=2.334, w2v_ctc_loss=0.697, task_loss=3.141, contrastive_loss=0, total=4165.77, n_correct=2608.96, ppl=5.04, accuracy=62.629, wps=13894.2, ups=1.67, wpb=8331.5, bsz=311.3, num_updates=18300, lr=0.000104542, gnorm=0.502, clip=0, loss_scale=64, train_wall=59, gb_free=14.1, wall=14871
2023-08-24 06:23:57 | INFO | train_inner | epoch 013:    719 / 1474 loss=2.067, trans_loss=5.128, nll_loss=2.354, w2v_ctc_loss=0.726, task_loss=3.645, contrastive_loss=0, total=4104.39, n_correct=2548.9, ppl=5.11, accuracy=62.102, wps=13590.3, ups=1.66, wpb=8208.8, bsz=285.6, num_updates=18400, lr=0.000104257, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=11.9, wall=14931
2023-08-24 06:24:58 | INFO | train_inner | epoch 013:    819 / 1474 loss=2.056, trans_loss=5.127, nll_loss=2.355, w2v_ctc_loss=0.706, task_loss=3.342, contrastive_loss=0, total=4124.92, n_correct=2563.73, ppl=5.11, accuracy=62.152, wps=13539.4, ups=1.64, wpb=8249.8, bsz=306.3, num_updates=18500, lr=0.000103975, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=16.6, wall=14992
2023-08-24 06:25:58 | INFO | train_inner | epoch 013:    919 / 1474 loss=2.058, trans_loss=5.133, nll_loss=2.361, w2v_ctc_loss=0.707, task_loss=3.369, contrastive_loss=0, total=4100.02, n_correct=2549.63, ppl=5.14, accuracy=62.186, wps=13654, ups=1.67, wpb=8200, bsz=295.8, num_updates=18600, lr=0.000103695, gnorm=0.51, clip=0, loss_scale=64, train_wall=59, gb_free=11.8, wall=15052
2023-08-24 06:26:58 | INFO | train_inner | epoch 013:   1019 / 1474 loss=2.067, trans_loss=5.135, nll_loss=2.365, w2v_ctc_loss=0.722, task_loss=3.502, contrastive_loss=0, total=4076.33, n_correct=2529.33, ppl=5.15, accuracy=62.049, wps=13428.8, ups=1.65, wpb=8152.7, bsz=291.6, num_updates=18700, lr=0.000103418, gnorm=0.522, clip=0, loss_scale=64, train_wall=60, gb_free=16.7, wall=15113
2023-08-24 06:27:59 | INFO | train_inner | epoch 013:   1119 / 1474 loss=2.054, trans_loss=5.125, nll_loss=2.353, w2v_ctc_loss=0.707, task_loss=3.276, contrastive_loss=0, total=4100.28, n_correct=2555.39, ppl=5.11, accuracy=62.322, wps=13602, ups=1.66, wpb=8200.6, bsz=304.1, num_updates=18800, lr=0.000103142, gnorm=0.506, clip=0, loss_scale=64, train_wall=60, gb_free=11.5, wall=15173
2023-08-24 06:28:59 | INFO | train_inner | epoch 013:   1219 / 1474 loss=2.061, trans_loss=5.136, nll_loss=2.367, w2v_ctc_loss=0.714, task_loss=3.442, contrastive_loss=0, total=4120.06, n_correct=2560.52, ppl=5.16, accuracy=62.148, wps=13715.8, ups=1.66, wpb=8240.1, bsz=298.6, num_updates=18900, lr=0.000102869, gnorm=0.514, clip=0, loss_scale=64, train_wall=59, gb_free=17.6, wall=15233
2023-08-24 06:29:59 | INFO | train_inner | epoch 013:   1319 / 1474 loss=2.053, trans_loss=5.124, nll_loss=2.352, w2v_ctc_loss=0.708, task_loss=3.24, contrastive_loss=0, total=4114.06, n_correct=2565.78, ppl=5.11, accuracy=62.366, wps=13670.5, ups=1.66, wpb=8228.1, bsz=307.9, num_updates=19000, lr=0.000102598, gnorm=0.509, clip=0, loss_scale=64, train_wall=59, gb_free=12.5, wall=15293
2023-08-24 06:30:59 | INFO | train_inner | epoch 013:   1419 / 1474 loss=2.056, trans_loss=5.136, nll_loss=2.369, w2v_ctc_loss=0.702, task_loss=3.195, contrastive_loss=0, total=4182.79, n_correct=2599.84, ppl=5.17, accuracy=62.156, wps=13915.7, ups=1.66, wpb=8365.6, bsz=313.3, num_updates=19100, lr=0.000102329, gnorm=0.501, clip=0, loss_scale=64, train_wall=59, gb_free=15.6, wall=15353
2023-08-24 06:31:33 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 06:32:06 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 4.167 | trans_loss 5.585 | nll_loss 2.865 | w2v_ctc_loss 1.306 | task_loss 11.504 | contrastive_loss 0 | total 4003.4 | n_correct 2466.8 | ppl 7.29 | accuracy 61.618 | uer 17.461 | wer 19.239 | raw_wer 19.239 | bleu 19.67 | wps 1598.6 | wpb 4003.4 | bsz 141.8 | num_updates 19155 | best_bleu 19.67
2023-08-24 06:32:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 19155 updates
2023-08-24 06:32:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:32:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:32:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 13 @ 19155 updates, score 19.67) (writing took 10.878723558038473 seconds)
2023-08-24 06:32:17 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-08-24 06:32:17 | INFO | train | epoch 013 | loss 2.054 | trans_loss 5.123 | nll_loss 2.349 | w2v_ctc_loss 0.708 | task_loss 3.286 | contrastive_loss 0 | total 4138.65 | n_correct 2579.04 | ppl 5.09 | accuracy 62.316 | wps 12408.1 | ups 1.5 | wpb 8277.3 | bsz 305.7 | num_updates 19155 | lr 0.000102182 | gnorm 0.508 | clip 0 | loss_scale 64 | train_wall 879 | gb_free 17.6 | wall 15432
2023-08-24 06:32:18 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 06:32:18 | INFO | fairseq.trainer | begin training epoch 14
2023-08-24 06:32:18 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 06:32:51 | INFO | train_inner | epoch 014:     45 / 1474 loss=2.039, trans_loss=5.098, nll_loss=2.319, w2v_ctc_loss=0.703, task_loss=3.032, contrastive_loss=0, total=4162.33, n_correct=2615.1, ppl=4.99, accuracy=62.828, wps=7403, ups=0.89, wpb=8324.7, bsz=319.9, num_updates=19200, lr=0.000102062, gnorm=0.503, clip=0, loss_scale=64, train_wall=60, gb_free=15.3, wall=15466
2023-08-24 06:33:52 | INFO | train_inner | epoch 014:    145 / 1474 loss=2.028, trans_loss=5.077, nll_loss=2.29, w2v_ctc_loss=0.688, task_loss=3.319, contrastive_loss=0, total=4091.57, n_correct=2589.62, ppl=4.89, accuracy=63.292, wps=13624.4, ups=1.66, wpb=8183.1, bsz=299.3, num_updates=19300, lr=0.000101797, gnorm=0.499, clip=0, loss_scale=64, train_wall=59, gb_free=13.4, wall=15526
2023-08-24 06:34:51 | INFO | train_inner | epoch 014:    245 / 1474 loss=2.039, trans_loss=5.097, nll_loss=2.315, w2v_ctc_loss=0.692, task_loss=3.416, contrastive_loss=0, total=4111.46, n_correct=2586.78, ppl=4.98, accuracy=62.916, wps=13750.1, ups=1.67, wpb=8222.9, bsz=295.7, num_updates=19400, lr=0.000101535, gnorm=0.51, clip=0, loss_scale=64, train_wall=59, gb_free=17.7, wall=15586
2023-08-24 06:35:51 | INFO | train_inner | epoch 014:    345 / 1474 loss=2.033, trans_loss=5.09, nll_loss=2.307, w2v_ctc_loss=0.694, task_loss=3.059, contrastive_loss=0, total=4172.59, n_correct=2629.13, ppl=4.95, accuracy=63.01, wps=13911.9, ups=1.67, wpb=8345.2, bsz=320.2, num_updates=19500, lr=0.000101274, gnorm=0.504, clip=0, loss_scale=64, train_wall=59, gb_free=11.7, wall=15646
2023-08-24 06:36:52 | INFO | train_inner | epoch 014:    445 / 1474 loss=2.042, trans_loss=5.105, nll_loss=2.326, w2v_ctc_loss=0.695, task_loss=3.403, contrastive_loss=0, total=4108.61, n_correct=2575.34, ppl=5.01, accuracy=62.682, wps=13652, ups=1.66, wpb=8217.2, bsz=294.5, num_updates=19600, lr=0.000101015, gnorm=0.505, clip=0, loss_scale=64, train_wall=60, gb_free=16.3, wall=15706
2023-08-24 06:37:53 | INFO | train_inner | epoch 014:    545 / 1474 loss=2.05, trans_loss=5.108, nll_loss=2.329, w2v_ctc_loss=0.713, task_loss=3.421, contrastive_loss=0, total=4103.97, n_correct=2568.28, ppl=5.03, accuracy=62.58, wps=13462.4, ups=1.64, wpb=8207.9, bsz=298.7, num_updates=19700, lr=0.000100759, gnorm=0.51, clip=0, loss_scale=64, train_wall=60, gb_free=16.4, wall=15767
2023-08-24 06:38:53 | INFO | train_inner | epoch 014:    645 / 1474 loss=2.045, trans_loss=5.109, nll_loss=2.331, w2v_ctc_loss=0.701, task_loss=3.288, contrastive_loss=0, total=4158.28, n_correct=2604.86, ppl=5.03, accuracy=62.643, wps=13680.5, ups=1.64, wpb=8316.6, bsz=307.1, num_updates=19800, lr=0.000100504, gnorm=0.508, clip=0, loss_scale=64, train_wall=60, gb_free=15.9, wall=15828
2023-08-24 06:39:53 | INFO | train_inner | epoch 014:    745 / 1474 loss=2.038, trans_loss=5.1, nll_loss=2.319, w2v_ctc_loss=0.697, task_loss=3.201, contrastive_loss=0, total=4149.79, n_correct=2608.76, ppl=4.99, accuracy=62.865, wps=13899.4, ups=1.67, wpb=8299.6, bsz=309.9, num_updates=19900, lr=0.000100251, gnorm=0.505, clip=0, loss_scale=64, train_wall=59, gb_free=15.4, wall=15887
2023-08-24 06:40:53 | INFO | train_inner | epoch 014:    845 / 1474 loss=2.034, trans_loss=5.096, nll_loss=2.316, w2v_ctc_loss=0.691, task_loss=3.124, contrastive_loss=0, total=4165.7, n_correct=2620.01, ppl=4.98, accuracy=62.895, wps=13902.6, ups=1.67, wpb=8331.4, bsz=318.2, num_updates=20000, lr=0.0001, gnorm=0.504, clip=0, loss_scale=64, train_wall=59, gb_free=12.2, wall=15947
2023-08-24 06:40:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 06:41:26 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 4.185 | trans_loss 5.582 | nll_loss 2.861 | w2v_ctc_loss 1.372 | task_loss 11.544 | contrastive_loss 0 | total 4003.4 | n_correct 2469.5 | ppl 7.27 | accuracy 61.685 | uer 17.864 | wer 19.761 | raw_wer 19.761 | bleu 19.71 | wps 1646.5 | wpb 4003.4 | bsz 141.8 | num_updates 20000 | best_bleu 19.71
2023-08-24 06:41:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 20000 updates
2023-08-24 06:41:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_14_20000.pt
2023-08-24 06:41:28 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_14_20000.pt
2023-08-24 06:41:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_14_20000.pt (epoch 14 @ 20000 updates, score 19.71) (writing took 11.191010124981403 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 06:42:38 | INFO | train_inner | epoch 014:    945 / 1474 loss=2.044, trans_loss=5.109, nll_loss=2.333, w2v_ctc_loss=0.703, task_loss=3.351, contrastive_loss=0, total=4148.78, n_correct=2596.27, ppl=5.04, accuracy=62.579, wps=7884.4, ups=0.95, wpb=8297.6, bsz=304.9, num_updates=20100, lr=9.97509e-05, gnorm=0.509, clip=0, loss_scale=64, train_wall=60, gb_free=16.2, wall=16053
2023-08-24 06:43:39 | INFO | train_inner | epoch 014:   1045 / 1474 loss=2.048, trans_loss=5.117, nll_loss=2.343, w2v_ctc_loss=0.698, task_loss=3.274, contrastive_loss=0, total=4165.56, n_correct=2601.09, ppl=5.07, accuracy=62.443, wps=13647.8, ups=1.64, wpb=8331.1, bsz=306.4, num_updates=20200, lr=9.95037e-05, gnorm=0.501, clip=0, loss_scale=128, train_wall=60, gb_free=16.4, wall=16114
2023-08-24 06:44:40 | INFO | train_inner | epoch 014:   1145 / 1474 loss=2.045, trans_loss=5.11, nll_loss=2.337, w2v_ctc_loss=0.701, task_loss=3.099, contrastive_loss=0, total=4220.71, n_correct=2636.49, ppl=5.05, accuracy=62.466, wps=13820.4, ups=1.64, wpb=8441.4, bsz=325.5, num_updates=20300, lr=9.92583e-05, gnorm=0.505, clip=0, loss_scale=128, train_wall=60, gb_free=15.9, wall=16175
2023-08-24 06:45:40 | INFO | train_inner | epoch 014:   1245 / 1474 loss=2.065, trans_loss=5.132, nll_loss=2.361, w2v_ctc_loss=0.721, task_loss=3.78, contrastive_loss=0, total=4038.97, n_correct=2509.62, ppl=5.14, accuracy=62.135, wps=13439.6, ups=1.66, wpb=8077.9, bsz=276.2, num_updates=20400, lr=9.90148e-05, gnorm=0.525, clip=0, loss_scale=128, train_wall=60, gb_free=15.8, wall=16235
2023-08-24 06:46:41 | INFO | train_inner | epoch 014:   1345 / 1474 loss=2.048, trans_loss=5.12, nll_loss=2.347, w2v_ctc_loss=0.701, task_loss=3.221, contrastive_loss=0, total=4182.25, n_correct=2612.74, ppl=5.09, accuracy=62.472, wps=13892.8, ups=1.66, wpb=8364.5, bsz=309.9, num_updates=20500, lr=9.8773e-05, gnorm=0.508, clip=0, loss_scale=128, train_wall=60, gb_free=17.7, wall=16295
2023-08-24 06:47:07 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-24 06:47:41 | INFO | train_inner | epoch 014:   1446 / 1474 loss=2.048, trans_loss=5.125, nll_loss=2.354, w2v_ctc_loss=0.699, task_loss=3.236, contrastive_loss=0, total=4141.73, n_correct=2587.54, ppl=5.11, accuracy=62.475, wps=13695.7, ups=1.65, wpb=8283.5, bsz=306.7, num_updates=20600, lr=9.85329e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=60, gb_free=16.1, wall=16355
2023-08-24 06:47:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
2023-08-24 06:48:30 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 4.171 | trans_loss 5.58 | nll_loss 2.864 | w2v_ctc_loss 1.33 | task_loss 11.476 | contrastive_loss 0 | total 4003.4 | n_correct 2472.9 | ppl 7.28 | accuracy 61.77 | uer 17.62 | wer 19.488 | raw_wer 19.488 | bleu 19.98 | wps 1683.7 | wpb 4003.4 | bsz 141.8 | num_updates 20628 | best_bleu 19.98
2023-08-24 06:48:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 20628 updates
2023-08-24 06:48:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:48:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 06:48:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 14 @ 20628 updates, score 19.98) (writing took 11.2461009810213 seconds)
2023-08-24 06:48:42 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2023-08-24 06:48:42 | INFO | train | epoch 014 | loss 2.043 | trans_loss 5.106 | nll_loss 2.329 | w2v_ctc_loss 0.7 | task_loss 3.289 | contrastive_loss 0 | total 4137.73 | n_correct 2593.68 | ppl 5.02 | accuracy 62.684 | wps 12378.5 | ups 1.5 | wpb 8275.5 | bsz 305.3 | num_updates 20628 | lr 9.8466e-05 | gnorm 0.507 | clip 0 | loss_scale 64 | train_wall 879 | gb_free 16.3 | wall 16417
2023-08-24 06:48:42 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 06:48:42 | INFO | fairseq.trainer | begin training epoch 15
2023-08-24 06:48:42 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 06:49:33 | INFO | train_inner | epoch 015:     72 / 1474 loss=2.034, trans_loss=5.092, nll_loss=2.31, w2v_ctc_loss=0.69, task_loss=3.287, contrastive_loss=0, total=4075.94, n_correct=2570.72, ppl=4.96, accuracy=63.071, wps=7301.1, ups=0.9, wpb=8151.9, bsz=299.9, num_updates=20700, lr=9.82946e-05, gnorm=0.509, clip=0, loss_scale=64, train_wall=59, gb_free=16.7, wall=16467
2023-08-24 06:50:33 | INFO | train_inner | epoch 015:    172 / 1474 loss=2.036, trans_loss=5.084, nll_loss=2.299, w2v_ctc_loss=0.699, task_loss=3.436, contrastive_loss=0, total=4125.04, n_correct=2602.6, ppl=4.92, accuracy=63.093, wps=13658.8, ups=1.66, wpb=8250.1, bsz=297.5, num_updates=20800, lr=9.80581e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=15.5, wall=16528
2023-08-24 06:51:33 | INFO | train_inner | epoch 015:    272 / 1474 loss=2.025, trans_loss=5.083, nll_loss=2.298, w2v_ctc_loss=0.683, task_loss=3.143, contrastive_loss=0, total=4187.82, n_correct=2649.37, ppl=4.92, accuracy=63.264, wps=13975.8, ups=1.67, wpb=8375.6, bsz=313.1, num_updates=20900, lr=9.78232e-05, gnorm=0.508, clip=0, loss_scale=64, train_wall=59, gb_free=16.7, wall=16587
2023-08-24 06:52:34 | INFO | train_inner | epoch 015:    372 / 1474 loss=2.032, trans_loss=5.08, nll_loss=2.294, w2v_ctc_loss=0.692, task_loss=3.397, contrastive_loss=0, total=4147.17, n_correct=2620.96, ppl=4.9, accuracy=63.199, wps=13735.7, ups=1.66, wpb=8294.3, bsz=299.7, num_updates=21000, lr=9.759e-05, gnorm=0.513, clip=0, loss_scale=64, train_wall=60, gb_free=11.6, wall=16648
2023-08-24 06:53:34 | INFO | train_inner | epoch 015:    472 / 1474 loss=2.031, trans_loss=5.087, nll_loss=2.303, w2v_ctc_loss=0.684, task_loss=3.331, contrastive_loss=0, total=4089.07, n_correct=2577.12, ppl=4.94, accuracy=63.025, wps=13586.2, ups=1.66, wpb=8178.1, bsz=300.4, num_updates=21100, lr=9.73585e-05, gnorm=0.513, clip=0, loss_scale=64, train_wall=60, gb_free=16.8, wall=16708
2023-08-24 06:54:34 | INFO | train_inner | epoch 015:    572 / 1474 loss=2.034, trans_loss=5.085, nll_loss=2.3, w2v_ctc_loss=0.695, task_loss=3.496, contrastive_loss=0, total=4126.64, n_correct=2604.09, ppl=4.93, accuracy=63.104, wps=13604.9, ups=1.65, wpb=8253.3, bsz=292.4, num_updates=21200, lr=9.71286e-05, gnorm=0.513, clip=0, loss_scale=64, train_wall=60, gb_free=15.6, wall=16769
2023-08-24 06:55:35 | INFO | train_inner | epoch 015:    672 / 1474 loss=2.032, trans_loss=5.085, nll_loss=2.302, w2v_ctc_loss=0.695, task_loss=3.252, contrastive_loss=0, total=4139.44, n_correct=2615.06, ppl=4.93, accuracy=63.174, wps=13668.6, ups=1.65, wpb=8278.9, bsz=310.2, num_updates=21300, lr=9.69003e-05, gnorm=0.511, clip=0, loss_scale=64, train_wall=60, gb_free=16.1, wall=16829
2023-08-24 06:56:36 | INFO | train_inner | epoch 015:    772 / 1474 loss=2.037, trans_loss=5.097, nll_loss=2.317, w2v_ctc_loss=0.696, task_loss=3.299, contrastive_loss=0, total=4187.25, n_correct=2632.36, ppl=4.98, accuracy=62.866, wps=13791.9, ups=1.65, wpb=8374.5, bsz=307.8, num_updates=21400, lr=9.66736e-05, gnorm=0.509, clip=0, loss_scale=64, train_wall=60, gb_free=15.4, wall=16890
2023-08-24 06:57:36 | INFO | train_inner | epoch 015:    872 / 1474 loss=2.042, trans_loss=5.101, nll_loss=2.322, w2v_ctc_loss=0.701, task_loss=3.551, contrastive_loss=0, total=4067.38, n_correct=2557.86, ppl=5, accuracy=62.887, wps=13583.5, ups=1.67, wpb=8134.8, bsz=288.1, num_updates=21500, lr=9.64486e-05, gnorm=0.517, clip=0, loss_scale=64, train_wall=59, gb_free=15.1, wall=16950
2023-08-24 06:58:36 | INFO | train_inner | epoch 015:    972 / 1474 loss=2.032, trans_loss=5.095, nll_loss=2.315, w2v_ctc_loss=0.686, task_loss=3.298, contrastive_loss=0, total=4116.05, n_correct=2595.44, ppl=4.97, accuracy=63.057, wps=13694.5, ups=1.66, wpb=8232.1, bsz=301.7, num_updates=21600, lr=9.6225e-05, gnorm=0.509, clip=0, loss_scale=64, train_wall=60, gb_free=16.3, wall=17010
2023-08-24 06:59:36 | INFO | train_inner | epoch 015:   1072 / 1474 loss=2.033, trans_loss=5.1, nll_loss=2.323, w2v_ctc_loss=0.691, task_loss=3.056, contrastive_loss=0, total=4195.99, n_correct=2636.32, ppl=5, accuracy=62.83, wps=13817, ups=1.65, wpb=8392, bsz=326.9, num_updates=21700, lr=9.60031e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=60, gb_free=17.4, wall=17071
2023-08-24 07:00:36 | INFO | train_inner | epoch 015:   1172 / 1474 loss=2.021, trans_loss=5.089, nll_loss=2.31, w2v_ctc_loss=0.676, task_loss=2.987, contrastive_loss=0, total=4176.34, n_correct=2643.08, ppl=4.96, accuracy=63.287, wps=13904.7, ups=1.66, wpb=8352.7, bsz=326.6, num_updates=21800, lr=9.57826e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=59, gb_free=16.7, wall=17131
2023-08-24 07:01:37 | INFO | train_inner | epoch 015:   1272 / 1474 loss=2.037, trans_loss=5.097, nll_loss=2.319, w2v_ctc_loss=0.7, task_loss=3.324, contrastive_loss=0, total=4152.51, n_correct=2613.56, ppl=4.99, accuracy=62.939, wps=13811.2, ups=1.66, wpb=8305, bsz=305, num_updates=21900, lr=9.55637e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=60, gb_free=15.1, wall=17191
2023-08-24 07:02:37 | INFO | train_inner | epoch 015:   1372 / 1474 loss=2.039, trans_loss=5.101, nll_loss=2.324, w2v_ctc_loss=0.697, task_loss=3.386, contrastive_loss=0, total=4110.45, n_correct=2585.6, ppl=5.01, accuracy=62.903, wps=13677, ups=1.66, wpb=8220.9, bsz=294.4, num_updates=22000, lr=9.53463e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=16.3, wall=17251
2023-08-24 07:02:37 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:03:10 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 4.17 | trans_loss 5.577 | nll_loss 2.851 | w2v_ctc_loss 1.334 | task_loss 11.537 | contrastive_loss 0 | total 4003.4 | n_correct 2473.7 | ppl 7.22 | accuracy 61.79 | uer 17.639 | wer 19.5 | raw_wer 19.5 | bleu 19.85 | wps 1621.7 | wpb 4003.4 | bsz 141.8 | num_updates 22000 | best_bleu 19.98
2023-08-24 07:03:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 22000 updates
2023-08-24 07:03:10 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_15_22000.pt
2023-08-24 07:03:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_15_22000.pt
2023-08-24 07:03:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_15_22000.pt (epoch 15 @ 22000 updates, score 19.85) (writing took 7.205906354007311 seconds)
2023-08-24 07:04:19 | INFO | train_inner | epoch 015:   1472 / 1474 loss=2.037, trans_loss=5.105, nll_loss=2.33, w2v_ctc_loss=0.695, task_loss=3.234, contrastive_loss=0, total=4146.43, n_correct=2607.38, ppl=5.03, accuracy=62.883, wps=8116.3, ups=0.98, wpb=8292.9, bsz=312.1, num_updates=22100, lr=9.51303e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=61, gb_free=17, wall=17353
2023-08-24 07:04:20 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:04:53 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 4.158 | trans_loss 5.567 | nll_loss 2.842 | w2v_ctc_loss 1.315 | task_loss 11.527 | contrastive_loss 0 | total 4003.4 | n_correct 2482.2 | ppl 7.17 | accuracy 62.002 | uer 17.644 | wer 19.529 | raw_wer 19.529 | bleu 20.12 | wps 1611.7 | wpb 4003.4 | bsz 141.8 | num_updates 22102 | best_bleu 20.12
2023-08-24 07:04:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 22102 updates
2023-08-24 07:04:53 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 07:04:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 07:05:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 15 @ 22102 updates, score 20.12) (writing took 11.469834677991457 seconds)
2023-08-24 07:05:05 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2023-08-24 07:05:05 | INFO | train | epoch 015 | loss 2.033 | trans_loss 5.091 | nll_loss 2.31 | w2v_ctc_loss 0.692 | task_loss 3.284 | contrastive_loss 0 | total 4138.65 | n_correct 2609.76 | ppl 4.96 | accuracy 63.058 | wps 12412.6 | ups 1.5 | wpb 8277.3 | bsz 305.7 | num_updates 22102 | lr 9.5126e-05 | gnorm 0.511 | clip 0 | loss_scale 64 | train_wall 880 | gb_free 16.9 | wall 17399
2023-08-24 07:05:05 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 07:05:05 | INFO | fairseq.trainer | begin training epoch 16
2023-08-24 07:05:05 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 07:06:11 | INFO | train_inner | epoch 016:     98 / 1474 loss=2.007, trans_loss=5.056, nll_loss=2.264, w2v_ctc_loss=0.67, task_loss=3.107, contrastive_loss=0, total=4110.66, n_correct=2624.37, ppl=4.8, accuracy=63.843, wps=7356.7, ups=0.89, wpb=8221.3, bsz=314.8, num_updates=22200, lr=9.49158e-05, gnorm=0.504, clip=0, loss_scale=64, train_wall=59, gb_free=16.2, wall=17465
2023-08-24 07:07:12 | INFO | train_inner | epoch 016:    198 / 1474 loss=2.014, trans_loss=5.058, nll_loss=2.267, w2v_ctc_loss=0.673, task_loss=3.363, contrastive_loss=0, total=4100.94, n_correct=2614.21, ppl=4.81, accuracy=63.747, wps=13464.2, ups=1.64, wpb=8201.9, bsz=297.9, num_updates=22300, lr=9.47027e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=15, wall=17526
2023-08-24 07:08:12 | INFO | train_inner | epoch 016:    298 / 1474 loss=2.022, trans_loss=5.069, nll_loss=2.281, w2v_ctc_loss=0.685, task_loss=3.261, contrastive_loss=0, total=4164.67, n_correct=2641.07, ppl=4.86, accuracy=63.416, wps=13787, ups=1.66, wpb=8329.3, bsz=309.2, num_updates=22400, lr=9.44911e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=14.2, wall=17586
2023-08-24 07:09:12 | INFO | train_inner | epoch 016:    398 / 1474 loss=2.023, trans_loss=5.069, nll_loss=2.28, w2v_ctc_loss=0.68, task_loss=3.49, contrastive_loss=0, total=4078.99, n_correct=2588.54, ppl=4.86, accuracy=63.46, wps=13679.1, ups=1.68, wpb=8158, bsz=288.4, num_updates=22500, lr=9.42809e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=59, gb_free=14.5, wall=17646
2023-08-24 07:10:12 | INFO | train_inner | epoch 016:    498 / 1474 loss=2.016, trans_loss=5.068, nll_loss=2.281, w2v_ctc_loss=0.677, task_loss=3.175, contrastive_loss=0, total=4167.57, n_correct=2650.19, ppl=4.86, accuracy=63.591, wps=13716.2, ups=1.65, wpb=8335.1, bsz=316.8, num_updates=22600, lr=9.40721e-05, gnorm=0.51, clip=0, loss_scale=128, train_wall=60, gb_free=17.3, wall=17707
2023-08-24 07:10:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-24 07:11:13 | INFO | train_inner | epoch 016:    599 / 1474 loss=2.02, trans_loss=5.07, nll_loss=2.283, w2v_ctc_loss=0.68, task_loss=3.309, contrastive_loss=0, total=4131.14, n_correct=2627.12, ppl=4.87, accuracy=63.593, wps=13603.5, ups=1.65, wpb=8262.3, bsz=300, num_updates=22700, lr=9.38647e-05, gnorm=0.503, clip=0, loss_scale=64, train_wall=60, gb_free=16.7, wall=17768
2023-08-24 07:12:13 | INFO | train_inner | epoch 016:    699 / 1474 loss=2.024, trans_loss=5.078, nll_loss=2.293, w2v_ctc_loss=0.683, task_loss=3.359, contrastive_loss=0, total=4096.68, n_correct=2595.97, ppl=4.9, accuracy=63.368, wps=13689.4, ups=1.67, wpb=8193.4, bsz=297.2, num_updates=22800, lr=9.36586e-05, gnorm=0.517, clip=0, loss_scale=64, train_wall=59, gb_free=16.6, wall=17827
2023-08-24 07:13:13 | INFO | train_inner | epoch 016:    799 / 1474 loss=2.018, trans_loss=5.078, nll_loss=2.293, w2v_ctc_loss=0.672, task_loss=3.179, contrastive_loss=0, total=4173.41, n_correct=2644.55, ppl=4.9, accuracy=63.367, wps=13860.6, ups=1.66, wpb=8346.8, bsz=309.5, num_updates=22900, lr=9.34539e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=15.4, wall=17888
2023-08-24 07:14:13 | INFO | train_inner | epoch 016:    899 / 1474 loss=2.02, trans_loss=5.075, nll_loss=2.291, w2v_ctc_loss=0.679, task_loss=3.203, contrastive_loss=0, total=4153.99, n_correct=2637.25, ppl=4.89, accuracy=63.487, wps=13837.5, ups=1.67, wpb=8308, bsz=309, num_updates=23000, lr=9.32505e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=59, gb_free=12.7, wall=17948
2023-08-24 07:15:14 | INFO | train_inner | epoch 016:    999 / 1474 loss=2.03, trans_loss=5.085, nll_loss=2.302, w2v_ctc_loss=0.693, task_loss=3.39, contrastive_loss=0, total=4114.34, n_correct=2598.79, ppl=4.93, accuracy=63.164, wps=13551.5, ups=1.65, wpb=8228.7, bsz=301, num_updates=23100, lr=9.30484e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=60, gb_free=16.1, wall=18008
2023-08-24 07:16:14 | INFO | train_inner | epoch 016:   1099 / 1474 loss=2.034, trans_loss=5.093, nll_loss=2.313, w2v_ctc_loss=0.695, task_loss=3.486, contrastive_loss=0, total=4122.73, n_correct=2600.3, ppl=4.97, accuracy=63.072, wps=13678.4, ups=1.66, wpb=8245.5, bsz=296.3, num_updates=23200, lr=9.28477e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=17.8, wall=18069
2023-08-24 07:17:15 | INFO | train_inner | epoch 016:   1199 / 1474 loss=2.025, trans_loss=5.087, nll_loss=2.307, w2v_ctc_loss=0.676, task_loss=3.36, contrastive_loss=0, total=4162.91, n_correct=2630.62, ppl=4.95, accuracy=63.192, wps=13631.7, ups=1.64, wpb=8325.8, bsz=307.3, num_updates=23300, lr=9.26482e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=14.9, wall=18130
2023-08-24 07:18:16 | INFO | train_inner | epoch 016:   1299 / 1474 loss=2.032, trans_loss=5.091, nll_loss=2.31, w2v_ctc_loss=0.696, task_loss=3.243, contrastive_loss=0, total=4129.01, n_correct=2609.78, ppl=4.96, accuracy=63.206, wps=13637.8, ups=1.65, wpb=8258, bsz=310.6, num_updates=23400, lr=9.245e-05, gnorm=0.515, clip=0, loss_scale=64, train_wall=60, gb_free=17.1, wall=18190
2023-08-24 07:19:16 | INFO | train_inner | epoch 016:   1399 / 1474 loss=2.027, trans_loss=5.089, nll_loss=2.31, w2v_ctc_loss=0.691, task_loss=3.115, contrastive_loss=0, total=4213.36, n_correct=2661.94, ppl=4.96, accuracy=63.179, wps=13960.6, ups=1.66, wpb=8426.7, bsz=323.2, num_updates=23500, lr=9.22531e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=17.2, wall=18251
2023-08-24 07:20:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:20:35 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 4.163 | trans_loss 5.565 | nll_loss 2.839 | w2v_ctc_loss 1.337 | task_loss 11.551 | contrastive_loss 0 | total 4003.4 | n_correct 2481.9 | ppl 7.16 | accuracy 61.995 | uer 17.442 | wer 19.317 | raw_wer 19.317 | bleu 19.99 | wps 1581.6 | wpb 4003.4 | bsz 141.8 | num_updates 23575 | best_bleu 20.12
2023-08-24 07:20:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 23575 updates
2023-08-24 07:20:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.9909.pt
2023-08-24 07:20:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.9909.pt
2023-08-24 07:20:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.9909.pt (epoch 16 @ 23575 updates, score 19.99) (writing took 6.807748986990191 seconds)
2023-08-24 07:20:42 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2023-08-24 07:20:42 | INFO | train | epoch 016 | loss 2.023 | trans_loss 5.077 | nll_loss 2.292 | w2v_ctc_loss 0.682 | task_loss 3.289 | contrastive_loss 0 | total 4138.54 | n_correct 2623.51 | ppl 4.9 | accuracy 63.392 | wps 13010.8 | ups 1.57 | wpb 8277.1 | bsz 305.7 | num_updates 23575 | lr 9.21063e-05 | gnorm 0.51 | clip 0 | loss_scale 64 | train_wall 880 | gb_free 15.3 | wall 18337
2023-08-24 07:20:42 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 07:20:42 | INFO | fairseq.trainer | begin training epoch 17
2023-08-24 07:20:42 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 07:21:05 | INFO | train_inner | epoch 017:     25 / 1474 loss=2.019, trans_loss=5.071, nll_loss=2.284, w2v_ctc_loss=0.673, task_loss=3.335, contrastive_loss=0, total=4145.29, n_correct=2632.45, ppl=4.87, accuracy=63.505, wps=7650.5, ups=0.92, wpb=8290.6, bsz=303.6, num_updates=23600, lr=9.20575e-05, gnorm=0.511, clip=0, loss_scale=64, train_wall=60, gb_free=16.6, wall=18359
2023-08-24 07:22:05 | INFO | train_inner | epoch 017:    125 / 1474 loss=2.012, trans_loss=5.049, nll_loss=2.255, w2v_ctc_loss=0.68, task_loss=3.389, contrastive_loss=0, total=4118.29, n_correct=2632.25, ppl=4.77, accuracy=63.916, wps=13687.7, ups=1.66, wpb=8236.6, bsz=295.5, num_updates=23700, lr=9.1863e-05, gnorm=0.512, clip=0, loss_scale=64, train_wall=59, gb_free=17.3, wall=18419
2023-08-24 07:23:05 | INFO | train_inner | epoch 017:    225 / 1474 loss=2.004, trans_loss=5.047, nll_loss=2.254, w2v_ctc_loss=0.664, task_loss=3.15, contrastive_loss=0, total=4153.83, n_correct=2655.92, ppl=4.77, accuracy=63.939, wps=13727.4, ups=1.65, wpb=8307.7, bsz=316, num_updates=23800, lr=9.16698e-05, gnorm=0.503, clip=0, loss_scale=64, train_wall=60, gb_free=16, wall=18480
2023-08-24 07:24:05 | INFO | train_inner | epoch 017:    325 / 1474 loss=2.008, trans_loss=5.052, nll_loss=2.259, w2v_ctc_loss=0.669, task_loss=3.279, contrastive_loss=0, total=4156.07, n_correct=2658.98, ppl=4.79, accuracy=63.978, wps=13830.9, ups=1.66, wpb=8312.1, bsz=305.6, num_updates=23900, lr=9.14779e-05, gnorm=0.502, clip=0, loss_scale=64, train_wall=59, gb_free=15.4, wall=18540
2023-08-24 07:25:06 | INFO | train_inner | epoch 017:    425 / 1474 loss=2.009, trans_loss=5.055, nll_loss=2.264, w2v_ctc_loss=0.673, task_loss=3.278, contrastive_loss=0, total=4137.22, n_correct=2649.6, ppl=4.8, accuracy=64.043, wps=13705.1, ups=1.66, wpb=8274.4, bsz=305.6, num_updates=24000, lr=9.12871e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=13, wall=18600
2023-08-24 07:25:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:25:40 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 4.172 | trans_loss 5.572 | nll_loss 2.845 | w2v_ctc_loss 1.349 | task_loss 11.522 | contrastive_loss 0 | total 4003.4 | n_correct 2473.9 | ppl 7.18 | accuracy 61.795 | uer 17.222 | wer 19.131 | raw_wer 19.131 | bleu 19.45 | wps 1568.7 | wpb 4003.4 | bsz 141.8 | num_updates 24000 | best_bleu 20.12
2023-08-24 07:25:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 24000 updates
2023-08-24 07:25:40 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_17_24000.pt
2023-08-24 07:25:42 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_17_24000.pt
2023-08-24 07:25:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_17_24000.pt (epoch 17 @ 24000 updates, score 19.45) (writing took 8.387583720032126 seconds)
2023-08-24 07:26:50 | INFO | train_inner | epoch 017:    525 / 1474 loss=2.013, trans_loss=5.059, nll_loss=2.27, w2v_ctc_loss=0.678, task_loss=3.368, contrastive_loss=0, total=4198.45, n_correct=2674.72, ppl=4.82, accuracy=63.707, wps=8090.3, ups=0.96, wpb=8396.9, bsz=311.3, num_updates=24100, lr=9.10975e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=14.1, wall=18704
2023-08-24 07:27:50 | INFO | train_inner | epoch 017:    625 / 1474 loss=2.01, trans_loss=5.062, nll_loss=2.273, w2v_ctc_loss=0.667, task_loss=3.304, contrastive_loss=0, total=4166.23, n_correct=2658.98, ppl=4.83, accuracy=63.822, wps=13806.7, ups=1.66, wpb=8332.5, bsz=302.1, num_updates=24200, lr=9.09091e-05, gnorm=0.501, clip=0, loss_scale=64, train_wall=60, gb_free=16.6, wall=18764
2023-08-24 07:28:50 | INFO | train_inner | epoch 017:    725 / 1474 loss=2.022, trans_loss=5.072, nll_loss=2.287, w2v_ctc_loss=0.688, task_loss=3.265, contrastive_loss=0, total=4162.79, n_correct=2647.68, ppl=4.88, accuracy=63.603, wps=13828.9, ups=1.66, wpb=8325.6, bsz=307.7, num_updates=24300, lr=9.07218e-05, gnorm=0.512, clip=0, loss_scale=64, train_wall=60, gb_free=15.4, wall=18825
2023-08-24 07:29:50 | INFO | train_inner | epoch 017:    825 / 1474 loss=2.016, trans_loss=5.067, nll_loss=2.278, w2v_ctc_loss=0.678, task_loss=3.284, contrastive_loss=0, total=4095.17, n_correct=2606.11, ppl=4.85, accuracy=63.639, wps=13597.8, ups=1.66, wpb=8190.3, bsz=297.6, num_updates=24400, lr=9.05357e-05, gnorm=0.511, clip=0, loss_scale=64, train_wall=60, gb_free=15, wall=18885
2023-08-24 07:30:50 | INFO | train_inner | epoch 017:    925 / 1474 loss=2.015, trans_loss=5.069, nll_loss=2.283, w2v_ctc_loss=0.676, task_loss=3.281, contrastive_loss=0, total=4105.79, n_correct=2612.16, ppl=4.87, accuracy=63.621, wps=13807.4, ups=1.68, wpb=8211.6, bsz=302.4, num_updates=24500, lr=9.03508e-05, gnorm=0.518, clip=0, loss_scale=64, train_wall=59, gb_free=17.5, wall=18944
2023-08-24 07:31:50 | INFO | train_inner | epoch 017:   1025 / 1474 loss=2.015, trans_loss=5.065, nll_loss=2.279, w2v_ctc_loss=0.679, task_loss=3.234, contrastive_loss=0, total=4125.36, n_correct=2627.07, ppl=4.85, accuracy=63.681, wps=13845.1, ups=1.68, wpb=8250.7, bsz=307.3, num_updates=24600, lr=9.0167e-05, gnorm=0.51, clip=0, loss_scale=64, train_wall=59, gb_free=14.8, wall=19004
2023-08-24 07:32:49 | INFO | train_inner | epoch 017:   1125 / 1474 loss=2.013, trans_loss=5.065, nll_loss=2.278, w2v_ctc_loss=0.667, task_loss=3.465, contrastive_loss=0, total=4049.08, n_correct=2580.86, ppl=4.85, accuracy=63.739, wps=13580.8, ups=1.68, wpb=8098.2, bsz=289.9, num_updates=24700, lr=8.99843e-05, gnorm=0.52, clip=0, loss_scale=128, train_wall=59, gb_free=14.9, wall=19063
2023-08-24 07:33:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-24 07:33:51 | INFO | train_inner | epoch 017:   1226 / 1474 loss=2.018, trans_loss=5.077, nll_loss=2.295, w2v_ctc_loss=0.674, task_loss=3.186, contrastive_loss=0, total=4184.09, n_correct=2648.41, ppl=4.91, accuracy=63.297, wps=13589.6, ups=1.62, wpb=8368.2, bsz=324.5, num_updates=24800, lr=8.98027e-05, gnorm=0.504, clip=0, loss_scale=64, train_wall=61, gb_free=13.5, wall=19125
2023-08-24 07:34:52 | INFO | train_inner | epoch 017:   1326 / 1474 loss=2.012, trans_loss=5.072, nll_loss=2.288, w2v_ctc_loss=0.666, task_loss=3.217, contrastive_loss=0, total=4166.32, n_correct=2649.1, ppl=4.88, accuracy=63.584, wps=13697, ups=1.64, wpb=8332.6, bsz=311.2, num_updates=24900, lr=8.96221e-05, gnorm=0.504, clip=0, loss_scale=64, train_wall=60, gb_free=15.6, wall=19186
2023-08-24 07:35:52 | INFO | train_inner | epoch 017:   1426 / 1474 loss=2.015, trans_loss=5.073, nll_loss=2.288, w2v_ctc_loss=0.673, task_loss=3.297, contrastive_loss=0, total=4115.33, n_correct=2615.93, ppl=4.88, accuracy=63.565, wps=13515.3, ups=1.64, wpb=8230.7, bsz=303.3, num_updates=25000, lr=8.94427e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=11.3, wall=19247
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 07:36:22 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
2023-08-24 07:36:55 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 4.159 | trans_loss 5.558 | nll_loss 2.837 | w2v_ctc_loss 1.336 | task_loss 11.532 | contrastive_loss 0 | total 4003.4 | n_correct 2478.5 | ppl 7.14 | accuracy 61.91 | uer 17.405 | wer 19.164 | raw_wer 19.164 | bleu 19.88 | wps 1606.9 | wpb 4003.4 | bsz 141.8 | num_updates 25048 | best_bleu 20.12
2023-08-24 07:36:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 25048 updates
2023-08-24 07:36:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.8801.pt
2023-08-24 07:36:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.8801.pt
2023-08-24 07:37:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_19.8801.pt (epoch 17 @ 25048 updates, score 19.88) (writing took 6.642691320972517 seconds)
2023-08-24 07:37:02 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2023-08-24 07:37:02 | INFO | train | epoch 017 | loss 2.013 | trans_loss 5.063 | nll_loss 2.275 | w2v_ctc_loss 0.674 | task_loss 3.286 | contrastive_loss 0 | total 4138.87 | n_correct 2637.69 | ppl 4.84 | accuracy 63.73 | wps 12445.9 | ups 1.5 | wpb 8277.7 | bsz 305.7 | num_updates 25048 | lr 8.9357e-05 | gnorm 0.51 | clip 0 | loss_scale 64 | train_wall 879 | gb_free 16.3 | wall 19316
2023-08-24 07:37:02 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 07:37:02 | INFO | fairseq.trainer | begin training epoch 18
2023-08-24 07:37:02 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 07:37:41 | INFO | train_inner | epoch 018:     52 / 1474 loss=2.011, trans_loss=5.058, nll_loss=2.269, w2v_ctc_loss=0.676, task_loss=3.343, contrastive_loss=0, total=4144.39, n_correct=2647.62, ppl=4.82, accuracy=63.884, wps=7627.1, ups=0.92, wpb=8288.8, bsz=303.7, num_updates=25100, lr=8.92644e-05, gnorm=0.512, clip=0, loss_scale=64, train_wall=60, gb_free=14.3, wall=19355
2023-08-24 07:38:42 | INFO | train_inner | epoch 018:    152 / 1474 loss=1.992, trans_loss=5.032, nll_loss=2.234, w2v_ctc_loss=0.652, task_loss=3.148, contrastive_loss=0, total=4146.83, n_correct=2665.62, ppl=4.7, accuracy=64.281, wps=13687.4, ups=1.65, wpb=8293.7, bsz=311.2, num_updates=25200, lr=8.90871e-05, gnorm=0.507, clip=0, loss_scale=64, train_wall=60, gb_free=16.2, wall=19416
2023-08-24 07:39:42 | INFO | train_inner | epoch 018:    252 / 1474 loss=1.993, trans_loss=5.032, nll_loss=2.234, w2v_ctc_loss=0.659, task_loss=3.195, contrastive_loss=0, total=4158.7, n_correct=2678.07, ppl=4.71, accuracy=64.397, wps=13760.1, ups=1.65, wpb=8317.4, bsz=312.4, num_updates=25300, lr=8.89108e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=9.6, wall=19477
2023-08-24 07:40:43 | INFO | train_inner | epoch 018:    352 / 1474 loss=2, trans_loss=5.042, nll_loss=2.246, w2v_ctc_loss=0.661, task_loss=3.32, contrastive_loss=0, total=4169.64, n_correct=2677.2, ppl=4.74, accuracy=64.207, wps=13695.8, ups=1.64, wpb=8339.3, bsz=302.8, num_updates=25400, lr=8.87357e-05, gnorm=0.513, clip=0, loss_scale=64, train_wall=60, gb_free=16.5, wall=19537
2023-08-24 07:41:44 | INFO | train_inner | epoch 018:    452 / 1474 loss=2.007, trans_loss=5.048, nll_loss=2.255, w2v_ctc_loss=0.669, task_loss=3.508, contrastive_loss=0, total=4091.07, n_correct=2617.94, ppl=4.77, accuracy=63.992, wps=13509.2, ups=1.65, wpb=8182.1, bsz=295, num_updates=25500, lr=8.85615e-05, gnorm=0.517, clip=0, loss_scale=64, train_wall=60, gb_free=17.3, wall=19598
2023-08-24 07:42:44 | INFO | train_inner | epoch 018:    552 / 1474 loss=1.991, trans_loss=5.036, nll_loss=2.241, w2v_ctc_loss=0.657, task_loss=2.949, contrastive_loss=0, total=4206.23, n_correct=2707.02, ppl=4.73, accuracy=64.357, wps=14038.5, ups=1.67, wpb=8412.5, bsz=328.7, num_updates=25600, lr=8.83883e-05, gnorm=0.52, clip=0, loss_scale=64, train_wall=59, gb_free=14.7, wall=19658
2023-08-24 07:43:43 | INFO | train_inner | epoch 018:    652 / 1474 loss=2.009, trans_loss=5.058, nll_loss=2.269, w2v_ctc_loss=0.668, task_loss=3.367, contrastive_loss=0, total=4099.25, n_correct=2617.48, ppl=4.82, accuracy=63.853, wps=13722.3, ups=1.67, wpb=8198.5, bsz=299.8, num_updates=25700, lr=8.82162e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=59, gb_free=15, wall=19718
2023-08-24 07:44:44 | INFO | train_inner | epoch 018:    752 / 1474 loss=2.009, trans_loss=5.055, nll_loss=2.266, w2v_ctc_loss=0.674, task_loss=3.176, contrastive_loss=0, total=4203.13, n_correct=2686.25, ppl=4.81, accuracy=63.911, wps=13806.8, ups=1.64, wpb=8406.3, bsz=320, num_updates=25800, lr=8.80451e-05, gnorm=0.506, clip=0, loss_scale=64, train_wall=60, gb_free=14.3, wall=19779
2023-08-24 07:45:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 07:45:46 | INFO | train_inner | epoch 018:    853 / 1474 loss=2.007, trans_loss=5.055, nll_loss=2.265, w2v_ctc_loss=0.667, task_loss=3.319, contrastive_loss=0, total=4162.27, n_correct=2664.93, ppl=4.81, accuracy=64.026, wps=13546.4, ups=1.63, wpb=8324.5, bsz=303.1, num_updates=25900, lr=8.7875e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=61, gb_free=15.7, wall=19840
2023-08-24 07:46:46 | INFO | train_inner | epoch 018:    953 / 1474 loss=1.995, trans_loss=5.046, nll_loss=2.254, w2v_ctc_loss=0.654, task_loss=3.05, contrastive_loss=0, total=4141.27, n_correct=2659.35, ppl=4.77, accuracy=64.216, wps=13823, ups=1.67, wpb=8282.5, bsz=316, num_updates=26000, lr=8.77058e-05, gnorm=0.511, clip=0, loss_scale=32, train_wall=59, gb_free=16, wall=19900
2023-08-24 07:46:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:47:19 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 4.164 | trans_loss 5.566 | nll_loss 2.839 | w2v_ctc_loss 1.337 | task_loss 11.546 | contrastive_loss 0 | total 4003.4 | n_correct 2480.4 | ppl 7.15 | accuracy 61.957 | uer 17.355 | wer 19.28 | raw_wer 19.28 | bleu 19.78 | wps 1610.2 | wpb 4003.4 | bsz 141.8 | num_updates 26000 | best_bleu 20.12
2023-08-24 07:47:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 26000 updates
2023-08-24 07:47:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_18_26000.pt
2023-08-24 07:47:21 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_18_26000.pt
2023-08-24 07:47:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_18_26000.pt (epoch 18 @ 26000 updates, score 19.78) (writing took 7.479830657015555 seconds)
2023-08-24 07:48:27 | INFO | train_inner | epoch 018:   1053 / 1474 loss=2.007, trans_loss=5.057, nll_loss=2.268, w2v_ctc_loss=0.665, task_loss=3.415, contrastive_loss=0, total=4134.55, n_correct=2643.26, ppl=4.81, accuracy=63.931, wps=8166.8, ups=0.99, wpb=8269.1, bsz=300.8, num_updates=26100, lr=8.75376e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=15.9, wall=20001
2023-08-24 07:49:27 | INFO | train_inner | epoch 018:   1153 / 1474 loss=2.001, trans_loss=5.046, nll_loss=2.254, w2v_ctc_loss=0.663, task_loss=3.124, contrastive_loss=0, total=4157.63, n_correct=2666.36, ppl=4.77, accuracy=64.132, wps=13836, ups=1.66, wpb=8315.3, bsz=314, num_updates=26200, lr=8.73704e-05, gnorm=0.507, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=20061
2023-08-24 07:50:27 | INFO | train_inner | epoch 018:   1253 / 1474 loss=2.009, trans_loss=5.064, nll_loss=2.276, w2v_ctc_loss=0.662, task_loss=3.546, contrastive_loss=0, total=4085.66, n_correct=2608.81, ppl=4.84, accuracy=63.853, wps=13589.3, ups=1.66, wpb=8171.3, bsz=286.6, num_updates=26300, lr=8.72041e-05, gnorm=0.51, clip=0, loss_scale=32, train_wall=59, gb_free=17.4, wall=20121
2023-08-24 07:51:27 | INFO | train_inner | epoch 018:   1353 / 1474 loss=2.017, trans_loss=5.07, nll_loss=2.285, w2v_ctc_loss=0.679, task_loss=3.518, contrastive_loss=0, total=4065.6, n_correct=2588.87, ppl=4.87, accuracy=63.677, wps=13594.6, ups=1.67, wpb=8131.2, bsz=291.1, num_updates=26400, lr=8.70388e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=13, wall=20181
2023-08-24 07:52:28 | INFO | train_inner | epoch 018:   1453 / 1474 loss=2.014, trans_loss=5.067, nll_loss=2.281, w2v_ctc_loss=0.674, task_loss=3.431, contrastive_loss=0, total=4122.48, n_correct=2624.89, ppl=4.86, accuracy=63.673, wps=13577, ups=1.65, wpb=8245, bsz=299.5, num_updates=26500, lr=8.68744e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=20242
2023-08-24 07:52:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 07:53:14 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 4.167 | trans_loss 5.565 | nll_loss 2.842 | w2v_ctc_loss 1.352 | task_loss 11.47 | contrastive_loss 0 | total 4003.4 | n_correct 2481.4 | ppl 7.17 | accuracy 61.982 | uer 17.325 | wer 19.22 | raw_wer 19.22 | bleu 20.02 | wps 1582.4 | wpb 4003.4 | bsz 141.8 | num_updates 26521 | best_bleu 20.12
2023-08-24 07:53:14 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 26521 updates
2023-08-24 07:53:14 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0209.pt
2023-08-24 07:53:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0209.pt
2023-08-24 07:53:21 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0209.pt (epoch 18 @ 26521 updates, score 20.02) (writing took 6.880317621049471 seconds)
2023-08-24 07:53:22 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2023-08-24 07:53:22 | INFO | train | epoch 018 | loss 2.004 | trans_loss 5.05 | nll_loss 2.259 | w2v_ctc_loss 0.665 | task_loss 3.285 | contrastive_loss 0 | total 4138.3 | n_correct 2649.98 | ppl 4.79 | accuracy 64.036 | wps 12443 | ups 1.5 | wpb 8276.6 | bsz 305.6 | num_updates 26521 | lr 8.684e-05 | gnorm 0.513 | clip 0 | loss_scale 32 | train_wall 880 | gb_free 15.8 | wall 20296
2023-08-24 07:53:22 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 07:53:22 | INFO | fairseq.trainer | begin training epoch 19
2023-08-24 07:53:22 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 07:54:17 | INFO | train_inner | epoch 019:     79 / 1474 loss=1.992, trans_loss=5.026, nll_loss=2.227, w2v_ctc_loss=0.655, task_loss=3.292, contrastive_loss=0, total=4101.48, n_correct=2644.58, ppl=4.68, accuracy=64.479, wps=7521.1, ups=0.92, wpb=8203, bsz=296.9, num_updates=26600, lr=8.6711e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=20351
2023-08-24 07:55:17 | INFO | train_inner | epoch 019:    179 / 1474 loss=1.988, trans_loss=5.02, nll_loss=2.219, w2v_ctc_loss=0.663, task_loss=3.062, contrastive_loss=0, total=4227.39, n_correct=2734.29, ppl=4.65, accuracy=64.68, wps=13910.6, ups=1.65, wpb=8454.8, bsz=324.7, num_updates=26700, lr=8.65485e-05, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=20412
2023-08-24 07:56:17 | INFO | train_inner | epoch 019:    279 / 1474 loss=1.989, trans_loss=5.022, nll_loss=2.221, w2v_ctc_loss=0.659, task_loss=3.242, contrastive_loss=0, total=4186.65, n_correct=2710.41, ppl=4.66, accuracy=64.739, wps=13981.5, ups=1.67, wpb=8373.3, bsz=306.4, num_updates=26800, lr=8.63868e-05, gnorm=0.506, clip=0, loss_scale=32, train_wall=59, gb_free=13.6, wall=20472
2023-08-24 07:57:18 | INFO | train_inner | epoch 019:    379 / 1474 loss=1.991, trans_loss=5.03, nll_loss=2.232, w2v_ctc_loss=0.652, task_loss=3.261, contrastive_loss=0, total=4165.84, n_correct=2686.01, ppl=4.7, accuracy=64.477, wps=13772.6, ups=1.65, wpb=8331.7, bsz=310, num_updates=26900, lr=8.62261e-05, gnorm=0.511, clip=0, loss_scale=32, train_wall=60, gb_free=15.9, wall=20532
2023-08-24 07:58:18 | INFO | train_inner | epoch 019:    479 / 1474 loss=1.993, trans_loss=5.033, nll_loss=2.237, w2v_ctc_loss=0.656, task_loss=3.356, contrastive_loss=0, total=4122.98, n_correct=2658.48, ppl=4.71, accuracy=64.48, wps=13722.1, ups=1.66, wpb=8246, bsz=302.7, num_updates=27000, lr=8.60663e-05, gnorm=0.514, clip=0, loss_scale=32, train_wall=59, gb_free=17.1, wall=20592
2023-08-24 07:59:18 | INFO | train_inner | epoch 019:    579 / 1474 loss=1.993, trans_loss=5.035, nll_loss=2.239, w2v_ctc_loss=0.653, task_loss=3.24, contrastive_loss=0, total=4121.66, n_correct=2655.32, ppl=4.72, accuracy=64.424, wps=13744.6, ups=1.67, wpb=8243.3, bsz=304.4, num_updates=27100, lr=8.59074e-05, gnorm=0.509, clip=0, loss_scale=32, train_wall=59, gb_free=16.8, wall=20652
2023-08-24 08:00:18 | INFO | train_inner | epoch 019:    679 / 1474 loss=1.984, trans_loss=5.034, nll_loss=2.239, w2v_ctc_loss=0.642, task_loss=2.973, contrastive_loss=0, total=4205.65, n_correct=2716.02, ppl=4.72, accuracy=64.58, wps=14060.7, ups=1.67, wpb=8411.3, bsz=322.9, num_updates=27200, lr=8.57493e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=16.1, wall=20712
2023-08-24 08:01:19 | INFO | train_inner | epoch 019:    779 / 1474 loss=2, trans_loss=5.038, nll_loss=2.243, w2v_ctc_loss=0.669, task_loss=3.387, contrastive_loss=0, total=4120.36, n_correct=2648.09, ppl=4.73, accuracy=64.268, wps=13552.8, ups=1.64, wpb=8240.7, bsz=298.5, num_updates=27300, lr=8.55921e-05, gnorm=0.512, clip=0, loss_scale=32, train_wall=60, gb_free=13.7, wall=20773
2023-08-24 08:02:19 | INFO | train_inner | epoch 019:    879 / 1474 loss=1.999, trans_loss=5.045, nll_loss=2.252, w2v_ctc_loss=0.661, task_loss=3.275, contrastive_loss=0, total=4176.52, n_correct=2684.4, ppl=4.76, accuracy=64.274, wps=13861.1, ups=1.66, wpb=8353, bsz=309.8, num_updates=27400, lr=8.54358e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=60, gb_free=16.9, wall=20833
2023-08-24 08:03:20 | INFO | train_inner | epoch 019:    979 / 1474 loss=2.006, trans_loss=5.058, nll_loss=2.27, w2v_ctc_loss=0.663, task_loss=3.358, contrastive_loss=0, total=4079.93, n_correct=2604.5, ppl=4.82, accuracy=63.837, wps=13400.2, ups=1.64, wpb=8159.9, bsz=305, num_updates=27500, lr=8.52803e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=20894
2023-08-24 08:04:20 | INFO | train_inner | epoch 019:   1079 / 1474 loss=2.004, trans_loss=5.057, nll_loss=2.268, w2v_ctc_loss=0.66, task_loss=3.49, contrastive_loss=0, total=4041.08, n_correct=2584.57, ppl=4.82, accuracy=63.957, wps=13448.2, ups=1.66, wpb=8082.2, bsz=292.3, num_updates=27600, lr=8.51257e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=60, gb_free=16, wall=20954
2023-08-24 08:05:20 | INFO | train_inner | epoch 019:   1179 / 1474 loss=2.004, trans_loss=5.055, nll_loss=2.266, w2v_ctc_loss=0.662, task_loss=3.305, contrastive_loss=0, total=4146.59, n_correct=2651.89, ppl=4.81, accuracy=63.954, wps=13767.5, ups=1.66, wpb=8293.2, bsz=310.1, num_updates=27700, lr=8.49719e-05, gnorm=0.514, clip=0, loss_scale=32, train_wall=60, gb_free=12, wall=21014
2023-08-24 08:06:20 | INFO | train_inner | epoch 019:   1279 / 1474 loss=2.004, trans_loss=5.058, nll_loss=2.27, w2v_ctc_loss=0.658, task_loss=3.329, contrastive_loss=0, total=4142.96, n_correct=2651.53, ppl=4.82, accuracy=64.001, wps=13781.1, ups=1.66, wpb=8285.9, bsz=300.3, num_updates=27800, lr=8.48189e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=59, gb_free=16.1, wall=21075
2023-08-24 08:07:21 | INFO | train_inner | epoch 019:   1379 / 1474 loss=2.003, trans_loss=5.051, nll_loss=2.26, w2v_ctc_loss=0.665, task_loss=3.381, contrastive_loss=0, total=4129.64, n_correct=2650.84, ppl=4.79, accuracy=64.191, wps=13698.2, ups=1.66, wpb=8259.3, bsz=300.4, num_updates=27900, lr=8.46668e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=21135
2023-08-24 08:08:18 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:08:52 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 4.162 | trans_loss 5.557 | nll_loss 2.831 | w2v_ctc_loss 1.352 | task_loss 11.546 | contrastive_loss 0 | total 4003.4 | n_correct 2483.8 | ppl 7.12 | accuracy 62.042 | uer 17.323 | wer 19.142 | raw_wer 19.142 | bleu 20.09 | wps 1528.2 | wpb 4003.4 | bsz 141.8 | num_updates 27995 | best_bleu 20.12
2023-08-24 08:08:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 27995 updates
2023-08-24 08:08:52 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0909.pt
2023-08-24 08:08:55 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0909.pt
2023-08-24 08:08:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.0909.pt (epoch 19 @ 27995 updates, score 20.09) (writing took 6.725264327018522 seconds)
2023-08-24 08:08:59 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2023-08-24 08:08:59 | INFO | train | epoch 019 | loss 1.996 | trans_loss 5.04 | nll_loss 2.246 | w2v_ctc_loss 0.658 | task_loss 3.286 | contrastive_loss 0 | total 4138.65 | n_correct 2661.93 | ppl 4.74 | accuracy 64.319 | wps 13014.3 | ups 1.57 | wpb 8277.3 | bsz 305.7 | num_updates 27995 | lr 8.4523e-05 | gnorm 0.516 | clip 0 | loss_scale 64 | train_wall 878 | gb_free 17.3 | wall 21234
2023-08-24 08:08:59 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 08:08:59 | INFO | fairseq.trainer | begin training epoch 20
2023-08-24 08:08:59 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 08:09:10 | INFO | train_inner | epoch 020:      5 / 1474 loss=1.995, trans_loss=5.042, nll_loss=2.25, w2v_ctc_loss=0.654, task_loss=3.335, contrastive_loss=0, total=4115.52, n_correct=2645.19, ppl=4.76, accuracy=64.274, wps=7516.3, ups=0.91, wpb=8231, bsz=302.4, num_updates=28000, lr=8.45154e-05, gnorm=0.519, clip=0, loss_scale=64, train_wall=60, gb_free=16, wall=21244
2023-08-24 08:09:10 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:09:43 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 4.165 | trans_loss 5.556 | nll_loss 2.827 | w2v_ctc_loss 1.362 | task_loss 11.546 | contrastive_loss 0 | total 4003.4 | n_correct 2492 | ppl 7.1 | accuracy 62.247 | uer 17.24 | wer 19.119 | raw_wer 19.119 | bleu 20.47 | wps 1610.6 | wpb 4003.4 | bsz 141.8 | num_updates 28000 | best_bleu 20.47
2023-08-24 08:09:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 28000 updates
2023-08-24 08:09:43 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_20_28000.pt
2023-08-24 08:09:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_20_28000.pt
2023-08-24 08:09:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_20_28000.pt (epoch 20 @ 28000 updates, score 20.47) (writing took 12.039701065048575 seconds)
2023-08-24 08:10:56 | INFO | train_inner | epoch 020:    105 / 1474 loss=1.976, trans_loss=5.006, nll_loss=2.201, w2v_ctc_loss=0.643, task_loss=3.173, contrastive_loss=0, total=4189.63, n_correct=2723.58, ppl=4.6, accuracy=65.008, wps=7881.9, ups=0.94, wpb=8379.3, bsz=312, num_updates=28100, lr=8.43649e-05, gnorm=0.512, clip=0, loss_scale=64, train_wall=60, gb_free=15.5, wall=21351
2023-08-24 08:11:57 | INFO | train_inner | epoch 020:    205 / 1474 loss=1.985, trans_loss=5.017, nll_loss=2.216, w2v_ctc_loss=0.649, task_loss=3.357, contrastive_loss=0, total=4166.91, n_correct=2698.01, ppl=4.64, accuracy=64.748, wps=13690.3, ups=1.64, wpb=8333.8, bsz=305, num_updates=28200, lr=8.42152e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=14.5, wall=21412
2023-08-24 08:12:57 | INFO | train_inner | epoch 020:    305 / 1474 loss=1.974, trans_loss=5.008, nll_loss=2.205, w2v_ctc_loss=0.643, task_loss=2.982, contrastive_loss=0, total=4184.03, n_correct=2722.21, ppl=4.61, accuracy=65.062, wps=14005.8, ups=1.67, wpb=8368.1, bsz=324.8, num_updates=28300, lr=8.40663e-05, gnorm=0.505, clip=0, loss_scale=64, train_wall=59, gb_free=14.7, wall=21471
2023-08-24 08:13:57 | INFO | train_inner | epoch 020:    405 / 1474 loss=1.984, trans_loss=5.018, nll_loss=2.217, w2v_ctc_loss=0.645, task_loss=3.306, contrastive_loss=0, total=4121.39, n_correct=2669.57, ppl=4.65, accuracy=64.774, wps=13643.3, ups=1.66, wpb=8242.8, bsz=298.9, num_updates=28400, lr=8.39181e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=15.9, wall=21532
2023-08-24 08:14:58 | INFO | train_inner | epoch 020:    505 / 1474 loss=1.99, trans_loss=5.033, nll_loss=2.236, w2v_ctc_loss=0.647, task_loss=3.415, contrastive_loss=0, total=4097.17, n_correct=2644.53, ppl=4.71, accuracy=64.545, wps=13571.6, ups=1.66, wpb=8194.3, bsz=297.3, num_updates=28500, lr=8.37708e-05, gnorm=0.518, clip=0, loss_scale=64, train_wall=60, gb_free=17.5, wall=21592
2023-08-24 08:15:58 | INFO | train_inner | epoch 020:    605 / 1474 loss=1.992, trans_loss=5.029, nll_loss=2.231, w2v_ctc_loss=0.653, task_loss=3.377, contrastive_loss=0, total=4109.2, n_correct=2646.71, ppl=4.7, accuracy=64.409, wps=13747.9, ups=1.67, wpb=8218.4, bsz=300.3, num_updates=28600, lr=8.36242e-05, gnorm=0.521, clip=0, loss_scale=64, train_wall=59, gb_free=13.9, wall=21652
2023-08-24 08:16:57 | INFO | train_inner | epoch 020:    705 / 1474 loss=1.998, trans_loss=5.037, nll_loss=2.242, w2v_ctc_loss=0.662, task_loss=3.399, contrastive_loss=0, total=4115.08, n_correct=2648.12, ppl=4.73, accuracy=64.352, wps=13746.7, ups=1.67, wpb=8230.2, bsz=293.8, num_updates=28700, lr=8.34784e-05, gnorm=0.522, clip=0, loss_scale=64, train_wall=59, gb_free=15.3, wall=21712
2023-08-24 08:17:58 | INFO | train_inner | epoch 020:    805 / 1474 loss=1.986, trans_loss=5.026, nll_loss=2.228, w2v_ctc_loss=0.651, task_loss=3.196, contrastive_loss=0, total=4160.72, n_correct=2691.36, ppl=4.69, accuracy=64.685, wps=13833.4, ups=1.66, wpb=8321.4, bsz=310.1, num_updates=28800, lr=8.33333e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=15.9, wall=21772
2023-08-24 08:18:58 | INFO | train_inner | epoch 020:    905 / 1474 loss=1.993, trans_loss=5.04, nll_loss=2.247, w2v_ctc_loss=0.651, task_loss=3.161, contrastive_loss=0, total=4144.96, n_correct=2664.11, ppl=4.75, accuracy=64.273, wps=13633.5, ups=1.64, wpb=8289.9, bsz=320.4, num_updates=28900, lr=8.3189e-05, gnorm=0.522, clip=0, loss_scale=64, train_wall=60, gb_free=14.2, wall=21833
2023-08-24 08:19:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 08:20:00 | INFO | train_inner | epoch 020:   1006 / 1474 loss=1.987, trans_loss=5.032, nll_loss=2.236, w2v_ctc_loss=0.645, task_loss=3.28, contrastive_loss=0, total=4166.11, n_correct=2693.68, ppl=4.71, accuracy=64.657, wps=13576.9, ups=1.63, wpb=8332.2, bsz=306, num_updates=29000, lr=8.30455e-05, gnorm=0.511, clip=0, loss_scale=32, train_wall=61, gb_free=14.9, wall=21894
2023-08-24 08:21:01 | INFO | train_inner | epoch 020:   1106 / 1474 loss=1.995, trans_loss=5.042, nll_loss=2.25, w2v_ctc_loss=0.658, task_loss=3.103, contrastive_loss=0, total=4181.53, n_correct=2691.86, ppl=4.76, accuracy=64.375, wps=13753.7, ups=1.64, wpb=8363.1, bsz=320.2, num_updates=29100, lr=8.29027e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=60, gb_free=17, wall=21955
2023-08-24 08:22:01 | INFO | train_inner | epoch 020:   1206 / 1474 loss=1.999, trans_loss=5.034, nll_loss=2.238, w2v_ctc_loss=0.665, task_loss=3.644, contrastive_loss=0, total=4029.26, n_correct=2593.81, ppl=4.72, accuracy=64.374, wps=13454.6, ups=1.67, wpb=8058.5, bsz=282.4, num_updates=29200, lr=8.27606e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=59, gb_free=16.6, wall=22015
2023-08-24 08:23:02 | INFO | train_inner | epoch 020:   1306 / 1474 loss=1.994, trans_loss=5.042, nll_loss=2.25, w2v_ctc_loss=0.653, task_loss=3.434, contrastive_loss=0, total=4127.21, n_correct=2656.82, ppl=4.76, accuracy=64.373, wps=13514.3, ups=1.64, wpb=8254.4, bsz=299.9, num_updates=29300, lr=8.26192e-05, gnorm=0.521, clip=0, loss_scale=32, train_wall=60, gb_free=14.6, wall=22076
2023-08-24 08:24:02 | INFO | train_inner | epoch 020:   1406 / 1474 loss=1.999, trans_loss=5.044, nll_loss=2.252, w2v_ctc_loss=0.659, task_loss=3.524, contrastive_loss=0, total=4110.89, n_correct=2641.27, ppl=4.76, accuracy=64.251, wps=13692.7, ups=1.67, wpb=8221.8, bsz=291.6, num_updates=29400, lr=8.24786e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=59, gb_free=13.1, wall=22136
2023-08-24 08:24:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:25:16 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 4.135 | trans_loss 5.549 | nll_loss 2.822 | w2v_ctc_loss 1.277 | task_loss 11.539 | contrastive_loss 0 | total 4003.4 | n_correct 2491.7 | ppl 7.07 | accuracy 62.24 | uer 16.938 | wer 18.597 | raw_wer 18.597 | bleu 20.27 | wps 1576.3 | wpb 4003.4 | bsz 141.8 | num_updates 29468 | best_bleu 20.47
2023-08-24 08:25:16 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 29468 updates
2023-08-24 08:25:16 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.2704.pt
2023-08-24 08:25:18 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.2704.pt
2023-08-24 08:25:23 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.2704.pt (epoch 20 @ 29468 updates, score 20.27) (writing took 6.81596180901397 seconds)
2023-08-24 08:25:23 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2023-08-24 08:25:23 | INFO | train | epoch 020 | loss 1.989 | trans_loss 5.03 | nll_loss 2.233 | w2v_ctc_loss 0.651 | task_loss 3.286 | contrastive_loss 0 | total 4138.84 | n_correct 2672.06 | ppl 4.7 | accuracy 64.561 | wps 12394.9 | ups 1.5 | wpb 8277.7 | bsz 305.7 | num_updates 29468 | lr 8.23834e-05 | gnorm 0.517 | clip 0 | loss_scale 32 | train_wall 880 | gb_free 16.2 | wall 22217
2023-08-24 08:25:23 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 08:25:23 | INFO | fairseq.trainer | begin training epoch 21
2023-08-24 08:25:23 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 08:25:50 | INFO | train_inner | epoch 021:     32 / 1474 loss=1.984, trans_loss=5.031, nll_loss=2.236, w2v_ctc_loss=0.642, task_loss=3.092, contrastive_loss=0, total=4166.35, n_correct=2688.83, ppl=4.71, accuracy=64.537, wps=7696.2, ups=0.92, wpb=8332.7, bsz=319.4, num_updates=29500, lr=8.23387e-05, gnorm=0.51, clip=0, loss_scale=32, train_wall=59, gb_free=11, wall=22244
2023-08-24 08:26:50 | INFO | train_inner | epoch 021:    132 / 1474 loss=1.97, trans_loss=4.999, nll_loss=2.193, w2v_ctc_loss=0.637, task_loss=3.092, contrastive_loss=0, total=4181.45, n_correct=2721.81, ppl=4.57, accuracy=65.092, wps=13916.7, ups=1.66, wpb=8362.9, bsz=317.6, num_updates=29600, lr=8.21995e-05, gnorm=0.507, clip=0, loss_scale=32, train_wall=59, gb_free=15, wall=22304
2023-08-24 08:27:50 | INFO | train_inner | epoch 021:    232 / 1474 loss=1.969, trans_loss=5.004, nll_loss=2.199, w2v_ctc_loss=0.633, task_loss=3.11, contrastive_loss=0, total=4167.12, n_correct=2715.23, ppl=4.59, accuracy=65.158, wps=13976.9, ups=1.68, wpb=8334.2, bsz=315.1, num_updates=29700, lr=8.2061e-05, gnorm=0.509, clip=0, loss_scale=32, train_wall=59, gb_free=11.6, wall=22364
2023-08-24 08:28:50 | INFO | train_inner | epoch 021:    332 / 1474 loss=1.98, trans_loss=5.01, nll_loss=2.206, w2v_ctc_loss=0.646, task_loss=3.364, contrastive_loss=0, total=4130.24, n_correct=2683.73, ppl=4.61, accuracy=64.978, wps=13598.4, ups=1.65, wpb=8260.5, bsz=303.6, num_updates=29800, lr=8.19232e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=60, gb_free=17.2, wall=22425
2023-08-24 08:29:50 | INFO | train_inner | epoch 021:    432 / 1474 loss=1.976, trans_loss=5.009, nll_loss=2.205, w2v_ctc_loss=0.641, task_loss=3.156, contrastive_loss=0, total=4186.28, n_correct=2725.76, ppl=4.61, accuracy=65.112, wps=14000.3, ups=1.67, wpb=8372.6, bsz=310.3, num_updates=29900, lr=8.17861e-05, gnorm=0.51, clip=0, loss_scale=32, train_wall=59, gb_free=17.1, wall=22485
2023-08-24 08:30:51 | INFO | train_inner | epoch 021:    532 / 1474 loss=1.978, trans_loss=5.007, nll_loss=2.203, w2v_ctc_loss=0.645, task_loss=3.367, contrastive_loss=0, total=4096.33, n_correct=2664.25, ppl=4.6, accuracy=65.04, wps=13562, ups=1.66, wpb=8192.7, bsz=298, num_updates=30000, lr=8.16497e-05, gnorm=0.512, clip=0, loss_scale=32, train_wall=60, gb_free=17.2, wall=22545
2023-08-24 08:30:51 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:31:24 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 4.169 | trans_loss 5.557 | nll_loss 2.828 | w2v_ctc_loss 1.375 | task_loss 11.633 | contrastive_loss 0 | total 4003.4 | n_correct 2488.3 | ppl 7.1 | accuracy 62.155 | uer 17.267 | wer 19.201 | raw_wer 19.201 | bleu 19.85 | wps 1592.4 | wpb 4003.4 | bsz 141.8 | num_updates 30000 | best_bleu 20.47
2023-08-24 08:31:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 30000 updates
2023-08-24 08:31:24 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_21_30000.pt
2023-08-24 08:31:26 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_21_30000.pt
2023-08-24 08:31:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_21_30000.pt (epoch 21 @ 30000 updates, score 19.85) (writing took 7.48778055596631 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 08:32:33 | INFO | train_inner | epoch 021:    632 / 1474 loss=1.981, trans_loss=5.018, nll_loss=2.218, w2v_ctc_loss=0.64, task_loss=3.267, contrastive_loss=0, total=4215.02, n_correct=2729.1, ppl=4.65, accuracy=64.747, wps=8272.1, ups=0.98, wpb=8430, bsz=314.6, num_updates=30100, lr=8.15139e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=60, gb_free=16.2, wall=22647
2023-08-24 08:33:33 | INFO | train_inner | epoch 021:    732 / 1474 loss=1.98, trans_loss=5.023, nll_loss=2.224, w2v_ctc_loss=0.64, task_loss=3.291, contrastive_loss=0, total=4147.25, n_correct=2685.38, ppl=4.67, accuracy=64.751, wps=13776.6, ups=1.66, wpb=8294.5, bsz=308.5, num_updates=30200, lr=8.13788e-05, gnorm=0.514, clip=0, loss_scale=32, train_wall=60, gb_free=17.8, wall=22707
2023-08-24 08:34:33 | INFO | train_inner | epoch 021:    832 / 1474 loss=1.987, trans_loss=5.029, nll_loss=2.232, w2v_ctc_loss=0.645, task_loss=3.492, contrastive_loss=0, total=4071.46, n_correct=2631.8, ppl=4.7, accuracy=64.64, wps=13543.3, ups=1.66, wpb=8142.9, bsz=294.2, num_updates=30300, lr=8.12444e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=17.2, wall=22767
2023-08-24 08:35:33 | INFO | train_inner | epoch 021:    932 / 1474 loss=1.979, trans_loss=5.016, nll_loss=2.216, w2v_ctc_loss=0.64, task_loss=3.278, contrastive_loss=0, total=4098.4, n_correct=2657.9, ppl=4.65, accuracy=64.852, wps=13668.4, ups=1.67, wpb=8196.8, bsz=301.3, num_updates=30400, lr=8.11107e-05, gnorm=0.512, clip=0, loss_scale=32, train_wall=59, gb_free=15.7, wall=22827
2023-08-24 08:36:33 | INFO | train_inner | epoch 021:   1032 / 1474 loss=1.992, trans_loss=5.039, nll_loss=2.246, w2v_ctc_loss=0.651, task_loss=3.369, contrastive_loss=0, total=4099.06, n_correct=2642.34, ppl=4.74, accuracy=64.462, wps=13677.6, ups=1.67, wpb=8198.1, bsz=297.6, num_updates=30500, lr=8.09776e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=15.8, wall=22887
2023-08-24 08:37:33 | INFO | train_inner | epoch 021:   1132 / 1474 loss=1.987, trans_loss=5.024, nll_loss=2.225, w2v_ctc_loss=0.649, task_loss=3.512, contrastive_loss=0, total=4127.16, n_correct=2674.34, ppl=4.68, accuracy=64.799, wps=13691, ups=1.66, wpb=8254.3, bsz=295.6, num_updates=30600, lr=8.08452e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=15.4, wall=22947
2023-08-24 08:38:33 | INFO | train_inner | epoch 021:   1232 / 1474 loss=1.981, trans_loss=5.025, nll_loss=2.229, w2v_ctc_loss=0.643, task_loss=3.101, contrastive_loss=0, total=4159.29, n_correct=2692.3, ppl=4.69, accuracy=64.73, wps=13864.4, ups=1.67, wpb=8318.6, bsz=312.4, num_updates=30700, lr=8.07134e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=59, gb_free=17.7, wall=23007
2023-08-24 08:39:33 | INFO | train_inner | epoch 021:   1332 / 1474 loss=1.983, trans_loss=5.024, nll_loss=2.228, w2v_ctc_loss=0.648, task_loss=3.187, contrastive_loss=0, total=4139.42, n_correct=2682.73, ppl=4.68, accuracy=64.809, wps=13713.1, ups=1.66, wpb=8278.8, bsz=311.8, num_updates=30800, lr=8.05823e-05, gnorm=0.512, clip=0, loss_scale=32, train_wall=60, gb_free=14.3, wall=23068
2023-08-24 08:40:34 | INFO | train_inner | epoch 021:   1432 / 1474 loss=1.999, trans_loss=5.039, nll_loss=2.246, w2v_ctc_loss=0.665, task_loss=3.487, contrastive_loss=0, total=4123.35, n_correct=2649.17, ppl=4.74, accuracy=64.248, wps=13565.1, ups=1.64, wpb=8246.7, bsz=301.4, num_updates=30900, lr=8.04518e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=23129
2023-08-24 08:41:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
2023-08-24 08:41:32 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 4.157 | trans_loss 5.562 | nll_loss 2.836 | w2v_ctc_loss 1.323 | task_loss 11.604 | contrastive_loss 0 | total 4003.4 | n_correct 2486.1 | ppl 7.14 | accuracy 62.1 | uer 17.201 | wer 19.209 | raw_wer 19.209 | bleu 19.76 | wps 1642.9 | wpb 4003.4 | bsz 141.8 | num_updates 30942 | best_bleu 20.47
2023-08-24 08:41:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 30942 updates
2023-08-24 08:41:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 08:41:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 08:41:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 21 @ 30942 updates, score 19.76) (writing took 5.707468491978943 seconds)
2023-08-24 08:41:38 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2023-08-24 08:41:38 | INFO | train | epoch 021 | loss 1.981 | trans_loss 5.019 | nll_loss 2.219 | w2v_ctc_loss 0.644 | task_loss 3.29 | contrastive_loss 0 | total 4138.65 | n_correct 2682.39 | ppl 4.66 | accuracy 64.813 | wps 12511.1 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 30942 | lr 8.03972e-05 | gnorm 0.515 | clip 0 | loss_scale 32 | train_wall 878 | gb_free 15.4 | wall 23192
2023-08-24 08:41:38 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 08:41:38 | INFO | fairseq.trainer | begin training epoch 22
2023-08-24 08:41:38 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 08:42:21 | INFO | train_inner | epoch 022:     58 / 1474 loss=1.978, trans_loss=5.007, nll_loss=2.204, w2v_ctc_loss=0.646, task_loss=3.315, contrastive_loss=0, total=4141.35, n_correct=2695.79, ppl=4.61, accuracy=65.094, wps=7770.8, ups=0.94, wpb=8282.7, bsz=300, num_updates=31000, lr=8.03219e-05, gnorm=0.522, clip=0, loss_scale=64, train_wall=60, gb_free=16.4, wall=23235
2023-08-24 08:43:21 | INFO | train_inner | epoch 022:    158 / 1474 loss=1.971, trans_loss=4.997, nll_loss=2.19, w2v_ctc_loss=0.641, task_loss=3.315, contrastive_loss=0, total=4119.8, n_correct=2685.9, ppl=4.56, accuracy=65.195, wps=13633.4, ups=1.65, wpb=8239.6, bsz=309.8, num_updates=31100, lr=8.01927e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=15.4, wall=23296
2023-08-24 08:44:21 | INFO | train_inner | epoch 022:    258 / 1474 loss=1.964, trans_loss=4.994, nll_loss=2.187, w2v_ctc_loss=0.629, task_loss=2.968, contrastive_loss=0, total=4246.49, n_correct=2773.99, ppl=4.55, accuracy=65.324, wps=14186.7, ups=1.67, wpb=8493, bsz=323.2, num_updates=31200, lr=8.00641e-05, gnorm=0.504, clip=0, loss_scale=64, train_wall=59, gb_free=16.7, wall=23355
2023-08-24 08:44:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 08:45:23 | INFO | train_inner | epoch 022:    359 / 1474 loss=1.975, trans_loss=5.003, nll_loss=2.198, w2v_ctc_loss=0.64, task_loss=3.311, contrastive_loss=0, total=4192.82, n_correct=2729.2, ppl=4.59, accuracy=65.092, wps=13636, ups=1.63, wpb=8385.6, bsz=311, num_updates=31300, lr=7.99361e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=61, gb_free=15.5, wall=23417
2023-08-24 08:46:23 | INFO | train_inner | epoch 022:    459 / 1474 loss=1.981, trans_loss=5.012, nll_loss=2.208, w2v_ctc_loss=0.646, task_loss=3.444, contrastive_loss=0, total=4131.12, n_correct=2682.64, ppl=4.62, accuracy=64.937, wps=13712.5, ups=1.66, wpb=8262.2, bsz=297.3, num_updates=31400, lr=7.98087e-05, gnorm=0.537, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=23477
2023-08-24 08:47:24 | INFO | train_inner | epoch 022:    559 / 1474 loss=1.975, trans_loss=5.006, nll_loss=2.202, w2v_ctc_loss=0.642, task_loss=3.311, contrastive_loss=0, total=4153.54, n_correct=2705.13, ppl=4.6, accuracy=65.128, wps=13711.5, ups=1.65, wpb=8307.1, bsz=307.1, num_updates=31500, lr=7.96819e-05, gnorm=0.51, clip=0, loss_scale=32, train_wall=60, gb_free=14.8, wall=23538
2023-08-24 08:48:23 | INFO | train_inner | epoch 022:    659 / 1474 loss=1.964, trans_loss=4.998, nll_loss=2.193, w2v_ctc_loss=0.624, task_loss=3.103, contrastive_loss=0, total=4143.91, n_correct=2705.43, ppl=4.57, accuracy=65.287, wps=13907.1, ups=1.68, wpb=8287.8, bsz=313.1, num_updates=31600, lr=7.95557e-05, gnorm=0.515, clip=0, loss_scale=32, train_wall=59, gb_free=15.7, wall=23597
2023-08-24 08:49:24 | INFO | train_inner | epoch 022:    759 / 1474 loss=1.976, trans_loss=5.007, nll_loss=2.204, w2v_ctc_loss=0.641, task_loss=3.38, contrastive_loss=0, total=4168.91, n_correct=2709, ppl=4.61, accuracy=64.981, wps=13778.8, ups=1.65, wpb=8337.8, bsz=303.5, num_updates=31700, lr=7.94301e-05, gnorm=0.515, clip=0, loss_scale=32, train_wall=60, gb_free=17.5, wall=23658
2023-08-24 08:50:24 | INFO | train_inner | epoch 022:    859 / 1474 loss=1.982, trans_loss=5.018, nll_loss=2.219, w2v_ctc_loss=0.642, task_loss=3.572, contrastive_loss=0, total=4079.59, n_correct=2643.41, ppl=4.65, accuracy=64.796, wps=13429.5, ups=1.65, wpb=8159.2, bsz=288.7, num_updates=31800, lr=7.93052e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=23719
2023-08-24 08:51:25 | INFO | train_inner | epoch 022:    959 / 1474 loss=1.969, trans_loss=5.009, nll_loss=2.207, w2v_ctc_loss=0.625, task_loss=3.293, contrastive_loss=0, total=4129.75, n_correct=2687.9, ppl=4.62, accuracy=65.086, wps=13694.8, ups=1.66, wpb=8259.5, bsz=303.9, num_updates=31900, lr=7.91808e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=60, gb_free=17.7, wall=23779
2023-08-24 08:52:25 | INFO | train_inner | epoch 022:   1059 / 1474 loss=1.969, trans_loss=5.007, nll_loss=2.205, w2v_ctc_loss=0.628, task_loss=3.129, contrastive_loss=0, total=4155.56, n_correct=2708.24, ppl=4.61, accuracy=65.171, wps=13885.2, ups=1.67, wpb=8311.1, bsz=315.3, num_updates=32000, lr=7.90569e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=23839
2023-08-24 08:52:25 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:52:57 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 4.161 | trans_loss 5.559 | nll_loss 2.834 | w2v_ctc_loss 1.34 | task_loss 11.539 | contrastive_loss 0 | total 4003.4 | n_correct 2488.2 | ppl 7.13 | accuracy 62.152 | uer 17.145 | wer 19.145 | raw_wer 19.145 | bleu 19.63 | wps 1649.1 | wpb 4003.4 | bsz 141.8 | num_updates 32000 | best_bleu 20.47
2023-08-24 08:52:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 32000 updates
2023-08-24 08:52:57 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_22_32000.pt
2023-08-24 08:52:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_22_32000.pt
2023-08-24 08:53:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_22_32000.pt (epoch 22 @ 32000 updates, score 19.63) (writing took 6.319800617988221 seconds)
2023-08-24 08:54:04 | INFO | train_inner | epoch 022:   1159 / 1474 loss=1.99, trans_loss=5.031, nll_loss=2.236, w2v_ctc_loss=0.652, task_loss=3.451, contrastive_loss=0, total=4089.92, n_correct=2642.85, ppl=4.71, accuracy=64.619, wps=8216.4, ups=1, wpb=8179.8, bsz=292.2, num_updates=32100, lr=7.89337e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=60, gb_free=16, wall=23938
2023-08-24 08:55:05 | INFO | train_inner | epoch 022:   1259 / 1474 loss=1.974, trans_loss=5.019, nll_loss=2.221, w2v_ctc_loss=0.636, task_loss=3.067, contrastive_loss=0, total=4179.82, n_correct=2715.25, ppl=4.66, accuracy=64.961, wps=13794.6, ups=1.65, wpb=8359.6, bsz=322.5, num_updates=32200, lr=7.8811e-05, gnorm=0.503, clip=0, loss_scale=32, train_wall=60, gb_free=15.7, wall=23999
2023-08-24 08:56:05 | INFO | train_inner | epoch 022:   1359 / 1474 loss=1.971, trans_loss=5.012, nll_loss=2.212, w2v_ctc_loss=0.627, task_loss=3.241, contrastive_loss=0, total=4076.98, n_correct=2655.22, ppl=4.63, accuracy=65.127, wps=13613.2, ups=1.67, wpb=8154, bsz=303.1, num_updates=32300, lr=7.86889e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=59, gb_free=10.3, wall=24059
2023-08-24 08:57:05 | INFO | train_inner | epoch 022:   1459 / 1474 loss=1.989, trans_loss=5.029, nll_loss=2.232, w2v_ctc_loss=0.653, task_loss=3.541, contrastive_loss=0, total=4070.93, n_correct=2630.9, ppl=4.7, accuracy=64.627, wps=13521.2, ups=1.66, wpb=8141.9, bsz=286.5, num_updates=32400, lr=7.85674e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=24119
2023-08-24 08:57:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 08:57:47 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 4.155 | trans_loss 5.547 | nll_loss 2.818 | w2v_ctc_loss 1.348 | task_loss 11.56 | contrastive_loss 0 | total 4003.4 | n_correct 2499.5 | ppl 7.05 | accuracy 62.434 | uer 17.055 | wer 18.817 | raw_wer 18.817 | bleu 20.57 | wps 1646.4 | wpb 4003.4 | bsz 141.8 | num_updates 32415 | best_bleu 20.57
2023-08-24 08:57:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 32415 updates
2023-08-24 08:57:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 08:57:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt
2023-08-24 08:57:58 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_best.pt (epoch 22 @ 32415 updates, score 20.57) (writing took 11.40854751993902 seconds)
2023-08-24 08:57:58 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2023-08-24 08:57:58 | INFO | train | epoch 022 | loss 1.975 | trans_loss 5.009 | nll_loss 2.207 | w2v_ctc_loss 0.638 | task_loss 3.292 | contrastive_loss 0 | total 4137.49 | n_correct 2690.9 | ppl 4.62 | accuracy 65.037 | wps 12433.7 | ups 1.5 | wpb 8275 | bsz 305.2 | num_updates 32415 | lr 7.85492e-05 | gnorm 0.518 | clip 0 | loss_scale 32 | train_wall 879 | gb_free 11.6 | wall 24173
2023-08-24 08:57:59 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 08:57:59 | INFO | fairseq.trainer | begin training epoch 23
2023-08-24 08:57:59 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 08:58:57 | INFO | train_inner | epoch 023:     85 / 1474 loss=1.969, trans_loss=4.99, nll_loss=2.182, w2v_ctc_loss=0.641, task_loss=3.373, contrastive_loss=0, total=4094.01, n_correct=2676.55, ppl=4.54, accuracy=65.377, wps=7274.8, ups=0.89, wpb=8188, bsz=301, num_updates=32500, lr=7.84465e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=16.1, wall=24232
2023-08-24 08:59:58 | INFO | train_inner | epoch 023:    185 / 1474 loss=1.964, trans_loss=4.985, nll_loss=2.175, w2v_ctc_loss=0.629, task_loss=3.441, contrastive_loss=0, total=4118.15, n_correct=2700.95, ppl=4.51, accuracy=65.586, wps=13623.3, ups=1.65, wpb=8236.3, bsz=296.2, num_updates=32600, lr=7.8326e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=15.3, wall=24292
2023-08-24 09:00:58 | INFO | train_inner | epoch 023:    285 / 1474 loss=1.963, trans_loss=4.994, nll_loss=2.186, w2v_ctc_loss=0.621, task_loss=3.313, contrastive_loss=0, total=4156.76, n_correct=2714.74, ppl=4.55, accuracy=65.309, wps=13727.7, ups=1.65, wpb=8313.5, bsz=305.6, num_updates=32700, lr=7.82062e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=16, wall=24353
2023-08-24 09:01:59 | INFO | train_inner | epoch 023:    385 / 1474 loss=1.963, trans_loss=4.989, nll_loss=2.18, w2v_ctc_loss=0.624, task_loss=3.387, contrastive_loss=0, total=4114.42, n_correct=2696.45, ppl=4.53, accuracy=65.537, wps=13660, ups=1.66, wpb=8228.8, bsz=295.1, num_updates=32800, lr=7.80869e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=60, gb_free=13, wall=24413
2023-08-24 09:02:59 | INFO | train_inner | epoch 023:    485 / 1474 loss=1.965, trans_loss=4.995, nll_loss=2.188, w2v_ctc_loss=0.63, task_loss=3.191, contrastive_loss=0, total=4156.07, n_correct=2712.43, ppl=4.56, accuracy=65.264, wps=13802.9, ups=1.66, wpb=8312.1, bsz=312.6, num_updates=32900, lr=7.79681e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=24473
2023-08-24 09:03:59 | INFO | train_inner | epoch 023:    585 / 1474 loss=1.957, trans_loss=4.985, nll_loss=2.175, w2v_ctc_loss=0.623, task_loss=3.122, contrastive_loss=0, total=4169.74, n_correct=2735.58, ppl=4.52, accuracy=65.606, wps=13910, ups=1.67, wpb=8339.5, bsz=314.9, num_updates=33000, lr=7.78499e-05, gnorm=0.511, clip=0, loss_scale=32, train_wall=59, gb_free=16.4, wall=24533
2023-08-24 09:04:59 | INFO | train_inner | epoch 023:    685 / 1474 loss=1.968, trans_loss=4.995, nll_loss=2.189, w2v_ctc_loss=0.633, task_loss=3.313, contrastive_loss=0, total=4139.41, n_correct=2703.17, ppl=4.56, accuracy=65.303, wps=13679.4, ups=1.65, wpb=8278.8, bsz=301.3, num_updates=33100, lr=7.77322e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=16.3, wall=24594
2023-08-24 09:05:59 | INFO | train_inner | epoch 023:    785 / 1474 loss=1.972, trans_loss=5.003, nll_loss=2.199, w2v_ctc_loss=0.638, task_loss=3.304, contrastive_loss=0, total=4149.58, n_correct=2706.46, ppl=4.59, accuracy=65.223, wps=13888.8, ups=1.67, wpb=8299.2, bsz=306.1, num_updates=33200, lr=7.76151e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=12.2, wall=24653
2023-08-24 09:07:00 | INFO | train_inner | epoch 023:    885 / 1474 loss=1.963, trans_loss=4.998, nll_loss=2.193, w2v_ctc_loss=0.631, task_loss=2.967, contrastive_loss=0, total=4192.08, n_correct=2740.33, ppl=4.57, accuracy=65.369, wps=13876.7, ups=1.66, wpb=8384.2, bsz=327.6, num_updates=33300, lr=7.74984e-05, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=24714
2023-08-24 09:08:00 | INFO | train_inner | epoch 023:    985 / 1474 loss=1.97, trans_loss=5.005, nll_loss=2.203, w2v_ctc_loss=0.629, task_loss=3.28, contrastive_loss=0, total=4165.47, n_correct=2708.95, ppl=4.6, accuracy=65.033, wps=13773.8, ups=1.65, wpb=8330.9, bsz=310, num_updates=33400, lr=7.73823e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=14.6, wall=24774
2023-08-24 09:09:00 | INFO | train_inner | epoch 023:   1085 / 1474 loss=1.985, trans_loss=5.015, nll_loss=2.214, w2v_ctc_loss=0.654, task_loss=3.518, contrastive_loss=0, total=4083.13, n_correct=2649.86, ppl=4.64, accuracy=64.898, wps=13516.8, ups=1.66, wpb=8166.3, bsz=289.5, num_updates=33500, lr=7.72667e-05, gnorm=0.536, clip=0, loss_scale=64, train_wall=60, gb_free=16.9, wall=24835
2023-08-24 09:10:01 | INFO | train_inner | epoch 023:   1185 / 1474 loss=1.969, trans_loss=5.008, nll_loss=2.207, w2v_ctc_loss=0.632, task_loss=3.294, contrastive_loss=0, total=4165.04, n_correct=2713.74, ppl=4.62, accuracy=65.155, wps=13698.7, ups=1.64, wpb=8330.1, bsz=308.3, num_updates=33600, lr=7.71517e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=11.7, wall=24896
2023-08-24 09:11:01 | INFO | train_inner | epoch 023:   1285 / 1474 loss=1.968, trans_loss=5.008, nll_loss=2.207, w2v_ctc_loss=0.628, task_loss=3.188, contrastive_loss=0, total=4131.11, n_correct=2695.09, ppl=4.62, accuracy=65.239, wps=13786.8, ups=1.67, wpb=8262.2, bsz=308.9, num_updates=33700, lr=7.70371e-05, gnorm=0.517, clip=0, loss_scale=64, train_wall=59, gb_free=16.7, wall=24956
2023-08-24 09:11:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 09:12:03 | INFO | train_inner | epoch 023:   1386 / 1474 loss=1.98, trans_loss=5.027, nll_loss=2.231, w2v_ctc_loss=0.637, task_loss=3.32, contrastive_loss=0, total=4137.22, n_correct=2681.05, ppl=4.69, accuracy=64.803, wps=13481.4, ups=1.63, wpb=8274.4, bsz=304.3, num_updates=33800, lr=7.69231e-05, gnorm=0.515, clip=0, loss_scale=32, train_wall=61, gb_free=16.6, wall=25017
2023-08-24 09:12:56 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 09:13:29 | INFO | dev_st | epoch 023 | valid on 'dev_st' subset | loss 4.165 | trans_loss 5.551 | nll_loss 2.819 | w2v_ctc_loss 1.374 | task_loss 11.59 | contrastive_loss 0 | total 4003.4 | n_correct 2498.9 | ppl 7.06 | accuracy 62.419 | uer 16.879 | wer 18.784 | raw_wer 18.784 | bleu 20.12 | wps 1649.3 | wpb 4003.4 | bsz 141.8 | num_updates 33888 | best_bleu 20.57
2023-08-24 09:13:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 33888 updates
2023-08-24 09:13:29 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1202.pt
2023-08-24 09:13:33 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1202.pt
2023-08-24 09:13:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1202.pt (epoch 23 @ 33888 updates, score 20.12) (writing took 9.246639157063328 seconds)
2023-08-24 09:13:38 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2023-08-24 09:13:38 | INFO | train | epoch 023 | loss 1.969 | trans_loss 5.001 | nll_loss 2.197 | w2v_ctc_loss 0.632 | task_loss 3.284 | contrastive_loss 0 | total 4138.41 | n_correct 2699.83 | ppl 4.58 | accuracy 65.238 | wps 12977 | ups 1.57 | wpb 8276.8 | bsz 305.6 | num_updates 33888 | lr 7.68231e-05 | gnorm 0.518 | clip 0 | loss_scale 32 | train_wall 881 | gb_free 13.6 | wall 25112
2023-08-24 09:13:38 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 09:13:38 | INFO | fairseq.trainer | begin training epoch 24
2023-08-24 09:13:38 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 09:13:53 | INFO | train_inner | epoch 024:     12 / 1474 loss=1.974, trans_loss=5.018, nll_loss=2.22, w2v_ctc_loss=0.628, task_loss=3.27, contrastive_loss=0, total=4095.53, n_correct=2657.24, ppl=4.66, accuracy=64.881, wps=7436.8, ups=0.91, wpb=8191.1, bsz=306.3, num_updates=33900, lr=7.68095e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=60, gb_free=17.3, wall=25127
2023-08-24 09:14:53 | INFO | train_inner | epoch 024:    112 / 1474 loss=1.952, trans_loss=4.973, nll_loss=2.16, w2v_ctc_loss=0.622, task_loss=3.06, contrastive_loss=0, total=4167.42, n_correct=2741.64, ppl=4.47, accuracy=65.787, wps=13881.3, ups=1.67, wpb=8334.8, bsz=323, num_updates=34000, lr=7.66965e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=59, gb_free=17.6, wall=25187
2023-08-24 09:14:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 09:15:26 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 4.157 | trans_loss 5.556 | nll_loss 2.824 | w2v_ctc_loss 1.337 | task_loss 11.539 | contrastive_loss 0 | total 4003.4 | n_correct 2491.6 | ppl 7.08 | accuracy 62.237 | uer 16.903 | wer 18.761 | raw_wer 18.761 | bleu 20.27 | wps 1584.8 | wpb 4003.4 | bsz 141.8 | num_updates 34000 | best_bleu 20.57
2023-08-24 09:15:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 34000 updates
2023-08-24 09:15:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_24_34000.pt
2023-08-24 09:15:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_24_34000.pt
2023-08-24 09:15:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_24_34000.pt (epoch 24 @ 34000 updates, score 20.27) (writing took 7.5733500310452655 seconds)
2023-08-24 09:16:35 | INFO | train_inner | epoch 024:    212 / 1474 loss=1.948, trans_loss=4.977, nll_loss=2.166, w2v_ctc_loss=0.61, task_loss=2.88, contrastive_loss=0, total=4247.08, n_correct=2792.77, ppl=4.49, accuracy=65.757, wps=8325.9, ups=0.98, wpb=8494.2, bsz=339.5, num_updates=34100, lr=7.6584e-05, gnorm=0.507, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=25289
2023-08-24 09:17:35 | INFO | train_inner | epoch 024:    312 / 1474 loss=1.953, trans_loss=4.978, nll_loss=2.166, w2v_ctc_loss=0.617, task_loss=3.168, contrastive_loss=0, total=4139.31, n_correct=2721.77, ppl=4.49, accuracy=65.754, wps=13798.6, ups=1.67, wpb=8278.6, bsz=308.4, num_updates=34200, lr=7.64719e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=59, gb_free=16.4, wall=25349
2023-08-24 09:18:35 | INFO | train_inner | epoch 024:    412 / 1474 loss=1.965, trans_loss=4.985, nll_loss=2.175, w2v_ctc_loss=0.628, task_loss=3.437, contrastive_loss=0, total=4157.07, n_correct=2722.16, ppl=4.52, accuracy=65.483, wps=13777.4, ups=1.66, wpb=8314.1, bsz=299.9, num_updates=34300, lr=7.63604e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=15.7, wall=25409
2023-08-24 09:19:36 | INFO | train_inner | epoch 024:    512 / 1474 loss=1.964, trans_loss=4.988, nll_loss=2.179, w2v_ctc_loss=0.631, task_loss=3.361, contrastive_loss=0, total=4138.82, n_correct=2712.21, ppl=4.53, accuracy=65.531, wps=13658.9, ups=1.65, wpb=8277.6, bsz=301.6, num_updates=34400, lr=7.62493e-05, gnorm=0.52, clip=0, loss_scale=32, train_wall=60, gb_free=16.9, wall=25470
2023-08-24 09:20:36 | INFO | train_inner | epoch 024:    612 / 1474 loss=1.958, trans_loss=4.985, nll_loss=2.176, w2v_ctc_loss=0.622, task_loss=3.26, contrastive_loss=0, total=4164.75, n_correct=2730.36, ppl=4.52, accuracy=65.559, wps=13811, ups=1.66, wpb=8329.5, bsz=309.1, num_updates=34500, lr=7.61387e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=25530
2023-08-24 09:21:37 | INFO | train_inner | epoch 024:    712 / 1474 loss=1.968, trans_loss=4.999, nll_loss=2.193, w2v_ctc_loss=0.629, task_loss=3.409, contrastive_loss=0, total=4103.92, n_correct=2683.1, ppl=4.57, accuracy=65.379, wps=13536.5, ups=1.65, wpb=8207.8, bsz=294, num_updates=34600, lr=7.60286e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=60, gb_free=11.9, wall=25591
2023-08-24 09:22:37 | INFO | train_inner | epoch 024:    812 / 1474 loss=1.962, trans_loss=4.997, nll_loss=2.192, w2v_ctc_loss=0.624, task_loss=3.31, contrastive_loss=0, total=4109.8, n_correct=2690.32, ppl=4.57, accuracy=65.461, wps=13631.2, ups=1.66, wpb=8219.6, bsz=305.3, num_updates=34700, lr=7.5919e-05, gnorm=0.52, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=25651
2023-08-24 09:23:37 | INFO | train_inner | epoch 024:    912 / 1474 loss=1.974, trans_loss=5.004, nll_loss=2.2, w2v_ctc_loss=0.634, task_loss=3.646, contrastive_loss=0, total=4042.08, n_correct=2633.57, ppl=4.59, accuracy=65.154, wps=13456.1, ups=1.66, wpb=8084.2, bsz=280.6, num_updates=34800, lr=7.58098e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=59, gb_free=16.6, wall=25711
2023-08-24 09:24:38 | INFO | train_inner | epoch 024:   1012 / 1474 loss=1.968, trans_loss=5.003, nll_loss=2.2, w2v_ctc_loss=0.627, task_loss=3.401, contrastive_loss=0, total=4140.44, n_correct=2699.76, ppl=4.59, accuracy=65.205, wps=13681.8, ups=1.65, wpb=8280.9, bsz=298.7, num_updates=34900, lr=7.57011e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=11.6, wall=25772
2023-08-24 09:25:38 | INFO | train_inner | epoch 024:   1112 / 1474 loss=1.959, trans_loss=4.987, nll_loss=2.179, w2v_ctc_loss=0.626, task_loss=3.161, contrastive_loss=0, total=4134.93, n_correct=2711.22, ppl=4.53, accuracy=65.569, wps=13783.5, ups=1.67, wpb=8269.9, bsz=309.4, num_updates=35000, lr=7.55929e-05, gnorm=0.515, clip=0, loss_scale=32, train_wall=59, gb_free=16.2, wall=25832
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 09:26:38 | INFO | train_inner | epoch 024:   1212 / 1474 loss=1.964, trans_loss=4.999, nll_loss=2.195, w2v_ctc_loss=0.626, task_loss=3.276, contrastive_loss=0, total=4144.49, n_correct=2706.61, ppl=4.58, accuracy=65.306, wps=13705.2, ups=1.65, wpb=8289, bsz=309.8, num_updates=35100, lr=7.54851e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=25892
2023-08-24 09:27:39 | INFO | train_inner | epoch 024:   1312 / 1474 loss=1.972, trans_loss=5.004, nll_loss=2.2, w2v_ctc_loss=0.638, task_loss=3.519, contrastive_loss=0, total=4110.93, n_correct=2685.58, ppl=4.6, accuracy=65.328, wps=13494.9, ups=1.64, wpb=8221.9, bsz=293, num_updates=35200, lr=7.53778e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=60, gb_free=13.4, wall=25953
2023-08-24 09:28:39 | INFO | train_inner | epoch 024:   1412 / 1474 loss=1.972, trans_loss=5.008, nll_loss=2.206, w2v_ctc_loss=0.637, task_loss=3.424, contrastive_loss=0, total=4088.73, n_correct=2667.83, ppl=4.61, accuracy=65.248, wps=13635.7, ups=1.67, wpb=8177.5, bsz=294.1, num_updates=35300, lr=7.5271e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=59, gb_free=17.6, wall=26013
2023-08-24 09:29:16 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
2023-08-24 09:29:49 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 4.156 | trans_loss 5.547 | nll_loss 2.816 | w2v_ctc_loss 1.352 | task_loss 11.608 | contrastive_loss 0 | total 4003.4 | n_correct 2491.5 | ppl 7.04 | accuracy 62.235 | uer 17.044 | wer 18.832 | raw_wer 18.832 | bleu 20.1 | wps 1652.4 | wpb 4003.4 | bsz 141.8 | num_updates 35362 | best_bleu 20.57
2023-08-24 09:29:49 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 35362 updates
2023-08-24 09:29:49 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1003.pt
2023-08-24 09:29:51 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1003.pt
2023-08-24 09:29:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.1003.pt (epoch 24 @ 35362 updates, score 20.1) (writing took 6.865008431021124 seconds)
2023-08-24 09:29:56 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2023-08-24 09:29:56 | INFO | train | epoch 024 | loss 1.962 | trans_loss 4.992 | nll_loss 2.185 | w2v_ctc_loss 0.626 | task_loss 3.284 | contrastive_loss 0 | total 4138.65 | n_correct 2709.56 | ppl 4.55 | accuracy 65.47 | wps 12472.9 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 35362 | lr 7.5205e-05 | gnorm 0.519 | clip 0 | loss_scale 32 | train_wall 880 | gb_free 16.1 | wall 26090
2023-08-24 09:29:56 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 09:29:56 | INFO | fairseq.trainer | begin training epoch 25
2023-08-24 09:29:56 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 09:30:26 | INFO | train_inner | epoch 025:     38 / 1474 loss=1.955, trans_loss=4.986, nll_loss=2.178, w2v_ctc_loss=0.62, task_loss=3.13, contrastive_loss=0, total=4170.36, n_correct=2741.2, ppl=4.52, accuracy=65.731, wps=7766, ups=0.93, wpb=8340.7, bsz=313, num_updates=35400, lr=7.51646e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=16.2, wall=26121
2023-08-24 09:31:26 | INFO | train_inner | epoch 025:    138 / 1474 loss=1.944, trans_loss=4.96, nll_loss=2.144, w2v_ctc_loss=0.61, task_loss=3.238, contrastive_loss=0, total=4133.56, n_correct=2733.55, ppl=4.42, accuracy=66.131, wps=13814.8, ups=1.67, wpb=8267.1, bsz=306.4, num_updates=35500, lr=7.50587e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=26181
2023-08-24 09:32:27 | INFO | train_inner | epoch 025:    238 / 1474 loss=1.95, trans_loss=4.968, nll_loss=2.153, w2v_ctc_loss=0.621, task_loss=3.367, contrastive_loss=0, total=4112.46, n_correct=2712.46, ppl=4.45, accuracy=65.957, wps=13538.2, ups=1.65, wpb=8224.9, bsz=303.4, num_updates=35600, lr=7.49532e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=26241
2023-08-24 09:33:28 | INFO | train_inner | epoch 025:    338 / 1474 loss=1.955, trans_loss=4.973, nll_loss=2.159, w2v_ctc_loss=0.617, task_loss=3.54, contrastive_loss=0, total=4139.11, n_correct=2723.62, ppl=4.47, accuracy=65.802, wps=13627.1, ups=1.65, wpb=8278.2, bsz=291.7, num_updates=35700, lr=7.48481e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=60, gb_free=14.9, wall=26302
2023-08-24 09:34:29 | INFO | train_inner | epoch 025:    438 / 1474 loss=1.96, trans_loss=4.975, nll_loss=2.163, w2v_ctc_loss=0.631, task_loss=3.347, contrastive_loss=0, total=4181.96, n_correct=2753.17, ppl=4.48, accuracy=65.834, wps=13699.2, ups=1.64, wpb=8363.9, bsz=303, num_updates=35800, lr=7.47435e-05, gnorm=0.516, clip=0, loss_scale=64, train_wall=60, gb_free=16.5, wall=26363
2023-08-24 09:35:29 | INFO | train_inner | epoch 025:    538 / 1474 loss=1.958, trans_loss=4.986, nll_loss=2.178, w2v_ctc_loss=0.624, task_loss=3.214, contrastive_loss=0, total=4162.59, n_correct=2730.2, ppl=4.52, accuracy=65.589, wps=13823.8, ups=1.66, wpb=8325.2, bsz=312.9, num_updates=35900, lr=7.46393e-05, gnorm=0.515, clip=0, loss_scale=64, train_wall=60, gb_free=11.7, wall=26423
2023-08-24 09:36:29 | INFO | train_inner | epoch 025:    638 / 1474 loss=1.952, trans_loss=4.974, nll_loss=2.163, w2v_ctc_loss=0.616, task_loss=3.285, contrastive_loss=0, total=4142.58, n_correct=2724.73, ppl=4.48, accuracy=65.774, wps=13755.7, ups=1.66, wpb=8285.2, bsz=308.3, num_updates=36000, lr=7.45356e-05, gnorm=0.52, clip=0, loss_scale=64, train_wall=59, gb_free=14.6, wall=26484
2023-08-24 09:36:29 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 09:37:03 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 4.172 | trans_loss 5.557 | nll_loss 2.83 | w2v_ctc_loss 1.384 | task_loss 11.551 | contrastive_loss 0 | total 4003.4 | n_correct 2487.3 | ppl 7.11 | accuracy 62.13 | uer 17.23 | wer 19.086 | raw_wer 19.086 | bleu 20.29 | wps 1599.3 | wpb 4003.4 | bsz 141.8 | num_updates 36000 | best_bleu 20.57
2023-08-24 09:37:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 36000 updates
2023-08-24 09:37:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_25_36000.pt
2023-08-24 09:37:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_25_36000.pt
2023-08-24 09:37:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_25_36000.pt (epoch 25 @ 36000 updates, score 20.29) (writing took 6.97473589098081 seconds)
2023-08-24 09:38:11 | INFO | train_inner | epoch 025:    738 / 1474 loss=1.958, trans_loss=4.983, nll_loss=2.174, w2v_ctc_loss=0.623, task_loss=3.33, contrastive_loss=0, total=4126.89, n_correct=2713, ppl=4.51, accuracy=65.74, wps=8136.2, ups=0.99, wpb=8253.8, bsz=300.9, num_updates=36100, lr=7.44323e-05, gnorm=0.532, clip=0, loss_scale=64, train_wall=60, gb_free=17, wall=26585
2023-08-24 09:39:11 | INFO | train_inner | epoch 025:    838 / 1474 loss=1.954, trans_loss=4.985, nll_loss=2.178, w2v_ctc_loss=0.621, task_loss=3.003, contrastive_loss=0, total=4199.63, n_correct=2759.32, ppl=4.52, accuracy=65.704, wps=13939.7, ups=1.66, wpb=8399.3, bsz=329, num_updates=36200, lr=7.43294e-05, gnorm=0.519, clip=0, loss_scale=64, train_wall=59, gb_free=16, wall=26645
2023-08-24 09:40:12 | INFO | train_inner | epoch 025:    938 / 1474 loss=1.958, trans_loss=4.988, nll_loss=2.181, w2v_ctc_loss=0.626, task_loss=3.164, contrastive_loss=0, total=4134.29, n_correct=2713.78, ppl=4.54, accuracy=65.641, wps=13668.9, ups=1.65, wpb=8268.6, bsz=312.8, num_updates=36300, lr=7.4227e-05, gnorm=0.519, clip=0, loss_scale=64, train_wall=60, gb_free=17.2, wall=26706
2023-08-24 09:41:12 | INFO | train_inner | epoch 025:   1038 / 1474 loss=1.963, trans_loss=4.998, nll_loss=2.194, w2v_ctc_loss=0.62, task_loss=3.25, contrastive_loss=0, total=4184.54, n_correct=2734.8, ppl=4.58, accuracy=65.355, wps=13907.9, ups=1.66, wpb=8369.1, bsz=311.2, num_updates=36400, lr=7.41249e-05, gnorm=0.524, clip=0, loss_scale=64, train_wall=60, gb_free=17.5, wall=26766
2023-08-24 09:42:12 | INFO | train_inner | epoch 025:   1138 / 1474 loss=1.963, trans_loss=4.993, nll_loss=2.187, w2v_ctc_loss=0.622, task_loss=3.556, contrastive_loss=0, total=4042.38, n_correct=2644.72, ppl=4.55, accuracy=65.425, wps=13330.7, ups=1.65, wpb=8084.8, bsz=286.2, num_updates=36500, lr=7.40233e-05, gnorm=0.534, clip=0, loss_scale=64, train_wall=60, gb_free=16.9, wall=26827
2023-08-24 09:43:12 | INFO | train_inner | epoch 025:   1238 / 1474 loss=1.961, trans_loss=4.996, nll_loss=2.19, w2v_ctc_loss=0.618, task_loss=3.381, contrastive_loss=0, total=4077.76, n_correct=2666.81, ppl=4.56, accuracy=65.399, wps=13708.7, ups=1.68, wpb=8155.5, bsz=291.8, num_updates=36600, lr=7.39221e-05, gnorm=0.527, clip=0, loss_scale=64, train_wall=59, gb_free=15.4, wall=26886
2023-08-24 09:43:42 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 09:44:13 | INFO | train_inner | epoch 025:   1339 / 1474 loss=1.959, trans_loss=4.991, nll_loss=2.185, w2v_ctc_loss=0.623, task_loss=3.139, contrastive_loss=0, total=4181.81, n_correct=2739.22, ppl=4.55, accuracy=65.503, wps=13780.9, ups=1.65, wpb=8363.6, bsz=314.3, num_updates=36700, lr=7.38213e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=16.6, wall=26947
2023-08-24 09:45:13 | INFO | train_inner | epoch 025:   1439 / 1474 loss=1.969, trans_loss=5.007, nll_loss=2.205, w2v_ctc_loss=0.628, task_loss=3.406, contrastive_loss=0, total=4102.27, n_correct=2676.07, ppl=4.61, accuracy=65.234, wps=13478, ups=1.64, wpb=8204.5, bsz=299.9, num_updates=36800, lr=7.3721e-05, gnorm=0.533, clip=0, loss_scale=32, train_wall=60, gb_free=15.8, wall=27008
2023-08-24 09:45:35 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 09:46:08 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 4.153 | trans_loss 5.543 | nll_loss 2.812 | w2v_ctc_loss 1.351 | task_loss 11.555 | contrastive_loss 0 | total 4003.4 | n_correct 2497.6 | ppl 7.02 | accuracy 62.387 | uer 16.887 | wer 18.78 | raw_wer 18.78 | bleu 19.87 | wps 1640.6 | wpb 4003.4 | bsz 141.8 | num_updates 36835 | best_bleu 20.57
2023-08-24 09:46:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 36835 updates
2023-08-24 09:46:08 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 09:46:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 09:46:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 25 @ 36835 updates, score 19.87) (writing took 5.840797645039856 seconds)
2023-08-24 09:46:14 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2023-08-24 09:46:14 | INFO | train | epoch 025 | loss 1.957 | trans_loss 4.984 | nll_loss 2.175 | w2v_ctc_loss 0.621 | task_loss 3.285 | contrastive_loss 0 | total 4139.06 | n_correct 2717.59 | ppl 4.52 | accuracy 65.657 | wps 12474.9 | ups 1.51 | wpb 8278.1 | bsz 305.7 | num_updates 36835 | lr 7.36859e-05 | gnorm 0.524 | clip 0 | loss_scale 32 | train_wall 880 | gb_free 14.2 | wall 27068
2023-08-24 09:46:14 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 09:46:14 | INFO | fairseq.trainer | begin training epoch 26
2023-08-24 09:46:14 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 09:47:00 | INFO | train_inner | epoch 026:     65 / 1474 loss=1.944, trans_loss=4.964, nll_loss=2.15, w2v_ctc_loss=0.61, task_loss=3.098, contrastive_loss=0, total=4178.19, n_correct=2759.69, ppl=4.44, accuracy=66.05, wps=7849.1, ups=0.94, wpb=8356.4, bsz=317.5, num_updates=36900, lr=7.3621e-05, gnorm=0.521, clip=0, loss_scale=32, train_wall=60, gb_free=14.2, wall=27114
2023-08-24 09:48:01 | INFO | train_inner | epoch 026:    165 / 1474 loss=1.937, trans_loss=4.96, nll_loss=2.145, w2v_ctc_loss=0.603, task_loss=2.864, contrastive_loss=0, total=4269.55, n_correct=2824.53, ppl=4.42, accuracy=66.155, wps=14029.5, ups=1.64, wpb=8539.1, bsz=341.4, num_updates=37000, lr=7.35215e-05, gnorm=0.513, clip=0, loss_scale=32, train_wall=60, gb_free=15.2, wall=27175
2023-08-24 09:49:01 | INFO | train_inner | epoch 026:    265 / 1474 loss=1.948, trans_loss=4.963, nll_loss=2.148, w2v_ctc_loss=0.618, task_loss=3.25, contrastive_loss=0, total=4128.39, n_correct=2724.32, ppl=4.43, accuracy=65.99, wps=13741.6, ups=1.66, wpb=8256.8, bsz=306.8, num_updates=37100, lr=7.34223e-05, gnorm=0.516, clip=0, loss_scale=32, train_wall=59, gb_free=9.7, wall=27235
2023-08-24 09:50:01 | INFO | train_inner | epoch 026:    365 / 1474 loss=1.946, trans_loss=4.965, nll_loss=2.151, w2v_ctc_loss=0.616, task_loss=3.143, contrastive_loss=0, total=4166.22, n_correct=2749.06, ppl=4.44, accuracy=65.985, wps=13811, ups=1.66, wpb=8332.4, bsz=315, num_updates=37200, lr=7.33236e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=16.6, wall=27296
2023-08-24 09:51:01 | INFO | train_inner | epoch 026:    465 / 1474 loss=1.944, trans_loss=4.96, nll_loss=2.144, w2v_ctc_loss=0.612, task_loss=3.125, contrastive_loss=0, total=4171.18, n_correct=2759.81, ppl=4.42, accuracy=66.164, wps=13867.1, ups=1.66, wpb=8342.4, bsz=315.5, num_updates=37300, lr=7.32252e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=59, gb_free=16.5, wall=27356
2023-08-24 09:52:02 | INFO | train_inner | epoch 026:    565 / 1474 loss=1.959, trans_loss=4.979, nll_loss=2.168, w2v_ctc_loss=0.63, task_loss=3.355, contrastive_loss=0, total=4139.82, n_correct=2722.72, ppl=4.49, accuracy=65.769, wps=13678.8, ups=1.65, wpb=8279.6, bsz=300, num_updates=37400, lr=7.31272e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=60, gb_free=14.9, wall=27416
2023-08-24 09:53:02 | INFO | train_inner | epoch 026:    665 / 1474 loss=1.948, trans_loss=4.972, nll_loss=2.159, w2v_ctc_loss=0.611, task_loss=3.311, contrastive_loss=0, total=4146.72, n_correct=2735.49, ppl=4.47, accuracy=65.968, wps=13796.8, ups=1.66, wpb=8293.4, bsz=302.7, num_updates=37500, lr=7.30297e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=27476
2023-08-24 09:54:02 | INFO | train_inner | epoch 026:    765 / 1474 loss=1.953, trans_loss=4.979, nll_loss=2.168, w2v_ctc_loss=0.612, task_loss=3.353, contrastive_loss=0, total=4084.89, n_correct=2684.09, ppl=4.49, accuracy=65.708, wps=13615.1, ups=1.67, wpb=8169.8, bsz=297.2, num_updates=37600, lr=7.29325e-05, gnorm=0.536, clip=0, loss_scale=32, train_wall=59, gb_free=17.2, wall=27536
2023-08-24 09:55:02 | INFO | train_inner | epoch 026:    865 / 1474 loss=1.954, trans_loss=4.976, nll_loss=2.165, w2v_ctc_loss=0.622, task_loss=3.241, contrastive_loss=0, total=4180.78, n_correct=2749.91, ppl=4.48, accuracy=65.775, wps=13873.6, ups=1.66, wpb=8361.6, bsz=309.6, num_updates=37700, lr=7.28357e-05, gnorm=0.514, clip=0, loss_scale=32, train_wall=60, gb_free=15.9, wall=27597
2023-08-24 09:56:03 | INFO | train_inner | epoch 026:    965 / 1474 loss=1.954, trans_loss=4.987, nll_loss=2.178, w2v_ctc_loss=0.608, task_loss=3.408, contrastive_loss=0, total=4147.79, n_correct=2723.97, ppl=4.53, accuracy=65.673, wps=13663.2, ups=1.65, wpb=8295.6, bsz=299.5, num_updates=37800, lr=7.27393e-05, gnorm=0.514, clip=0, loss_scale=32, train_wall=60, gb_free=12.2, wall=27657
2023-08-24 09:57:03 | INFO | train_inner | epoch 026:   1065 / 1474 loss=1.957, trans_loss=4.984, nll_loss=2.175, w2v_ctc_loss=0.619, task_loss=3.465, contrastive_loss=0, total=4118.07, n_correct=2706.48, ppl=4.52, accuracy=65.722, wps=13666.2, ups=1.66, wpb=8236.1, bsz=293.6, num_updates=37900, lr=7.26433e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=60, gb_free=15.7, wall=27718
2023-08-24 09:58:04 | INFO | train_inner | epoch 026:   1165 / 1474 loss=1.959, trans_loss=4.993, nll_loss=2.187, w2v_ctc_loss=0.617, task_loss=3.435, contrastive_loss=0, total=4108.48, n_correct=2689.02, ppl=4.55, accuracy=65.45, wps=13567.1, ups=1.65, wpb=8217, bsz=297.9, num_updates=38000, lr=7.25476e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=60, gb_free=16.3, wall=27778
2023-08-24 09:58:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 09:58:37 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 4.175 | trans_loss 5.56 | nll_loss 2.832 | w2v_ctc_loss 1.389 | task_loss 11.606 | contrastive_loss 0 | total 4003.4 | n_correct 2487.2 | ppl 7.12 | accuracy 62.127 | uer 17.214 | wer 19.086 | raw_wer 19.086 | bleu 20.02 | wps 1646.9 | wpb 4003.4 | bsz 141.8 | num_updates 38000 | best_bleu 20.57
2023-08-24 09:58:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 38000 updates
2023-08-24 09:58:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_26_38000.pt
2023-08-24 09:58:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_26_38000.pt
2023-08-24 09:58:45 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_26_38000.pt (epoch 26 @ 38000 updates, score 20.02) (writing took 8.140278398990631 seconds)
2023-08-24 09:59:45 | INFO | train_inner | epoch 026:   1265 / 1474 loss=1.971, trans_loss=5.002, nll_loss=2.199, w2v_ctc_loss=0.635, task_loss=3.665, contrastive_loss=0, total=4005.94, n_correct=2614.45, ppl=4.59, accuracy=65.264, wps=7900.6, ups=0.99, wpb=8011.9, bsz=280.6, num_updates=38100, lr=7.24524e-05, gnorm=0.539, clip=0, loss_scale=32, train_wall=59, gb_free=16.3, wall=27880
2023-08-24 10:00:46 | INFO | train_inner | epoch 026:   1365 / 1474 loss=1.953, trans_loss=4.99, nll_loss=2.183, w2v_ctc_loss=0.61, task_loss=3.318, contrastive_loss=0, total=4146.34, n_correct=2723.54, ppl=4.54, accuracy=65.685, wps=13568.7, ups=1.64, wpb=8292.7, bsz=307.7, num_updates=38200, lr=7.23575e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=27941
2023-08-24 10:01:47 | INFO | train_inner | epoch 026:   1465 / 1474 loss=1.949, trans_loss=4.987, nll_loss=2.181, w2v_ctc_loss=0.608, task_loss=3.081, contrastive_loss=0, total=4172.4, n_correct=2743.82, ppl=4.53, accuracy=65.761, wps=13839.4, ups=1.66, wpb=8344.8, bsz=320, num_updates=38300, lr=7.22629e-05, gnorm=0.517, clip=0, loss_scale=32, train_wall=60, gb_free=16, wall=28001
2023-08-24 10:01:52 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 10:02:25 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 4.148 | trans_loss 5.552 | nll_loss 2.823 | w2v_ctc_loss 1.316 | task_loss 11.539 | contrastive_loss 0 | total 4003.4 | n_correct 2498.1 | ppl 7.07 | accuracy 62.399 | uer 16.911 | wer 18.855 | raw_wer 18.855 | bleu 19.89 | wps 1657.5 | wpb 4003.4 | bsz 141.8 | num_updates 38309 | best_bleu 20.57
2023-08-24 10:02:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 38309 updates
2023-08-24 10:02:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 10:02:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 10:02:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 26 @ 38309 updates, score 19.89) (writing took 5.879226673976518 seconds)
2023-08-24 10:02:31 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2023-08-24 10:02:31 | INFO | train | epoch 026 | loss 1.952 | trans_loss 4.977 | nll_loss 2.166 | w2v_ctc_loss 0.616 | task_loss 3.284 | contrastive_loss 0 | total 4138.65 | n_correct 2723.98 | ppl 4.49 | accuracy 65.818 | wps 12488.3 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 38309 | lr 7.22544e-05 | gnorm 0.522 | clip 0 | loss_scale 32 | train_wall 879 | gb_free 15.9 | wall 28045
2023-08-24 10:02:31 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 10:02:31 | INFO | fairseq.trainer | begin training epoch 27
2023-08-24 10:02:31 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 10:03:32 | INFO | train_inner | epoch 027:     91 / 1474 loss=1.937, trans_loss=4.944, nll_loss=2.121, w2v_ctc_loss=0.601, task_loss=3.55, contrastive_loss=0, total=4051.87, n_correct=2695.02, ppl=4.35, accuracy=66.513, wps=7691.6, ups=0.95, wpb=8103.7, bsz=281.2, num_updates=38400, lr=7.21688e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=28106
2023-08-24 10:04:32 | INFO | train_inner | epoch 027:    191 / 1474 loss=1.934, trans_loss=4.945, nll_loss=2.125, w2v_ctc_loss=0.611, task_loss=3.104, contrastive_loss=0, total=4197.99, n_correct=2792.82, ppl=4.36, accuracy=66.528, wps=13912, ups=1.66, wpb=8396, bsz=324.3, num_updates=38500, lr=7.2075e-05, gnorm=0.515, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=28167
2023-08-24 10:05:33 | INFO | train_inner | epoch 027:    291 / 1474 loss=1.94, trans_loss=4.956, nll_loss=2.139, w2v_ctc_loss=0.605, task_loss=3.297, contrastive_loss=0, total=4161.57, n_correct=2758.61, ppl=4.4, accuracy=66.288, wps=13787, ups=1.66, wpb=8323.1, bsz=305.5, num_updates=38600, lr=7.19816e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=60, gb_free=15.2, wall=28227
2023-08-24 10:06:33 | INFO | train_inner | epoch 027:    391 / 1474 loss=1.946, trans_loss=4.965, nll_loss=2.15, w2v_ctc_loss=0.607, task_loss=3.414, contrastive_loss=0, total=4085.81, n_correct=2699.34, ppl=4.44, accuracy=66.066, wps=13475.1, ups=1.65, wpb=8171.6, bsz=298.1, num_updates=38700, lr=7.18885e-05, gnorm=0.52, clip=0, loss_scale=64, train_wall=60, gb_free=15.3, wall=28288
2023-08-24 10:07:34 | INFO | train_inner | epoch 027:    491 / 1474 loss=1.94, trans_loss=4.966, nll_loss=2.153, w2v_ctc_loss=0.606, task_loss=3.015, contrastive_loss=0, total=4241.27, n_correct=2800.18, ppl=4.45, accuracy=66.022, wps=13922.8, ups=1.64, wpb=8482.5, bsz=330.9, num_updates=38800, lr=7.17958e-05, gnorm=0.513, clip=0, loss_scale=64, train_wall=60, gb_free=15.8, wall=28349
2023-08-24 10:08:34 | INFO | train_inner | epoch 027:    591 / 1474 loss=1.945, trans_loss=4.966, nll_loss=2.152, w2v_ctc_loss=0.613, task_loss=3.199, contrastive_loss=0, total=4133.35, n_correct=2729.89, ppl=4.45, accuracy=66.045, wps=13810.1, ups=1.67, wpb=8266.7, bsz=312.8, num_updates=38900, lr=7.17035e-05, gnorm=0.53, clip=0, loss_scale=64, train_wall=59, gb_free=12.6, wall=28409
2023-08-24 10:09:35 | INFO | train_inner | epoch 027:    691 / 1474 loss=1.952, trans_loss=4.975, nll_loss=2.163, w2v_ctc_loss=0.618, task_loss=3.322, contrastive_loss=0, total=4151.08, n_correct=2737.59, ppl=4.48, accuracy=65.949, wps=13700.8, ups=1.65, wpb=8302.2, bsz=302.6, num_updates=39000, lr=7.16115e-05, gnorm=0.524, clip=0, loss_scale=64, train_wall=60, gb_free=17, wall=28469
2023-08-24 10:10:35 | INFO | train_inner | epoch 027:    791 / 1474 loss=1.953, trans_loss=4.972, nll_loss=2.159, w2v_ctc_loss=0.62, task_loss=3.454, contrastive_loss=0, total=4106.27, n_correct=2709.06, ppl=4.47, accuracy=65.974, wps=13677.1, ups=1.67, wpb=8212.5, bsz=293, num_updates=39100, lr=7.15199e-05, gnorm=0.528, clip=0, loss_scale=64, train_wall=59, gb_free=16.4, wall=28529
2023-08-24 10:11:35 | INFO | train_inner | epoch 027:    891 / 1474 loss=1.946, trans_loss=4.976, nll_loss=2.165, w2v_ctc_loss=0.601, task_loss=3.392, contrastive_loss=0, total=4112.64, n_correct=2714.7, ppl=4.48, accuracy=66.009, wps=13694.4, ups=1.66, wpb=8225.3, bsz=294.8, num_updates=39200, lr=7.14286e-05, gnorm=0.518, clip=0, loss_scale=64, train_wall=59, gb_free=17.5, wall=28589
2023-08-24 10:12:36 | INFO | train_inner | epoch 027:    991 / 1474 loss=1.947, trans_loss=4.974, nll_loss=2.163, w2v_ctc_loss=0.609, task_loss=3.177, contrastive_loss=0, total=4195.59, n_correct=2763.08, ppl=4.48, accuracy=65.857, wps=13752.3, ups=1.64, wpb=8391.2, bsz=316.2, num_updates=39300, lr=7.13376e-05, gnorm=0.518, clip=0, loss_scale=64, train_wall=60, gb_free=17.7, wall=28650
2023-08-24 10:13:36 | INFO | train_inner | epoch 027:   1091 / 1474 loss=1.946, trans_loss=4.973, nll_loss=2.162, w2v_ctc_loss=0.608, task_loss=3.3, contrastive_loss=0, total=4151.68, n_correct=2737.89, ppl=4.47, accuracy=65.947, wps=13755.5, ups=1.66, wpb=8303.4, bsz=305, num_updates=39400, lr=7.1247e-05, gnorm=0.518, clip=0, loss_scale=64, train_wall=60, gb_free=16.9, wall=28711
2023-08-24 10:13:52 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 10:14:38 | INFO | train_inner | epoch 027:   1192 / 1474 loss=1.953, trans_loss=4.978, nll_loss=2.168, w2v_ctc_loss=0.619, task_loss=3.424, contrastive_loss=0, total=4105.52, n_correct=2702.71, ppl=4.49, accuracy=65.831, wps=13426.1, ups=1.64, wpb=8211, bsz=298.3, num_updates=39500, lr=7.11568e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=60, gb_free=17.6, wall=28772
2023-08-24 10:15:38 | INFO | train_inner | epoch 027:   1292 / 1474 loss=1.959, trans_loss=4.988, nll_loss=2.181, w2v_ctc_loss=0.618, task_loss=3.512, contrastive_loss=0, total=4065.94, n_correct=2665.56, ppl=4.53, accuracy=65.558, wps=13559.9, ups=1.67, wpb=8131.9, bsz=292.4, num_updates=39600, lr=7.10669e-05, gnorm=0.533, clip=0, loss_scale=32, train_wall=59, gb_free=15.9, wall=28832
2023-08-24 10:16:37 | INFO | train_inner | epoch 027:   1392 / 1474 loss=1.947, trans_loss=4.978, nll_loss=2.169, w2v_ctc_loss=0.609, task_loss=3.091, contrastive_loss=0, total=4149.21, n_correct=2732.3, ppl=4.5, accuracy=65.851, wps=13893.8, ups=1.67, wpb=8298.4, bsz=312.6, num_updates=39700, lr=7.09773e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=59, gb_free=16.8, wall=28892
2023-08-24 10:17:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 10:17:59 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 4.146 | trans_loss 5.55 | nll_loss 2.817 | w2v_ctc_loss 1.311 | task_loss 11.523 | contrastive_loss 0 | total 4003.4 | n_correct 2497.3 | ppl 7.05 | accuracy 62.379 | uer 16.731 | wer 18.534 | raw_wer 18.534 | bleu 20.34 | wps 1649.5 | wpb 4003.4 | bsz 141.8 | num_updates 39782 | best_bleu 20.57
2023-08-24 10:17:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 39782 updates
2023-08-24 10:17:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3401.pt
2023-08-24 10:18:02 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3401.pt
2023-08-24 10:18:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3401.pt (epoch 27 @ 39782 updates, score 20.34) (writing took 7.515019209007733 seconds)
2023-08-24 10:18:07 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2023-08-24 10:18:07 | INFO | train | epoch 027 | loss 1.946 | trans_loss 4.968 | nll_loss 2.155 | w2v_ctc_loss 0.61 | task_loss 3.282 | contrastive_loss 0 | total 4138.61 | n_correct 2732.9 | ppl 4.45 | accuracy 66.034 | wps 13017 | ups 1.57 | wpb 8277.2 | bsz 305.7 | num_updates 39782 | lr 7.09042e-05 | gnorm 0.522 | clip 0 | loss_scale 32 | train_wall 878 | gb_free 17.8 | wall 28982
2023-08-24 10:18:07 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 10:18:07 | INFO | fairseq.trainer | begin training epoch 28
2023-08-24 10:18:07 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 10:18:26 | INFO | train_inner | epoch 028:     18 / 1474 loss=1.939, trans_loss=4.967, nll_loss=2.154, w2v_ctc_loss=0.6, task_loss=3.173, contrastive_loss=0, total=4106.72, n_correct=2715.52, ppl=4.45, accuracy=66.124, wps=7543.5, ups=0.92, wpb=8213.4, bsz=305, num_updates=39800, lr=7.08881e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=59, gb_free=16.1, wall=29000
2023-08-24 10:19:26 | INFO | train_inner | epoch 028:    118 / 1474 loss=1.937, trans_loss=4.942, nll_loss=2.119, w2v_ctc_loss=0.608, task_loss=3.445, contrastive_loss=0, total=4103.42, n_correct=2734.87, ppl=4.35, accuracy=66.649, wps=13719.5, ups=1.67, wpb=8206.8, bsz=292, num_updates=39900, lr=7.07992e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=59, gb_free=16, wall=29060
2023-08-24 10:20:26 | INFO | train_inner | epoch 028:    218 / 1474 loss=1.929, trans_loss=4.946, nll_loss=2.125, w2v_ctc_loss=0.597, task_loss=3.073, contrastive_loss=0, total=4200.12, n_correct=2797.07, ppl=4.36, accuracy=66.595, wps=13976.2, ups=1.66, wpb=8400.2, bsz=317.8, num_updates=40000, lr=7.07107e-05, gnorm=0.52, clip=0, loss_scale=32, train_wall=59, gb_free=10.8, wall=29120
2023-08-24 10:20:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 10:20:59 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 4.168 | trans_loss 5.548 | nll_loss 2.817 | w2v_ctc_loss 1.39 | task_loss 11.608 | contrastive_loss 0 | total 4003.4 | n_correct 2493.4 | ppl 7.05 | accuracy 62.282 | uer 16.925 | wer 18.664 | raw_wer 18.664 | bleu 20.38 | wps 1624.2 | wpb 4003.4 | bsz 141.8 | num_updates 40000 | best_bleu 20.57
2023-08-24 10:20:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 40000 updates
2023-08-24 10:20:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_28_40000.pt
2023-08-24 10:21:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_28_40000.pt
2023-08-24 10:21:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_28_40000.pt (epoch 28 @ 40000 updates, score 20.38) (writing took 7.702009677886963 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 10:22:08 | INFO | train_inner | epoch 028:    318 / 1474 loss=1.941, trans_loss=4.959, nll_loss=2.143, w2v_ctc_loss=0.603, task_loss=3.278, contrastive_loss=0, total=4147.36, n_correct=2738.45, ppl=4.42, accuracy=66.029, wps=8144.5, ups=0.98, wpb=8294.7, bsz=315.4, num_updates=40100, lr=7.06225e-05, gnorm=0.541, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=29222
2023-08-24 10:23:08 | INFO | train_inner | epoch 028:    418 / 1474 loss=1.941, trans_loss=4.954, nll_loss=2.136, w2v_ctc_loss=0.608, task_loss=3.401, contrastive_loss=0, total=4087.34, n_correct=2710.35, ppl=4.4, accuracy=66.311, wps=13626.9, ups=1.67, wpb=8174.7, bsz=295.1, num_updates=40200, lr=7.05346e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=29282
2023-08-24 10:24:09 | INFO | train_inner | epoch 028:    518 / 1474 loss=1.939, trans_loss=4.957, nll_loss=2.14, w2v_ctc_loss=0.601, task_loss=3.408, contrastive_loss=0, total=4099.71, n_correct=2719.59, ppl=4.41, accuracy=66.336, wps=13498.2, ups=1.65, wpb=8199.4, bsz=296.2, num_updates=40300, lr=7.0447e-05, gnorm=0.535, clip=0, loss_scale=32, train_wall=60, gb_free=15.2, wall=29343
2023-08-24 10:25:09 | INFO | train_inner | epoch 028:    618 / 1474 loss=1.943, trans_loss=4.966, nll_loss=2.152, w2v_ctc_loss=0.604, task_loss=3.332, contrastive_loss=0, total=4177.06, n_correct=2761.57, ppl=4.44, accuracy=66.113, wps=13898.6, ups=1.66, wpb=8354.1, bsz=304.1, num_updates=40400, lr=7.03598e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=17.2, wall=29403
2023-08-24 10:26:09 | INFO | train_inner | epoch 028:    718 / 1474 loss=1.939, trans_loss=4.966, nll_loss=2.154, w2v_ctc_loss=0.606, task_loss=2.954, contrastive_loss=0, total=4190.74, n_correct=2772.36, ppl=4.45, accuracy=66.154, wps=13876.5, ups=1.66, wpb=8381.5, bsz=328.5, num_updates=40500, lr=7.02728e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=60, gb_free=15.3, wall=29464
2023-08-24 10:27:09 | INFO | train_inner | epoch 028:    818 / 1474 loss=1.937, trans_loss=4.962, nll_loss=2.147, w2v_ctc_loss=0.602, task_loss=3.247, contrastive_loss=0, total=4091.75, n_correct=2713.79, ppl=4.43, accuracy=66.323, wps=13619.1, ups=1.66, wpb=8183.5, bsz=306, num_updates=40600, lr=7.01862e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=59, gb_free=16.3, wall=29524
2023-08-24 10:28:10 | INFO | train_inner | epoch 028:    918 / 1474 loss=1.945, trans_loss=4.969, nll_loss=2.156, w2v_ctc_loss=0.606, task_loss=3.376, contrastive_loss=0, total=4123.89, n_correct=2724.45, ppl=4.46, accuracy=66.065, wps=13596.3, ups=1.65, wpb=8247.8, bsz=301, num_updates=40700, lr=7.01e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=29584
2023-08-24 10:29:10 | INFO | train_inner | epoch 028:   1018 / 1474 loss=1.947, trans_loss=4.97, nll_loss=2.158, w2v_ctc_loss=0.613, task_loss=3.191, contrastive_loss=0, total=4176.06, n_correct=2756.41, ppl=4.46, accuracy=66.005, wps=13800.9, ups=1.65, wpb=8352.1, bsz=311.4, num_updates=40800, lr=7.0014e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=29645
2023-08-24 10:30:11 | INFO | train_inner | epoch 028:   1118 / 1474 loss=1.937, trans_loss=4.961, nll_loss=2.147, w2v_ctc_loss=0.602, task_loss=3.188, contrastive_loss=0, total=4206.08, n_correct=2788.24, ppl=4.43, accuracy=66.291, wps=13915.1, ups=1.65, wpb=8412.2, bsz=317.3, num_updates=40900, lr=6.99284e-05, gnorm=0.521, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=29705
2023-08-24 10:31:11 | INFO | train_inner | epoch 028:   1218 / 1474 loss=1.938, trans_loss=4.966, nll_loss=2.153, w2v_ctc_loss=0.597, task_loss=3.226, contrastive_loss=0, total=4109.72, n_correct=2715.87, ppl=4.45, accuracy=66.084, wps=13696.8, ups=1.67, wpb=8219.4, bsz=306.9, num_updates=41000, lr=6.9843e-05, gnorm=0.538, clip=0, loss_scale=32, train_wall=59, gb_free=16.1, wall=29765
2023-08-24 10:32:11 | INFO | train_inner | epoch 028:   1318 / 1474 loss=1.954, trans_loss=4.976, nll_loss=2.164, w2v_ctc_loss=0.616, task_loss=3.573, contrastive_loss=0, total=4085.44, n_correct=2692.46, ppl=4.48, accuracy=65.904, wps=13495.1, ups=1.65, wpb=8170.9, bsz=285.6, num_updates=41100, lr=6.9758e-05, gnorm=0.546, clip=0, loss_scale=32, train_wall=60, gb_free=16.2, wall=29826
2023-08-24 10:33:12 | INFO | train_inner | epoch 028:   1418 / 1474 loss=1.953, trans_loss=4.978, nll_loss=2.167, w2v_ctc_loss=0.613, task_loss=3.486, contrastive_loss=0, total=4137.47, n_correct=2720.22, ppl=4.49, accuracy=65.746, wps=13673.6, ups=1.65, wpb=8274.9, bsz=294.8, num_updates=41200, lr=6.96733e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=29886
2023-08-24 10:33:45 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
2023-08-24 10:34:19 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 4.157 | trans_loss 5.551 | nll_loss 2.818 | w2v_ctc_loss 1.346 | task_loss 11.525 | contrastive_loss 0 | total 4003.4 | n_correct 2496.9 | ppl 7.05 | accuracy 62.369 | uer 16.848 | wer 18.683 | raw_wer 18.683 | bleu 20.06 | wps 1580.2 | wpb 4003.4 | bsz 141.8 | num_updates 41256 | best_bleu 20.57
2023-08-24 10:34:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 41256 updates
2023-08-24 10:34:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 10:34:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 10:34:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 28 @ 41256 updates, score 20.06) (writing took 5.955770082073286 seconds)
2023-08-24 10:34:25 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2023-08-24 10:34:25 | INFO | train | epoch 028 | loss 1.941 | trans_loss 4.962 | nll_loss 2.147 | w2v_ctc_loss 0.605 | task_loss 3.281 | contrastive_loss 0 | total 4138.65 | n_correct 2739.93 | ppl 4.43 | accuracy 66.204 | wps 12478 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 41256 | lr 6.9626e-05 | gnorm 0.528 | clip 0 | loss_scale 32 | train_wall 879 | gb_free 16.4 | wall 29959
2023-08-24 10:34:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 10:34:25 | INFO | fairseq.trainer | begin training epoch 29
2023-08-24 10:34:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 10:34:59 | INFO | train_inner | epoch 029:     44 / 1474 loss=1.933, trans_loss=4.946, nll_loss=2.127, w2v_ctc_loss=0.606, task_loss=3.153, contrastive_loss=0, total=4168.25, n_correct=2777.41, ppl=4.37, accuracy=66.633, wps=7777.7, ups=0.93, wpb=8336.5, bsz=315.7, num_updates=41300, lr=6.95889e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=59, gb_free=17.6, wall=29994
2023-08-24 10:35:59 | INFO | train_inner | epoch 029:    144 / 1474 loss=1.934, trans_loss=4.946, nll_loss=2.126, w2v_ctc_loss=0.604, task_loss=3.226, contrastive_loss=0, total=4117.66, n_correct=2738.12, ppl=4.36, accuracy=66.497, wps=13720.6, ups=1.67, wpb=8235.3, bsz=308.4, num_updates=41400, lr=6.95048e-05, gnorm=0.535, clip=0, loss_scale=32, train_wall=59, gb_free=17.2, wall=30054
2023-08-24 10:37:00 | INFO | train_inner | epoch 029:    244 / 1474 loss=1.918, trans_loss=4.934, nll_loss=2.112, w2v_ctc_loss=0.583, task_loss=2.991, contrastive_loss=0, total=4198.99, n_correct=2806.17, ppl=4.32, accuracy=66.83, wps=13851.9, ups=1.65, wpb=8398, bsz=330.7, num_updates=41500, lr=6.9421e-05, gnorm=0.514, clip=0, loss_scale=64, train_wall=60, gb_free=15.2, wall=30114
2023-08-24 10:38:00 | INFO | train_inner | epoch 029:    344 / 1474 loss=1.941, trans_loss=4.954, nll_loss=2.136, w2v_ctc_loss=0.612, task_loss=3.538, contrastive_loss=0, total=4091.28, n_correct=2716.65, ppl=4.39, accuracy=66.401, wps=13608.2, ups=1.66, wpb=8182.6, bsz=290.4, num_updates=41600, lr=6.93375e-05, gnorm=0.527, clip=0, loss_scale=64, train_wall=59, gb_free=17.2, wall=30174
2023-08-24 10:39:00 | INFO | train_inner | epoch 029:    444 / 1474 loss=1.923, trans_loss=4.93, nll_loss=2.105, w2v_ctc_loss=0.592, task_loss=3.177, contrastive_loss=0, total=4158.09, n_correct=2784.18, ppl=4.3, accuracy=66.958, wps=13804.9, ups=1.66, wpb=8316.2, bsz=307.2, num_updates=41700, lr=6.92543e-05, gnorm=0.523, clip=0, loss_scale=64, train_wall=60, gb_free=15.9, wall=30235
2023-08-24 10:40:01 | INFO | train_inner | epoch 029:    544 / 1474 loss=1.942, trans_loss=4.96, nll_loss=2.144, w2v_ctc_loss=0.601, task_loss=3.491, contrastive_loss=0, total=4156.12, n_correct=2750.46, ppl=4.42, accuracy=66.179, wps=13616, ups=1.64, wpb=8312.2, bsz=295.2, num_updates=41800, lr=6.91714e-05, gnorm=0.535, clip=0, loss_scale=64, train_wall=60, gb_free=12.1, wall=30296
2023-08-24 10:41:01 | INFO | train_inner | epoch 029:    644 / 1474 loss=1.93, trans_loss=4.948, nll_loss=2.131, w2v_ctc_loss=0.596, task_loss=3.09, contrastive_loss=0, total=4153.45, n_correct=2758.54, ppl=4.38, accuracy=66.416, wps=13808.5, ups=1.66, wpb=8306.9, bsz=320.5, num_updates=41900, lr=6.90889e-05, gnorm=0.53, clip=0, loss_scale=64, train_wall=60, gb_free=16.4, wall=30356
2023-08-24 10:42:02 | INFO | train_inner | epoch 029:    744 / 1474 loss=1.929, trans_loss=4.948, nll_loss=2.129, w2v_ctc_loss=0.595, task_loss=3.035, contrastive_loss=0, total=4232.02, n_correct=2816.16, ppl=4.37, accuracy=66.544, wps=14028.7, ups=1.66, wpb=8464, bsz=328, num_updates=42000, lr=6.90066e-05, gnorm=0.52, clip=0, loss_scale=64, train_wall=60, gb_free=11.3, wall=30416
2023-08-24 10:42:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 10:42:35 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 4.169 | trans_loss 5.551 | nll_loss 2.818 | w2v_ctc_loss 1.386 | task_loss 11.544 | contrastive_loss 0 | total 4003.4 | n_correct 2493.4 | ppl 7.05 | accuracy 62.282 | uer 17.126 | wer 18.892 | raw_wer 18.892 | bleu 19.83 | wps 1580.8 | wpb 4003.4 | bsz 141.8 | num_updates 42000 | best_bleu 20.57
2023-08-24 10:42:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 42000 updates
2023-08-24 10:42:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_29_42000.pt
2023-08-24 10:42:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_29_42000.pt
2023-08-24 10:42:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_29_42000.pt (epoch 29 @ 42000 updates, score 19.83) (writing took 6.567436129087582 seconds)
2023-08-24 10:43:42 | INFO | train_inner | epoch 029:    844 / 1474 loss=1.942, trans_loss=4.966, nll_loss=2.151, w2v_ctc_loss=0.598, task_loss=3.644, contrastive_loss=0, total=4033.38, n_correct=2669.15, ppl=4.44, accuracy=66.177, wps=8034.5, ups=1, wpb=8066.8, bsz=280.8, num_updates=42100, lr=6.89246e-05, gnorm=0.54, clip=0, loss_scale=64, train_wall=59, gb_free=16.5, wall=30517
2023-08-24 10:44:42 | INFO | train_inner | epoch 029:    944 / 1474 loss=1.94, trans_loss=4.966, nll_loss=2.152, w2v_ctc_loss=0.601, task_loss=3.347, contrastive_loss=0, total=4082.33, n_correct=2706.15, ppl=4.45, accuracy=66.289, wps=13647.8, ups=1.67, wpb=8164.7, bsz=297.1, num_updates=42200, lr=6.88428e-05, gnorm=0.529, clip=0, loss_scale=64, train_wall=59, gb_free=16, wall=30576
2023-08-24 10:45:01 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 10:45:43 | INFO | train_inner | epoch 029:   1045 / 1474 loss=1.936, trans_loss=4.954, nll_loss=2.138, w2v_ctc_loss=0.598, task_loss=3.294, contrastive_loss=0, total=4139.19, n_correct=2743.36, ppl=4.4, accuracy=66.278, wps=13579.7, ups=1.64, wpb=8278.4, bsz=306.4, num_updates=42300, lr=6.87614e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=30637
2023-08-24 10:46:43 | INFO | train_inner | epoch 029:   1145 / 1474 loss=1.947, trans_loss=4.969, nll_loss=2.156, w2v_ctc_loss=0.612, task_loss=3.576, contrastive_loss=0, total=4068.4, n_correct=2690.27, ppl=4.46, accuracy=66.126, wps=13613.3, ups=1.67, wpb=8136.8, bsz=284.2, num_updates=42400, lr=6.86803e-05, gnorm=0.539, clip=0, loss_scale=32, train_wall=59, gb_free=17.4, wall=30697
2023-08-24 10:47:43 | INFO | train_inner | epoch 029:   1245 / 1474 loss=1.945, trans_loss=4.97, nll_loss=2.158, w2v_ctc_loss=0.606, task_loss=3.364, contrastive_loss=0, total=4154.79, n_correct=2746.17, ppl=4.46, accuracy=66.096, wps=13813.8, ups=1.66, wpb=8309.6, bsz=299.6, num_updates=42500, lr=6.85994e-05, gnorm=0.541, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=30757
2023-08-24 10:48:43 | INFO | train_inner | epoch 029:   1345 / 1474 loss=1.937, trans_loss=4.959, nll_loss=2.144, w2v_ctc_loss=0.602, task_loss=3.225, contrastive_loss=0, total=4166.4, n_correct=2763.73, ppl=4.42, accuracy=66.334, wps=13800.7, ups=1.66, wpb=8332.8, bsz=311.5, num_updates=42600, lr=6.85189e-05, gnorm=0.526, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=30818
2023-08-24 10:49:43 | INFO | train_inner | epoch 029:   1445 / 1474 loss=1.939, trans_loss=4.962, nll_loss=2.15, w2v_ctc_loss=0.603, task_loss=3.225, contrastive_loss=0, total=4169.4, n_correct=2758.72, ppl=4.44, accuracy=66.166, wps=13964.3, ups=1.67, wpb=8338.8, bsz=312, num_updates=42700, lr=6.84386e-05, gnorm=0.532, clip=0, loss_scale=32, train_wall=59, gb_free=15.8, wall=30877
2023-08-24 10:50:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 10:50:34 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 4.159 | trans_loss 5.544 | nll_loss 2.811 | w2v_ctc_loss 1.371 | task_loss 11.592 | contrastive_loss 0 | total 4003.4 | n_correct 2498.1 | ppl 7.02 | accuracy 62.399 | uer 16.866 | wer 18.799 | raw_wer 18.799 | bleu 20.33 | wps 1574.5 | wpb 4003.4 | bsz 141.8 | num_updates 42729 | best_bleu 20.57
2023-08-24 10:50:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 42729 updates
2023-08-24 10:50:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3309.pt
2023-08-24 10:50:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3309.pt
2023-08-24 10:50:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.3309.pt (epoch 29 @ 42729 updates, score 20.33) (writing took 8.407114548957907 seconds)
2023-08-24 10:50:43 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2023-08-24 10:50:43 | INFO | train | epoch 029 | loss 1.935 | trans_loss 4.954 | nll_loss 2.137 | w2v_ctc_loss 0.6 | task_loss 3.286 | contrastive_loss 0 | total 4138.31 | n_correct 2747.54 | ppl 4.4 | accuracy 66.393 | wps 12467.8 | ups 1.51 | wpb 8276.6 | bsz 305.6 | num_updates 42729 | lr 6.84154e-05 | gnorm 0.53 | clip 0 | loss_scale 32 | train_wall 877 | gb_free 16 | wall 30937
2023-08-24 10:50:43 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 10:50:43 | INFO | fairseq.trainer | begin training epoch 30
2023-08-24 10:50:43 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 10:51:33 | INFO | train_inner | epoch 030:     71 / 1474 loss=1.924, trans_loss=4.938, nll_loss=2.116, w2v_ctc_loss=0.587, task_loss=3.113, contrastive_loss=0, total=4176.73, n_correct=2784.95, ppl=4.34, accuracy=66.678, wps=7568.7, ups=0.91, wpb=8353.5, bsz=319, num_updates=42800, lr=6.83586e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=60, gb_free=17, wall=30988
2023-08-24 10:52:33 | INFO | train_inner | epoch 030:    171 / 1474 loss=1.922, trans_loss=4.924, nll_loss=2.098, w2v_ctc_loss=0.596, task_loss=3.061, contrastive_loss=0, total=4202.84, n_correct=2814.41, ppl=4.28, accuracy=66.964, wps=14002.5, ups=1.67, wpb=8405.7, bsz=318.6, num_updates=42900, lr=6.82789e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=59, gb_free=12.5, wall=31048
2023-08-24 10:53:34 | INFO | train_inner | epoch 030:    271 / 1474 loss=1.932, trans_loss=4.939, nll_loss=2.116, w2v_ctc_loss=0.602, task_loss=3.387, contrastive_loss=0, total=4120.08, n_correct=2744.41, ppl=4.33, accuracy=66.611, wps=13712.5, ups=1.66, wpb=8240.2, bsz=296.4, num_updates=43000, lr=6.81994e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=31108
2023-08-24 10:54:34 | INFO | train_inner | epoch 030:    371 / 1474 loss=1.927, trans_loss=4.935, nll_loss=2.112, w2v_ctc_loss=0.596, task_loss=3.289, contrastive_loss=0, total=4175.82, n_correct=2788.19, ppl=4.32, accuracy=66.77, wps=13803.7, ups=1.65, wpb=8351.6, bsz=306.1, num_updates=43100, lr=6.81203e-05, gnorm=0.533, clip=0, loss_scale=32, train_wall=60, gb_free=15.6, wall=31168
2023-08-24 10:55:34 | INFO | train_inner | epoch 030:    471 / 1474 loss=1.923, trans_loss=4.936, nll_loss=2.114, w2v_ctc_loss=0.589, task_loss=3.161, contrastive_loss=0, total=4128.9, n_correct=2758.95, ppl=4.33, accuracy=66.82, wps=13854.2, ups=1.68, wpb=8257.8, bsz=312.5, num_updates=43200, lr=6.80414e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=59, gb_free=16.4, wall=31228
2023-08-24 10:56:34 | INFO | train_inner | epoch 030:    571 / 1474 loss=1.928, trans_loss=4.947, nll_loss=2.128, w2v_ctc_loss=0.592, task_loss=3.206, contrastive_loss=0, total=4162.83, n_correct=2774.92, ppl=4.37, accuracy=66.659, wps=13861.1, ups=1.66, wpb=8325.7, bsz=311.5, num_updates=43300, lr=6.79628e-05, gnorm=0.529, clip=0, loss_scale=32, train_wall=59, gb_free=15, wall=31288
2023-08-24 10:57:34 | INFO | train_inner | epoch 030:    671 / 1474 loss=1.929, trans_loss=4.943, nll_loss=2.124, w2v_ctc_loss=0.598, task_loss=3.199, contrastive_loss=0, total=4197.56, n_correct=2798.48, ppl=4.36, accuracy=66.669, wps=13876.7, ups=1.65, wpb=8395.1, bsz=317.6, num_updates=43400, lr=6.78844e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=31349
2023-08-24 10:58:34 | INFO | train_inner | epoch 030:    771 / 1474 loss=1.943, trans_loss=4.961, nll_loss=2.147, w2v_ctc_loss=0.61, task_loss=3.378, contrastive_loss=0, total=4097.27, n_correct=2712.15, ppl=4.43, accuracy=66.194, wps=13610.9, ups=1.66, wpb=8194.5, bsz=301.1, num_updates=43500, lr=6.78064e-05, gnorm=0.535, clip=0, loss_scale=32, train_wall=59, gb_free=14.8, wall=31409
2023-08-24 10:59:34 | INFO | train_inner | epoch 030:    871 / 1474 loss=1.937, trans_loss=4.955, nll_loss=2.137, w2v_ctc_loss=0.599, task_loss=3.433, contrastive_loss=0, total=4097.18, n_correct=2721.96, ppl=4.4, accuracy=66.435, wps=13672.4, ups=1.67, wpb=8194.4, bsz=292.2, num_updates=43600, lr=6.77285e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=31469
2023-08-24 11:00:34 | INFO | train_inner | epoch 030:    971 / 1474 loss=1.935, trans_loss=4.954, nll_loss=2.136, w2v_ctc_loss=0.6, task_loss=3.311, contrastive_loss=0, total=4140.12, n_correct=2751.51, ppl=4.4, accuracy=66.46, wps=13864.8, ups=1.67, wpb=8280.2, bsz=304.6, num_updates=43700, lr=6.7651e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=59, gb_free=15.2, wall=31528
2023-08-24 11:01:35 | INFO | train_inner | epoch 030:   1071 / 1474 loss=1.949, trans_loss=4.971, nll_loss=2.157, w2v_ctc_loss=0.607, task_loss=3.701, contrastive_loss=0, total=4099.61, n_correct=2702.13, ppl=4.46, accuracy=65.912, wps=13362.2, ups=1.63, wpb=8199.2, bsz=281.4, num_updates=43800, lr=6.75737e-05, gnorm=0.537, clip=0, loss_scale=32, train_wall=61, gb_free=17.4, wall=31590
2023-08-24 11:02:36 | INFO | train_inner | epoch 030:   1171 / 1474 loss=1.931, trans_loss=4.955, nll_loss=2.14, w2v_ctc_loss=0.592, task_loss=3.142, contrastive_loss=0, total=4164.38, n_correct=2767.88, ppl=4.41, accuracy=66.466, wps=13688, ups=1.64, wpb=8328.8, bsz=314.8, num_updates=43900, lr=6.74967e-05, gnorm=0.522, clip=0, loss_scale=32, train_wall=60, gb_free=17.4, wall=31651
2023-08-24 11:03:37 | INFO | train_inner | epoch 030:   1271 / 1474 loss=1.947, trans_loss=4.964, nll_loss=2.15, w2v_ctc_loss=0.612, task_loss=3.703, contrastive_loss=0, total=4030.53, n_correct=2666.25, ppl=4.44, accuracy=66.151, wps=13259.4, ups=1.64, wpb=8061.1, bsz=281.4, num_updates=44000, lr=6.742e-05, gnorm=0.534, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=31711
2023-08-24 11:03:37 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:04:11 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 4.152 | trans_loss 5.548 | nll_loss 2.816 | w2v_ctc_loss 1.337 | task_loss 11.622 | contrastive_loss 0 | total 4003.4 | n_correct 2497.2 | ppl 7.04 | accuracy 62.377 | uer 16.991 | wer 18.903 | raw_wer 18.903 | bleu 20.04 | wps 1570 | wpb 4003.4 | bsz 141.8 | num_updates 44000 | best_bleu 20.57
2023-08-24 11:04:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 44000 updates
2023-08-24 11:04:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_30_44000.pt
2023-08-24 11:04:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_30_44000.pt
2023-08-24 11:04:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_30_44000.pt (epoch 30 @ 44000 updates, score 20.04) (writing took 7.55677565804217 seconds)
2023-08-24 11:05:18 | INFO | train_inner | epoch 030:   1371 / 1474 loss=1.927, trans_loss=4.952, nll_loss=2.137, w2v_ctc_loss=0.591, task_loss=3.1, contrastive_loss=0, total=4163.24, n_correct=2770.04, ppl=4.4, accuracy=66.536, wps=8220, ups=0.99, wpb=8326.5, bsz=320.7, num_updates=44100, lr=6.73435e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=17.2, wall=31813
2023-08-24 11:06:18 | INFO | train_inner | epoch 030:   1471 / 1474 loss=1.933, trans_loss=4.959, nll_loss=2.146, w2v_ctc_loss=0.591, task_loss=3.142, contrastive_loss=0, total=4130.55, n_correct=2737.99, ppl=4.43, accuracy=66.286, wps=13858.9, ups=1.68, wpb=8261.1, bsz=311.7, num_updates=44200, lr=6.72673e-05, gnorm=0.534, clip=0, loss_scale=32, train_wall=59, gb_free=16.3, wall=31872
2023-08-24 11:06:20 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:06:53 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 4.169 | trans_loss 5.555 | nll_loss 2.824 | w2v_ctc_loss 1.377 | task_loss 11.626 | contrastive_loss 0 | total 4003.4 | n_correct 2492.7 | ppl 7.08 | accuracy 62.265 | uer 17.251 | wer 19.149 | raw_wer 19.149 | bleu 19.74 | wps 1573.4 | wpb 4003.4 | bsz 141.8 | num_updates 44203 | best_bleu 20.57
2023-08-24 11:06:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 44203 updates
2023-08-24 11:06:53 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 11:07:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 11:07:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 30 @ 44203 updates, score 19.74) (writing took 7.866897565079853 seconds)
2023-08-24 11:07:01 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2023-08-24 11:07:01 | INFO | train | epoch 030 | loss 1.932 | trans_loss 4.949 | nll_loss 2.13 | w2v_ctc_loss 0.597 | task_loss 3.285 | contrastive_loss 0 | total 4138.65 | n_correct 2752.76 | ppl 4.38 | accuracy 66.513 | wps 12469.5 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 44203 | lr 6.7265e-05 | gnorm 0.528 | clip 0 | loss_scale 32 | train_wall 877 | gb_free 17.1 | wall 31916
2023-08-24 11:07:02 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 11:07:02 | INFO | fairseq.trainer | begin training epoch 31
2023-08-24 11:07:02 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 11:08:07 | INFO | train_inner | epoch 031:     97 / 1474 loss=1.925, trans_loss=4.931, nll_loss=2.105, w2v_ctc_loss=0.594, task_loss=3.399, contrastive_loss=0, total=4081.82, n_correct=2734.7, ppl=4.3, accuracy=66.997, wps=7461.1, ups=0.91, wpb=8163.6, bsz=295.5, num_updates=44300, lr=6.71913e-05, gnorm=0.534, clip=0, loss_scale=64, train_wall=60, gb_free=13.4, wall=31982
2023-08-24 11:09:08 | INFO | train_inner | epoch 031:    197 / 1474 loss=1.924, trans_loss=4.931, nll_loss=2.105, w2v_ctc_loss=0.593, task_loss=3.385, contrastive_loss=0, total=4143.18, n_correct=2772.83, ppl=4.3, accuracy=66.925, wps=13701.4, ups=1.65, wpb=8286.4, bsz=301.1, num_updates=44400, lr=6.71156e-05, gnorm=0.535, clip=0, loss_scale=64, train_wall=60, gb_free=17.1, wall=32042
2023-08-24 11:10:08 | INFO | train_inner | epoch 031:    297 / 1474 loss=1.928, trans_loss=4.934, nll_loss=2.11, w2v_ctc_loss=0.598, task_loss=3.38, contrastive_loss=0, total=4154.03, n_correct=2778.6, ppl=4.32, accuracy=66.889, wps=13757.5, ups=1.66, wpb=8308.1, bsz=301.5, num_updates=44500, lr=6.70402e-05, gnorm=0.534, clip=0, loss_scale=64, train_wall=60, gb_free=16.2, wall=32103
2023-08-24 11:11:08 | INFO | train_inner | epoch 031:    397 / 1474 loss=1.933, trans_loss=4.944, nll_loss=2.123, w2v_ctc_loss=0.596, task_loss=3.597, contrastive_loss=0, total=4079.78, n_correct=2718.63, ppl=4.36, accuracy=66.637, wps=13590.8, ups=1.67, wpb=8159.6, bsz=284.9, num_updates=44600, lr=6.6965e-05, gnorm=0.533, clip=0, loss_scale=64, train_wall=59, gb_free=15.7, wall=32163
2023-08-24 11:12:09 | INFO | train_inner | epoch 031:    497 / 1474 loss=1.929, trans_loss=4.936, nll_loss=2.114, w2v_ctc_loss=0.6, task_loss=3.399, contrastive_loss=0, total=4122.36, n_correct=2750.93, ppl=4.33, accuracy=66.732, wps=13683.2, ups=1.66, wpb=8244.7, bsz=302, num_updates=44700, lr=6.689e-05, gnorm=0.533, clip=0, loss_scale=64, train_wall=59, gb_free=16.6, wall=32223
2023-08-24 11:13:09 | INFO | train_inner | epoch 031:    597 / 1474 loss=1.924, trans_loss=4.936, nll_loss=2.113, w2v_ctc_loss=0.588, task_loss=3.438, contrastive_loss=0, total=4082.24, n_correct=2727.29, ppl=4.33, accuracy=66.809, wps=13468.3, ups=1.65, wpb=8164.5, bsz=294.3, num_updates=44800, lr=6.68153e-05, gnorm=0.541, clip=0, loss_scale=64, train_wall=60, gb_free=16.5, wall=32284
2023-08-24 11:13:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 11:14:10 | INFO | train_inner | epoch 031:    698 / 1474 loss=1.92, trans_loss=4.934, nll_loss=2.111, w2v_ctc_loss=0.587, task_loss=3.137, contrastive_loss=0, total=4209.87, n_correct=2816.95, ppl=4.32, accuracy=66.913, wps=13943.9, ups=1.66, wpb=8419.7, bsz=314.9, num_updates=44900, lr=6.67409e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=60, gb_free=14.6, wall=32344
2023-08-24 11:15:10 | INFO | train_inner | epoch 031:    798 / 1474 loss=1.936, trans_loss=4.952, nll_loss=2.135, w2v_ctc_loss=0.599, task_loss=3.445, contrastive_loss=0, total=4098.1, n_correct=2718.54, ppl=4.39, accuracy=66.337, wps=13570.9, ups=1.66, wpb=8196.2, bsz=295.7, num_updates=45000, lr=6.66667e-05, gnorm=0.539, clip=0, loss_scale=32, train_wall=60, gb_free=16.8, wall=32404
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:0')
2023-08-24 11:16:10 | INFO | train_inner | epoch 031:    898 / 1474 loss=1.927, trans_loss=4.938, nll_loss=2.116, w2v_ctc_loss=0.591, task_loss=3.417, contrastive_loss=0, total=4101.05, n_correct=2733.95, ppl=4.34, accuracy=66.665, wps=13685, ups=1.67, wpb=8202.1, bsz=296.9, num_updates=45100, lr=6.65927e-05, gnorm=0.542, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=32464
2023-08-24 11:17:10 | INFO | train_inner | epoch 031:    998 / 1474 loss=1.927, trans_loss=4.949, nll_loss=2.132, w2v_ctc_loss=0.589, task_loss=3.108, contrastive_loss=0, total=4186.3, n_correct=2789.33, ppl=4.38, accuracy=66.63, wps=13958.3, ups=1.67, wpb=8372.6, bsz=318.6, num_updates=45200, lr=6.6519e-05, gnorm=0.526, clip=0, loss_scale=32, train_wall=59, gb_free=16.3, wall=32524
2023-08-24 11:18:10 | INFO | train_inner | epoch 031:   1098 / 1474 loss=1.928, trans_loss=4.946, nll_loss=2.129, w2v_ctc_loss=0.593, task_loss=3.23, contrastive_loss=0, total=4147.34, n_correct=2760.41, ppl=4.37, accuracy=66.559, wps=13716.5, ups=1.65, wpb=8294.7, bsz=314.6, num_updates=45300, lr=6.64455e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=32585
2023-08-24 11:19:10 | INFO | train_inner | epoch 031:   1198 / 1474 loss=1.923, trans_loss=4.946, nll_loss=2.129, w2v_ctc_loss=0.584, task_loss=3.069, contrastive_loss=0, total=4185.34, n_correct=2786.93, ppl=4.37, accuracy=66.588, wps=14005.2, ups=1.67, wpb=8370.7, bsz=321.6, num_updates=45400, lr=6.63723e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=32645
2023-08-24 11:20:10 | INFO | train_inner | epoch 031:   1298 / 1474 loss=1.927, trans_loss=4.95, nll_loss=2.134, w2v_ctc_loss=0.593, task_loss=2.97, contrastive_loss=0, total=4223.54, n_correct=2811.44, ppl=4.39, accuracy=66.566, wps=14117.7, ups=1.67, wpb=8447.1, bsz=325, num_updates=45500, lr=6.62994e-05, gnorm=0.534, clip=0, loss_scale=32, train_wall=59, gb_free=13.4, wall=32704
2023-08-24 11:21:10 | INFO | train_inner | epoch 031:   1398 / 1474 loss=1.925, trans_loss=4.947, nll_loss=2.13, w2v_ctc_loss=0.586, task_loss=2.987, contrastive_loss=0, total=4195.76, n_correct=2792.6, ppl=4.38, accuracy=66.558, wps=13956.7, ups=1.66, wpb=8391.5, bsz=328.2, num_updates=45600, lr=6.62266e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=59, gb_free=16.5, wall=32764
2023-08-24 11:21:56 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2453, device='cuda:7')
2023-08-24 11:22:30 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 4.142 | trans_loss 5.544 | nll_loss 2.811 | w2v_ctc_loss 1.311 | task_loss 11.599 | contrastive_loss 0 | total 4003.4 | n_correct 2499.9 | ppl 7.02 | accuracy 62.444 | uer 16.789 | wer 18.784 | raw_wer 18.784 | bleu 20.51 | wps 1558 | wpb 4003.4 | bsz 141.8 | num_updates 45676 | best_bleu 20.57
2023-08-24 11:22:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 45676 updates
2023-08-24 11:22:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5107.pt
2023-08-24 11:22:32 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5107.pt
2023-08-24 11:22:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5107.pt (epoch 31 @ 45676 updates, score 20.51) (writing took 7.41752128303051 seconds)
2023-08-24 11:22:38 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2023-08-24 11:22:38 | INFO | train | epoch 031 | loss 1.927 | trans_loss 4.942 | nll_loss 2.121 | w2v_ctc_loss 0.593 | task_loss 3.288 | contrastive_loss 0 | total 4138.6 | n_correct 2760.03 | ppl 4.35 | accuracy 66.69 | wps 13018.5 | ups 1.57 | wpb 8277.2 | bsz 305.7 | num_updates 45676 | lr 6.61715e-05 | gnorm 0.533 | clip 0 | loss_scale 32 | train_wall 876 | gb_free 12 | wall 32852
2023-08-24 11:22:38 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 11:22:38 | INFO | fairseq.trainer | begin training epoch 32
2023-08-24 11:22:38 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 11:22:59 | INFO | train_inner | epoch 032:     24 / 1474 loss=1.93, trans_loss=4.943, nll_loss=2.123, w2v_ctc_loss=0.595, task_loss=3.491, contrastive_loss=0, total=4039.04, n_correct=2696.1, ppl=4.36, accuracy=66.751, wps=7396.3, ups=0.92, wpb=8078.1, bsz=287.3, num_updates=45700, lr=6.61541e-05, gnorm=0.546, clip=0, loss_scale=32, train_wall=59, gb_free=17.7, wall=32874
2023-08-24 11:24:00 | INFO | train_inner | epoch 032:    124 / 1474 loss=1.906, trans_loss=4.909, nll_loss=2.079, w2v_ctc_loss=0.575, task_loss=3.039, contrastive_loss=0, total=4224.84, n_correct=2849.58, ppl=4.22, accuracy=67.448, wps=13936.4, ups=1.65, wpb=8449.7, bsz=322.5, num_updates=45800, lr=6.60819e-05, gnorm=0.519, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=32934
2023-08-24 11:25:01 | INFO | train_inner | epoch 032:    224 / 1474 loss=1.915, trans_loss=4.926, nll_loss=2.101, w2v_ctc_loss=0.585, task_loss=3.105, contrastive_loss=0, total=4163.01, n_correct=2790.73, ppl=4.29, accuracy=67.036, wps=13688.5, ups=1.64, wpb=8326, bsz=322.2, num_updates=45900, lr=6.60098e-05, gnorm=0.536, clip=0, loss_scale=32, train_wall=60, gb_free=17.1, wall=32995
2023-08-24 11:26:01 | INFO | train_inner | epoch 032:    324 / 1474 loss=1.909, trans_loss=4.914, nll_loss=2.085, w2v_ctc_loss=0.578, task_loss=3.095, contrastive_loss=0, total=4185.21, n_correct=2818.79, ppl=4.24, accuracy=67.351, wps=13972, ups=1.67, wpb=8370.4, bsz=315.1, num_updates=46000, lr=6.5938e-05, gnorm=0.526, clip=0, loss_scale=32, train_wall=59, gb_free=16.3, wall=33055
2023-08-24 11:26:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:26:34 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 4.159 | trans_loss 5.548 | nll_loss 2.816 | w2v_ctc_loss 1.361 | task_loss 11.539 | contrastive_loss 0 | total 4003.4 | n_correct 2507.9 | ppl 7.04 | accuracy 62.644 | uer 16.688 | wer 18.579 | raw_wer 18.579 | bleu 20.48 | wps 1645.7 | wpb 4003.4 | bsz 141.8 | num_updates 46000 | best_bleu 20.57
2023-08-24 11:26:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 46000 updates
2023-08-24 11:26:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_32_46000.pt
2023-08-24 11:26:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_32_46000.pt
2023-08-24 11:26:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_32_46000.pt (epoch 32 @ 46000 updates, score 20.48) (writing took 9.57914245792199 seconds)
2023-08-24 11:27:44 | INFO | train_inner | epoch 032:    424 / 1474 loss=1.918, trans_loss=4.924, nll_loss=2.098, w2v_ctc_loss=0.585, task_loss=3.274, contrastive_loss=0, total=4156.71, n_correct=2789.29, ppl=4.28, accuracy=67.103, wps=8063, ups=0.97, wpb=8313.4, bsz=305.7, num_updates=46100, lr=6.58665e-05, gnorm=0.541, clip=0, loss_scale=32, train_wall=60, gb_free=10.6, wall=33158
2023-08-24 11:28:45 | INFO | train_inner | epoch 032:    524 / 1474 loss=1.926, trans_loss=4.938, nll_loss=2.117, w2v_ctc_loss=0.596, task_loss=3.158, contrastive_loss=0, total=4195.32, n_correct=2800.34, ppl=4.34, accuracy=66.749, wps=13814, ups=1.65, wpb=8390.6, bsz=318.2, num_updates=46200, lr=6.57952e-05, gnorm=0.525, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=33219
2023-08-24 11:29:45 | INFO | train_inner | epoch 032:    624 / 1474 loss=1.923, trans_loss=4.937, nll_loss=2.114, w2v_ctc_loss=0.586, task_loss=3.401, contrastive_loss=0, total=4141.99, n_correct=2770.36, ppl=4.33, accuracy=66.885, wps=13689.6, ups=1.65, wpb=8284, bsz=300.9, num_updates=46300, lr=6.57241e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=33279
2023-08-24 11:30:46 | INFO | train_inner | epoch 032:    724 / 1474 loss=1.926, trans_loss=4.939, nll_loss=2.117, w2v_ctc_loss=0.594, task_loss=3.357, contrastive_loss=0, total=4153.97, n_correct=2776.07, ppl=4.34, accuracy=66.829, wps=13664.3, ups=1.64, wpb=8307.9, bsz=301.5, num_updates=46400, lr=6.56532e-05, gnorm=0.526, clip=0, loss_scale=32, train_wall=60, gb_free=17, wall=33340
2023-08-24 11:31:46 | INFO | train_inner | epoch 032:    824 / 1474 loss=1.918, trans_loss=4.934, nll_loss=2.11, w2v_ctc_loss=0.578, task_loss=3.387, contrastive_loss=0, total=4119.08, n_correct=2758.97, ppl=4.32, accuracy=66.98, wps=13741.7, ups=1.67, wpb=8238.2, bsz=295.1, num_updates=46500, lr=6.55826e-05, gnorm=0.533, clip=0, loss_scale=32, train_wall=59, gb_free=16.8, wall=33400
2023-08-24 11:32:46 | INFO | train_inner | epoch 032:    924 / 1474 loss=1.923, trans_loss=4.935, nll_loss=2.113, w2v_ctc_loss=0.585, task_loss=3.39, contrastive_loss=0, total=4142.37, n_correct=2768.28, ppl=4.32, accuracy=66.828, wps=13687.4, ups=1.65, wpb=8284.7, bsz=299.1, num_updates=46600, lr=6.55122e-05, gnorm=0.536, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=33461
2023-08-24 11:33:46 | INFO | train_inner | epoch 032:   1024 / 1474 loss=1.927, trans_loss=4.946, nll_loss=2.126, w2v_ctc_loss=0.588, task_loss=3.289, contrastive_loss=0, total=4112.12, n_correct=2739.52, ppl=4.36, accuracy=66.621, wps=13694.8, ups=1.67, wpb=8224.2, bsz=302.5, num_updates=46700, lr=6.5442e-05, gnorm=0.552, clip=0, loss_scale=32, train_wall=59, gb_free=16.7, wall=33521
2023-08-24 11:34:47 | INFO | train_inner | epoch 032:   1124 / 1474 loss=1.937, trans_loss=4.949, nll_loss=2.13, w2v_ctc_loss=0.599, task_loss=3.834, contrastive_loss=0, total=4022.64, n_correct=2675.07, ppl=4.38, accuracy=66.5, wps=13260.7, ups=1.65, wpb=8045.3, bsz=273.1, num_updates=46800, lr=6.5372e-05, gnorm=0.549, clip=0, loss_scale=32, train_wall=60, gb_free=11, wall=33581
2023-08-24 11:35:48 | INFO | train_inner | epoch 032:   1224 / 1474 loss=1.931, trans_loss=4.954, nll_loss=2.138, w2v_ctc_loss=0.59, task_loss=3.286, contrastive_loss=0, total=4145.44, n_correct=2751.99, ppl=4.4, accuracy=66.386, wps=13730.3, ups=1.66, wpb=8290.9, bsz=308.7, num_updates=46900, lr=6.53023e-05, gnorm=0.525, clip=0, loss_scale=64, train_wall=60, gb_free=17.1, wall=33642
2023-08-24 11:36:47 | INFO | train_inner | epoch 032:   1324 / 1474 loss=1.927, trans_loss=4.944, nll_loss=2.124, w2v_ctc_loss=0.589, task_loss=3.354, contrastive_loss=0, total=4083.72, n_correct=2721.06, ppl=4.36, accuracy=66.632, wps=13710.5, ups=1.68, wpb=8167.4, bsz=297.1, num_updates=47000, lr=6.52328e-05, gnorm=0.531, clip=0, loss_scale=64, train_wall=59, gb_free=15.6, wall=33701
2023-08-24 11:37:47 | INFO | train_inner | epoch 032:   1424 / 1474 loss=1.931, trans_loss=4.947, nll_loss=2.13, w2v_ctc_loss=0.594, task_loss=3.312, contrastive_loss=0, total=4105.33, n_correct=2734.34, ppl=4.38, accuracy=66.605, wps=13638.8, ups=1.66, wpb=8210.7, bsz=305.7, num_updates=47100, lr=6.51635e-05, gnorm=0.53, clip=0, loss_scale=64, train_wall=60, gb_free=16.4, wall=33762
2023-08-24 11:38:17 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:38:51 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 4.157 | trans_loss 5.542 | nll_loss 2.81 | w2v_ctc_loss 1.368 | task_loss 11.583 | contrastive_loss 0 | total 4003.4 | n_correct 2507.1 | ppl 7.01 | accuracy 62.624 | uer 16.68 | wer 18.437 | raw_wer 18.437 | bleu 20.27 | wps 1549.7 | wpb 4003.4 | bsz 141.8 | num_updates 47150 | best_bleu 20.57
2023-08-24 11:38:51 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 47150 updates
2023-08-24 11:38:51 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 11:38:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt
2023-08-24 11:38:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_last.pt (epoch 32 @ 47150 updates, score 20.27) (writing took 6.144060628022999 seconds)
2023-08-24 11:38:57 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2023-08-24 11:38:57 | INFO | train | epoch 032 | loss 1.922 | trans_loss 4.935 | nll_loss 2.113 | w2v_ctc_loss 0.587 | task_loss 3.284 | contrastive_loss 0 | total 4138.65 | n_correct 2767.23 | ppl 4.32 | accuracy 66.863 | wps 12458.9 | ups 1.51 | wpb 8277.3 | bsz 305.7 | num_updates 47150 | lr 6.5129e-05 | gnorm 0.533 | clip 0 | loss_scale 64 | train_wall 878 | gb_free 16.3 | wall 33831
2023-08-24 11:38:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 11:38:57 | INFO | fairseq.trainer | begin training epoch 33
2023-08-24 11:38:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 11:39:35 | INFO | train_inner | epoch 033:     50 / 1474 loss=1.913, trans_loss=4.929, nll_loss=2.106, w2v_ctc_loss=0.577, task_loss=3.067, contrastive_loss=0, total=4161.67, n_correct=2790.06, ppl=4.3, accuracy=67.042, wps=7755.6, ups=0.93, wpb=8323.3, bsz=322.6, num_updates=47200, lr=6.50945e-05, gnorm=0.528, clip=0, loss_scale=64, train_wall=59, gb_free=17.8, wall=33869
2023-08-24 11:40:35 | INFO | train_inner | epoch 033:    150 / 1474 loss=1.907, trans_loss=4.91, nll_loss=2.078, w2v_ctc_loss=0.565, task_loss=3.552, contrastive_loss=0, total=4067.33, n_correct=2742.79, ppl=4.22, accuracy=67.435, wps=13469.6, ups=1.66, wpb=8134.7, bsz=284.1, num_updates=47300, lr=6.50256e-05, gnorm=0.526, clip=0, loss_scale=64, train_wall=60, gb_free=17.3, wall=33929
2023-08-24 11:40:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-24 11:41:36 | INFO | train_inner | epoch 033:    251 / 1474 loss=1.906, trans_loss=4.913, nll_loss=2.086, w2v_ctc_loss=0.574, task_loss=2.805, contrastive_loss=0, total=4277.21, n_correct=2876.7, ppl=4.24, accuracy=67.256, wps=14051.1, ups=1.64, wpb=8554.4, bsz=345.7, num_updates=47400, lr=6.4957e-05, gnorm=0.535, clip=0, loss_scale=32, train_wall=60, gb_free=16.4, wall=33990
2023-08-24 11:42:36 | INFO | train_inner | epoch 033:    351 / 1474 loss=1.92, trans_loss=4.927, nll_loss=2.103, w2v_ctc_loss=0.585, task_loss=3.388, contrastive_loss=0, total=4111.69, n_correct=2756.09, ppl=4.29, accuracy=67.031, wps=13636.9, ups=1.66, wpb=8223.4, bsz=298.4, num_updates=47500, lr=6.48886e-05, gnorm=0.537, clip=0, loss_scale=32, train_wall=60, gb_free=16.7, wall=34051
2023-08-24 11:43:36 | INFO | train_inner | epoch 033:    451 / 1474 loss=1.905, trans_loss=4.912, nll_loss=2.082, w2v_ctc_loss=0.572, task_loss=3.09, contrastive_loss=0, total=4147.28, n_correct=2794.65, ppl=4.23, accuracy=67.385, wps=13960, ups=1.68, wpb=8294.6, bsz=313.5, num_updates=47600, lr=6.48204e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=59, gb_free=16.5, wall=34110
2023-08-24 11:44:36 | INFO | train_inner | epoch 033:    551 / 1474 loss=1.922, trans_loss=4.93, nll_loss=2.105, w2v_ctc_loss=0.585, task_loss=3.437, contrastive_loss=0, total=4127.68, n_correct=2765.92, ppl=4.3, accuracy=67.009, wps=13672.3, ups=1.66, wpb=8255.4, bsz=292.6, num_updates=47700, lr=6.47524e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=15.5, wall=34170
2023-08-24 11:45:37 | INFO | train_inner | epoch 033:    651 / 1474 loss=1.924, trans_loss=4.941, nll_loss=2.12, w2v_ctc_loss=0.585, task_loss=3.361, contrastive_loss=0, total=4164.1, n_correct=2778.67, ppl=4.35, accuracy=66.729, wps=13734.8, ups=1.65, wpb=8328.2, bsz=302.4, num_updates=47800, lr=6.46846e-05, gnorm=0.534, clip=0, loss_scale=32, train_wall=60, gb_free=15.3, wall=34231
2023-08-24 11:46:37 | INFO | train_inner | epoch 033:    751 / 1474 loss=1.934, trans_loss=4.941, nll_loss=2.119, w2v_ctc_loss=0.604, task_loss=3.597, contrastive_loss=0, total=4064.29, n_correct=2710.96, ppl=4.34, accuracy=66.702, wps=13450.6, ups=1.65, wpb=8128.6, bsz=285.8, num_updates=47900, lr=6.46171e-05, gnorm=0.545, clip=0, loss_scale=32, train_wall=60, gb_free=16.5, wall=34291
2023-08-24 11:47:37 | INFO | train_inner | epoch 033:    851 / 1474 loss=1.908, trans_loss=4.924, nll_loss=2.1, w2v_ctc_loss=0.571, task_loss=3.098, contrastive_loss=0, total=4141.12, n_correct=2784.25, ppl=4.29, accuracy=67.234, wps=13795.6, ups=1.67, wpb=8282.2, bsz=318.5, num_updates=48000, lr=6.45497e-05, gnorm=0.518, clip=0, loss_scale=32, train_wall=59, gb_free=16.5, wall=34351
2023-08-24 11:47:37 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:48:11 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 4.163 | trans_loss 5.549 | nll_loss 2.814 | w2v_ctc_loss 1.373 | task_loss 11.569 | contrastive_loss 0 | total 4003.4 | n_correct 2503 | ppl 7.03 | accuracy 62.522 | uer 16.587 | wer 18.362 | raw_wer 18.362 | bleu 20.33 | wps 1573.4 | wpb 4003.4 | bsz 141.8 | num_updates 48000 | best_bleu 20.57
2023-08-24 11:48:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 48000 updates
2023-08-24 11:48:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_33_48000.pt
2023-08-24 11:48:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_33_48000.pt
2023-08-24 11:48:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_33_48000.pt (epoch 33 @ 48000 updates, score 20.33) (writing took 9.564339456963353 seconds)
2023-08-24 11:49:21 | INFO | train_inner | epoch 033:    951 / 1474 loss=1.922, trans_loss=4.933, nll_loss=2.111, w2v_ctc_loss=0.592, task_loss=3.278, contrastive_loss=0, total=4147.76, n_correct=2776.81, ppl=4.32, accuracy=66.947, wps=8002.7, ups=0.96, wpb=8295.5, bsz=308.2, num_updates=48100, lr=6.44826e-05, gnorm=0.527, clip=0, loss_scale=32, train_wall=59, gb_free=17.6, wall=34455
2023-08-24 11:50:21 | INFO | train_inner | epoch 033:   1051 / 1474 loss=1.921, trans_loss=4.934, nll_loss=2.112, w2v_ctc_loss=0.584, task_loss=3.288, contrastive_loss=0, total=4137.41, n_correct=2766.44, ppl=4.32, accuracy=66.864, wps=13657.3, ups=1.65, wpb=8274.8, bsz=307.9, num_updates=48200, lr=6.44157e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=60, gb_free=15.7, wall=34516
2023-08-24 11:51:22 | INFO | train_inner | epoch 033:   1151 / 1474 loss=1.924, trans_loss=4.942, nll_loss=2.123, w2v_ctc_loss=0.581, task_loss=3.31, contrastive_loss=0, total=4182.88, n_correct=2788.94, ppl=4.36, accuracy=66.675, wps=13774.1, ups=1.65, wpb=8365.8, bsz=308.6, num_updates=48300, lr=6.43489e-05, gnorm=0.528, clip=0, loss_scale=32, train_wall=60, gb_free=16.2, wall=34576
2023-08-24 11:52:23 | INFO | train_inner | epoch 033:   1251 / 1474 loss=1.927, trans_loss=4.938, nll_loss=2.115, w2v_ctc_loss=0.593, task_loss=3.504, contrastive_loss=0, total=4102.27, n_correct=2742.2, ppl=4.33, accuracy=66.846, wps=13538.5, ups=1.65, wpb=8204.5, bsz=291.8, num_updates=48400, lr=6.42824e-05, gnorm=0.538, clip=0, loss_scale=32, train_wall=60, gb_free=15.6, wall=34637
2023-08-24 11:53:24 | INFO | train_inner | epoch 033:   1351 / 1474 loss=1.919, trans_loss=4.937, nll_loss=2.117, w2v_ctc_loss=0.585, task_loss=3.199, contrastive_loss=0, total=4131.08, n_correct=2765.6, ppl=4.34, accuracy=66.946, wps=13530.8, ups=1.64, wpb=8262.2, bsz=313.9, num_updates=48500, lr=6.42161e-05, gnorm=0.524, clip=0, loss_scale=32, train_wall=60, gb_free=17.2, wall=34698
2023-08-24 11:54:24 | INFO | train_inner | epoch 033:   1451 / 1474 loss=1.919, trans_loss=4.935, nll_loss=2.114, w2v_ctc_loss=0.578, task_loss=3.248, contrastive_loss=0, total=4135.49, n_correct=2764.15, ppl=4.33, accuracy=66.84, wps=13742.7, ups=1.66, wpb=8271, bsz=310.7, num_updates=48600, lr=6.415e-05, gnorm=0.53, clip=0, loss_scale=32, train_wall=59, gb_free=16.1, wall=34758
2023-08-24 11:54:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 11:55:11 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 4.151 | trans_loss 5.542 | nll_loss 2.808 | w2v_ctc_loss 1.348 | task_loss 11.592 | contrastive_loss 0 | total 4003.4 | n_correct 2504.3 | ppl 7 | accuracy 62.554 | uer 16.702 | wer 18.575 | raw_wer 18.575 | bleu 20.53 | wps 1625.9 | wpb 4003.4 | bsz 141.8 | num_updates 48623 | best_bleu 20.57
2023-08-24 11:55:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 48623 updates
2023-08-24 11:55:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5303.pt
2023-08-24 11:55:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5303.pt
2023-08-24 11:55:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint.best_bleu_20.5303.pt (epoch 33 @ 48623 updates, score 20.53) (writing took 7.140577147016302 seconds)
2023-08-24 11:55:18 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2023-08-24 11:55:18 | INFO | train | epoch 033 | loss 1.918 | trans_loss 4.929 | nll_loss 2.105 | w2v_ctc_loss 0.582 | task_loss 3.288 | contrastive_loss 0 | total 4138.2 | n_correct 2772.73 | ppl 4.3 | accuracy 67.003 | wps 12426.9 | ups 1.5 | wpb 8276.4 | bsz 305.6 | num_updates 48623 | lr 6.41349e-05 | gnorm 0.531 | clip 0 | loss_scale 32 | train_wall 878 | gb_free 17.8 | wall 34812
2023-08-24 11:55:18 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1474
2023-08-24 11:55:18 | INFO | fairseq.trainer | begin training epoch 34
2023-08-24 11:55:18 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-24 11:56:12 | INFO | train_inner | epoch 034:     77 / 1474 loss=1.909, trans_loss=4.912, nll_loss=2.082, w2v_ctc_loss=0.576, task_loss=3.248, contrastive_loss=0, total=4122.67, n_correct=2778, ppl=4.23, accuracy=67.384, wps=7619.4, ups=0.92, wpb=8245.3, bsz=301.4, num_updates=48700, lr=6.40841e-05, gnorm=0.534, clip=0, loss_scale=32, train_wall=59, gb_free=17.6, wall=34867
2023-08-24 11:57:12 | INFO | train_inner | epoch 034:    177 / 1474 loss=1.908, trans_loss=4.904, nll_loss=2.072, w2v_ctc_loss=0.58, task_loss=3.435, contrastive_loss=0, total=4074.94, n_correct=2752.27, ppl=4.2, accuracy=67.541, wps=13557.8, ups=1.66, wpb=8149.9, bsz=295.4, num_updates=48800, lr=6.40184e-05, gnorm=0.536, clip=0, loss_scale=32, train_wall=59, gb_free=17, wall=34927
2023-08-24 11:58:13 | INFO | train_inner | epoch 034:    277 / 1474 loss=1.915, trans_loss=4.925, nll_loss=2.1, w2v_ctc_loss=0.58, task_loss=3.113, contrastive_loss=0, total=4228.22, n_correct=2832.81, ppl=4.29, accuracy=66.998, wps=14046.2, ups=1.66, wpb=8456.4, bsz=324.6, num_updates=48900, lr=6.39529e-05, gnorm=0.523, clip=0, loss_scale=32, train_wall=60, gb_free=16.6, wall=34987
2023-08-24 11:59:13 | INFO | train_inner | epoch 034:    377 / 1474 loss=1.902, trans_loss=4.908, nll_loss=2.077, w2v_ctc_loss=0.567, task_loss=3.085, contrastive_loss=0, total=4173.35, n_correct=2814.05, ppl=4.22, accuracy=67.429, wps=13728.6, ups=1.64, wpb=8346.7, bsz=320.5, num_updates=49000, lr=6.38877e-05, gnorm=0.546, clip=0, loss_scale=32, train_wall=60, gb_free=16.2, wall=35048
2023-08-24 12:00:13 | INFO | train_inner | epoch 034:    477 / 1474 loss=1.919, trans_loss=4.922, nll_loss=2.094, w2v_ctc_loss=0.587, task_loss=3.604, contrastive_loss=0, total=4066.67, n_correct=2733.22, ppl=4.27, accuracy=67.21, wps=13585.4, ups=1.67, wpb=8133.3, bsz=284.6, num_updates=49100, lr=6.38226e-05, gnorm=0.556, clip=0, loss_scale=32, train_wall=59, gb_free=16.8, wall=35108
2023-08-24 12:01:13 | INFO | train_inner | epoch 034:    577 / 1474 loss=1.91, trans_loss=4.913, nll_loss=2.083, w2v_ctc_loss=0.574, task_loss=3.326, contrastive_loss=0, total=4115.49, n_correct=2770.29, ppl=4.24, accuracy=67.314, wps=13804.5, ups=1.68, wpb=8231, bsz=299.4, num_updates=49200, lr=6.37577e-05, gnorm=0.531, clip=0, loss_scale=32, train_wall=59, gb_free=14.8, wall=35167
2023-08-24 12:02:13 | INFO | train_inner | epoch 034:    677 / 1474 loss=1.91, trans_loss=4.918, nll_loss=2.091, w2v_ctc_loss=0.575, task_loss=3.338, contrastive_loss=0, total=4124.78, n_correct=2779.33, ppl=4.26, accuracy=67.381, wps=13691.1, ups=1.66, wpb=8249.6, bsz=300.2, num_updates=49300, lr=6.3693e-05, gnorm=0.535, clip=0, loss_scale=32, train_wall=59, gb_free=11.5, wall=35227
2023-08-24 12:03:13 | INFO | train_inner | epoch 034:    777 / 1474 loss=1.92, trans_loss=4.94, nll_loss=2.119, w2v_ctc_loss=0.574, task_loss=3.411, contrastive_loss=0, total=4082.25, n_correct=2729.52, ppl=4.34, accuracy=66.863, wps=13705.6, ups=1.68, wpb=8164.5, bsz=296, num_updates=49400, lr=6.36285e-05, gnorm=0.538, clip=0, loss_scale=64, train_wall=59, gb_free=16, wall=35287
2023-08-24 12:04:14 | INFO | train_inner | epoch 034:    877 / 1474 loss=1.919, trans_loss=4.93, nll_loss=2.106, w2v_ctc_loss=0.583, task_loss=3.486, contrastive_loss=0, total=4110.66, n_correct=2756.41, ppl=4.31, accuracy=67.055, wps=13497, ups=1.64, wpb=8221.3, bsz=296.1, num_updates=49500, lr=6.35642e-05, gnorm=0.537, clip=0, loss_scale=64, train_wall=60, gb_free=15.8, wall=35348
2023-08-24 12:05:14 | INFO | train_inner | epoch 034:    977 / 1474 loss=1.919, trans_loss=4.929, nll_loss=2.107, w2v_ctc_loss=0.587, task_loss=3.217, contrastive_loss=0, total=4162.47, n_correct=2789.27, ppl=4.31, accuracy=67.01, wps=13836.5, ups=1.66, wpb=8324.9, bsz=312.5, num_updates=49600, lr=6.35001e-05, gnorm=0.529, clip=0, loss_scale=64, train_wall=60, gb_free=13, wall=35408
2023-08-24 12:06:13 | INFO | train_inner | epoch 034:   1077 / 1474 loss=1.92, trans_loss=4.934, nll_loss=2.111, w2v_ctc_loss=0.588, task_loss=3.171, contrastive_loss=0, total=4151.58, n_correct=2776, ppl=4.32, accuracy=66.866, wps=13930.2, ups=1.68, wpb=8303.2, bsz=308, num_updates=49700, lr=6.34361e-05, gnorm=0.537, clip=0, loss_scale=64, train_wall=59, gb_free=17.3, wall=35468
2023-08-24 12:07:14 | INFO | train_inner | epoch 034:   1177 / 1474 loss=1.917, trans_loss=4.929, nll_loss=2.105, w2v_ctc_loss=0.581, task_loss=3.392, contrastive_loss=0, total=4091.98, n_correct=2742.53, ppl=4.3, accuracy=67.022, wps=13588.1, ups=1.66, wpb=8184, bsz=297.4, num_updates=49800, lr=6.33724e-05, gnorm=0.532, clip=0, loss_scale=64, train_wall=60, gb_free=17.1, wall=35528
2023-08-24 12:08:14 | INFO | train_inner | epoch 034:   1277 / 1474 loss=1.916, trans_loss=4.928, nll_loss=2.104, w2v_ctc_loss=0.578, task_loss=3.311, contrastive_loss=0, total=4162.83, n_correct=2790.57, ppl=4.3, accuracy=67.035, wps=13895.6, ups=1.67, wpb=8325.7, bsz=301.1, num_updates=49900, lr=6.33089e-05, gnorm=0.543, clip=0, loss_scale=64, train_wall=59, gb_free=16, wall=35588
2023-08-24 12:09:14 | INFO | train_inner | epoch 034:   1377 / 1474 loss=1.921, trans_loss=4.935, nll_loss=2.113, w2v_ctc_loss=0.589, task_loss=3.158, contrastive_loss=0, total=4187.24, n_correct=2798.31, ppl=4.33, accuracy=66.829, wps=13866.8, ups=1.66, wpb=8374.5, bsz=320.2, num_updates=50000, lr=6.32456e-05, gnorm=0.535, clip=0, loss_scale=64, train_wall=60, gb_free=17.1, wall=35648
2023-08-24 12:09:14 | INFO | fairseq_cli.train | Stopping training due to num_updates: 50000 >= max_update: 50000
2023-08-24 12:09:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-24 12:09:47 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 4.161 | trans_loss 5.547 | nll_loss 2.815 | w2v_ctc_loss 1.371 | task_loss 11.589 | contrastive_loss 0 | total 4003.4 | n_correct 2498.8 | ppl 7.04 | accuracy 62.417 | uer 16.89 | wer 18.81 | raw_wer 18.81 | bleu 20.24 | wps 1578.7 | wpb 4003.4 | bsz 141.8 | num_updates 50000 | best_bleu 20.57
2023-08-24 12:09:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 50000 updates
2023-08-24 12:09:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_34_50000.pt
2023-08-24 12:09:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_34_50000.pt
2023-08-24 12:09:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5/checkpoint_34_50000.pt (epoch 34 @ 50000 updates, score 20.24) (writing took 7.735354342032224 seconds)
2023-08-24 12:09:55 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2023-08-24 12:09:55 | INFO | train | epoch 034 | loss 1.915 | trans_loss 4.923 | nll_loss 2.097 | w2v_ctc_loss 0.58 | task_loss 3.305 | contrastive_loss 0 | total 4133.06 | n_correct 2774.96 | ppl 4.28 | accuracy 67.14 | wps 12974.1 | ups 1.57 | wpb 8266.1 | bsz 304.2 | num_updates 50000 | lr 6.32456e-05 | gnorm 0.536 | clip 0 | loss_scale 64 | train_wall 818 | gb_free 17.1 | wall 35690
2023-08-24 12:09:55 | INFO | fairseq_cli.train | done training in 35645.4 seconds
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
    raise EOFError
EOFError
    raise EOFError
EOFError
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1472 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:11276
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-26 12:17:58 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-26 12:17:58 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-26 12:18:02 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:11276', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 15000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 15000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_ende_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=15000, max_tokens_valid=15000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/ende_shrink_v2_merge_mustc_0824_soft_noCL_AT_sentence_mixup0307_scale2.5_alpha0_mt0.5', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-26 12:18:02 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 10,000
2023-08-26 12:18:02 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 10,000
2023-08-26 12:18:02 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-26 12:18:02 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-26 12:18:02 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-26 12:18:06 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-26 12:18:06 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_ende_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-26 12:18:06 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-26 12:18:08 | INFO | root | load pretrained hubert
Traceback (most recent call last):
  File "/mnt/zhangyh/fairseq-AT/fairseq_cli/train.py", line 564, in <module>
    cli_main()
  File "/mnt/zhangyh/fairseq-AT/fairseq_cli/train.py", line 557, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/mnt/zhangyh/fairseq-AT/fairseq/distributed/utils.py", line 344, in call_main
    torch.multiprocessing.spawn(
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 239, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 197, in start_processes
    while not context.join():
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 140, in join
    raise ProcessExitedException(
torch.multiprocessing.spawn.ProcessExitedException: process 6 terminated with signal SIGTERM
