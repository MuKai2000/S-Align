2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:19925
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-29 23:37:17 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 23:37:17 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-29 23:37:20 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:19925', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 11000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 11000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=3.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=3.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=3.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.0, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-29 23:37:20 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 9,999
2023-08-29 23:37:20 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 9,999
2023-08-29 23:37:20 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-29 23:37:20 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-29 23:37:20 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-29 23:37:24 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-29 23:37:24 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_enfr_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-29 23:37:24 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-29 23:37:26 | INFO | root | load pretrained hubert
2023-08-29 23:37:33 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-29 23:37:35 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-29 23:37:40 | INFO | root | load pretrained decoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-29 23:37:40 | INFO | root | share the sematic adapter and textual encoder
2023-08-29 23:37:40 | INFO | fairseq_cli.train | S2TJoint(
  (acoustic_encoder): AcousticEncoder(
    (compress_ffn): Linear(in_features=768, out_features=512, bias=True)
    (proj): Linear(in_features=512, out_features=9999, bias=False)
    (w2v_model): HubertModel(
      (feature_extractor): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Fp32GroupNorm(512, 512, eps=1e-05, affine=True)
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
        )
      )
      (post_extract_proj): Linear(in_features=512, out_features=768, bias=True)
      (dropout_input): Dropout(p=0.0, inplace=False)
      (dropout_features): Dropout(p=0.1, inplace=False)
      (encoder): TransformerEncoder(
        (pos_conv): Sequential(
          (0): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
          (1): SamePad()
          (2): GELU(approximate='none')
        )
        (layers): ModuleList(
          (0-11): 12 x TransformerSentenceEncoderLayer(
            (self_attn): MultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
            (dropout3): Dropout(p=0.1, inplace=False)
            (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
          )
        )
        (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      (final_proj): None
    )
    (noad): NormalAdapter(
      (subsample): Conv1dSubsampler(
        (conv_layers): ModuleList(
          (0): Conv1d(512, 512, kernel_size=(5,), stride=(2,), padding=(2,))
          (1): Conv1d(256, 1024, kernel_size=(5,), stride=(2,), padding=(2,))
        )
      )
      (layers): ModuleList()
    )
    (sead): SemanticAdapter(
      (embed_positions): SinusoidalPositionalEmbedding()
      (layers): ModuleList(
        (0-5): 6 x TransformerEncoderLayerBase(
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        )
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    )
    (final_dropout): Dropout(p=0.1, inplace=False)
    (shrink_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (textual_encoder): MTModelEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayerBase(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoderScriptable(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=512, out_features=9999, bias=False)
  )
  (task_net): TaskNetwork(
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (down_proj): Linear(in_features=512, out_features=256, bias=True)
    (up_proj): Linear(in_features=256, out_features=512, bias=True)
    (dropout_module): FairseqDropout()
    (task_proj): Linear(in_features=512, out_features=1, bias=False)
  )
)
2023-08-29 23:37:40 | INFO | fairseq_cli.train | task: JointTriplePretrainingMergeTask
2023-08-29 23:37:40 | INFO | fairseq_cli.train | model: S2TJoint
2023-08-29 23:37:40 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropywithW2vCtcShrinkJointATMerge
2023-08-29 23:37:40 | INFO | fairseq_cli.train | num. shared model params: 147,043,968 (num. trained: 147,043,968)
2023-08-29 23:37:40 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2023-08-29 23:37:40 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-29 23:37:40 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 23:37:40 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 23:37:40 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="dev_st", n_samples=1408, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 23:37:56 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:2 to store for rank: 0
2023-08-29 23:38:00 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- textual_encoder.embed_tokens.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.embed_tokens.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.output_projection.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.0.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.1.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.2.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.3.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.4.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.5.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.6.0.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- decoder.output_projection.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- task_net.task_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.weight <- textual_encoder.layers.0.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.bias <- textual_encoder.layers.0.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.weight <- textual_encoder.layers.0.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.bias <- textual_encoder.layers.0.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.weight <- textual_encoder.layers.0.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.bias <- textual_encoder.layers.0.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.weight <- textual_encoder.layers.0.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.bias <- textual_encoder.layers.0.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.weight <- textual_encoder.layers.0.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.bias <- textual_encoder.layers.0.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.weight <- textual_encoder.layers.0.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.bias <- textual_encoder.layers.0.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.weight <- textual_encoder.layers.0.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.bias <- textual_encoder.layers.0.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.weight <- textual_encoder.layers.0.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.bias <- textual_encoder.layers.0.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.weight <- textual_encoder.layers.1.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.bias <- textual_encoder.layers.1.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.weight <- textual_encoder.layers.1.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.bias <- textual_encoder.layers.1.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.weight <- textual_encoder.layers.1.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.bias <- textual_encoder.layers.1.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.weight <- textual_encoder.layers.1.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.bias <- textual_encoder.layers.1.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.weight <- textual_encoder.layers.1.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.bias <- textual_encoder.layers.1.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.weight <- textual_encoder.layers.1.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.bias <- textual_encoder.layers.1.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.weight <- textual_encoder.layers.1.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.bias <- textual_encoder.layers.1.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.weight <- textual_encoder.layers.1.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.bias <- textual_encoder.layers.1.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.weight <- textual_encoder.layers.2.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.bias <- textual_encoder.layers.2.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.weight <- textual_encoder.layers.2.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.bias <- textual_encoder.layers.2.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.weight <- textual_encoder.layers.2.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.bias <- textual_encoder.layers.2.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.weight <- textual_encoder.layers.2.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.bias <- textual_encoder.layers.2.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.weight <- textual_encoder.layers.2.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.bias <- textual_encoder.layers.2.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.weight <- textual_encoder.layers.2.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.bias <- textual_encoder.layers.2.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.weight <- textual_encoder.layers.2.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.bias <- textual_encoder.layers.2.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.weight <- textual_encoder.layers.2.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.bias <- textual_encoder.layers.2.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.weight <- textual_encoder.layers.3.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.bias <- textual_encoder.layers.3.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.weight <- textual_encoder.layers.3.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.bias <- textual_encoder.layers.3.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.weight <- textual_encoder.layers.3.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.bias <- textual_encoder.layers.3.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.weight <- textual_encoder.layers.3.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.bias <- textual_encoder.layers.3.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.weight <- textual_encoder.layers.3.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.bias <- textual_encoder.layers.3.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.weight <- textual_encoder.layers.3.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.bias <- textual_encoder.layers.3.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.weight <- textual_encoder.layers.3.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.bias <- textual_encoder.layers.3.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.weight <- textual_encoder.layers.3.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.bias <- textual_encoder.layers.3.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.weight <- textual_encoder.layers.4.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.bias <- textual_encoder.layers.4.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.weight <- textual_encoder.layers.4.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.bias <- textual_encoder.layers.4.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.weight <- textual_encoder.layers.4.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.bias <- textual_encoder.layers.4.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.weight <- textual_encoder.layers.4.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.bias <- textual_encoder.layers.4.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.weight <- textual_encoder.layers.4.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.bias <- textual_encoder.layers.4.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.weight <- textual_encoder.layers.4.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.bias <- textual_encoder.layers.4.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.weight <- textual_encoder.layers.4.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.bias <- textual_encoder.layers.4.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.weight <- textual_encoder.layers.4.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.bias <- textual_encoder.layers.4.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.weight <- textual_encoder.layers.5.self_attn.k_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.bias <- textual_encoder.layers.5.self_attn.k_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.weight <- textual_encoder.layers.5.self_attn.v_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.bias <- textual_encoder.layers.5.self_attn.v_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.weight <- textual_encoder.layers.5.self_attn.q_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.bias <- textual_encoder.layers.5.self_attn.q_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.weight <- textual_encoder.layers.5.self_attn.out_proj.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.bias <- textual_encoder.layers.5.self_attn.out_proj.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.weight <- textual_encoder.layers.5.self_attn_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.bias <- textual_encoder.layers.5.self_attn_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.weight <- textual_encoder.layers.5.fc1.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.bias <- textual_encoder.layers.5.fc1.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.weight <- textual_encoder.layers.5.fc2.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.bias <- textual_encoder.layers.5.fc2.bias
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.weight <- textual_encoder.layers.5.final_layer_norm.weight
2023-08-29 23:38:00 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.bias <- textual_encoder.layers.5.final_layer_norm.bias
2023-08-29 23:38:00 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   1: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   2: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   3: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   4: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   5: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   6: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | rank   7: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 23:38:00 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-29 23:38:00 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)
2023-08-29 23:38:00 | INFO | fairseq_cli.train | max tokens per device = 11000 and max sentences per device = None
2023-08-29 23:38:00 | INFO | fairseq.trainer | Preparing to load checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-29 23:38:00 | INFO | fairseq.trainer | No existing checkpoint found ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-29 23:38:00 | INFO | fairseq.trainer | loading train data for epoch 1
2023-08-29 23:38:00 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-29 23:38:00 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 23:38:00 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 23:38:02 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_asr", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 23:38:04 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_st", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 23:38:54 | INFO | fairseq.optim.adam | using FusedAdam
2023-08-29 23:38:54 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 23:38:54 | INFO | fairseq.trainer | begin training epoch 1
2023-08-29 23:38:54 | INFO | fairseq_cli.train | Start iterating over samples
True False
None None None
2023-08-29 23:39:07 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-29 23:39:09 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
True False
None None None
True False
None None None
True False
None None None
2023-08-29 23:39:54 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
True False
None None None
2023-08-29 23:40:15 | INFO | train_inner | epoch 001:    103 / 1191 loss=19.025, trans_loss=6.389, nll_loss=5.162, w2v_ctc_loss=21.391, task_loss=4.161, contrastive_loss=3.613, total=6741.87, n_correct=203.52, ppl=35.79, accuracy=3.019, wps=28015.9, ups=1.44, wpb=19523.2, bsz=683.5, num_updates=100, lr=4.098e-06, gnorm=1.644, clip=0, loss_scale=16, train_wall=73, gb_free=17.9, wall=135
2023-08-29 23:41:22 | INFO | train_inner | epoch 001:    203 / 1191 loss=15.285, trans_loss=6.188, nll_loss=4.982, w2v_ctc_loss=15.857, task_loss=3.976, contrastive_loss=3.626, total=6694.99, n_correct=167.58, ppl=31.59, accuracy=2.503, wps=28845.4, ups=1.49, wpb=19404.5, bsz=683.1, num_updates=200, lr=8.096e-06, gnorm=6.147, clip=4, loss_scale=16, train_wall=67, gb_free=17.6, wall=202
2023-08-29 23:42:31 | INFO | train_inner | epoch 001:    303 / 1191 loss=10.271, trans_loss=6.166, nll_loss=5.031, w2v_ctc_loss=8.13, task_loss=3.339, contrastive_loss=3.656, total=6849.79, n_correct=128.44, ppl=32.69, accuracy=1.875, wps=28647.6, ups=1.44, wpb=19850.1, bsz=713.5, num_updates=300, lr=1.2094e-05, gnorm=1.621, clip=0, loss_scale=16, train_wall=69, gb_free=18, wall=271
2023-08-29 23:43:39 | INFO | train_inner | epoch 001:    403 / 1191 loss=9.821, trans_loss=6.276, nll_loss=5.201, w2v_ctc_loss=7.387, task_loss=3.536, contrastive_loss=3.538, total=6661.33, n_correct=68, ppl=36.78, accuracy=1.021, wps=28602.7, ups=1.48, wpb=19315.8, bsz=657.1, num_updates=400, lr=1.6092e-05, gnorm=0.843, clip=0, loss_scale=16, train_wall=67, gb_free=18.1, wall=339
2023-08-29 23:44:46 | INFO | train_inner | epoch 001:    503 / 1191 loss=9.693, trans_loss=6.4, nll_loss=5.363, w2v_ctc_loss=7.035, task_loss=3.124, contrastive_loss=3.59, total=6737.22, n_correct=38.68, ppl=41.15, accuracy=0.574, wps=29035.1, ups=1.49, wpb=19517.9, bsz=686.6, num_updates=500, lr=2.009e-05, gnorm=0.718, clip=0, loss_scale=16, train_wall=67, gb_free=18.4, wall=406
2023-08-29 23:45:53 | INFO | train_inner | epoch 001:    603 / 1191 loss=9.647, trans_loss=6.457, nll_loss=5.439, w2v_ctc_loss=6.899, task_loss=3.038, contrastive_loss=3.559, total=6775.38, n_correct=29.98, ppl=43.39, accuracy=0.442, wps=29345.6, ups=1.49, wpb=19631.7, bsz=689.3, num_updates=600, lr=2.4088e-05, gnorm=0.853, clip=0, loss_scale=16, train_wall=66, gb_free=18, wall=473
2023-08-29 23:47:00 | INFO | train_inner | epoch 001:    703 / 1191 loss=9.603, trans_loss=6.522, nll_loss=5.521, w2v_ctc_loss=6.788, task_loss=3.116, contrastive_loss=3.576, total=6625.64, n_correct=19.53, ppl=45.91, accuracy=0.295, wps=28679.7, ups=1.49, wpb=19188.7, bsz=672.7, num_updates=700, lr=2.8086e-05, gnorm=0.879, clip=0, loss_scale=16, train_wall=66, gb_free=18.1, wall=540
2023-08-29 23:48:06 | INFO | train_inner | epoch 001:    803 / 1191 loss=9.543, trans_loss=6.471, nll_loss=5.454, w2v_ctc_loss=6.751, task_loss=2.942, contrastive_loss=3.54, total=6750.05, n_correct=15.46, ppl=43.83, accuracy=0.229, wps=29352.5, ups=1.5, wpb=19548.7, bsz=688.8, num_updates=800, lr=3.2084e-05, gnorm=0.914, clip=0, loss_scale=16, train_wall=66, gb_free=18.3, wall=606
2023-08-29 23:49:15 | INFO | train_inner | epoch 001:    903 / 1191 loss=9.387, trans_loss=6.357, nll_loss=5.307, w2v_ctc_loss=6.711, task_loss=3.101, contrastive_loss=3.484, total=6706.37, n_correct=17.09, ppl=39.58, accuracy=0.255, wps=28551.8, ups=1.47, wpb=19433.6, bsz=675.8, num_updates=900, lr=3.6082e-05, gnorm=1.26, clip=0, loss_scale=16, train_wall=67, gb_free=17.6, wall=674
2023-08-29 23:50:22 | INFO | train_inner | epoch 001:   1003 / 1191 loss=9.335, trans_loss=6.325, nll_loss=5.264, w2v_ctc_loss=6.725, task_loss=3.217, contrastive_loss=3.414, total=6668.9, n_correct=24.24, ppl=38.42, accuracy=0.363, wps=28765.1, ups=1.49, wpb=19321.9, bsz=662.2, num_updates=1000, lr=4.008e-05, gnorm=1.359, clip=0, loss_scale=16, train_wall=67, gb_free=18.6, wall=742
2023-08-29 23:51:28 | INFO | train_inner | epoch 001:   1103 / 1191 loss=9.251, trans_loss=6.314, nll_loss=5.245, w2v_ctc_loss=6.638, task_loss=3.203, contrastive_loss=3.346, total=6578.13, n_correct=31.28, ppl=37.92, accuracy=0.476, wps=28666.9, ups=1.5, wpb=19050.5, bsz=647.4, num_updates=1100, lr=4.4078e-05, gnorm=1.602, clip=0, loss_scale=16, train_wall=66, gb_free=17.6, wall=808
2023-08-29 23:52:27 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2023-08-29 23:53:10 | INFO | dev_st | epoch 001 | valid on 'dev_st' subset | loss 13.296 | trans_loss 13.876 | nll_loss 13.603 | w2v_ctc_loss 9.307 | task_loss 19.622 | contrastive_loss 4.91 | total 6138.43 | n_correct 24 | ppl 12441.1 | accuracy 0.391 | uer 91.643 | wer 98.866 | raw_wer 98.866 | bleu 0 | wps 1218.9 | wpb 6138.4 | bsz 201.1 | num_updates 1188
2023-08-29 23:53:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 1188 updates
2023-08-29 23:53:10 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-29 23:53:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-29 23:53:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 1 @ 1188 updates, score 0.0) (writing took 3.9090200039936462 seconds)
2023-08-29 23:53:14 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-08-29 23:53:14 | INFO | train | epoch 001 | loss 10.862 | trans_loss 6.347 | nll_loss 5.266 | w2v_ctc_loss 8.942 | task_loss 3.321 | contrastive_loss 3.531 | total 6703.11 | n_correct 64.9857 | ppl 38.47 | accuracy 0.969 | wps 27166.7 | ups 1.4 | wpb 19420.9 | bsz 678 | num_updates 1188 | lr 4.75962e-05 | gnorm 1.604 | clip 0.3 | loss_scale 16 | train_wall 797 | gb_free 18.5 | wall 914
2023-08-29 23:53:14 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 23:53:14 | INFO | fairseq.trainer | begin training epoch 2
2023-08-29 23:53:14 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 23:53:30 | INFO | train_inner | epoch 002:     12 / 1191 loss=9.203, trans_loss=6.292, nll_loss=5.217, w2v_ctc_loss=6.597, task_loss=3.045, contrastive_loss=3.41, total=6631.26, n_correct=32, ppl=37.19, accuracy=0.483, wps=15718.8, ups=0.82, wpb=19218.6, bsz=679.5, num_updates=1200, lr=4.8076e-05, gnorm=1.415, clip=0, loss_scale=16, train_wall=66, gb_free=17.5, wall=930
2023-08-29 23:54:37 | INFO | train_inner | epoch 002:    112 / 1191 loss=9.133, trans_loss=6.27, nll_loss=5.186, w2v_ctc_loss=6.594, task_loss=3.162, contrastive_loss=3.295, total=6617.43, n_correct=33.87, ppl=36.41, accuracy=0.512, wps=28604.2, ups=1.49, wpb=19164.1, bsz=662.2, num_updates=1300, lr=5.2074e-05, gnorm=1.735, clip=0, loss_scale=16, train_wall=66, gb_free=17.6, wall=997
2023-08-29 23:55:44 | INFO | train_inner | epoch 002:    212 / 1191 loss=8.809, trans_loss=6.249, nll_loss=5.159, w2v_ctc_loss=6.134, task_loss=3.122, contrastive_loss=3.246, total=6716.9, n_correct=36.38, ppl=35.73, accuracy=0.542, wps=29124.3, ups=1.5, wpb=19456.2, bsz=672.8, num_updates=1400, lr=5.6072e-05, gnorm=1.732, clip=0, loss_scale=16, train_wall=66, gb_free=17.5, wall=1064
2023-08-29 23:56:52 | INFO | train_inner | epoch 002:    312 / 1191 loss=8.032, trans_loss=6.232, nll_loss=5.138, w2v_ctc_loss=4.972, task_loss=2.948, contrastive_loss=3.211, total=6776.25, n_correct=41.22, ppl=35.2, accuracy=0.608, wps=28942.7, ups=1.47, wpb=19634.6, bsz=690.8, num_updates=1500, lr=6.007e-05, gnorm=1.187, clip=0, loss_scale=16, train_wall=67, gb_free=18, wall=1132
2023-08-29 23:57:59 | INFO | train_inner | epoch 002:    412 / 1191 loss=7.729, trans_loss=6.213, nll_loss=5.113, w2v_ctc_loss=4.566, task_loss=3.011, contrastive_loss=3.209, total=6718.15, n_correct=43.53, ppl=34.61, accuracy=0.648, wps=29100.3, ups=1.49, wpb=19472.2, bsz=690.8, num_updates=1600, lr=6.4068e-05, gnorm=1.071, clip=0, loss_scale=16, train_wall=66, gb_free=17.8, wall=1199
2023-08-29 23:59:06 | INFO | train_inner | epoch 002:    512 / 1191 loss=7.448, trans_loss=6.172, nll_loss=5.061, w2v_ctc_loss=4.218, task_loss=3.127, contrastive_loss=3.183, total=6696.54, n_correct=48, ppl=33.38, accuracy=0.717, wps=29094.4, ups=1.5, wpb=19408.7, bsz=678.7, num_updates=1700, lr=6.8066e-05, gnorm=1.203, clip=0, loss_scale=16, train_wall=66, gb_free=18.1, wall=1266
2023-08-30 00:00:12 | INFO | train_inner | epoch 002:    612 / 1191 loss=7.208, trans_loss=6.161, nll_loss=5.046, w2v_ctc_loss=3.916, task_loss=3.177, contrastive_loss=3.097, total=6640.77, n_correct=50.83, ppl=33.03, accuracy=0.765, wps=28853.5, ups=1.5, wpb=19228.2, bsz=659.1, num_updates=1800, lr=7.2064e-05, gnorm=1.267, clip=0, loss_scale=16, train_wall=66, gb_free=17.8, wall=1332
2023-08-30 00:01:19 | INFO | train_inner | epoch 002:    712 / 1191 loss=7.061, trans_loss=6.157, nll_loss=5.041, w2v_ctc_loss=3.669, task_loss=2.939, contrastive_loss=3.117, total=6799.78, n_correct=53.74, ppl=32.93, accuracy=0.79, wps=29509.8, ups=1.5, wpb=19685.9, bsz=701.6, num_updates=1900, lr=7.6062e-05, gnorm=1.341, clip=0, loss_scale=16, train_wall=66, gb_free=17.9, wall=1399
2023-08-30 00:02:26 | INFO | train_inner | epoch 002:    812 / 1191 loss=6.921, trans_loss=6.153, nll_loss=5.035, w2v_ctc_loss=3.495, task_loss=2.998, contrastive_loss=3.001, total=6729.15, n_correct=55.42, ppl=32.79, accuracy=0.824, wps=29277.3, ups=1.5, wpb=19495.9, bsz=677.7, num_updates=2000, lr=8.006e-05, gnorm=1.418, clip=0, loss_scale=16, train_wall=66, gb_free=17.8, wall=1465
2023-08-30 00:02:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 00:03:09 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 11.747 | trans_loss 13.871 | nll_loss 13.47 | w2v_ctc_loss 4.489 | task_loss 19.621 | contrastive_loss 4.486 | total 6138.43 | n_correct 47.4286 | ppl 11345.2 | accuracy 0.773 | uer 64.277 | wer 61.67 | raw_wer 61.67 | bleu 0 | wps 1217.1 | wpb 6138.4 | bsz 201.1 | num_updates 2000 | best_bleu 0
2023-08-30 00:03:09 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2000 updates
2023-08-30 00:03:09 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-30 00:03:11 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-30 00:03:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.0) (writing took 11.208136383007513 seconds)
2023-08-30 00:04:27 | INFO | train_inner | epoch 002:    912 / 1191 loss=6.798, trans_loss=6.156, nll_loss=5.04, w2v_ctc_loss=3.335, task_loss=2.95, contrastive_loss=3.069, total=6738.95, n_correct=59.78, ppl=32.91, accuracy=0.887, wps=16094.6, ups=0.82, wpb=19533.2, bsz=703.8, num_updates=2100, lr=8.4058e-05, gnorm=1.37, clip=0, loss_scale=16, train_wall=66, gb_free=17.9, wall=1587
2023-08-30 00:05:34 | INFO | train_inner | epoch 002:   1012 / 1191 loss=6.688, trans_loss=6.168, nll_loss=5.051, w2v_ctc_loss=3.226, task_loss=3.045, contrastive_loss=2.92, total=6774.79, n_correct=60.84, ppl=33.16, accuracy=0.898, wps=29357.5, ups=1.49, wpb=19640.8, bsz=687.3, num_updates=2200, lr=8.8056e-05, gnorm=1.392, clip=0, loss_scale=32, train_wall=66, gb_free=18.1, wall=1654
2023-08-30 00:06:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-30 00:06:41 | INFO | train_inner | epoch 002:   1113 / 1191 loss=6.577, trans_loss=6.171, nll_loss=5.055, w2v_ctc_loss=3.128, task_loss=3.232, contrastive_loss=2.793, total=6648.85, n_correct=61.12, ppl=33.25, accuracy=0.919, wps=28677.6, ups=1.49, wpb=19256.7, bsz=650.7, num_updates=2300, lr=9.2054e-05, gnorm=1.592, clip=0, loss_scale=16, train_wall=67, gb_free=18.5, wall=1721
2023-08-30 00:07:33 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 00:08:16 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 11.577 | trans_loss 14.033 | nll_loss 13.59 | w2v_ctc_loss 3.85 | task_loss 19.621 | contrastive_loss 4.105 | total 6138.43 | n_correct 59.8571 | ppl 12331.6 | accuracy 0.975 | uer 57.639 | wer 55.593 | raw_wer 55.593 | bleu 0 | wps 1219.8 | wpb 6138.4 | bsz 201.1 | num_updates 2378 | best_bleu 0
2023-08-30 00:08:16 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2378 updates
2023-08-30 00:08:16 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:08:23 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:08:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 2 @ 2378 updates, score 0.0) (writing took 11.755374614003813 seconds)
2023-08-30 00:08:28 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-08-30 00:08:28 | INFO | train | epoch 002 | loss 7.442 | trans_loss 6.19 | nll_loss 5.083 | w2v_ctc_loss 4.236 | task_loss 3.074 | contrastive_loss 3.09 | total 6703.17 | n_correct 50.0908 | ppl 33.89 | accuracy 0.747 | wps 25281 | ups 1.3 | wpb 19421.1 | bsz 677.8 | num_updates 2378 | lr 9.51724e-05 | gnorm 1.41 | clip 0 | loss_scale 16 | train_wall 788 | gb_free 17.7 | wall 1828
2023-08-30 00:08:29 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 00:08:29 | INFO | fairseq.trainer | begin training epoch 3
2023-08-30 00:08:29 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 00:08:50 | INFO | train_inner | epoch 003:     22 / 1191 loss=6.492, trans_loss=6.165, nll_loss=5.05, w2v_ctc_loss=3.043, task_loss=3.276, contrastive_loss=2.828, total=6597.75, n_correct=61.24, ppl=33.14, accuracy=0.928, wps=14794, ups=0.77, wpb=19123.8, bsz=654.9, num_updates=2400, lr=9.6052e-05, gnorm=1.548, clip=0, loss_scale=16, train_wall=66, gb_free=18.5, wall=1850
2023-08-30 00:09:57 | INFO | train_inner | epoch 003:    122 / 1191 loss=6.427, trans_loss=6.154, nll_loss=5.041, w2v_ctc_loss=2.952, task_loss=3.014, contrastive_loss=2.808, total=6689.99, n_correct=61.41, ppl=32.92, accuracy=0.918, wps=28999.9, ups=1.49, wpb=19400.5, bsz=686.9, num_updates=2500, lr=0.00010005, gnorm=1.611, clip=0, loss_scale=16, train_wall=66, gb_free=18.7, wall=1917
2023-08-30 00:11:05 | INFO | train_inner | epoch 003:    222 / 1191 loss=6.329, trans_loss=6.164, nll_loss=5.053, w2v_ctc_loss=2.856, task_loss=2.988, contrastive_loss=2.729, total=6716.3, n_correct=63.04, ppl=33.19, accuracy=0.939, wps=28876.2, ups=1.48, wpb=19462.8, bsz=684.5, num_updates=2600, lr=0.000104048, gnorm=1.459, clip=0, loss_scale=16, train_wall=67, gb_free=17.7, wall=1984
2023-08-30 00:12:12 | INFO | train_inner | epoch 003:    322 / 1191 loss=6.241, trans_loss=6.163, nll_loss=5.052, w2v_ctc_loss=2.827, task_loss=3.509, contrastive_loss=2.554, total=6578.84, n_correct=62.28, ppl=33.17, accuracy=0.947, wps=28495.2, ups=1.5, wpb=19052.5, bsz=625.2, num_updates=2700, lr=0.000108046, gnorm=1.547, clip=0, loss_scale=16, train_wall=66, gb_free=18.5, wall=2051
2023-08-30 00:13:18 | INFO | train_inner | epoch 003:    422 / 1191 loss=6.197, trans_loss=6.159, nll_loss=5.05, w2v_ctc_loss=2.733, task_loss=3.004, contrastive_loss=2.68, total=6697.81, n_correct=65.76, ppl=33.13, accuracy=0.982, wps=29395.5, ups=1.51, wpb=19404.2, bsz=690.4, num_updates=2800, lr=0.000112044, gnorm=1.409, clip=0, loss_scale=16, train_wall=65, gb_free=18.9, wall=2117
2023-08-30 00:14:24 | INFO | train_inner | epoch 003:    522 / 1191 loss=6.158, trans_loss=6.168, nll_loss=5.064, w2v_ctc_loss=2.709, task_loss=3.06, contrastive_loss=2.518, total=6747.27, n_correct=67.08, ppl=33.46, accuracy=0.994, wps=29346.4, ups=1.5, wpb=19551.8, bsz=674.2, num_updates=2900, lr=0.000116042, gnorm=1.6, clip=0, loss_scale=16, train_wall=66, gb_free=18.2, wall=2184
2023-08-30 00:15:31 | INFO | train_inner | epoch 003:    622 / 1191 loss=6.099, trans_loss=6.157, nll_loss=5.049, w2v_ctc_loss=2.661, task_loss=3.11, contrastive_loss=2.478, total=6746.29, n_correct=69.82, ppl=33.1, accuracy=1.035, wps=29191.4, ups=1.49, wpb=19552.3, bsz=665.2, num_updates=3000, lr=0.00012004, gnorm=1.504, clip=0, loss_scale=16, train_wall=66, gb_free=18.6, wall=2251
2023-08-30 00:15:32 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-30 00:15:33 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
2023-08-30 00:15:36 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
2023-08-30 00:15:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 1.0
2023-08-30 00:17:21 | INFO | train_inner | epoch 003:    726 / 1191 loss=5.471, trans_loss=5.401, nll_loss=4.127, w2v_ctc_loss=2.414, task_loss=2.135, contrastive_loss=2.648, total=6742.35, n_correct=251.9, ppl=17.47, accuracy=3.736, wps=17804.9, ups=0.91, wpb=19541.9, bsz=701.5, num_updates=3100, lr=0.000124038, gnorm=2.887, clip=2, loss_scale=1, train_wall=109, gb_free=13, wall=2361
2023-08-30 00:19:05 | INFO | train_inner | epoch 003:    826 / 1191 loss=4.948, trans_loss=5.191, nll_loss=3.858, w2v_ctc_loss=2.122, task_loss=2.01, contrastive_loss=2.272, total=6780.63, n_correct=387.23, ppl=14.5, accuracy=5.711, wps=18841.2, ups=0.96, wpb=19654.7, bsz=710.8, num_updates=3200, lr=0.000128036, gnorm=1.643, clip=0, loss_scale=1, train_wall=104, gb_free=12, wall=2465
2023-08-30 00:20:48 | INFO | train_inner | epoch 003:    926 / 1191 loss=4.707, trans_loss=5.103, nll_loss=3.739, w2v_ctc_loss=1.964, task_loss=1.989, contrastive_loss=2.102, total=6793.28, n_correct=617.15, ppl=13.35, accuracy=9.085, wps=19086.6, ups=0.97, wpb=19676.5, bsz=709, num_updates=3300, lr=0.000132034, gnorm=1.673, clip=0, loss_scale=1, train_wall=102, gb_free=13.1, wall=2568
2023-08-30 00:22:34 | INFO | train_inner | epoch 003:   1026 / 1191 loss=4.451, trans_loss=4.943, nll_loss=3.526, w2v_ctc_loss=1.898, task_loss=2.511, contrastive_loss=1.907, total=6544.02, n_correct=882.64, ppl=11.52, accuracy=13.488, wps=18023.6, ups=0.95, wpb=18965.3, bsz=618.6, num_updates=3400, lr=0.000136032, gnorm=1.574, clip=0, loss_scale=1, train_wall=105, gb_free=13.8, wall=2673
2023-08-30 00:24:19 | INFO | train_inner | epoch 003:   1126 / 1191 loss=4.276, trans_loss=4.798, nll_loss=3.328, w2v_ctc_loss=1.785, task_loss=2.068, contrastive_loss=1.933, total=6773.24, n_correct=1116.67, ppl=10.04, accuracy=16.486, wps=18555.6, ups=0.95, wpb=19607.2, bsz=708.3, num_updates=3500, lr=0.00014003, gnorm=1.526, clip=0, loss_scale=1, train_wall=105, gb_free=14.6, wall=2779
2023-08-30 00:25:27 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 00:26:07 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 7.13 | trans_loss 8.793 | nll_loss 7.175 | w2v_ctc_loss 2.057 | task_loss 10.759 | contrastive_loss 2.557 | total 6138.43 | n_correct 1206.29 | ppl 144.54 | accuracy 19.651 | uer 33.677 | wer 33.261 | raw_wer 33.261 | bleu 0.34 | wps 1285.7 | wpb 6138.4 | bsz 201.1 | num_updates 3565 | best_bleu 0.34
2023-08-30 00:26:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 3565 updates
2023-08-30 00:26:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:26:14 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:26:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 3 @ 3565 updates, score 0.34) (writing took 11.946476853001514 seconds)
2023-08-30 00:26:20 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-08-30 00:26:20 | INFO | train | epoch 003 | loss 5.511 | trans_loss 5.63 | nll_loss 4.389 | w2v_ctc_loss 2.418 | task_loss 2.644 | contrastive_loss 2.397 | total 6704.62 | n_correct 372.969 | ppl 20.95 | accuracy 5.563 | wps 21523.6 | ups 1.11 | wpb 19425.5 | bsz 678.6 | num_updates 3565 | lr 0.000142629 | gnorm 1.658 | clip 0.2 | loss_scale 1 | train_wall 1003 | gb_free 15.1 | wall 2900
2023-08-30 00:26:20 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 00:26:20 | INFO | fairseq.trainer | begin training epoch 4
2023-08-30 00:26:20 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 00:27:04 | INFO | train_inner | epoch 004:     35 / 1191 loss=4.098, trans_loss=4.708, nll_loss=3.207, w2v_ctc_loss=1.724, task_loss=2.291, contrastive_loss=1.74, total=6566.26, n_correct=1194.33, ppl=9.24, accuracy=18.189, wps=11544.7, ups=0.61, wpb=19006.6, bsz=644.2, num_updates=3600, lr=0.000144028, gnorm=1.488, clip=0, loss_scale=1, train_wall=104, gb_free=13.3, wall=2944
2023-08-30 00:28:49 | INFO | train_inner | epoch 004:    135 / 1191 loss=3.944, trans_loss=4.586, nll_loss=3.046, w2v_ctc_loss=1.657, task_loss=2.226, contrastive_loss=1.647, total=6733.36, n_correct=1403.79, ppl=8.26, accuracy=20.848, wps=18509.3, ups=0.95, wpb=19503.2, bsz=659, num_updates=3700, lr=0.000148026, gnorm=1.412, clip=0, loss_scale=1, train_wall=105, gb_free=13.5, wall=3049
2023-08-30 00:30:33 | INFO | train_inner | epoch 004:    235 / 1191 loss=3.702, trans_loss=4.283, nll_loss=2.649, w2v_ctc_loss=1.612, task_loss=2.097, contrastive_loss=1.747, total=6747.52, n_correct=1964.78, ppl=6.27, accuracy=29.119, wps=18813.9, ups=0.96, wpb=19554.6, bsz=702.1, num_updates=3800, lr=0.000152024, gnorm=1.42, clip=0, loss_scale=1, train_wall=103, gb_free=14.2, wall=3153
2023-08-30 00:32:17 | INFO | train_inner | epoch 004:    335 / 1191 loss=3.473, trans_loss=4.074, nll_loss=2.379, w2v_ctc_loss=1.58, task_loss=2.174, contrastive_loss=1.511, total=6670.37, n_correct=2409.61, ppl=5.2, accuracy=36.124, wps=18679.4, ups=0.97, wpb=19329.7, bsz=662.9, num_updates=3900, lr=0.000156022, gnorm=1.238, clip=0, loss_scale=1, train_wall=103, gb_free=14.4, wall=3256
2023-08-30 00:34:01 | INFO | train_inner | epoch 004:    435 / 1191 loss=3.423, trans_loss=4.037, nll_loss=2.332, w2v_ctc_loss=1.563, task_loss=2.185, contrastive_loss=1.585, total=6715.16, n_correct=2501.84, ppl=5.03, accuracy=37.257, wps=18614.8, ups=0.96, wpb=19457, bsz=683.7, num_updates=4000, lr=0.00016002, gnorm=1.285, clip=0, loss_scale=1, train_wall=104, gb_free=11.7, wall=3361
2023-08-30 00:34:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 00:34:41 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 5.661 | trans_loss 6.892 | nll_loss 4.689 | w2v_ctc_loss 1.847 | task_loss 10.831 | contrastive_loss 2.037 | total 6138.43 | n_correct 2441.71 | ppl 25.8 | accuracy 39.778 | uer 30.294 | wer 30.695 | raw_wer 30.695 | bleu 1.23 | wps 1315.4 | wpb 6138.4 | bsz 201.1 | num_updates 4000 | best_bleu 1.23
2023-08-30 00:34:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4000 updates
2023-08-30 00:34:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-30 00:34:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-30 00:34:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_4_4000.pt (epoch 4 @ 4000 updates, score 1.23) (writing took 12.860083243998815 seconds)
2023-08-30 00:36:39 | INFO | train_inner | epoch 004:    535 / 1191 loss=3.331, trans_loss=4.003, nll_loss=2.289, w2v_ctc_loss=1.526, task_loss=2.22, contrastive_loss=1.392, total=6673.82, n_correct=2561.32, ppl=4.89, accuracy=38.379, wps=12264.5, ups=0.63, wpb=19338.8, bsz=668.4, num_updates=4100, lr=0.000164018, gnorm=1.137, clip=0, loss_scale=1, train_wall=104, gb_free=12.2, wall=3519
2023-08-30 00:38:25 | INFO | train_inner | epoch 004:    635 / 1191 loss=3.289, trans_loss=3.989, nll_loss=2.271, w2v_ctc_loss=1.496, task_loss=2.09, contrastive_loss=1.431, total=6814.1, n_correct=2664.46, ppl=4.83, accuracy=39.102, wps=18682.4, ups=0.95, wpb=19748.2, bsz=705.7, num_updates=4200, lr=0.000168016, gnorm=1.107, clip=0, loss_scale=1, train_wall=105, gb_free=10.2, wall=3624
2023-08-30 00:40:08 | INFO | train_inner | epoch 004:    735 / 1191 loss=3.222, trans_loss=3.973, nll_loss=2.25, w2v_ctc_loss=1.459, task_loss=2.128, contrastive_loss=1.377, total=6700.29, n_correct=2666.22, ppl=4.76, accuracy=39.793, wps=18819.2, ups=0.97, wpb=19408.2, bsz=687.4, num_updates=4300, lr=0.000172014, gnorm=1.07, clip=0, loss_scale=1, train_wall=103, gb_free=13.8, wall=3728
2023-08-30 00:41:53 | INFO | train_inner | epoch 004:    835 / 1191 loss=3.18, trans_loss=3.959, nll_loss=2.232, w2v_ctc_loss=1.441, task_loss=2.021, contrastive_loss=1.333, total=6860.6, n_correct=2775.18, ppl=4.7, accuracy=40.451, wps=18844.5, ups=0.95, wpb=19871.7, bsz=724.3, num_updates=4400, lr=0.000176012, gnorm=1.066, clip=0, loss_scale=1, train_wall=105, gb_free=11.8, wall=3833
2023-08-30 00:43:37 | INFO | train_inner | epoch 004:    935 / 1191 loss=3.122, trans_loss=3.937, nll_loss=2.203, w2v_ctc_loss=1.421, task_loss=2.061, contrastive_loss=1.257, total=6733.51, n_correct=2779.89, ppl=4.61, accuracy=41.284, wps=18708.3, ups=0.96, wpb=19496.4, bsz=704.1, num_updates=4500, lr=0.00018001, gnorm=1.017, clip=0, loss_scale=1, train_wall=104, gb_free=13.3, wall=3937
2023-08-30 00:45:23 | INFO | train_inner | epoch 004:   1035 / 1191 loss=3.088, trans_loss=3.927, nll_loss=2.191, w2v_ctc_loss=1.429, task_loss=2.309, contrastive_loss=1.171, total=6645.98, n_correct=2760.25, ppl=4.57, accuracy=41.533, wps=18248.6, ups=0.95, wpb=19247.9, bsz=661.3, num_updates=4600, lr=0.000184008, gnorm=1.071, clip=0, loss_scale=1, train_wall=105, gb_free=12, wall=4043
2023-08-30 00:47:07 | INFO | train_inner | epoch 004:   1135 / 1191 loss=3.007, trans_loss=3.9, nll_loss=2.157, w2v_ctc_loss=1.405, task_loss=2.338, contrastive_loss=1.007, total=6563.35, n_correct=2798.05, ppl=4.46, accuracy=42.631, wps=18220.6, ups=0.96, wpb=19027.9, bsz=629.6, num_updates=4700, lr=0.000188006, gnorm=0.984, clip=0, loss_scale=1, train_wall=104, gb_free=9.1, wall=4147
2023-08-30 00:48:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 00:48:44 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 5.096 | trans_loss 6.39 | nll_loss 4.031 | w2v_ctc_loss 1.57 | task_loss 11.211 | contrastive_loss 1.384 | total 6138.43 | n_correct 2899.29 | ppl 16.35 | accuracy 47.232 | uer 25.989 | wer 26.839 | raw_wer 26.839 | bleu 5.12 | wps 1367.8 | wpb 6138.4 | bsz 201.1 | num_updates 4756 | best_bleu 5.12
2023-08-30 00:48:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4756 updates
2023-08-30 00:48:44 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:48:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 00:48:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 4 @ 4756 updates, score 5.12) (writing took 11.219732229990768 seconds)
2023-08-30 00:48:56 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-08-30 00:48:56 | INFO | train | epoch 004 | loss 3.347 | trans_loss 4.069 | nll_loss 2.375 | w2v_ctc_loss 1.509 | task_loss 2.178 | contrastive_loss 1.396 | total 6703.69 | n_correct 2463.92 | ppl 5.19 | accuracy 36.755 | wps 17055.2 | ups 0.88 | wpb 19422.7 | bsz 678.2 | num_updates 4756 | lr 0.000190245 | gnorm 1.163 | clip 0 | loss_scale 1 | train_wall 1238 | gb_free 13.2 | wall 4256
2023-08-30 00:48:56 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 00:48:56 | INFO | fairseq.trainer | begin training epoch 5
2023-08-30 00:48:56 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 00:49:49 | INFO | train_inner | epoch 005:     44 / 1191 loss=2.948, trans_loss=3.852, nll_loss=2.095, w2v_ctc_loss=1.37, task_loss=2.035, contrastive_loss=1.069, total=6757.62, n_correct=3014.13, ppl=4.27, accuracy=44.603, wps=12124.6, ups=0.62, wpb=19585.7, bsz=710.1, num_updates=4800, lr=0.000192004, gnorm=0.954, clip=0, loss_scale=1, train_wall=102, gb_free=12.1, wall=4309
2023-08-30 00:51:33 | INFO | train_inner | epoch 005:    144 / 1191 loss=2.877, trans_loss=3.829, nll_loss=2.063, w2v_ctc_loss=1.345, task_loss=2.183, contrastive_loss=1.006, total=6720.77, n_correct=3077.32, ppl=4.18, accuracy=45.788, wps=18626, ups=0.96, wpb=19470.6, bsz=679.4, num_updates=4900, lr=0.000196002, gnorm=0.963, clip=0, loss_scale=1, train_wall=104, gb_free=12.1, wall=4413
2023-08-30 00:53:18 | INFO | train_inner | epoch 005:    244 / 1191 loss=2.817, trans_loss=3.791, nll_loss=2.013, w2v_ctc_loss=1.329, task_loss=1.989, contrastive_loss=0.948, total=6862.7, n_correct=3270.54, ppl=4.04, accuracy=47.657, wps=19072.4, ups=0.96, wpb=19879, bsz=728.1, num_updates=5000, lr=0.0002, gnorm=0.923, clip=0, loss_scale=1, train_wall=104, gb_free=12.4, wall=4517
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:0')
2023-08-30 00:55:02 | INFO | train_inner | epoch 005:    344 / 1191 loss=2.762, trans_loss=3.76, nll_loss=1.974, w2v_ctc_loss=1.327, task_loss=2.256, contrastive_loss=0.884, total=6623.63, n_correct=3243.99, ppl=3.93, accuracy=48.976, wps=18437.5, ups=0.96, wpb=19190.6, bsz=663.6, num_updates=5100, lr=0.00019803, gnorm=0.671, clip=0, loss_scale=2, train_wall=103, gb_free=13.7, wall=4622
2023-08-30 00:56:47 | INFO | train_inner | epoch 005:    444 / 1191 loss=2.736, trans_loss=3.728, nll_loss=1.933, w2v_ctc_loss=1.331, task_loss=2.193, contrastive_loss=0.899, total=6678.98, n_correct=3362.45, ppl=3.82, accuracy=50.344, wps=18438.1, ups=0.95, wpb=19364, bsz=677.9, num_updates=5200, lr=0.000196116, gnorm=0.653, clip=0, loss_scale=2, train_wall=104, gb_free=14.2, wall=4727
2023-08-30 00:58:31 | INFO | train_inner | epoch 005:    544 / 1191 loss=2.694, trans_loss=3.702, nll_loss=1.897, w2v_ctc_loss=1.312, task_loss=2.204, contrastive_loss=0.904, total=6674.44, n_correct=3447.92, ppl=3.72, accuracy=51.659, wps=18473.4, ups=0.96, wpb=19332, bsz=676.1, num_updates=5300, lr=0.000194257, gnorm=0.655, clip=0, loss_scale=2, train_wall=104, gb_free=12.6, wall=4831
2023-08-30 01:00:15 | INFO | train_inner | epoch 005:    644 / 1191 loss=2.637, trans_loss=3.678, nll_loss=1.865, w2v_ctc_loss=1.305, task_loss=2.211, contrastive_loss=0.733, total=6701.47, n_correct=3545.74, ppl=3.64, accuracy=52.91, wps=18786, ups=0.97, wpb=19404.6, bsz=666.6, num_updates=5400, lr=0.00019245, gnorm=0.613, clip=0, loss_scale=2, train_wall=103, gb_free=13.5, wall=4935
2023-08-30 01:02:00 | INFO | train_inner | epoch 005:    744 / 1191 loss=2.622, trans_loss=3.648, nll_loss=1.83, w2v_ctc_loss=1.298, task_loss=2.173, contrastive_loss=0.826, total=6726.46, n_correct=3636.36, ppl=3.56, accuracy=54.061, wps=18448, ups=0.95, wpb=19494.9, bsz=687.1, num_updates=5500, lr=0.000190693, gnorm=0.61, clip=0, loss_scale=2, train_wall=105, gb_free=14.8, wall=5040
2023-08-30 01:03:45 | INFO | train_inner | epoch 005:    844 / 1191 loss=2.586, trans_loss=3.632, nll_loss=1.807, w2v_ctc_loss=1.288, task_loss=2.136, contrastive_loss=0.772, total=6755.92, n_correct=3702.91, ppl=3.5, accuracy=54.81, wps=18778.1, ups=0.96, wpb=19568, bsz=685.5, num_updates=5600, lr=0.000188982, gnorm=0.685, clip=0, loss_scale=2, train_wall=104, gb_free=14.2, wall=5144
2023-08-30 01:05:30 | INFO | train_inner | epoch 005:    944 / 1191 loss=2.56, trans_loss=3.623, nll_loss=1.798, w2v_ctc_loss=1.286, task_loss=2.274, contrastive_loss=0.733, total=6609, n_correct=3654.85, ppl=3.48, accuracy=55.301, wps=18189.9, ups=0.95, wpb=19153.5, bsz=658.3, num_updates=5700, lr=0.000187317, gnorm=0.586, clip=0, loss_scale=2, train_wall=105, gb_free=12.4, wall=5250
2023-08-30 01:07:15 | INFO | train_inner | epoch 005:   1044 / 1191 loss=2.529, trans_loss=3.606, nll_loss=1.775, w2v_ctc_loss=1.274, task_loss=2.328, contrastive_loss=0.681, total=6638.38, n_correct=3717.45, ppl=3.42, accuracy=55.999, wps=18322.9, ups=0.95, wpb=19232.6, bsz=646.6, num_updates=5800, lr=0.000185695, gnorm=0.583, clip=0, loss_scale=2, train_wall=104, gb_free=12.1, wall=5355
2023-08-30 01:08:59 | INFO | train_inner | epoch 005:   1144 / 1191 loss=2.52, trans_loss=3.593, nll_loss=1.76, w2v_ctc_loss=1.27, task_loss=2.21, contrastive_loss=0.708, total=6707.27, n_correct=3794.05, ppl=3.39, accuracy=56.566, wps=18659.7, ups=0.96, wpb=19433.4, bsz=672.3, num_updates=5900, lr=0.000184115, gnorm=0.582, clip=0, loss_scale=2, train_wall=104, gb_free=14, wall=5459
2023-08-30 01:09:48 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.5099, device='cuda:1')
2023-08-30 01:10:22 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.322 | trans_loss 5.479 | nll_loss 2.844 | w2v_ctc_loss 1.442 | task_loss 11.464 | contrastive_loss 0.87 | total 6138.43 | n_correct 3796 | ppl 7.18 | accuracy 61.84 | uer 23.657 | wer 24.76 | raw_wer 24.76 | bleu 19.51 | wps 1587.3 | wpb 6138.4 | bsz 201.1 | num_updates 5947 | best_bleu 19.51
2023-08-30 01:10:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 5947 updates
2023-08-30 01:10:22 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 01:10:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 01:10:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 5 @ 5947 updates, score 19.51) (writing took 11.916916576010408 seconds)
2023-08-30 01:10:35 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-08-30 01:10:35 | INFO | train | epoch 005 | loss 2.671 | trans_loss 3.691 | nll_loss 1.885 | w2v_ctc_loss 1.306 | task_loss 2.183 | contrastive_loss 0.835 | total 6703.69 | n_correct 3492.88 | ppl 3.69 | accuracy 52.104 | wps 17812 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 5947 | lr 0.000183386 | gnorm 0.69 | clip 0 | loss_scale 2 | train_wall 1237 | gb_free 11.1 | wall 5555
2023-08-30 01:10:35 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 01:10:35 | INFO | fairseq.trainer | begin training epoch 6
2023-08-30 01:10:35 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 01:11:36 | INFO | train_inner | epoch 006:     53 / 1191 loss=2.465, trans_loss=3.564, nll_loss=1.722, w2v_ctc_loss=1.224, task_loss=2.218, contrastive_loss=0.716, total=6661.78, n_correct=3838.44, ppl=3.3, accuracy=57.619, wps=12266.6, ups=0.64, wpb=19302.8, bsz=664.4, num_updates=6000, lr=0.000182574, gnorm=0.584, clip=0, loss_scale=2, train_wall=103, gb_free=12.2, wall=5616
2023-08-30 01:11:36 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 01:12:12 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.324 | trans_loss 5.474 | nll_loss 2.84 | w2v_ctc_loss 1.468 | task_loss 11.527 | contrastive_loss 0.856 | total 6138.43 | n_correct 3793.29 | ppl 7.16 | accuracy 61.796 | uer 23.221 | wer 24.34 | raw_wer 24.34 | bleu 19.83 | wps 1474.8 | wpb 6138.4 | bsz 201.1 | num_updates 6000 | best_bleu 19.83
2023-08-30 01:12:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 6000 updates
2023-08-30 01:12:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-30 01:12:14 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-30 01:12:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_6_6000.pt (epoch 6 @ 6000 updates, score 19.83) (writing took 14.115738316002535 seconds)
2023-08-30 01:14:11 | INFO | train_inner | epoch 006:    153 / 1191 loss=2.429, trans_loss=3.556, nll_loss=1.709, w2v_ctc_loss=1.209, task_loss=2.223, contrastive_loss=0.643, total=6706.17, n_correct=3898.69, ppl=3.27, accuracy=58.136, wps=12561.1, ups=0.65, wpb=19417, bsz=672.3, num_updates=6100, lr=0.000181071, gnorm=0.556, clip=0, loss_scale=2, train_wall=104, gb_free=11.5, wall=5771
2023-08-30 01:15:55 | INFO | train_inner | epoch 006:    253 / 1191 loss=2.423, trans_loss=3.538, nll_loss=1.689, w2v_ctc_loss=1.197, task_loss=2.01, contrastive_loss=0.707, total=6846.28, n_correct=4022.39, ppl=3.22, accuracy=58.753, wps=18974.7, ups=0.96, wpb=19836, bsz=721.4, num_updates=6200, lr=0.000179605, gnorm=0.554, clip=0, loss_scale=2, train_wall=104, gb_free=13.6, wall=5875
2023-08-30 01:17:41 | INFO | train_inner | epoch 006:    353 / 1191 loss=2.41, trans_loss=3.54, nll_loss=1.69, w2v_ctc_loss=1.211, task_loss=2.21, contrastive_loss=0.597, total=6725.76, n_correct=3951.27, ppl=3.23, accuracy=58.748, wps=18387.6, ups=0.94, wpb=19477.6, bsz=674.9, num_updates=6300, lr=0.000178174, gnorm=0.578, clip=0, loss_scale=2, train_wall=105, gb_free=12.5, wall=5981
2023-08-30 01:19:25 | INFO | train_inner | epoch 006:    453 / 1191 loss=2.4, trans_loss=3.531, nll_loss=1.681, w2v_ctc_loss=1.212, task_loss=2.271, contrastive_loss=0.634, total=6576.12, n_correct=3885.08, ppl=3.21, accuracy=59.079, wps=18439.3, ups=0.97, wpb=19058.3, bsz=652.6, num_updates=6400, lr=0.000176777, gnorm=0.562, clip=0, loss_scale=2, train_wall=103, gb_free=13, wall=6085
2023-08-30 01:21:10 | INFO | train_inner | epoch 006:    553 / 1191 loss=2.372, trans_loss=3.518, nll_loss=1.665, w2v_ctc_loss=1.195, task_loss=2.257, contrastive_loss=0.562, total=6685.87, n_correct=3979.43, ppl=3.17, accuracy=59.52, wps=18441.6, ups=0.95, wpb=19382.5, bsz=660.9, num_updates=6500, lr=0.000175412, gnorm=0.572, clip=0, loss_scale=2, train_wall=104, gb_free=14.2, wall=6190
2023-08-30 01:22:55 | INFO | train_inner | epoch 006:    653 / 1191 loss=2.359, trans_loss=3.516, nll_loss=1.66, w2v_ctc_loss=1.182, task_loss=2.305, contrastive_loss=0.602, total=6675.16, n_correct=3992.08, ppl=3.16, accuracy=59.805, wps=18435, ups=0.95, wpb=19332.7, bsz=654.5, num_updates=6600, lr=0.000174078, gnorm=0.567, clip=0, loss_scale=2, train_wall=104, gb_free=14.4, wall=6295
2023-08-30 01:24:40 | INFO | train_inner | epoch 006:    753 / 1191 loss=2.369, trans_loss=3.503, nll_loss=1.645, w2v_ctc_loss=1.185, task_loss=2.043, contrastive_loss=0.69, total=6843.27, n_correct=4124.96, ppl=3.13, accuracy=60.278, wps=18918.2, ups=0.95, wpb=19825.5, bsz=722.5, num_updates=6700, lr=0.000172774, gnorm=0.536, clip=0, loss_scale=2, train_wall=104, gb_free=13.8, wall=6399
2023-08-30 01:26:24 | INFO | train_inner | epoch 006:    853 / 1191 loss=2.347, trans_loss=3.492, nll_loss=1.635, w2v_ctc_loss=1.183, task_loss=2.217, contrastive_loss=0.642, total=6628.09, n_correct=4015.91, ppl=3.1, accuracy=60.589, wps=18312.5, ups=0.95, wpb=19221.2, bsz=682.5, num_updates=6800, lr=0.000171499, gnorm=0.523, clip=0, loss_scale=2, train_wall=104, gb_free=14.4, wall=6504
2023-08-30 01:28:10 | INFO | train_inner | epoch 006:    953 / 1191 loss=2.338, trans_loss=3.499, nll_loss=1.639, w2v_ctc_loss=1.187, task_loss=2.431, contrastive_loss=0.563, total=6623.09, n_correct=4002.97, ppl=3.12, accuracy=60.44, wps=18256.5, ups=0.95, wpb=19184.2, bsz=632.5, num_updates=6900, lr=0.000170251, gnorm=0.534, clip=0, loss_scale=2, train_wall=105, gb_free=15.1, wall=6609
2023-08-30 01:29:53 | INFO | train_inner | epoch 006:   1053 / 1191 loss=2.308, trans_loss=3.48, nll_loss=1.618, w2v_ctc_loss=1.153, task_loss=2.191, contrastive_loss=0.617, total=6685.49, n_correct=4091.56, ppl=3.07, accuracy=61.201, wps=18658.9, ups=0.96, wpb=19375.2, bsz=672.3, num_updates=7000, lr=0.000169031, gnorm=0.511, clip=0, loss_scale=2, train_wall=103, gb_free=14, wall=6713
2023-08-30 01:31:37 | INFO | train_inner | epoch 006:   1153 / 1191 loss=2.279, trans_loss=3.471, nll_loss=1.606, w2v_ctc_loss=1.145, task_loss=2.016, contrastive_loss=0.497, total=6756.56, n_correct=4160, ppl=3.04, accuracy=61.57, wps=18988.1, ups=0.97, wpb=19583.8, bsz=710.5, num_updates=7100, lr=0.000167836, gnorm=0.52, clip=0, loss_scale=4, train_wall=102, gb_free=13.8, wall=6816
2023-08-30 01:32:16 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 01:32:52 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.097 | trans_loss 5.25 | nll_loss 2.558 | w2v_ctc_loss 1.345 | task_loss 11.686 | contrastive_loss 0.681 | total 6138.43 | n_correct 4001.71 | ppl 5.89 | accuracy 65.191 | uer 22.309 | wer 23.838 | raw_wer 23.838 | bleu 23.13 | wps 1489 | wpb 6138.4 | bsz 201.1 | num_updates 7138 | best_bleu 23.13
2023-08-30 01:32:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 7138 updates
2023-08-30 01:32:52 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 01:32:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 01:33:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 6 @ 7138 updates, score 23.13) (writing took 13.229365449005854 seconds)
2023-08-30 01:33:06 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-08-30 01:33:06 | INFO | train | epoch 006 | loss 2.367 | trans_loss 3.514 | nll_loss 1.659 | w2v_ctc_loss 1.186 | task_loss 2.187 | contrastive_loss 0.617 | total 6703.69 | n_correct 4009.18 | ppl 3.16 | accuracy 59.806 | wps 17125.2 | ups 0.88 | wpb 19422.7 | bsz 678.2 | num_updates 7138 | lr 0.000167389 | gnorm 0.547 | clip 0 | loss_scale 4 | train_wall 1237 | gb_free 13.6 | wall 6905
2023-08-30 01:33:06 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 01:33:06 | INFO | fairseq.trainer | begin training epoch 7
2023-08-30 01:33:06 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 01:34:18 | INFO | train_inner | epoch 007:     62 / 1191 loss=2.272, trans_loss=3.466, nll_loss=1.597, w2v_ctc_loss=1.129, task_loss=2.122, contrastive_loss=0.595, total=6721.95, n_correct=4150.95, ppl=3.02, accuracy=61.752, wps=12079, ups=0.62, wpb=19460.2, bsz=692.1, num_updates=7200, lr=0.000166667, gnorm=0.492, clip=0, loss_scale=4, train_wall=104, gb_free=15, wall=6978
2023-08-30 01:36:03 | INFO | train_inner | epoch 007:    162 / 1191 loss=2.245, trans_loss=3.448, nll_loss=1.578, w2v_ctc_loss=1.114, task_loss=2.239, contrastive_loss=0.568, total=6672.19, n_correct=4151.21, ppl=2.99, accuracy=62.217, wps=18336.5, ups=0.95, wpb=19352.6, bsz=674.7, num_updates=7300, lr=0.000165521, gnorm=0.507, clip=0, loss_scale=4, train_wall=105, gb_free=6.3, wall=7083
2023-08-30 01:37:47 | INFO | train_inner | epoch 007:    262 / 1191 loss=2.228, trans_loss=3.445, nll_loss=1.572, w2v_ctc_loss=1.114, task_loss=2.189, contrastive_loss=0.473, total=6687.13, n_correct=4178.4, ppl=2.97, accuracy=62.484, wps=18623.9, ups=0.96, wpb=19375.7, bsz=672.9, num_updates=7400, lr=0.000164399, gnorm=0.486, clip=0, loss_scale=4, train_wall=103, gb_free=10.8, wall=7187
2023-08-30 01:39:29 | INFO | train_inner | epoch 007:    362 / 1191 loss=2.199, trans_loss=3.431, nll_loss=1.555, w2v_ctc_loss=1.092, task_loss=2.108, contrastive_loss=0.446, total=6732.56, n_correct=4243.86, ppl=2.94, accuracy=63.035, wps=19123.8, ups=0.98, wpb=19514, bsz=689.7, num_updates=7500, lr=0.000163299, gnorm=0.485, clip=0, loss_scale=4, train_wall=101, gb_free=13.6, wall=7289
2023-08-30 01:41:13 | INFO | train_inner | epoch 007:    462 / 1191 loss=2.216, trans_loss=3.438, nll_loss=1.564, w2v_ctc_loss=1.098, task_loss=2.059, contrastive_loss=0.537, total=6781.49, n_correct=4260.43, ppl=2.96, accuracy=62.824, wps=19011.4, ups=0.97, wpb=19649.3, bsz=708.3, num_updates=7600, lr=0.000162221, gnorm=0.485, clip=0, loss_scale=4, train_wall=103, gb_free=12, wall=7393
2023-08-30 01:42:58 | INFO | train_inner | epoch 007:    562 / 1191 loss=2.204, trans_loss=3.434, nll_loss=1.557, w2v_ctc_loss=1.103, task_loss=2.234, contrastive_loss=0.46, total=6712.62, n_correct=4234.72, ppl=2.94, accuracy=63.086, wps=18548.8, ups=0.95, wpb=19444.9, bsz=672.4, num_updates=7700, lr=0.000161165, gnorm=0.484, clip=0, loss_scale=4, train_wall=104, gb_free=14.1, wall=7497
2023-08-30 01:44:43 | INFO | train_inner | epoch 007:    662 / 1191 loss=2.206, trans_loss=3.434, nll_loss=1.559, w2v_ctc_loss=1.091, task_loss=2.134, contrastive_loss=0.541, total=6755.47, n_correct=4255.64, ppl=2.95, accuracy=62.995, wps=18535.1, ups=0.95, wpb=19573.5, bsz=694.3, num_updates=7800, lr=0.000160128, gnorm=0.492, clip=0, loss_scale=4, train_wall=105, gb_free=13.5, wall=7603
2023-08-30 01:46:27 | INFO | train_inner | epoch 007:    762 / 1191 loss=2.182, trans_loss=3.426, nll_loss=1.547, w2v_ctc_loss=1.091, task_loss=2.239, contrastive_loss=0.437, total=6675.9, n_correct=4230.69, ppl=2.92, accuracy=63.373, wps=18610.1, ups=0.96, wpb=19333.2, bsz=669.4, num_updates=7900, lr=0.000159111, gnorm=0.478, clip=0, loss_scale=4, train_wall=103, gb_free=14.3, wall=7707
2023-08-30 01:48:11 | INFO | train_inner | epoch 007:    862 / 1191 loss=2.187, trans_loss=3.427, nll_loss=1.548, w2v_ctc_loss=1.083, task_loss=2.272, contrastive_loss=0.539, total=6653.07, n_correct=4214.44, ppl=2.92, accuracy=63.346, wps=18468.6, ups=0.96, wpb=19269.9, bsz=656.8, num_updates=8000, lr=0.000158114, gnorm=0.478, clip=0, loss_scale=4, train_wall=104, gb_free=14.6, wall=7811
2023-08-30 01:48:11 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 01:48:46 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.003 | trans_loss 5.152 | nll_loss 2.437 | w2v_ctc_loss 1.314 | task_loss 11.76 | contrastive_loss 0.601 | total 6138.43 | n_correct 4095 | ppl 5.42 | accuracy 66.711 | uer 20.742 | wer 22.164 | raw_wer 22.164 | bleu 24.83 | wps 1588.1 | wpb 6138.4 | bsz 201.1 | num_updates 8000 | best_bleu 24.83
2023-08-30 01:48:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8000 updates
2023-08-30 01:48:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-30 01:48:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-30 01:48:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_7_8000.pt (epoch 7 @ 8000 updates, score 24.83) (writing took 13.08545124498778 seconds)
2023-08-30 01:50:44 | INFO | train_inner | epoch 007:    962 / 1191 loss=2.163, trans_loss=3.415, nll_loss=1.534, w2v_ctc_loss=1.083, task_loss=2.31, contrastive_loss=0.429, total=6647.82, n_correct=4237.97, ppl=2.9, accuracy=63.75, wps=12576.4, ups=0.65, wpb=19259.8, bsz=648.5, num_updates=8100, lr=0.000157135, gnorm=0.472, clip=0, loss_scale=4, train_wall=105, gb_free=13.8, wall=7964
2023-08-30 01:52:29 | INFO | train_inner | epoch 007:   1062 / 1191 loss=2.177, trans_loss=3.414, nll_loss=1.531, w2v_ctc_loss=1.082, task_loss=2.157, contrastive_loss=0.539, total=6668.15, n_correct=4258.71, ppl=2.89, accuracy=63.866, wps=18497.7, ups=0.96, wpb=19305.1, bsz=687.9, num_updates=8200, lr=0.000156174, gnorm=0.471, clip=0, loss_scale=4, train_wall=104, gb_free=6.6, wall=8069
2023-08-30 01:54:14 | INFO | train_inner | epoch 007:   1162 / 1191 loss=2.167, trans_loss=3.414, nll_loss=1.535, w2v_ctc_loss=1.077, task_loss=2.215, contrastive_loss=0.511, total=6725.89, n_correct=4291.81, ppl=2.9, accuracy=63.81, wps=18608.1, ups=0.95, wpb=19497.5, bsz=681, num_updates=8300, lr=0.00015523, gnorm=0.469, clip=0, loss_scale=4, train_wall=104, gb_free=11.7, wall=8173
2023-08-30 01:54:44 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 01:55:17 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 3.957 | trans_loss 5.115 | nll_loss 2.393 | w2v_ctc_loss 1.255 | task_loss 11.775 | contrastive_loss 0.59 | total 6138.43 | n_correct 4126.71 | ppl 5.25 | accuracy 67.228 | uer 20.579 | wer 22.019 | raw_wer 22.019 | bleu 24.78 | wps 1690.5 | wpb 6138.4 | bsz 201.1 | num_updates 8329 | best_bleu 24.83
2023-08-30 01:55:17 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8329 updates
2023-08-30 01:55:17 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_24.7803.pt
2023-08-30 01:55:20 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_24.7803.pt
2023-08-30 01:55:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_24.7803.pt (epoch 7 @ 8329 updates, score 24.78) (writing took 7.316290286005824 seconds)
2023-08-30 01:55:25 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-08-30 01:55:25 | INFO | train | epoch 007 | loss 2.2 | trans_loss 3.43 | nll_loss 1.554 | w2v_ctc_loss 1.094 | task_loss 2.192 | contrastive_loss 0.504 | total 6703.69 | n_correct 4231.37 | ppl 2.94 | accuracy 63.12 | wps 17275.2 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 8329 | lr 0.00015496 | gnorm 0.482 | clip 0 | loss_scale 4 | train_wall 1235 | gb_free 12.7 | wall 8244
2023-08-30 01:55:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 01:55:25 | INFO | fairseq.trainer | begin training epoch 8
2023-08-30 01:55:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 01:56:46 | INFO | train_inner | epoch 008:     71 / 1191 loss=2.116, trans_loss=3.393, nll_loss=1.505, w2v_ctc_loss=1.044, task_loss=2.194, contrastive_loss=0.387, total=6731.47, n_correct=4345.5, ppl=2.84, accuracy=64.555, wps=12762.6, ups=0.65, wpb=19491.5, bsz=668.5, num_updates=8400, lr=0.000154303, gnorm=0.465, clip=0, loss_scale=4, train_wall=104, gb_free=12.8, wall=8326
2023-08-30 01:58:31 | INFO | train_inner | epoch 008:    171 / 1191 loss=2.124, trans_loss=3.383, nll_loss=1.497, w2v_ctc_loss=1.034, task_loss=2.099, contrastive_loss=0.535, total=6745.22, n_correct=4362.51, ppl=2.82, accuracy=64.676, wps=18744.3, ups=0.96, wpb=19562.8, bsz=714.9, num_updates=8500, lr=0.000153393, gnorm=0.464, clip=0, loss_scale=4, train_wall=104, gb_free=13.5, wall=8431
2023-08-30 02:00:17 | INFO | train_inner | epoch 008:    271 / 1191 loss=2.111, trans_loss=3.388, nll_loss=1.5, w2v_ctc_loss=1.035, task_loss=2.173, contrastive_loss=0.455, total=6743.26, n_correct=4362.88, ppl=2.83, accuracy=64.7, wps=18408.6, ups=0.94, wpb=19534.2, bsz=692.4, num_updates=8600, lr=0.000152499, gnorm=0.471, clip=0, loss_scale=4, train_wall=106, gb_free=13.2, wall=8537
2023-08-30 02:02:02 | INFO | train_inner | epoch 008:    371 / 1191 loss=2.102, trans_loss=3.391, nll_loss=1.506, w2v_ctc_loss=1.048, task_loss=2.39, contrastive_loss=0.365, total=6640.26, n_correct=4287.47, ppl=2.84, accuracy=64.568, wps=18234.7, ups=0.95, wpb=19250.5, bsz=638.1, num_updates=8700, lr=0.00015162, gnorm=0.47, clip=0, loss_scale=4, train_wall=105, gb_free=14, wall=8642
2023-08-30 02:03:48 | INFO | train_inner | epoch 008:    471 / 1191 loss=2.108, trans_loss=3.383, nll_loss=1.495, w2v_ctc_loss=1.04, task_loss=2.238, contrastive_loss=0.441, total=6667.27, n_correct=4319.85, ppl=2.82, accuracy=64.792, wps=18357.8, ups=0.95, wpb=19324, bsz=666.9, num_updates=8800, lr=0.000150756, gnorm=0.46, clip=0, loss_scale=4, train_wall=105, gb_free=13.6, wall=8748
2023-08-30 02:05:32 | INFO | train_inner | epoch 008:    571 / 1191 loss=2.089, trans_loss=3.382, nll_loss=1.494, w2v_ctc_loss=1.025, task_loss=2.271, contrastive_loss=0.435, total=6679.79, n_correct=4335.73, ppl=2.82, accuracy=64.908, wps=18586.9, ups=0.96, wpb=19355.8, bsz=670.5, num_updates=8900, lr=0.000149906, gnorm=0.457, clip=0, loss_scale=4, train_wall=104, gb_free=5.9, wall=8852
2023-08-30 02:07:15 | INFO | train_inner | epoch 008:    671 / 1191 loss=2.078, trans_loss=3.381, nll_loss=1.491, w2v_ctc_loss=1.025, task_loss=2.141, contrastive_loss=0.363, total=6737.47, n_correct=4387.98, ppl=2.81, accuracy=65.128, wps=18992.3, ups=0.97, wpb=19517.5, bsz=681, num_updates=9000, lr=0.000149071, gnorm=0.452, clip=0, loss_scale=4, train_wall=102, gb_free=13.2, wall=8954
2023-08-30 02:08:59 | INFO | train_inner | epoch 008:    771 / 1191 loss=2.089, trans_loss=3.38, nll_loss=1.491, w2v_ctc_loss=1.031, task_loss=2.251, contrastive_loss=0.44, total=6673.31, n_correct=4342.78, ppl=2.81, accuracy=65.077, wps=18576.2, ups=0.96, wpb=19339.7, bsz=668.2, num_updates=9100, lr=0.00014825, gnorm=0.458, clip=0, loss_scale=4, train_wall=104, gb_free=14.4, wall=9059
2023-08-30 02:10:42 | INFO | train_inner | epoch 008:    871 / 1191 loss=2.082, trans_loss=3.37, nll_loss=1.479, w2v_ctc_loss=1.031, task_loss=2.06, contrastive_loss=0.39, total=6790.6, n_correct=4444.82, ppl=2.79, accuracy=65.455, wps=18971.3, ups=0.96, wpb=19678.3, bsz=702.2, num_updates=9200, lr=0.000147442, gnorm=0.45, clip=0, loss_scale=8, train_wall=103, gb_free=12.2, wall=9162
2023-08-30 02:12:27 | INFO | train_inner | epoch 008:    971 / 1191 loss=2.091, trans_loss=3.381, nll_loss=1.491, w2v_ctc_loss=1.027, task_loss=2.263, contrastive_loss=0.476, total=6661.79, n_correct=4333.72, ppl=2.81, accuracy=65.053, wps=18428.2, ups=0.96, wpb=19289.7, bsz=661.6, num_updates=9300, lr=0.000146647, gnorm=0.454, clip=0, loss_scale=8, train_wall=104, gb_free=13, wall=9267
2023-08-30 02:14:11 | INFO | train_inner | epoch 008:   1071 / 1191 loss=2.062, trans_loss=3.372, nll_loss=1.477, w2v_ctc_loss=1.021, task_loss=2.236, contrastive_loss=0.337, total=6694.64, n_correct=4380.17, ppl=2.78, accuracy=65.428, wps=18603.3, ups=0.96, wpb=19369.6, bsz=664.5, num_updates=9400, lr=0.000145865, gnorm=0.45, clip=0, loss_scale=8, train_wall=103, gb_free=13.5, wall=9371
2023-08-30 02:15:55 | INFO | train_inner | epoch 008:   1171 / 1191 loss=2.077, trans_loss=3.362, nll_loss=1.47, w2v_ctc_loss=1.005, task_loss=2.009, contrastive_loss=0.531, total=6735.36, n_correct=4422.73, ppl=2.77, accuracy=65.664, wps=18841.5, ups=0.97, wpb=19521, bsz=722.2, num_updates=9500, lr=0.000145095, gnorm=0.451, clip=0, loss_scale=8, train_wall=103, gb_free=14.1, wall=9475
2023-08-30 02:16:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 02:16:49 | INFO | dev_st | epoch 008 | valid on 'dev_st' subset | loss 3.894 | trans_loss 5.051 | nll_loss 2.314 | w2v_ctc_loss 1.243 | task_loss 11.837 | contrastive_loss 0.519 | total 6138.43 | n_correct 4187.57 | ppl 4.97 | accuracy 68.219 | uer 19.469 | wer 20.889 | raw_wer 20.889 | bleu 26.33 | wps 1676.2 | wpb 6138.4 | bsz 201.1 | num_updates 9520 | best_bleu 26.33
2023-08-30 02:16:49 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 9520 updates
2023-08-30 02:16:49 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 02:16:55 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 02:17:02 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 8 @ 9520 updates, score 26.33) (writing took 12.988734123995528 seconds)
2023-08-30 02:17:02 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-08-30 02:17:02 | INFO | train | epoch 008 | loss 2.093 | trans_loss 3.38 | nll_loss 1.49 | w2v_ctc_loss 1.029 | task_loss 2.195 | contrastive_loss 0.434 | total 6703.69 | n_correct 4359.31 | ppl 2.81 | accuracy 65.029 | wps 17832.7 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 9520 | lr 0.000144943 | gnorm 0.458 | clip 0 | loss_scale 8 | train_wall 1236 | gb_free 14 | wall 9542
2023-08-30 02:17:02 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 02:17:02 | INFO | fairseq.trainer | begin training epoch 9
2023-08-30 02:17:02 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 02:18:32 | INFO | train_inner | epoch 009:     80 / 1191 loss=2.037, trans_loss=3.349, nll_loss=1.452, w2v_ctc_loss=0.984, task_loss=2.216, contrastive_loss=0.431, total=6668.28, n_correct=4404.49, ppl=2.74, accuracy=66.051, wps=12271.3, ups=0.64, wpb=19318.2, bsz=673.6, num_updates=9600, lr=0.000144338, gnorm=0.443, clip=0, loss_scale=8, train_wall=103, gb_free=12.8, wall=9632
2023-08-30 02:20:17 | INFO | train_inner | epoch 009:    180 / 1191 loss=2.021, trans_loss=3.341, nll_loss=1.442, w2v_ctc_loss=0.977, task_loss=2.149, contrastive_loss=0.402, total=6753.46, n_correct=4476.65, ppl=2.72, accuracy=66.287, wps=18757.9, ups=0.96, wpb=19576.2, bsz=689.9, num_updates=9700, lr=0.000143592, gnorm=0.448, clip=0, loss_scale=8, train_wall=104, gb_free=13.5, wall=9736
2023-08-30 02:22:00 | INFO | train_inner | epoch 009:    280 / 1191 loss=2.033, trans_loss=3.353, nll_loss=1.454, w2v_ctc_loss=0.997, task_loss=2.083, contrastive_loss=0.353, total=6804.86, n_correct=4499.93, ppl=2.74, accuracy=66.128, wps=18998.9, ups=0.96, wpb=19697, bsz=703.1, num_updates=9800, lr=0.000142857, gnorm=0.446, clip=0, loss_scale=8, train_wall=103, gb_free=13.2, wall=9840
2023-08-30 02:23:47 | INFO | train_inner | epoch 009:    380 / 1191 loss=2.023, trans_loss=3.346, nll_loss=1.449, w2v_ctc_loss=0.98, task_loss=2.159, contrastive_loss=0.405, total=6768.72, n_correct=4481.03, ppl=2.73, accuracy=66.202, wps=18460, ups=0.94, wpb=19612.6, bsz=695, num_updates=9900, lr=0.000142134, gnorm=0.439, clip=0, loss_scale=8, train_wall=106, gb_free=13.1, wall=9946
2023-08-30 02:25:32 | INFO | train_inner | epoch 009:    480 / 1191 loss=2.038, trans_loss=3.347, nll_loss=1.451, w2v_ctc_loss=0.991, task_loss=2.167, contrastive_loss=0.426, total=6709.01, n_correct=4445.69, ppl=2.73, accuracy=66.264, wps=18452.1, ups=0.95, wpb=19445.3, bsz=689.9, num_updates=10000, lr=0.000141421, gnorm=0.441, clip=0, loss_scale=8, train_wall=105, gb_free=13.8, wall=10052
2023-08-30 02:25:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 02:26:04 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.874 | trans_loss 5.031 | nll_loss 2.29 | w2v_ctc_loss 1.231 | task_loss 11.887 | contrastive_loss 0.51 | total 6138.43 | n_correct 4211.43 | ppl 4.89 | accuracy 68.608 | uer 18.843 | wer 20.022 | raw_wer 20.022 | bleu 26.91 | wps 1776.2 | wpb 6138.4 | bsz 201.1 | num_updates 10000 | best_bleu 26.91
2023-08-30 02:26:04 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10000 updates
2023-08-30 02:26:04 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-30 02:26:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-30 02:26:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_9_10000.pt (epoch 9 @ 10000 updates, score 26.91) (writing took 13.56676858800347 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 02:28:01 | INFO | train_inner | epoch 009:    580 / 1191 loss=2.007, trans_loss=3.341, nll_loss=1.442, w2v_ctc_loss=0.978, task_loss=2.247, contrastive_loss=0.337, total=6631.73, n_correct=4403.04, ppl=2.72, accuracy=66.394, wps=12849.8, ups=0.67, wpb=19212.5, bsz=663.9, num_updates=10100, lr=0.00014072, gnorm=0.365, clip=0, loss_scale=8, train_wall=103, gb_free=14.1, wall=10201
2023-08-30 02:29:45 | INFO | train_inner | epoch 009:    680 / 1191 loss=2.027, trans_loss=3.351, nll_loss=1.454, w2v_ctc_loss=0.988, task_loss=2.44, contrastive_loss=0.412, total=6557.22, n_correct=4336.02, ppl=2.74, accuracy=66.126, wps=18280.2, ups=0.96, wpb=18991.2, bsz=622.7, num_updates=10200, lr=0.000140028, gnorm=0.364, clip=0, loss_scale=8, train_wall=103, gb_free=13.7, wall=10305
2023-08-30 02:31:30 | INFO | train_inner | epoch 009:    780 / 1191 loss=2.03, trans_loss=3.345, nll_loss=1.448, w2v_ctc_loss=0.982, task_loss=2.169, contrastive_loss=0.442, total=6702.82, n_correct=4443.24, ppl=2.73, accuracy=66.289, wps=18637.6, ups=0.96, wpb=19425.6, bsz=689.1, num_updates=10300, lr=0.000139347, gnorm=0.367, clip=0, loss_scale=8, train_wall=104, gb_free=9.9, wall=10409
2023-08-30 02:33:14 | INFO | train_inner | epoch 009:    880 / 1191 loss=2.01, trans_loss=3.344, nll_loss=1.447, w2v_ctc_loss=0.982, task_loss=2.222, contrastive_loss=0.334, total=6723.89, n_correct=4460.43, ppl=2.73, accuracy=66.337, wps=18669.1, ups=0.96, wpb=19484.9, bsz=665.3, num_updates=10400, lr=0.000138675, gnorm=0.358, clip=0, loss_scale=8, train_wall=104, gb_free=12.2, wall=10514
2023-08-30 02:34:59 | INFO | train_inner | epoch 009:    980 / 1191 loss=2.013, trans_loss=3.34, nll_loss=1.441, w2v_ctc_loss=0.978, task_loss=2.198, contrastive_loss=0.4, total=6707.63, n_correct=4460, ppl=2.71, accuracy=66.491, wps=18516.1, ups=0.95, wpb=19428.7, bsz=680.5, num_updates=10500, lr=0.000138013, gnorm=0.359, clip=0, loss_scale=8, train_wall=104, gb_free=10.1, wall=10619
2023-08-30 02:36:43 | INFO | train_inner | epoch 009:   1080 / 1191 loss=2.017, trans_loss=3.339, nll_loss=1.44, w2v_ctc_loss=0.974, task_loss=2.159, contrastive_loss=0.453, total=6672.16, n_correct=4441.26, ppl=2.71, accuracy=66.564, wps=18539.6, ups=0.96, wpb=19337.6, bsz=680, num_updates=10600, lr=0.000137361, gnorm=0.359, clip=0, loss_scale=8, train_wall=104, gb_free=13.4, wall=10723
2023-08-30 02:38:27 | INFO | train_inner | epoch 009:   1180 / 1191 loss=2.014, trans_loss=3.339, nll_loss=1.44, w2v_ctc_loss=0.993, task_loss=2.293, contrastive_loss=0.324, total=6677.77, n_correct=4443.21, ppl=2.71, accuracy=66.537, wps=18588.2, ups=0.96, wpb=19352.3, bsz=656.5, num_updates=10700, lr=0.000136717, gnorm=0.36, clip=0, loss_scale=8, train_wall=104, gb_free=13.3, wall=10827
2023-08-30 02:38:39 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
2023-08-30 02:39:13 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.858 | trans_loss 5.011 | nll_loss 2.259 | w2v_ctc_loss 1.238 | task_loss 11.832 | contrastive_loss 0.483 | total 6138.43 | n_correct 4229 | ppl 4.79 | accuracy 68.894 | uer 19.218 | wer 20.725 | raw_wer 20.725 | bleu 26.89 | wps 1646.1 | wpb 6138.4 | bsz 201.1 | num_updates 10711 | best_bleu 26.91
2023-08-30 02:39:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10711 updates
2023-08-30 02:39:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_26.8900.pt
2023-08-30 02:39:16 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_26.8900.pt
2023-08-30 02:39:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_26.8900.pt (epoch 9 @ 10711 updates, score 26.89) (writing took 7.725177697007894 seconds)
2023-08-30 02:39:21 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-08-30 02:39:21 | INFO | train | epoch 009 | loss 2.021 | trans_loss 3.344 | nll_loss 1.446 | w2v_ctc_loss 0.983 | task_loss 2.196 | contrastive_loss 0.391 | total 6703.69 | n_correct 4446.41 | ppl 2.72 | accuracy 66.328 | wps 17275.6 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 10711 | lr 0.000136647 | gnorm 0.394 | clip 0 | loss_scale 8 | train_wall 1236 | gb_free 14.3 | wall 10881
2023-08-30 02:39:21 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 02:39:21 | INFO | fairseq.trainer | begin training epoch 10
2023-08-30 02:39:21 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 02:41:00 | INFO | train_inner | epoch 010:     89 / 1191 loss=1.961, trans_loss=3.315, nll_loss=1.409, w2v_ctc_loss=0.94, task_loss=2.216, contrastive_loss=0.315, total=6648.32, n_correct=4472.6, ppl=2.66, accuracy=67.274, wps=12590.1, ups=0.65, wpb=19263.2, bsz=668.9, num_updates=10800, lr=0.000136083, gnorm=0.354, clip=0, loss_scale=8, train_wall=103, gb_free=12.7, wall=10980
2023-08-30 02:42:44 | INFO | train_inner | epoch 010:    189 / 1191 loss=1.983, trans_loss=3.327, nll_loss=1.424, w2v_ctc_loss=0.953, task_loss=2.2, contrastive_loss=0.372, total=6683.04, n_correct=4477.62, ppl=2.68, accuracy=67, wps=18659, ups=0.96, wpb=19363.3, bsz=683.1, num_updates=10900, lr=0.000135457, gnorm=0.359, clip=0, loss_scale=8, train_wall=103, gb_free=14.3, wall=11084
2023-08-30 02:44:29 | INFO | train_inner | epoch 010:    289 / 1191 loss=1.981, trans_loss=3.318, nll_loss=1.412, w2v_ctc_loss=0.947, task_loss=2.172, contrastive_loss=0.415, total=6751.8, n_correct=4535.04, ppl=2.66, accuracy=67.168, wps=18718.9, ups=0.96, wpb=19554.8, bsz=686.8, num_updates=11000, lr=0.00013484, gnorm=0.367, clip=0, loss_scale=8, train_wall=104, gb_free=13.6, wall=11188
2023-08-30 02:46:15 | INFO | train_inner | epoch 010:    389 / 1191 loss=1.996, trans_loss=3.32, nll_loss=1.417, w2v_ctc_loss=0.951, task_loss=2.022, contrastive_loss=0.489, total=6846.12, n_correct=4597.81, ppl=2.67, accuracy=67.159, wps=18677.9, ups=0.94, wpb=19837.5, bsz=736.1, num_updates=11100, lr=0.000134231, gnorm=0.349, clip=0, loss_scale=8, train_wall=106, gb_free=14, wall=11295
2023-08-30 02:47:59 | INFO | train_inner | epoch 010:    489 / 1191 loss=1.975, trans_loss=3.316, nll_loss=1.409, w2v_ctc_loss=0.965, task_loss=2.214, contrastive_loss=0.289, total=6735.23, n_correct=4530.76, ppl=2.66, accuracy=67.27, wps=18738.6, ups=0.96, wpb=19501.1, bsz=671.5, num_updates=11200, lr=0.000133631, gnorm=0.367, clip=0, loss_scale=16, train_wall=103, gb_free=13.7, wall=11399
2023-08-30 02:49:42 | INFO | train_inner | epoch 010:    589 / 1191 loss=1.975, trans_loss=3.323, nll_loss=1.419, w2v_ctc_loss=0.951, task_loss=2.244, contrastive_loss=0.368, total=6686.53, n_correct=4491.01, ppl=2.67, accuracy=67.165, wps=18696, ups=0.97, wpb=19368.1, bsz=662.3, num_updates=11300, lr=0.000133038, gnorm=0.353, clip=0, loss_scale=16, train_wall=103, gb_free=12.4, wall=11502
2023-08-30 02:51:28 | INFO | train_inner | epoch 010:    689 / 1191 loss=1.975, trans_loss=3.317, nll_loss=1.413, w2v_ctc_loss=0.951, task_loss=2.134, contrastive_loss=0.364, total=6772.06, n_correct=4556.66, ppl=2.66, accuracy=67.286, wps=18643.4, ups=0.95, wpb=19624.2, bsz=700.8, num_updates=11400, lr=0.000132453, gnorm=0.349, clip=0, loss_scale=16, train_wall=105, gb_free=12, wall=11608
2023-08-30 02:53:12 | INFO | train_inner | epoch 010:    789 / 1191 loss=1.956, trans_loss=3.316, nll_loss=1.411, w2v_ctc_loss=0.95, task_loss=2.325, contrastive_loss=0.276, total=6641.02, n_correct=4471.85, ppl=2.66, accuracy=67.337, wps=18498.6, ups=0.96, wpb=19245.2, bsz=652, num_updates=11500, lr=0.000131876, gnorm=0.36, clip=0, loss_scale=16, train_wall=103, gb_free=13, wall=11712
2023-08-30 02:54:57 | INFO | train_inner | epoch 010:    889 / 1191 loss=1.973, trans_loss=3.314, nll_loss=1.409, w2v_ctc_loss=0.956, task_loss=2.386, contrastive_loss=0.364, total=6543.01, n_correct=4401.32, ppl=2.65, accuracy=67.268, wps=17968.3, ups=0.95, wpb=18962, bsz=637.4, num_updates=11600, lr=0.000131306, gnorm=0.356, clip=0, loss_scale=16, train_wall=105, gb_free=14.3, wall=11817
2023-08-30 02:56:41 | INFO | train_inner | epoch 010:    989 / 1191 loss=1.959, trans_loss=3.31, nll_loss=1.404, w2v_ctc_loss=0.947, task_loss=2.103, contrastive_loss=0.311, total=6752.85, n_correct=4558.98, ppl=2.65, accuracy=67.512, wps=18787.7, ups=0.96, wpb=19566, bsz=689.1, num_updates=11700, lr=0.000130744, gnorm=0.35, clip=0, loss_scale=16, train_wall=104, gb_free=14.8, wall=11921
2023-08-30 02:58:26 | INFO | train_inner | epoch 010:   1089 / 1191 loss=1.965, trans_loss=3.307, nll_loss=1.402, w2v_ctc_loss=0.957, task_loss=2.202, contrastive_loss=0.309, total=6686.85, n_correct=4516.55, ppl=2.64, accuracy=67.544, wps=18556.1, ups=0.96, wpb=19386.7, bsz=674.5, num_updates=11800, lr=0.000130189, gnorm=0.351, clip=0, loss_scale=16, train_wall=104, gb_free=12.6, wall=12026
2023-08-30 03:00:10 | INFO | train_inner | epoch 010:   1189 / 1191 loss=1.979, trans_loss=3.316, nll_loss=1.41, w2v_ctc_loss=0.942, task_loss=2.151, contrastive_loss=0.484, total=6721.73, n_correct=4523.9, ppl=2.66, accuracy=67.303, wps=18768, ups=0.96, wpb=19469.4, bsz=687.5, num_updates=11900, lr=0.000129641, gnorm=0.352, clip=0, loss_scale=16, train_wall=103, gb_free=13.8, wall=12130
2023-08-30 03:00:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 03:00:47 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 3.815 | trans_loss 4.971 | nll_loss 2.215 | w2v_ctc_loss 1.2 | task_loss 11.902 | contrastive_loss 0.467 | total 6138.43 | n_correct 4266.14 | ppl 4.64 | accuracy 69.499 | uer 18.832 | wer 20.197 | raw_wer 20.197 | bleu 27.46 | wps 1601.5 | wpb 6138.4 | bsz 201.1 | num_updates 11902 | best_bleu 27.46
2023-08-30 03:00:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 11902 updates
2023-08-30 03:00:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 03:00:54 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 03:01:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 10 @ 11902 updates, score 27.46) (writing took 13.141255078997347 seconds)
2023-08-30 03:01:01 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-08-30 03:01:01 | INFO | train | epoch 010 | loss 1.973 | trans_loss 3.317 | nll_loss 1.412 | w2v_ctc_loss 0.951 | task_loss 2.199 | contrastive_loss 0.364 | total 6703.69 | n_correct 4509.9 | ppl 2.66 | accuracy 67.275 | wps 17789.7 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 11902 | lr 0.00012963 | gnorm 0.355 | clip 0 | loss_scale 16 | train_wall 1236 | gb_free 12.1 | wall 12181
2023-08-30 03:01:01 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 03:01:01 | INFO | fairseq.trainer | begin training epoch 11
2023-08-30 03:01:01 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 03:02:51 | INFO | train_inner | epoch 011:     98 / 1191 loss=1.943, trans_loss=3.296, nll_loss=1.386, w2v_ctc_loss=0.935, task_loss=2.356, contrastive_loss=0.329, total=6617.02, n_correct=4490.89, ppl=2.61, accuracy=67.869, wps=11854.5, ups=0.62, wpb=19180.3, bsz=644.2, num_updates=12000, lr=0.000129099, gnorm=0.354, clip=0, loss_scale=16, train_wall=104, gb_free=11.9, wall=12291
2023-08-30 03:02:51 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 03:03:27 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.834 | trans_loss 4.973 | nll_loss 2.211 | w2v_ctc_loss 1.265 | task_loss 11.991 | contrastive_loss 0.463 | total 6138.43 | n_correct 4268.43 | ppl 4.63 | accuracy 69.536 | uer 18.704 | wer 20.119 | raw_wer 20.119 | bleu 27.51 | wps 1617.6 | wpb 6138.4 | bsz 201.1 | num_updates 12000 | best_bleu 27.51
2023-08-30 03:03:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 12000 updates
2023-08-30 03:03:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-30 03:03:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-30 03:03:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_11_12000.pt (epoch 11 @ 12000 updates, score 27.51) (writing took 12.825392705999548 seconds)
2023-08-30 03:05:24 | INFO | train_inner | epoch 011:    198 / 1191 loss=1.933, trans_loss=3.298, nll_loss=1.387, w2v_ctc_loss=0.911, task_loss=2.136, contrastive_loss=0.39, total=6719.66, n_correct=4567.4, ppl=2.62, accuracy=67.971, wps=12791.6, ups=0.66, wpb=19458.7, bsz=691.2, num_updates=12100, lr=0.000128565, gnorm=0.346, clip=0, loss_scale=16, train_wall=102, gb_free=13.1, wall=12443
2023-08-30 03:07:08 | INFO | train_inner | epoch 011:    298 / 1191 loss=1.929, trans_loss=3.292, nll_loss=1.381, w2v_ctc_loss=0.917, task_loss=2.237, contrastive_loss=0.349, total=6603.62, n_correct=4494.07, ppl=2.6, accuracy=68.055, wps=18385.6, ups=0.96, wpb=19133.3, bsz=665.6, num_updates=12200, lr=0.000128037, gnorm=0.348, clip=0, loss_scale=16, train_wall=103, gb_free=12.9, wall=12548
2023-08-30 03:08:51 | INFO | train_inner | epoch 011:    398 / 1191 loss=1.938, trans_loss=3.293, nll_loss=1.383, w2v_ctc_loss=0.919, task_loss=2.268, contrastive_loss=0.397, total=6598.96, n_correct=4490.48, ppl=2.61, accuracy=68.048, wps=18451, ups=0.96, wpb=19128.5, bsz=664.1, num_updates=12300, lr=0.000127515, gnorm=0.347, clip=0, loss_scale=16, train_wall=103, gb_free=13.5, wall=12651
2023-08-30 03:10:36 | INFO | train_inner | epoch 011:    498 / 1191 loss=1.932, trans_loss=3.299, nll_loss=1.391, w2v_ctc_loss=0.931, task_loss=2.341, contrastive_loss=0.268, total=6657.89, n_correct=4519.64, ppl=2.62, accuracy=67.884, wps=18477.3, ups=0.96, wpb=19298.1, bsz=648.5, num_updates=12400, lr=0.000127, gnorm=0.346, clip=0, loss_scale=16, train_wall=104, gb_free=12.5, wall=12756
2023-08-30 03:12:20 | INFO | train_inner | epoch 011:    598 / 1191 loss=1.927, trans_loss=3.293, nll_loss=1.385, w2v_ctc_loss=0.929, task_loss=2.201, contrastive_loss=0.271, total=6662.32, n_correct=4532.36, ppl=2.61, accuracy=68.03, wps=18619.6, ups=0.96, wpb=19321.9, bsz=676.2, num_updates=12500, lr=0.000126491, gnorm=0.345, clip=0, loss_scale=16, train_wall=103, gb_free=12.6, wall=12859
2023-08-30 03:14:04 | INFO | train_inner | epoch 011:    698 / 1191 loss=1.924, trans_loss=3.289, nll_loss=1.379, w2v_ctc_loss=0.919, task_loss=2.317, contrastive_loss=0.312, total=6669.6, n_correct=4541.74, ppl=2.6, accuracy=68.096, wps=18471.3, ups=0.96, wpb=19337, bsz=658.6, num_updates=12600, lr=0.000125988, gnorm=0.346, clip=0, loss_scale=16, train_wall=104, gb_free=13.9, wall=12964
2023-08-30 03:15:49 | INFO | train_inner | epoch 011:    798 / 1191 loss=1.946, trans_loss=3.298, nll_loss=1.389, w2v_ctc_loss=0.936, task_loss=2.134, contrastive_loss=0.346, total=6805.13, n_correct=4619.47, ppl=2.62, accuracy=67.882, wps=18808.2, ups=0.95, wpb=19716.9, bsz=705.9, num_updates=12700, lr=0.000125491, gnorm=0.345, clip=0, loss_scale=16, train_wall=104, gb_free=11.9, wall=13069
2023-08-30 03:17:34 | INFO | train_inner | epoch 011:    898 / 1191 loss=1.922, trans_loss=3.3, nll_loss=1.388, w2v_ctc_loss=0.91, task_loss=2.159, contrastive_loss=0.321, total=6771.78, n_correct=4607.52, ppl=2.62, accuracy=68.04, wps=18719.1, ups=0.95, wpb=19602.7, bsz=680.9, num_updates=12800, lr=0.000125, gnorm=0.343, clip=0, loss_scale=16, train_wall=104, gb_free=6, wall=13174
2023-08-30 03:19:19 | INFO | train_inner | epoch 011:    998 / 1191 loss=1.926, trans_loss=3.293, nll_loss=1.381, w2v_ctc_loss=0.902, task_loss=2.069, contrastive_loss=0.403, total=6790.04, n_correct=4630.52, ppl=2.6, accuracy=68.196, wps=18684.6, ups=0.95, wpb=19657.4, bsz=707.5, num_updates=12900, lr=0.000124515, gnorm=0.345, clip=0, loss_scale=16, train_wall=105, gb_free=11.6, wall=13279
2023-08-30 03:21:03 | INFO | train_inner | epoch 011:   1098 / 1191 loss=1.935, trans_loss=3.29, nll_loss=1.379, w2v_ctc_loss=0.916, task_loss=2.062, contrastive_loss=0.417, total=6766.38, n_correct=4615.99, ppl=2.6, accuracy=68.219, wps=18947.9, ups=0.97, wpb=19607.9, bsz=703.5, num_updates=13000, lr=0.000124035, gnorm=0.339, clip=0, loss_scale=16, train_wall=103, gb_free=12.1, wall=13382
2023-08-30 03:22:39 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 03:23:12 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.805 | trans_loss 4.948 | nll_loss 2.184 | w2v_ctc_loss 1.237 | task_loss 11.984 | contrastive_loss 0.443 | total 6138.43 | n_correct 4286.86 | ppl 4.54 | accuracy 69.836 | uer 18.418 | wer 19.84 | raw_wer 19.84 | bleu 27.42 | wps 1734.3 | wpb 6138.4 | bsz 201.1 | num_updates 13093 | best_bleu 27.51
2023-08-30 03:23:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 13093 updates
2023-08-30 03:23:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.4209.pt
2023-08-30 03:23:14 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.4209.pt
2023-08-30 03:23:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.4209.pt (epoch 11 @ 13093 updates, score 27.42) (writing took 6.79413122900587 seconds)
2023-08-30 03:23:20 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-08-30 03:23:20 | INFO | train | epoch 011 | loss 1.932 | trans_loss 3.295 | nll_loss 1.384 | w2v_ctc_loss 0.92 | task_loss 2.198 | contrastive_loss 0.344 | total 6703.69 | n_correct 4560.82 | ppl 2.61 | accuracy 68.034 | wps 17280 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 13093 | lr 0.000123593 | gnorm 0.345 | clip 0 | loss_scale 16 | train_wall 1234 | gb_free 13 | wall 13520
2023-08-30 03:23:20 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 03:23:20 | INFO | fairseq.trainer | begin training epoch 12
2023-08-30 03:23:20 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 03:23:35 | INFO | train_inner | epoch 012:      7 / 1191 loss=1.922, trans_loss=3.294, nll_loss=1.382, w2v_ctc_loss=0.915, task_loss=2.051, contrastive_loss=0.316, total=6804.63, n_correct=4641.18, ppl=2.61, accuracy=68.206, wps=12943.4, ups=0.66, wpb=19695.8, bsz=712.2, num_updates=13100, lr=0.00012356, gnorm=0.341, clip=0, loss_scale=16, train_wall=103, gb_free=13.9, wall=13535
2023-08-30 03:25:19 | INFO | train_inner | epoch 012:    107 / 1191 loss=1.883, trans_loss=3.271, nll_loss=1.354, w2v_ctc_loss=0.888, task_loss=2.229, contrastive_loss=0.261, total=6726.14, n_correct=4626.42, ppl=2.56, accuracy=68.783, wps=18715.8, ups=0.96, wpb=19488.3, bsz=666.7, num_updates=13200, lr=0.000123091, gnorm=0.34, clip=0, loss_scale=16, train_wall=104, gb_free=12.7, wall=13639
2023-08-30 03:27:03 | INFO | train_inner | epoch 012:    207 / 1191 loss=1.901, trans_loss=3.28, nll_loss=1.366, w2v_ctc_loss=0.896, task_loss=2.223, contrastive_loss=0.329, total=6717.75, n_correct=4599.22, ppl=2.58, accuracy=68.464, wps=18733.7, ups=0.96, wpb=19462, bsz=666.9, num_updates=13300, lr=0.000122628, gnorm=0.341, clip=0, loss_scale=32, train_wall=103, gb_free=10.1, wall=13743
2023-08-30 03:28:47 | INFO | train_inner | epoch 012:    307 / 1191 loss=1.913, trans_loss=3.279, nll_loss=1.366, w2v_ctc_loss=0.897, task_loss=2.136, contrastive_loss=0.397, total=6705.4, n_correct=4595.15, ppl=2.58, accuracy=68.529, wps=18564.7, ups=0.96, wpb=19434.8, bsz=692.2, num_updates=13400, lr=0.000122169, gnorm=0.339, clip=0, loss_scale=32, train_wall=104, gb_free=13.3, wall=13847
2023-08-30 03:30:31 | INFO | train_inner | epoch 012:    407 / 1191 loss=1.895, trans_loss=3.277, nll_loss=1.362, w2v_ctc_loss=0.88, task_loss=2.033, contrastive_loss=0.364, total=6783.44, n_correct=4656.23, ppl=2.57, accuracy=68.641, wps=18895, ups=0.96, wpb=19652.9, bsz=708.9, num_updates=13500, lr=0.000121716, gnorm=0.336, clip=0, loss_scale=32, train_wall=103, gb_free=14.1, wall=13951
2023-08-30 03:32:16 | INFO | train_inner | epoch 012:    507 / 1191 loss=1.886, trans_loss=3.276, nll_loss=1.361, w2v_ctc_loss=0.886, task_loss=2.128, contrastive_loss=0.269, total=6734.71, n_correct=4628.39, ppl=2.57, accuracy=68.724, wps=18712.7, ups=0.96, wpb=19509.6, bsz=688.4, num_updates=13600, lr=0.000121268, gnorm=0.348, clip=0, loss_scale=32, train_wall=104, gb_free=10.4, wall=14056
2023-08-30 03:34:00 | INFO | train_inner | epoch 012:    607 / 1191 loss=1.906, trans_loss=3.276, nll_loss=1.36, w2v_ctc_loss=0.9, task_loss=2.256, contrastive_loss=0.349, total=6728.64, n_correct=4620.24, ppl=2.57, accuracy=68.665, wps=18619.1, ups=0.96, wpb=19492.3, bsz=678.2, num_updates=13700, lr=0.000120824, gnorm=0.339, clip=0, loss_scale=32, train_wall=104, gb_free=13.9, wall=14160
2023-08-30 03:35:45 | INFO | train_inner | epoch 012:    707 / 1191 loss=1.906, trans_loss=3.267, nll_loss=1.353, w2v_ctc_loss=0.893, task_loss=2.096, contrastive_loss=0.413, total=6764.33, n_correct=4647.24, ppl=2.55, accuracy=68.702, wps=18767.8, ups=0.96, wpb=19618.6, bsz=697.1, num_updates=13800, lr=0.000120386, gnorm=0.34, clip=0, loss_scale=32, train_wall=104, gb_free=14.1, wall=14265
2023-08-30 03:37:29 | INFO | train_inner | epoch 012:    807 / 1191 loss=1.901, trans_loss=3.282, nll_loss=1.367, w2v_ctc_loss=0.9, task_loss=2.273, contrastive_loss=0.31, total=6655.82, n_correct=4559.76, ppl=2.58, accuracy=68.508, wps=18433.9, ups=0.96, wpb=19273.2, bsz=663.1, num_updates=13900, lr=0.000119952, gnorm=0.337, clip=0, loss_scale=32, train_wall=104, gb_free=11.7, wall=14369
2023-08-30 03:39:15 | INFO | train_inner | epoch 012:    907 / 1191 loss=1.908, trans_loss=3.283, nll_loss=1.369, w2v_ctc_loss=0.902, task_loss=2.34, contrastive_loss=0.339, total=6656.61, n_correct=4557.78, ppl=2.58, accuracy=68.47, wps=18348.3, ups=0.95, wpb=19280.3, bsz=657.1, num_updates=14000, lr=0.000119523, gnorm=0.342, clip=0, loss_scale=32, train_wall=105, gb_free=13.3, wall=14474
2023-08-30 03:39:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 03:39:47 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.792 | trans_loss 4.94 | nll_loss 2.174 | w2v_ctc_loss 1.212 | task_loss 11.897 | contrastive_loss 0.446 | total 6138.43 | n_correct 4291.86 | ppl 4.51 | accuracy 69.918 | uer 18.498 | wer 19.877 | raw_wer 19.877 | bleu 27.37 | wps 1762.2 | wpb 6138.4 | bsz 201.1 | num_updates 14000 | best_bleu 27.51
2023-08-30 03:39:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14000 updates
2023-08-30 03:39:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-30 03:39:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-30 03:39:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_12_14000.pt (epoch 12 @ 14000 updates, score 27.37) (writing took 8.819550443004118 seconds)
2023-08-30 03:41:40 | INFO | train_inner | epoch 012:   1007 / 1191 loss=1.904, trans_loss=3.277, nll_loss=1.364, w2v_ctc_loss=0.909, task_loss=2.276, contrastive_loss=0.3, total=6593.96, n_correct=4522.53, ppl=2.57, accuracy=68.586, wps=13174, ups=0.69, wpb=19121.5, bsz=661.7, num_updates=14100, lr=0.000119098, gnorm=0.345, clip=0, loss_scale=32, train_wall=103, gb_free=14.6, wall=14620
2023-08-30 03:43:25 | INFO | train_inner | epoch 012:   1107 / 1191 loss=1.9, trans_loss=3.278, nll_loss=1.363, w2v_ctc_loss=0.893, task_loss=2.242, contrastive_loss=0.356, total=6662.47, n_correct=4576.13, ppl=2.57, accuracy=68.685, wps=18341.5, ups=0.95, wpb=19297.1, bsz=674.6, num_updates=14200, lr=0.000118678, gnorm=0.337, clip=0, loss_scale=32, train_wall=105, gb_free=13.7, wall=14725
2023-08-30 03:44:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 03:45:25 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.791 | trans_loss 4.933 | nll_loss 2.168 | w2v_ctc_loss 1.226 | task_loss 11.949 | contrastive_loss 0.438 | total 6138.43 | n_correct 4304.29 | ppl 4.49 | accuracy 70.12 | uer 18.134 | wer 19.606 | raw_wer 19.606 | bleu 27.93 | wps 1735.8 | wpb 6138.4 | bsz 201.1 | num_updates 14284 | best_bleu 27.93
2023-08-30 03:45:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14284 updates
2023-08-30 03:45:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 03:45:32 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 03:45:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 12 @ 14284 updates, score 27.93) (writing took 13.503285684011644 seconds)
2023-08-30 03:45:39 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-08-30 03:45:39 | INFO | train | epoch 012 | loss 1.9 | trans_loss 3.277 | nll_loss 1.362 | w2v_ctc_loss 0.895 | task_loss 2.198 | contrastive_loss 0.33 | total 6703.69 | n_correct 4600.27 | ppl 2.57 | accuracy 68.623 | wps 17269.3 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 14284 | lr 0.000118329 | gnorm 0.34 | clip 0 | loss_scale 32 | train_wall 1236 | gb_free 14.1 | wall 14859
2023-08-30 03:45:40 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 03:45:40 | INFO | fairseq.trainer | begin training epoch 13
2023-08-30 03:45:40 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 03:46:04 | INFO | train_inner | epoch 013:     16 / 1191 loss=1.888, trans_loss=3.274, nll_loss=1.357, w2v_ctc_loss=0.894, task_loss=2.23, contrastive_loss=0.269, total=6695.08, n_correct=4605.78, ppl=2.56, accuracy=68.794, wps=12221.1, ups=0.63, wpb=19387.8, bsz=667.7, num_updates=14300, lr=0.000118262, gnorm=0.337, clip=0, loss_scale=32, train_wall=104, gb_free=11.7, wall=14883
2023-08-30 03:47:49 | INFO | train_inner | epoch 013:    116 / 1191 loss=1.87, trans_loss=3.256, nll_loss=1.335, w2v_ctc_loss=0.869, task_loss=2.304, contrastive_loss=0.33, total=6709.84, n_correct=4645.86, ppl=2.52, accuracy=69.24, wps=18498.5, ups=0.95, wpb=19443.8, bsz=663.9, num_updates=14400, lr=0.000117851, gnorm=0.332, clip=0, loss_scale=32, train_wall=104, gb_free=11.7, wall=14989
2023-08-30 03:49:33 | INFO | train_inner | epoch 013:    216 / 1191 loss=1.877, trans_loss=3.265, nll_loss=1.347, w2v_ctc_loss=0.867, task_loss=2.178, contrastive_loss=0.37, total=6635.65, n_correct=4579.86, ppl=2.54, accuracy=69.019, wps=18413.9, ups=0.96, wpb=19225.6, bsz=687.8, num_updates=14500, lr=0.000117444, gnorm=0.336, clip=0, loss_scale=32, train_wall=104, gb_free=14.2, wall=15093
2023-08-30 03:51:17 | INFO | train_inner | epoch 013:    316 / 1191 loss=1.88, trans_loss=3.26, nll_loss=1.341, w2v_ctc_loss=0.852, task_loss=2.048, contrastive_loss=0.463, total=6732.12, n_correct=4664.43, ppl=2.53, accuracy=69.286, wps=18764.6, ups=0.96, wpb=19501.5, bsz=716.2, num_updates=14600, lr=0.000117041, gnorm=0.333, clip=0, loss_scale=32, train_wall=103, gb_free=13, wall=15197
2023-08-30 03:53:01 | INFO | train_inner | epoch 013:    416 / 1191 loss=1.865, trans_loss=3.263, nll_loss=1.346, w2v_ctc_loss=0.875, task_loss=2.174, contrastive_loss=0.243, total=6753.67, n_correct=4666.75, ppl=2.54, accuracy=69.099, wps=18762.5, ups=0.96, wpb=19572.6, bsz=678.7, num_updates=14700, lr=0.000116642, gnorm=0.339, clip=0, loss_scale=32, train_wall=104, gb_free=13.4, wall=15301
2023-08-30 03:54:46 | INFO | train_inner | epoch 013:    516 / 1191 loss=1.88, trans_loss=3.266, nll_loss=1.349, w2v_ctc_loss=0.876, task_loss=2.334, contrastive_loss=0.345, total=6638.04, n_correct=4577.5, ppl=2.55, accuracy=68.959, wps=18375.8, ups=0.96, wpb=19233.6, bsz=655.6, num_updates=14800, lr=0.000116248, gnorm=0.338, clip=0, loss_scale=32, train_wall=104, gb_free=14.6, wall=15406
2023-08-30 03:56:30 | INFO | train_inner | epoch 013:    616 / 1191 loss=1.877, trans_loss=3.266, nll_loss=1.347, w2v_ctc_loss=0.884, task_loss=2.277, contrastive_loss=0.294, total=6702.58, n_correct=4624.86, ppl=2.54, accuracy=69.001, wps=18698.7, ups=0.96, wpb=19417.2, bsz=654.1, num_updates=14900, lr=0.000115857, gnorm=0.337, clip=0, loss_scale=32, train_wall=103, gb_free=13.4, wall=15510
2023-08-30 03:58:15 | INFO | train_inner | epoch 013:    716 / 1191 loss=1.864, trans_loss=3.263, nll_loss=1.343, w2v_ctc_loss=0.874, task_loss=2.313, contrastive_loss=0.247, total=6640, n_correct=4591.21, ppl=2.54, accuracy=69.145, wps=18252, ups=0.95, wpb=19234, bsz=654.1, num_updates=15000, lr=0.00011547, gnorm=0.338, clip=0, loss_scale=32, train_wall=105, gb_free=15, wall=15615
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 03:59:29 | INFO | train_inner | epoch 013:    816 / 1191 loss=1.915, trans_loss=4.704, nll_loss=1.938, w2v_ctc_loss=0.628, task_loss=3.165, contrastive_loss=0.234, total=6754.21, n_correct=4669.37, ppl=3.83, accuracy=69.133, wps=18522.4, ups=1.36, wpb=13574.6, bsz=462.3, num_updates=15100, lr=0.000115087, gnorm=0.43, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=15688
2023-08-30 04:00:41 | INFO | train_inner | epoch 013:    916 / 1191 loss=1.924, trans_loss=4.727, nll_loss=1.948, w2v_ctc_loss=0.643, task_loss=3.646, contrastive_loss=0.21, total=6564.2, n_correct=4528.95, ppl=3.86, accuracy=68.995, wps=18136.1, ups=1.38, wpb=13128.4, bsz=422.2, num_updates=15200, lr=0.000114708, gnorm=0.443, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=15761
2023-08-30 04:01:54 | INFO | train_inner | epoch 013:   1016 / 1191 loss=1.913, trans_loss=4.724, nll_loss=1.945, w2v_ctc_loss=0.628, task_loss=3.152, contrastive_loss=0.195, total=6796.22, n_correct=4706.31, ppl=3.85, accuracy=69.249, wps=18614.2, ups=1.37, wpb=13592.4, bsz=468.6, num_updates=15300, lr=0.000114332, gnorm=0.424, clip=0, loss_scale=64, train_wall=72, gb_free=12.2, wall=15834
2023-08-30 04:03:07 | INFO | train_inner | epoch 013:   1116 / 1191 loss=1.921, trans_loss=4.725, nll_loss=1.945, w2v_ctc_loss=0.638, task_loss=3.191, contrastive_loss=0.256, total=6753.73, n_correct=4667.61, ppl=3.85, accuracy=69.112, wps=18582.7, ups=1.38, wpb=13507.5, bsz=465.1, num_updates=15400, lr=0.000113961, gnorm=0.426, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=15906
2023-08-30 04:04:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
2023-08-30 04:04:34 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 3.773 | trans_loss 4.92 | nll_loss 2.15 | w2v_ctc_loss 1.202 | task_loss 12.026 | contrastive_loss 0.427 | total 6138.43 | n_correct 4310.29 | ppl 4.44 | accuracy 70.218 | uer 17.953 | wer 19.617 | raw_wer 19.617 | bleu 28.17 | wps 1746.5 | wpb 6138.4 | bsz 201.1 | num_updates 15475 | best_bleu 28.17
2023-08-30 04:04:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 15475 updates
2023-08-30 04:04:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 04:04:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 04:04:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 13 @ 15475 updates, score 28.17) (writing took 13.914665438001975 seconds)
2023-08-30 04:04:48 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-08-30 04:04:48 | INFO | train | epoch 013 | loss 1.888 | trans_loss 3.722 | nll_loss 1.533 | w2v_ctc_loss 0.796 | task_loss 2.54 | contrastive_loss 0.3 | total 6703.69 | n_correct 4633.16 | ppl 2.89 | accuracy 69.114 | wps 17644.7 | ups 1.04 | wpb 17022.9 | bsz 587.5 | num_updates 15475 | lr 0.000113684 | gnorm 0.373 | clip 0 | loss_scale 64 | train_wall 1086 | gb_free 9.7 | wall 16008
2023-08-30 04:04:49 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 04:04:49 | INFO | fairseq.trainer | begin training epoch 14
2023-08-30 04:04:49 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 04:05:14 | INFO | train_inner | epoch 014:     25 / 1191 loss=1.917, trans_loss=4.723, nll_loss=1.943, w2v_ctc_loss=0.633, task_loss=3.071, contrastive_loss=0.25, total=6745.72, n_correct=4670.48, ppl=3.85, accuracy=69.236, wps=10600.1, ups=0.79, wpb=13491.4, bsz=465.6, num_updates=15500, lr=0.000113592, gnorm=0.424, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=16034
2023-08-30 04:06:26 | INFO | train_inner | epoch 014:    125 / 1191 loss=1.91, trans_loss=4.707, nll_loss=1.922, w2v_ctc_loss=0.625, task_loss=3.238, contrastive_loss=0.266, total=6649.06, n_correct=4624.66, ppl=3.79, accuracy=69.554, wps=18475.6, ups=1.39, wpb=13298.1, bsz=449.5, num_updates=15600, lr=0.000113228, gnorm=0.43, clip=0, loss_scale=64, train_wall=71, gb_free=14.1, wall=16106
2023-08-30 04:07:39 | INFO | train_inner | epoch 014:    225 / 1191 loss=1.906, trans_loss=4.711, nll_loss=1.928, w2v_ctc_loss=0.62, task_loss=3.359, contrastive_loss=0.2, total=6640.19, n_correct=4609.67, ppl=3.8, accuracy=69.421, wps=18236.5, ups=1.37, wpb=13280.4, bsz=445.2, num_updates=15700, lr=0.000112867, gnorm=0.423, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=16179
2023-08-30 04:08:52 | INFO | train_inner | epoch 014:    325 / 1191 loss=1.913, trans_loss=4.71, nll_loss=1.927, w2v_ctc_loss=0.627, task_loss=3.364, contrastive_loss=0.267, total=6727.18, n_correct=4666.52, ppl=3.8, accuracy=69.368, wps=18462.2, ups=1.37, wpb=13454.4, bsz=448.4, num_updates=15800, lr=0.000112509, gnorm=0.427, clip=0, loss_scale=64, train_wall=72, gb_free=15, wall=16251
2023-08-30 04:09:46 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 04:10:06 | INFO | train_inner | epoch 014:    426 / 1191 loss=1.9, trans_loss=4.705, nll_loss=1.919, w2v_ctc_loss=0.616, task_loss=3.142, contrastive_loss=0.203, total=6817.18, n_correct=4746.27, ppl=3.78, accuracy=69.622, wps=18402.9, ups=1.35, wpb=13634.4, bsz=470.1, num_updates=15900, lr=0.000112154, gnorm=0.418, clip=0, loss_scale=32, train_wall=73, gb_free=13.1, wall=16326
2023-08-30 04:11:19 | INFO | train_inner | epoch 014:    526 / 1191 loss=1.911, trans_loss=4.704, nll_loss=1.919, w2v_ctc_loss=0.624, task_loss=3.248, contrastive_loss=0.292, total=6709.13, n_correct=4665.11, ppl=3.78, accuracy=69.534, wps=18397.7, ups=1.37, wpb=13418.3, bsz=456.4, num_updates=16000, lr=0.000111803, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=16398
2023-08-30 04:11:19 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 04:11:52 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.774 | trans_loss 4.917 | nll_loss 2.147 | w2v_ctc_loss 1.204 | task_loss 11.987 | contrastive_loss 0.446 | total 6138.43 | n_correct 4319 | ppl 4.43 | accuracy 70.36 | uer 18.223 | wer 19.676 | raw_wer 19.676 | bleu 28.15 | wps 1712.1 | wpb 6138.4 | bsz 201.1 | num_updates 16000 | best_bleu 28.17
2023-08-30 04:11:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16000 updates
2023-08-30 04:11:52 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-30 04:11:54 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-30 04:12:02 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_14_16000.pt (epoch 14 @ 16000 updates, score 28.15) (writing took 10.037997766994522 seconds)
2023-08-30 04:13:15 | INFO | train_inner | epoch 014:    626 / 1191 loss=1.908, trans_loss=4.709, nll_loss=1.925, w2v_ctc_loss=0.629, task_loss=3.194, contrastive_loss=0.224, total=6815.41, n_correct=4734.67, ppl=3.8, accuracy=69.47, wps=11751.7, ups=0.86, wpb=13630.8, bsz=465.9, num_updates=16100, lr=0.000111456, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=16514
2023-08-30 04:14:27 | INFO | train_inner | epoch 014:    726 / 1191 loss=1.915, trans_loss=4.709, nll_loss=1.926, w2v_ctc_loss=0.632, task_loss=3.331, contrastive_loss=0.28, total=6688.33, n_correct=4643.16, ppl=3.8, accuracy=69.422, wps=18439.7, ups=1.38, wpb=13376.7, bsz=448, num_updates=16200, lr=0.000111111, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=16587
2023-08-30 04:15:40 | INFO | train_inner | epoch 014:    826 / 1191 loss=1.915, trans_loss=4.715, nll_loss=1.933, w2v_ctc_loss=0.628, task_loss=3.31, contrastive_loss=0.315, total=6699.73, n_correct=4646.9, ppl=3.82, accuracy=69.36, wps=18387.1, ups=1.37, wpb=13399.5, bsz=459.5, num_updates=16300, lr=0.00011077, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=16660
2023-08-30 04:16:53 | INFO | train_inner | epoch 014:    926 / 1191 loss=1.908, trans_loss=4.71, nll_loss=1.927, w2v_ctc_loss=0.629, task_loss=3.342, contrastive_loss=0.196, total=6651.62, n_correct=4623.54, ppl=3.8, accuracy=69.51, wps=18187.1, ups=1.37, wpb=13303.2, bsz=446, num_updates=16400, lr=0.000110432, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=16733
2023-08-30 04:18:07 | INFO | train_inner | epoch 014:   1026 / 1191 loss=1.917, trans_loss=4.717, nll_loss=1.935, w2v_ctc_loss=0.644, task_loss=3.682, contrastive_loss=0.185, total=6566.51, n_correct=4546.98, ppl=3.82, accuracy=69.245, wps=17868.9, ups=1.36, wpb=13133, bsz=420.2, num_updates=16500, lr=0.000110096, gnorm=0.434, clip=0, loss_scale=32, train_wall=73, gb_free=10.3, wall=16807
2023-08-30 04:19:19 | INFO | train_inner | epoch 014:   1126 / 1191 loss=1.906, trans_loss=4.708, nll_loss=1.925, w2v_ctc_loss=0.625, task_loss=3.042, contrastive_loss=0.236, total=6798.37, n_correct=4732.56, ppl=3.8, accuracy=69.613, wps=18728.9, ups=1.38, wpb=13596.7, bsz=475.2, num_updates=16600, lr=0.000109764, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=14.7, wall=16879
2023-08-30 04:20:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 04:20:41 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.91 | nll_loss 2.138 | w2v_ctc_loss 1.21 | task_loss 11.994 | contrastive_loss 0.438 | total 6138.43 | n_correct 4321.14 | ppl 4.4 | accuracy 70.395 | uer 17.886 | wer 19.375 | raw_wer 19.375 | bleu 27.99 | wps 1640.8 | wpb 6138.4 | bsz 201.1 | num_updates 16665 | best_bleu 28.17
2023-08-30 04:20:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16665 updates
2023-08-30 04:20:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.9900.pt
2023-08-30 04:20:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.9900.pt
2023-08-30 04:20:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_27.9900.pt (epoch 14 @ 16665 updates, score 27.99) (writing took 7.257915621012216 seconds)
2023-08-30 04:20:49 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2023-08-30 04:20:49 | INFO | train | epoch 014 | loss 1.91 | trans_loss 4.709 | nll_loss 1.926 | w2v_ctc_loss 0.627 | task_loss 3.294 | contrastive_loss 0.241 | total 6703.54 | n_correct 4657.37 | ppl 3.8 | accuracy 69.476 | wps 16610.3 | ups 1.24 | wpb 13407.1 | bsz 452.2 | num_updates 16665 | lr 0.00010955 | gnorm 0.425 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 14.3 | wall 16969
2023-08-30 04:20:49 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 04:20:49 | INFO | fairseq.trainer | begin training epoch 15
2023-08-30 04:20:49 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 04:21:22 | INFO | train_inner | epoch 015:     35 / 1191 loss=1.906, trans_loss=4.701, nll_loss=1.916, w2v_ctc_loss=0.624, task_loss=3.303, contrastive_loss=0.246, total=6693.11, n_correct=4660.1, ppl=3.77, accuracy=69.625, wps=10903.8, ups=0.81, wpb=13386.2, bsz=448.1, num_updates=16700, lr=0.000109435, gnorm=0.429, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=17002
2023-08-30 04:22:34 | INFO | train_inner | epoch 015:    135 / 1191 loss=1.898, trans_loss=4.693, nll_loss=1.905, w2v_ctc_loss=0.618, task_loss=3.209, contrastive_loss=0.241, total=6736.22, n_correct=4707.61, ppl=3.75, accuracy=69.885, wps=18615.1, ups=1.38, wpb=13472.4, bsz=458.3, num_updates=16800, lr=0.000109109, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=12, wall=17074
2023-08-30 04:23:47 | INFO | train_inner | epoch 015:    235 / 1191 loss=1.896, trans_loss=4.689, nll_loss=1.899, w2v_ctc_loss=0.619, task_loss=3.292, contrastive_loss=0.21, total=6691.08, n_correct=4675.96, ppl=3.73, accuracy=69.883, wps=18514, ups=1.38, wpb=13382.2, bsz=447.5, num_updates=16900, lr=0.000108786, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=17147
2023-08-30 04:24:59 | INFO | train_inner | epoch 015:    335 / 1191 loss=1.89, trans_loss=4.683, nll_loss=1.892, w2v_ctc_loss=0.611, task_loss=3.313, contrastive_loss=0.202, total=6665.88, n_correct=4668.32, ppl=3.71, accuracy=70.033, wps=18417.5, ups=1.38, wpb=13331.8, bsz=446.9, num_updates=17000, lr=0.000108465, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=17219
2023-08-30 04:26:12 | INFO | train_inner | epoch 015:    435 / 1191 loss=1.904, trans_loss=4.7, nll_loss=1.914, w2v_ctc_loss=0.625, task_loss=3.326, contrastive_loss=0.232, total=6733.73, n_correct=4692.12, ppl=3.77, accuracy=69.681, wps=18557.5, ups=1.38, wpb=13467.5, bsz=456.4, num_updates=17100, lr=0.000108148, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=17292
2023-08-30 04:27:25 | INFO | train_inner | epoch 015:    535 / 1191 loss=1.902, trans_loss=4.693, nll_loss=1.906, w2v_ctc_loss=0.624, task_loss=3.265, contrastive_loss=0.244, total=6700.53, n_correct=4675.96, ppl=3.75, accuracy=69.785, wps=18413.7, ups=1.37, wpb=13401.1, bsz=460.4, num_updates=17200, lr=0.000107833, gnorm=0.427, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=17364
2023-08-30 04:28:37 | INFO | train_inner | epoch 015:    635 / 1191 loss=1.908, trans_loss=4.697, nll_loss=1.909, w2v_ctc_loss=0.633, task_loss=3.732, contrastive_loss=0.221, total=6598.77, n_correct=4596.37, ppl=3.76, accuracy=69.655, wps=18245.3, ups=1.38, wpb=13197.5, bsz=410.4, num_updates=17300, lr=0.000107521, gnorm=0.434, clip=0, loss_scale=32, train_wall=72, gb_free=11.6, wall=17437
2023-08-30 04:29:50 | INFO | train_inner | epoch 015:    735 / 1191 loss=1.9, trans_loss=4.69, nll_loss=1.901, w2v_ctc_loss=0.615, task_loss=3.326, contrastive_loss=0.315, total=6644.1, n_correct=4641.74, ppl=3.74, accuracy=69.863, wps=18195.1, ups=1.37, wpb=13288.2, bsz=454.2, num_updates=17400, lr=0.000107211, gnorm=0.425, clip=0, loss_scale=32, train_wall=73, gb_free=14, wall=17510
2023-08-30 04:31:03 | INFO | train_inner | epoch 015:    835 / 1191 loss=1.895, trans_loss=4.689, nll_loss=1.9, w2v_ctc_loss=0.623, task_loss=3.279, contrastive_loss=0.186, total=6725.66, n_correct=4707.35, ppl=3.73, accuracy=69.991, wps=18498.1, ups=1.38, wpb=13451.3, bsz=448.3, num_updates=17500, lr=0.000106904, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=17582
2023-08-30 04:32:16 | INFO | train_inner | epoch 015:    935 / 1191 loss=1.895, trans_loss=4.689, nll_loss=1.901, w2v_ctc_loss=0.614, task_loss=3.134, contrastive_loss=0.289, total=6750.02, n_correct=4722.81, ppl=3.73, accuracy=69.967, wps=18346.6, ups=1.36, wpb=13500, bsz=473.6, num_updates=17600, lr=0.0001066, gnorm=0.419, clip=0, loss_scale=32, train_wall=73, gb_free=13.6, wall=17656
2023-08-30 04:33:29 | INFO | train_inner | epoch 015:   1035 / 1191 loss=1.894, trans_loss=4.691, nll_loss=1.903, w2v_ctc_loss=0.616, task_loss=3.277, contrastive_loss=0.211, total=6700.78, n_correct=4688.37, ppl=3.74, accuracy=69.968, wps=18411.2, ups=1.37, wpb=13401.6, bsz=454.3, num_updates=17700, lr=0.000106299, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=17729
2023-08-30 04:34:42 | INFO | train_inner | epoch 015:   1135 / 1191 loss=1.9, trans_loss=4.696, nll_loss=1.909, w2v_ctc_loss=0.622, task_loss=3.345, contrastive_loss=0.222, total=6753.24, n_correct=4710.56, ppl=3.76, accuracy=69.753, wps=18475.3, ups=1.37, wpb=13506.5, bsz=446, num_updates=17800, lr=0.000106, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=12.7, wall=17802
2023-08-30 04:35:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 04:35:55 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 3.771 | trans_loss 4.902 | nll_loss 2.126 | w2v_ctc_loss 1.235 | task_loss 11.964 | contrastive_loss 0.43 | total 6138.43 | n_correct 4338.14 | ppl 4.36 | accuracy 70.672 | uer 18.22 | wer 19.569 | raw_wer 19.569 | bleu 28.37 | wps 1772.2 | wpb 6138.4 | bsz 201.1 | num_updates 17856 | best_bleu 28.37
2023-08-30 04:35:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 17856 updates
2023-08-30 04:35:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 04:36:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 04:36:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 15 @ 17856 updates, score 28.37) (writing took 11.891797909993329 seconds)
2023-08-30 04:36:08 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2023-08-30 04:36:08 | INFO | train | epoch 015 | loss 1.899 | trans_loss 4.692 | nll_loss 1.904 | w2v_ctc_loss 0.619 | task_loss 3.297 | contrastive_loss 0.238 | total 6703.69 | n_correct 4683 | ppl 3.74 | accuracy 69.857 | wps 17381.5 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 17856 | lr 0.000105833 | gnorm 0.422 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 11.6 | wall 17887
2023-08-30 04:36:08 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 04:36:08 | INFO | fairseq.trainer | begin training epoch 16
2023-08-30 04:36:08 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 04:36:47 | INFO | train_inner | epoch 016:     44 / 1191 loss=1.895, trans_loss=4.686, nll_loss=1.897, w2v_ctc_loss=0.608, task_loss=3.217, contrastive_loss=0.296, total=6683.77, n_correct=4677.3, ppl=3.72, accuracy=69.98, wps=10740.7, ups=0.8, wpb=13367.5, bsz=454.6, num_updates=17900, lr=0.000105703, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=17926
2023-08-30 04:38:00 | INFO | train_inner | epoch 016:    144 / 1191 loss=1.888, trans_loss=4.677, nll_loss=1.884, w2v_ctc_loss=0.611, task_loss=3.382, contrastive_loss=0.218, total=6721.68, n_correct=4718.37, ppl=3.69, accuracy=70.196, wps=18313.7, ups=1.36, wpb=13443.4, bsz=446.2, num_updates=18000, lr=0.000105409, gnorm=0.416, clip=0, loss_scale=64, train_wall=73, gb_free=14, wall=18000
2023-08-30 04:38:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 04:38:36 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.769 | trans_loss 4.903 | nll_loss 2.127 | w2v_ctc_loss 1.224 | task_loss 11.907 | contrastive_loss 0.435 | total 6138.43 | n_correct 4336.14 | ppl 4.37 | accuracy 70.639 | uer 17.915 | wer 19.398 | raw_wer 19.398 | bleu 28.16 | wps 1570.7 | wpb 6138.4 | bsz 201.1 | num_updates 18000 | best_bleu 28.37
2023-08-30 04:38:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 18000 updates
2023-08-30 04:38:36 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-30 04:38:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-30 04:38:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_16_18000.pt (epoch 16 @ 18000 updates, score 28.16) (writing took 7.170867382999859 seconds)
2023-08-30 04:39:57 | INFO | train_inner | epoch 016:    244 / 1191 loss=1.891, trans_loss=4.679, nll_loss=1.887, w2v_ctc_loss=0.613, task_loss=3.416, contrastive_loss=0.235, total=6694.44, n_correct=4692.21, ppl=3.7, accuracy=70.091, wps=11446.7, ups=0.85, wpb=13388.9, bsz=440.6, num_updates=18100, lr=0.000105118, gnorm=0.418, clip=0, loss_scale=64, train_wall=72, gb_free=13.1, wall=18117
2023-08-30 04:41:09 | INFO | train_inner | epoch 016:    344 / 1191 loss=1.889, trans_loss=4.682, nll_loss=1.891, w2v_ctc_loss=0.609, task_loss=3.157, contrastive_loss=0.234, total=6766.61, n_correct=4748.59, ppl=3.71, accuracy=70.177, wps=18726, ups=1.38, wpb=13533.2, bsz=461.2, num_updates=18200, lr=0.000104828, gnorm=0.416, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=18189
2023-08-30 04:42:21 | INFO | train_inner | epoch 016:    444 / 1191 loss=1.888, trans_loss=4.679, nll_loss=1.887, w2v_ctc_loss=0.616, task_loss=3.283, contrastive_loss=0.188, total=6682.58, n_correct=4688.44, ppl=3.7, accuracy=70.159, wps=18549, ups=1.39, wpb=13365.2, bsz=450, num_updates=18300, lr=0.000104542, gnorm=0.418, clip=0, loss_scale=64, train_wall=71, gb_free=13.1, wall=18261
2023-08-30 04:43:34 | INFO | train_inner | epoch 016:    544 / 1191 loss=1.885, trans_loss=4.672, nll_loss=1.879, w2v_ctc_loss=0.606, task_loss=3.335, contrastive_loss=0.237, total=6679.83, n_correct=4697.33, ppl=3.68, accuracy=70.321, wps=18329.8, ups=1.37, wpb=13359.7, bsz=445.7, num_updates=18400, lr=0.000104257, gnorm=0.416, clip=0, loss_scale=64, train_wall=72, gb_free=12.2, wall=18334
2023-08-30 04:44:48 | INFO | train_inner | epoch 016:    644 / 1191 loss=1.891, trans_loss=4.677, nll_loss=1.885, w2v_ctc_loss=0.613, task_loss=3.32, contrastive_loss=0.255, total=6709.38, n_correct=4708.54, ppl=3.69, accuracy=70.178, wps=18286.8, ups=1.36, wpb=13418.8, bsz=455.6, num_updates=18500, lr=0.000103975, gnorm=0.418, clip=0, loss_scale=64, train_wall=73, gb_free=13.5, wall=18407
2023-08-30 04:46:00 | INFO | train_inner | epoch 016:    744 / 1191 loss=1.885, trans_loss=4.67, nll_loss=1.876, w2v_ctc_loss=0.612, task_loss=3.349, contrastive_loss=0.217, total=6649.58, n_correct=4675.98, ppl=3.67, accuracy=70.32, wps=18363.5, ups=1.38, wpb=13299.2, bsz=447.6, num_updates=18600, lr=0.000103695, gnorm=0.419, clip=0, loss_scale=64, train_wall=72, gb_free=15.2, wall=18480
2023-08-30 04:47:13 | INFO | train_inner | epoch 016:    844 / 1191 loss=1.892, trans_loss=4.682, nll_loss=1.891, w2v_ctc_loss=0.617, task_loss=3.449, contrastive_loss=0.216, total=6697.41, n_correct=4696.25, ppl=3.71, accuracy=70.12, wps=18314.8, ups=1.37, wpb=13394.8, bsz=439.9, num_updates=18700, lr=0.000103418, gnorm=0.419, clip=0, loss_scale=64, train_wall=73, gb_free=14.6, wall=18553
2023-08-30 04:48:26 | INFO | train_inner | epoch 016:    944 / 1191 loss=1.886, trans_loss=4.679, nll_loss=1.888, w2v_ctc_loss=0.608, task_loss=3.148, contrastive_loss=0.229, total=6750.33, n_correct=4736.85, ppl=3.7, accuracy=70.172, wps=18480.8, ups=1.37, wpb=13500.7, bsz=468.6, num_updates=18800, lr=0.000103142, gnorm=0.42, clip=0, loss_scale=64, train_wall=73, gb_free=13.5, wall=18626
2023-08-30 04:49:39 | INFO | train_inner | epoch 016:   1044 / 1191 loss=1.891, trans_loss=4.676, nll_loss=1.884, w2v_ctc_loss=0.618, task_loss=3.304, contrastive_loss=0.253, total=6671.1, n_correct=4681.92, ppl=3.69, accuracy=70.182, wps=18378.7, ups=1.38, wpb=13342.2, bsz=455.1, num_updates=18900, lr=0.000102869, gnorm=0.418, clip=0, loss_scale=64, train_wall=72, gb_free=11.6, wall=18699
2023-08-30 04:50:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 04:50:53 | INFO | train_inner | epoch 016:   1145 / 1191 loss=1.888, trans_loss=4.68, nll_loss=1.889, w2v_ctc_loss=0.609, task_loss=3.094, contrastive_loss=0.25, total=6790.42, n_correct=4768.75, ppl=3.7, accuracy=70.228, wps=18332.2, ups=1.35, wpb=13580.8, bsz=477.1, num_updates=19000, lr=0.000102598, gnorm=0.414, clip=0, loss_scale=32, train_wall=74, gb_free=13.1, wall=18773
2023-08-30 04:51:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 04:51:59 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.754 | trans_loss 4.897 | nll_loss 2.122 | w2v_ctc_loss 1.189 | task_loss 11.969 | contrastive_loss 0.435 | total 6138.43 | n_correct 4342.86 | ppl 4.35 | accuracy 70.749 | uer 18.086 | wer 19.807 | raw_wer 19.807 | bleu 28.2 | wps 1748.3 | wpb 6138.4 | bsz 201.1 | num_updates 19046 | best_bleu 28.37
2023-08-30 04:51:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 19046 updates
2023-08-30 04:51:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.2002.pt
2023-08-30 04:52:02 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.2002.pt
2023-08-30 04:52:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.2002.pt (epoch 16 @ 19046 updates, score 28.2) (writing took 9.133237085989094 seconds)
2023-08-30 04:52:08 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2023-08-30 04:52:08 | INFO | train | epoch 016 | loss 1.889 | trans_loss 4.677 | nll_loss 1.885 | w2v_ctc_loss 0.612 | task_loss 3.298 | contrastive_loss 0.235 | total 6703.17 | n_correct 4704.94 | ppl 3.69 | accuracy 70.19 | wps 16605.6 | ups 1.24 | wpb 13406.3 | bsz 452 | num_updates 19046 | lr 0.000102474 | gnorm 0.418 | clip 0 | loss_scale 32 | train_wall 860 | gb_free 13.6 | wall 18848
2023-08-30 04:52:09 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 04:52:09 | INFO | fairseq.trainer | begin training epoch 17
2023-08-30 04:52:09 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 04:52:56 | INFO | train_inner | epoch 017:     54 / 1191 loss=1.887, trans_loss=4.673, nll_loss=1.88, w2v_ctc_loss=0.606, task_loss=3.426, contrastive_loss=0.258, total=6598.23, n_correct=4634.31, ppl=3.68, accuracy=70.236, wps=10722.4, ups=0.81, wpb=13196.5, bsz=437.8, num_updates=19100, lr=0.000102329, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=13.7, wall=18896
2023-08-30 04:54:08 | INFO | train_inner | epoch 017:    154 / 1191 loss=1.879, trans_loss=4.662, nll_loss=1.866, w2v_ctc_loss=0.602, task_loss=3.329, contrastive_loss=0.239, total=6698.82, n_correct=4724.93, ppl=3.65, accuracy=70.534, wps=18497.1, ups=1.38, wpb=13397.6, bsz=450.9, num_updates=19200, lr=0.000102062, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=18968
2023-08-30 04:55:21 | INFO | train_inner | epoch 017:    254 / 1191 loss=1.869, trans_loss=4.653, nll_loss=1.854, w2v_ctc_loss=0.598, task_loss=3.126, contrastive_loss=0.191, total=6821.43, n_correct=4827.18, ppl=3.62, accuracy=70.765, wps=18781.9, ups=1.38, wpb=13642.9, bsz=473.7, num_updates=19300, lr=0.000101797, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=10, wall=19041
2023-08-30 04:56:34 | INFO | train_inner | epoch 017:    354 / 1191 loss=1.879, trans_loss=4.667, nll_loss=1.872, w2v_ctc_loss=0.606, task_loss=3.367, contrastive_loss=0.194, total=6643.4, n_correct=4677.58, ppl=3.66, accuracy=70.409, wps=18261.8, ups=1.37, wpb=13286.8, bsz=444.5, num_updates=19400, lr=0.000101535, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=19114
2023-08-30 04:57:47 | INFO | train_inner | epoch 017:    454 / 1191 loss=1.885, trans_loss=4.667, nll_loss=1.872, w2v_ctc_loss=0.608, task_loss=3.357, contrastive_loss=0.242, total=6705.47, n_correct=4719.51, ppl=3.66, accuracy=70.383, wps=18428.9, ups=1.37, wpb=13410.9, bsz=443.5, num_updates=19500, lr=0.000101274, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=19186
2023-08-30 04:59:00 | INFO | train_inner | epoch 017:    554 / 1191 loss=1.888, trans_loss=4.672, nll_loss=1.879, w2v_ctc_loss=0.607, task_loss=3.357, contrastive_loss=0.274, total=6675.84, n_correct=4690.38, ppl=3.68, accuracy=70.259, wps=18234.3, ups=1.37, wpb=13351.7, bsz=440.8, num_updates=19600, lr=0.000101015, gnorm=0.416, clip=0, loss_scale=32, train_wall=73, gb_free=14, wall=19260
2023-08-30 05:00:12 | INFO | train_inner | epoch 017:    654 / 1191 loss=1.879, trans_loss=4.663, nll_loss=1.868, w2v_ctc_loss=0.607, task_loss=3.235, contrastive_loss=0.211, total=6687.04, n_correct=4712.27, ppl=3.65, accuracy=70.469, wps=18576.4, ups=1.39, wpb=13374.1, bsz=458.1, num_updates=19700, lr=0.000100759, gnorm=0.416, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=19332
2023-08-30 05:01:24 | INFO | train_inner | epoch 017:    754 / 1191 loss=1.883, trans_loss=4.67, nll_loss=1.877, w2v_ctc_loss=0.612, task_loss=3.421, contrastive_loss=0.179, total=6671.22, n_correct=4688.77, ppl=3.67, accuracy=70.284, wps=18370.3, ups=1.38, wpb=13342.4, bsz=434.6, num_updates=19800, lr=0.000100504, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=19404
2023-08-30 05:02:38 | INFO | train_inner | epoch 017:    854 / 1191 loss=1.886, trans_loss=4.665, nll_loss=1.87, w2v_ctc_loss=0.609, task_loss=3.577, contrastive_loss=0.272, total=6600.69, n_correct=4648.68, ppl=3.66, accuracy=70.427, wps=18013.8, ups=1.36, wpb=13201.4, bsz=434.3, num_updates=19900, lr=0.000100251, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=13.6, wall=19478
2023-08-30 05:03:50 | INFO | train_inner | epoch 017:    954 / 1191 loss=1.875, trans_loss=4.659, nll_loss=1.863, w2v_ctc_loss=0.587, task_loss=2.871, contrastive_loss=0.33, total=6821.56, n_correct=4820.24, ppl=3.64, accuracy=70.662, wps=18879.5, ups=1.38, wpb=13643.1, bsz=498.7, num_updates=20000, lr=0.0001, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=19550
2023-08-30 05:03:50 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:04:23 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.769 | trans_loss 4.888 | nll_loss 2.108 | w2v_ctc_loss 1.255 | task_loss 11.974 | contrastive_loss 0.435 | total 6138.43 | n_correct 4345.43 | ppl 4.31 | accuracy 70.791 | uer 17.765 | wer 19.305 | raw_wer 19.305 | bleu 28.28 | wps 1738.7 | wpb 6138.4 | bsz 201.1 | num_updates 20000 | best_bleu 28.37
2023-08-30 05:04:23 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20000 updates
2023-08-30 05:04:23 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-30 05:04:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-30 05:04:30 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_17_20000.pt (epoch 17 @ 20000 updates, score 28.28) (writing took 7.540841766007361 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 05:05:44 | INFO | train_inner | epoch 017:   1054 / 1191 loss=1.876, trans_loss=4.658, nll_loss=1.862, w2v_ctc_loss=0.604, task_loss=3.388, contrastive_loss=0.224, total=6652.48, n_correct=4695.34, ppl=3.63, accuracy=70.58, wps=11698.1, ups=0.88, wpb=13305, bsz=441.9, num_updates=20100, lr=9.97509e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=19664
2023-08-30 05:06:57 | INFO | train_inner | epoch 017:   1154 / 1191 loss=1.876, trans_loss=4.659, nll_loss=1.862, w2v_ctc_loss=0.606, task_loss=3.297, contrastive_loss=0.209, total=6757.28, n_correct=4771.84, ppl=3.64, accuracy=70.618, wps=18550.2, ups=1.37, wpb=13514.6, bsz=451.7, num_updates=20200, lr=9.95037e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=19736
2023-08-30 05:07:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
2023-08-30 05:07:56 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.754 | trans_loss 4.888 | nll_loss 2.111 | w2v_ctc_loss 1.21 | task_loss 11.987 | contrastive_loss 0.436 | total 6138.43 | n_correct 4341.29 | ppl 4.32 | accuracy 70.723 | uer 17.838 | wer 19.494 | raw_wer 19.494 | bleu 28.1 | wps 1742.9 | wpb 6138.4 | bsz 201.1 | num_updates 20237 | best_bleu 28.37
2023-08-30 05:07:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20237 updates
2023-08-30 05:07:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.1003.pt
2023-08-30 05:07:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.1003.pt
2023-08-30 05:08:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.1003.pt (epoch 17 @ 20237 updates, score 28.1) (writing took 7.347394237993285 seconds)
2023-08-30 05:08:04 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2023-08-30 05:08:04 | INFO | train | epoch 017 | loss 1.879 | trans_loss 4.663 | nll_loss 1.868 | w2v_ctc_loss 0.604 | task_loss 3.297 | contrastive_loss 0.233 | total 6703.69 | n_correct 4725.41 | ppl 3.65 | accuracy 70.49 | wps 16705.1 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 20237 | lr 9.94127e-05 | gnorm 0.416 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 14 | wall 19804
2023-08-30 05:08:04 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 05:08:04 | INFO | fairseq.trainer | begin training epoch 18
2023-08-30 05:08:04 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 05:08:57 | INFO | train_inner | epoch 018:     63 / 1191 loss=1.865, trans_loss=4.646, nll_loss=1.846, w2v_ctc_loss=0.586, task_loss=3.151, contrastive_loss=0.221, total=6803.5, n_correct=4820.96, ppl=3.6, accuracy=70.86, wps=11282.7, ups=0.83, wpb=13607, bsz=464.9, num_updates=20300, lr=9.92583e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=71, gb_free=13.3, wall=19857
2023-08-30 05:10:10 | INFO | train_inner | epoch 018:    163 / 1191 loss=1.876, trans_loss=4.656, nll_loss=1.859, w2v_ctc_loss=0.605, task_loss=3.666, contrastive_loss=0.19, total=6645.84, n_correct=4691.77, ppl=3.63, accuracy=70.597, wps=18238.3, ups=1.37, wpb=13291.7, bsz=424, num_updates=20400, lr=9.90148e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=19930
2023-08-30 05:11:23 | INFO | train_inner | epoch 018:    263 / 1191 loss=1.876, trans_loss=4.654, nll_loss=1.856, w2v_ctc_loss=0.597, task_loss=3.365, contrastive_loss=0.293, total=6609.1, n_correct=4673.39, ppl=3.62, accuracy=70.711, wps=18168.2, ups=1.37, wpb=13218.2, bsz=445.1, num_updates=20500, lr=9.8773e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=20003
2023-08-30 05:12:36 | INFO | train_inner | epoch 018:    363 / 1191 loss=1.87, trans_loss=4.649, nll_loss=1.849, w2v_ctc_loss=0.593, task_loss=3.246, contrastive_loss=0.259, total=6738.43, n_correct=4773.55, ppl=3.6, accuracy=70.841, wps=18339.4, ups=1.36, wpb=13476.9, bsz=459.9, num_updates=20600, lr=9.85329e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=73, gb_free=11.9, wall=20076
2023-08-30 05:13:49 | INFO | train_inner | epoch 018:    463 / 1191 loss=1.867, trans_loss=4.65, nll_loss=1.852, w2v_ctc_loss=0.59, task_loss=3.246, contrastive_loss=0.209, total=6707.38, n_correct=4752.99, ppl=3.61, accuracy=70.862, wps=18468.9, ups=1.38, wpb=13414.8, bsz=456.1, num_updates=20700, lr=9.82946e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=20149
2023-08-30 05:15:01 | INFO | train_inner | epoch 018:    563 / 1191 loss=1.867, trans_loss=4.65, nll_loss=1.851, w2v_ctc_loss=0.592, task_loss=3.024, contrastive_loss=0.225, total=6841.12, n_correct=4845.79, ppl=3.61, accuracy=70.833, wps=18883.3, ups=1.38, wpb=13682.2, bsz=482, num_updates=20800, lr=9.80581e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=12.5, wall=20221
2023-08-30 05:16:13 | INFO | train_inner | epoch 018:    663 / 1191 loss=1.87, trans_loss=4.648, nll_loss=1.849, w2v_ctc_loss=0.598, task_loss=3.533, contrastive_loss=0.204, total=6567.35, n_correct=4644.93, ppl=3.6, accuracy=70.728, wps=18289.2, ups=1.39, wpb=13134.7, bsz=427.3, num_updates=20900, lr=9.78232e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=71, gb_free=5.6, wall=20293
2023-08-30 05:17:26 | INFO | train_inner | epoch 018:    763 / 1191 loss=1.869, trans_loss=4.654, nll_loss=1.857, w2v_ctc_loss=0.598, task_loss=3.137, contrastive_loss=0.197, total=6835.85, n_correct=4839.27, ppl=3.62, accuracy=70.793, wps=18687.6, ups=1.37, wpb=13671.7, bsz=472.2, num_updates=21000, lr=9.759e-05, gnorm=0.412, clip=0, loss_scale=64, train_wall=73, gb_free=14, wall=20366
2023-08-30 05:18:40 | INFO | train_inner | epoch 018:    863 / 1191 loss=1.878, trans_loss=4.658, nll_loss=1.861, w2v_ctc_loss=0.604, task_loss=3.342, contrastive_loss=0.244, total=6702.18, n_correct=4730.73, ppl=3.63, accuracy=70.585, wps=18187.1, ups=1.36, wpb=13404.4, bsz=448.9, num_updates=21100, lr=9.73585e-05, gnorm=0.417, clip=0, loss_scale=64, train_wall=73, gb_free=13.2, wall=20440
2023-08-30 05:19:53 | INFO | train_inner | epoch 018:    963 / 1191 loss=1.866, trans_loss=4.646, nll_loss=1.846, w2v_ctc_loss=0.599, task_loss=3.219, contrastive_loss=0.181, total=6702.56, n_correct=4749.25, ppl=3.6, accuracy=70.857, wps=18490.4, ups=1.38, wpb=13405.1, bsz=452.7, num_updates=21200, lr=9.71286e-05, gnorm=0.409, clip=0, loss_scale=64, train_wall=72, gb_free=11.1, wall=20512
2023-08-30 05:21:05 | INFO | train_inner | epoch 018:   1063 / 1191 loss=1.876, trans_loss=4.653, nll_loss=1.855, w2v_ctc_loss=0.604, task_loss=3.485, contrastive_loss=0.245, total=6587.43, n_correct=4655.8, ppl=3.62, accuracy=70.677, wps=18241.2, ups=1.38, wpb=13174.9, bsz=434.9, num_updates=21300, lr=9.69003e-05, gnorm=0.413, clip=0, loss_scale=64, train_wall=72, gb_free=14.3, wall=20585
2023-08-30 05:22:18 | INFO | train_inner | epoch 018:   1163 / 1191 loss=1.874, trans_loss=4.651, nll_loss=1.853, w2v_ctc_loss=0.598, task_loss=3.219, contrastive_loss=0.262, total=6769.67, n_correct=4789.75, ppl=3.61, accuracy=70.753, wps=18523.4, ups=1.37, wpb=13539.3, bsz=466.9, num_updates=21400, lr=9.66736e-05, gnorm=0.414, clip=0, loss_scale=64, train_wall=73, gb_free=14.8, wall=20658
2023-08-30 05:22:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:23:11 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 3.761 | trans_loss 4.878 | nll_loss 2.099 | w2v_ctc_loss 1.252 | task_loss 12.001 | contrastive_loss 0.433 | total 6138.43 | n_correct 4356.29 | ppl 4.28 | accuracy 70.967 | uer 17.581 | wer 19.059 | raw_wer 19.059 | bleu 28.65 | wps 1755.9 | wpb 6138.4 | bsz 201.1 | num_updates 21428 | best_bleu 28.65
2023-08-30 05:23:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 21428 updates
2023-08-30 05:23:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 05:23:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 05:23:23 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 18 @ 21428 updates, score 28.65) (writing took 12.908445792010752 seconds)
2023-08-30 05:23:24 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2023-08-30 05:23:24 | INFO | train | epoch 018 | loss 1.871 | trans_loss 4.651 | nll_loss 1.852 | w2v_ctc_loss 0.596 | task_loss 3.298 | contrastive_loss 0.231 | total 6703.69 | n_correct 4744.42 | ppl 3.61 | accuracy 70.773 | wps 17360.6 | ups 1.29 | wpb 13407.4 | bsz 452.1 | num_updates 21428 | lr 9.66105e-05 | gnorm 0.412 | clip 0 | loss_scale 64 | train_wall 859 | gb_free 13.8 | wall 20724
2023-08-30 05:23:24 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 05:23:24 | INFO | fairseq.trainer | begin training epoch 19
2023-08-30 05:23:24 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 05:24:24 | INFO | train_inner | epoch 019:     72 / 1191 loss=1.862, trans_loss=4.638, nll_loss=1.836, w2v_ctc_loss=0.586, task_loss=3.52, contrastive_loss=0.228, total=6585.47, n_correct=4680.14, ppl=3.57, accuracy=71.068, wps=10442.5, ups=0.79, wpb=13170.9, bsz=425.2, num_updates=21500, lr=9.64486e-05, gnorm=0.418, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=20784
2023-08-30 05:25:36 | INFO | train_inner | epoch 019:    172 / 1191 loss=1.852, trans_loss=4.631, nll_loss=1.827, w2v_ctc_loss=0.578, task_loss=3.331, contrastive_loss=0.181, total=6683.38, n_correct=4759.43, ppl=3.55, accuracy=71.213, wps=18481.3, ups=1.38, wpb=13366.8, bsz=446.6, num_updates=21600, lr=9.6225e-05, gnorm=0.411, clip=0, loss_scale=64, train_wall=72, gb_free=12.1, wall=20856
2023-08-30 05:26:50 | INFO | train_inner | epoch 019:    272 / 1191 loss=1.858, trans_loss=4.631, nll_loss=1.827, w2v_ctc_loss=0.585, task_loss=3.138, contrastive_loss=0.234, total=6766.59, n_correct=4817.32, ppl=3.55, accuracy=71.193, wps=18466.4, ups=1.36, wpb=13533.2, bsz=464.3, num_updates=21700, lr=9.60031e-05, gnorm=0.409, clip=0, loss_scale=64, train_wall=73, gb_free=12.9, wall=20930
2023-08-30 05:28:02 | INFO | train_inner | epoch 019:    372 / 1191 loss=1.857, trans_loss=4.639, nll_loss=1.838, w2v_ctc_loss=0.583, task_loss=3.281, contrastive_loss=0.172, total=6694.81, n_correct=4753.03, ppl=3.57, accuracy=70.996, wps=18626, ups=1.39, wpb=13389.6, bsz=444.8, num_updates=21800, lr=9.57826e-05, gnorm=0.411, clip=0, loss_scale=64, train_wall=71, gb_free=14.3, wall=21001
2023-08-30 05:29:15 | INFO | train_inner | epoch 019:    472 / 1191 loss=1.868, trans_loss=4.644, nll_loss=1.843, w2v_ctc_loss=0.589, task_loss=3.084, contrastive_loss=0.282, total=6775.29, n_correct=4803.55, ppl=3.59, accuracy=70.898, wps=18553.4, ups=1.37, wpb=13550.6, bsz=476.3, num_updates=21900, lr=9.55637e-05, gnorm=0.41, clip=0, loss_scale=64, train_wall=72, gb_free=14.5, wall=21074
2023-08-30 05:30:28 | INFO | train_inner | epoch 019:    572 / 1191 loss=1.86, trans_loss=4.643, nll_loss=1.842, w2v_ctc_loss=0.588, task_loss=3.248, contrastive_loss=0.204, total=6762.36, n_correct=4805.22, ppl=3.59, accuracy=71.058, wps=18419.3, ups=1.36, wpb=13524.7, bsz=464.5, num_updates=22000, lr=9.53463e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=73, gb_free=13.7, wall=21148
2023-08-30 05:30:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:31:01 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.75 | trans_loss 4.879 | nll_loss 2.097 | w2v_ctc_loss 1.223 | task_loss 11.942 | contrastive_loss 0.418 | total 6138.43 | n_correct 4354 | ppl 4.28 | accuracy 70.93 | uer 17.321 | wer 18.829 | raw_wer 18.829 | bleu 28.62 | wps 1764.7 | wpb 6138.4 | bsz 201.1 | num_updates 22000 | best_bleu 28.65
2023-08-30 05:31:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22000 updates
2023-08-30 05:31:01 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-30 05:31:02 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-30 05:31:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_19_22000.pt (epoch 19 @ 22000 updates, score 28.62) (writing took 10.520084853997105 seconds)
2023-08-30 05:32:24 | INFO | train_inner | epoch 019:    672 / 1191 loss=1.861, trans_loss=4.636, nll_loss=1.833, w2v_ctc_loss=0.58, task_loss=3.3, contrastive_loss=0.292, total=6661.24, n_correct=4738.87, ppl=3.56, accuracy=71.141, wps=11511.9, ups=0.86, wpb=13322.5, bsz=452.2, num_updates=22100, lr=9.51303e-05, gnorm=0.41, clip=0, loss_scale=64, train_wall=72, gb_free=14.3, wall=21264
2023-08-30 05:33:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 05:33:37 | INFO | train_inner | epoch 019:    773 / 1191 loss=1.865, trans_loss=4.64, nll_loss=1.839, w2v_ctc_loss=0.595, task_loss=3.246, contrastive_loss=0.211, total=6746.02, n_correct=4790.08, ppl=3.58, accuracy=71.006, wps=18323.3, ups=1.36, wpb=13492, bsz=460.3, num_updates=22200, lr=9.49158e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=73, gb_free=11.7, wall=21337
2023-08-30 05:34:50 | INFO | train_inner | epoch 019:    873 / 1191 loss=1.871, trans_loss=4.641, nll_loss=1.84, w2v_ctc_loss=0.597, task_loss=3.41, contrastive_loss=0.27, total=6623.8, n_correct=4698.91, ppl=3.58, accuracy=70.94, wps=18214.8, ups=1.37, wpb=13247.6, bsz=440.7, num_updates=22300, lr=9.47027e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=21410
2023-08-30 05:36:02 | INFO | train_inner | epoch 019:    973 / 1191 loss=1.863, trans_loss=4.636, nll_loss=1.834, w2v_ctc_loss=0.592, task_loss=3.523, contrastive_loss=0.208, total=6611.17, n_correct=4700.57, ppl=3.56, accuracy=71.1, wps=18366.3, ups=1.39, wpb=13222.3, bsz=434.3, num_updates=22400, lr=9.44911e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=71, gb_free=13.2, wall=21482
2023-08-30 05:37:14 | INFO | train_inner | epoch 019:   1073 / 1191 loss=1.866, trans_loss=4.641, nll_loss=1.84, w2v_ctc_loss=0.593, task_loss=3.213, contrastive_loss=0.23, total=6738.74, n_correct=4785.15, ppl=3.58, accuracy=71.01, wps=18739.2, ups=1.39, wpb=13477.5, bsz=455.1, num_updates=22500, lr=9.42809e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=71, gb_free=13.9, wall=21554
2023-08-30 05:38:28 | INFO | train_inner | epoch 019:   1173 / 1191 loss=1.871, trans_loss=4.651, nll_loss=1.853, w2v_ctc_loss=0.593, task_loss=3.276, contrastive_loss=0.256, total=6789.71, n_correct=4807.29, ppl=3.61, accuracy=70.803, wps=18429.7, ups=1.36, wpb=13579.4, bsz=457.9, num_updates=22600, lr=9.40721e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=73, gb_free=14.2, wall=21628
2023-08-30 05:38:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:39:13 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.756 | trans_loss 4.881 | nll_loss 2.101 | w2v_ctc_loss 1.235 | task_loss 11.949 | contrastive_loss 0.427 | total 6138.43 | n_correct 4355.57 | ppl 4.29 | accuracy 70.956 | uer 17.34 | wer 18.907 | raw_wer 18.907 | bleu 28.77 | wps 1767.4 | wpb 6138.4 | bsz 201.1 | num_updates 22618 | best_bleu 28.77
2023-08-30 05:39:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22618 updates
2023-08-30 05:39:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 05:39:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 05:39:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 19 @ 22618 updates, score 28.77) (writing took 11.92283801099984 seconds)
2023-08-30 05:39:25 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2023-08-30 05:39:25 | INFO | train | epoch 019 | loss 1.863 | trans_loss 4.639 | nll_loss 1.838 | w2v_ctc_loss 0.589 | task_loss 3.297 | contrastive_loss 0.229 | total 6703.37 | n_correct 4761.64 | ppl 3.57 | accuracy 71.034 | wps 16594 | ups 1.24 | wpb 13406.7 | bsz 452.2 | num_updates 22618 | lr 9.40346e-05 | gnorm 0.412 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 14.3 | wall 21685
2023-08-30 05:39:26 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 05:39:26 | INFO | fairseq.trainer | begin training epoch 20
2023-08-30 05:39:26 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 05:40:33 | INFO | train_inner | epoch 020:     82 / 1191 loss=1.853, trans_loss=4.624, nll_loss=1.818, w2v_ctc_loss=0.582, task_loss=3.336, contrastive_loss=0.214, total=6693.71, n_correct=4771.75, ppl=3.53, accuracy=71.287, wps=10679.5, ups=0.8, wpb=13387.4, bsz=451.9, num_updates=22700, lr=9.38647e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=73, gb_free=13.5, wall=21753
2023-08-30 05:41:46 | INFO | train_inner | epoch 020:    182 / 1191 loss=1.854, trans_loss=4.623, nll_loss=1.816, w2v_ctc_loss=0.58, task_loss=3.422, contrastive_loss=0.231, total=6599.88, n_correct=4710.63, ppl=3.52, accuracy=71.374, wps=18188.7, ups=1.38, wpb=13199.8, bsz=438.3, num_updates=22800, lr=9.36586e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=14.9, wall=21826
2023-08-30 05:42:58 | INFO | train_inner | epoch 020:    282 / 1191 loss=1.857, trans_loss=4.632, nll_loss=1.828, w2v_ctc_loss=0.581, task_loss=3.269, contrastive_loss=0.236, total=6767.67, n_correct=4817.79, ppl=3.55, accuracy=71.188, wps=18715.7, ups=1.38, wpb=13535.3, bsz=457.2, num_updates=22900, lr=9.34539e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=21898
2023-08-30 05:44:10 | INFO | train_inner | epoch 020:    382 / 1191 loss=1.855, trans_loss=4.632, nll_loss=1.829, w2v_ctc_loss=0.585, task_loss=3.115, contrastive_loss=0.186, total=6794.56, n_correct=4839.38, ppl=3.55, accuracy=71.224, wps=18933.1, ups=1.39, wpb=13589.1, bsz=468.7, num_updates=23000, lr=9.32505e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=71, gb_free=13.8, wall=21970
2023-08-30 05:45:22 | INFO | train_inner | epoch 020:    482 / 1191 loss=1.852, trans_loss=4.623, nll_loss=1.817, w2v_ctc_loss=0.581, task_loss=3.288, contrastive_loss=0.217, total=6694, n_correct=4773.71, ppl=3.52, accuracy=71.313, wps=18438.9, ups=1.38, wpb=13388, bsz=446.1, num_updates=23100, lr=9.30484e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=11.6, wall=22042
2023-08-30 05:46:35 | INFO | train_inner | epoch 020:    582 / 1191 loss=1.868, trans_loss=4.632, nll_loss=1.829, w2v_ctc_loss=0.589, task_loss=3.405, contrastive_loss=0.328, total=6622.52, n_correct=4711.2, ppl=3.55, accuracy=71.139, wps=18222.8, ups=1.38, wpb=13245, bsz=442.4, num_updates=23200, lr=9.28477e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=22115
2023-08-30 05:47:47 | INFO | train_inner | epoch 020:    682 / 1191 loss=1.85, trans_loss=4.626, nll_loss=1.821, w2v_ctc_loss=0.569, task_loss=3.094, contrastive_loss=0.266, total=6711.24, n_correct=4793.28, ppl=3.53, accuracy=71.422, wps=18557.8, ups=1.38, wpb=13422.5, bsz=470.5, num_updates=23300, lr=9.26482e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=22187
2023-08-30 05:49:00 | INFO | train_inner | epoch 020:    782 / 1191 loss=1.856, trans_loss=4.629, nll_loss=1.825, w2v_ctc_loss=0.581, task_loss=3.159, contrastive_loss=0.228, total=6749.91, n_correct=4812.34, ppl=3.54, accuracy=71.295, wps=18654.3, ups=1.38, wpb=13499.8, bsz=458.6, num_updates=23400, lr=9.245e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=22260
2023-08-30 05:50:13 | INFO | train_inner | epoch 020:    882 / 1191 loss=1.855, trans_loss=4.628, nll_loss=1.823, w2v_ctc_loss=0.586, task_loss=3.387, contrastive_loss=0.192, total=6725.15, n_correct=4795.03, ppl=3.54, accuracy=71.3, wps=18469.4, ups=1.37, wpb=13450.3, bsz=447.2, num_updates=23500, lr=9.22531e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=22332
2023-08-30 05:51:26 | INFO | train_inner | epoch 020:    982 / 1191 loss=1.852, trans_loss=4.627, nll_loss=1.823, w2v_ctc_loss=0.577, task_loss=3.553, contrastive_loss=0.181, total=6666.28, n_correct=4750.92, ppl=3.54, accuracy=71.268, wps=18224.3, ups=1.37, wpb=13332.6, bsz=433.5, num_updates=23600, lr=9.20575e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=22406
2023-08-30 05:52:39 | INFO | train_inner | epoch 020:   1082 / 1191 loss=1.854, trans_loss=4.628, nll_loss=1.824, w2v_ctc_loss=0.588, task_loss=3.251, contrastive_loss=0.177, total=6748.86, n_correct=4807.9, ppl=3.54, accuracy=71.24, wps=18497.4, ups=1.37, wpb=13497.7, bsz=458, num_updates=23700, lr=9.1863e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=22479
2023-08-30 05:53:52 | INFO | train_inner | epoch 020:   1182 / 1191 loss=1.859, trans_loss=4.636, nll_loss=1.834, w2v_ctc_loss=0.585, task_loss=3.329, contrastive_loss=0.224, total=6683.47, n_correct=4751.33, ppl=3.56, accuracy=71.091, wps=18171.6, ups=1.36, wpb=13366.9, bsz=452.7, num_updates=23800, lr=9.16698e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=73, gb_free=13.9, wall=22552
2023-08-30 05:53:59 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:54:31 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 3.739 | trans_loss 4.869 | nll_loss 2.085 | w2v_ctc_loss 1.202 | task_loss 12.031 | contrastive_loss 0.432 | total 6138.43 | n_correct 4366 | ppl 4.24 | accuracy 71.126 | uer 17.166 | wer 18.672 | raw_wer 18.672 | bleu 28.68 | wps 1764.3 | wpb 6138.4 | bsz 201.1 | num_updates 23809 | best_bleu 28.77
2023-08-30 05:54:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 23809 updates
2023-08-30 05:54:31 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6800.pt
2023-08-30 05:54:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6800.pt
2023-08-30 05:54:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6800.pt (epoch 20 @ 23809 updates, score 28.68) (writing took 7.676908723980887 seconds)
2023-08-30 05:54:39 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2023-08-30 05:54:39 | INFO | train | epoch 020 | loss 1.855 | trans_loss 4.628 | nll_loss 1.824 | w2v_ctc_loss 0.582 | task_loss 3.297 | contrastive_loss 0.227 | total 6703.69 | n_correct 4777 | ppl 3.54 | accuracy 71.259 | wps 17478 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 23809 | lr 9.16525e-05 | gnorm 0.412 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 15.2 | wall 22599
2023-08-30 05:54:39 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 05:54:39 | INFO | fairseq.trainer | begin training epoch 21
2023-08-30 05:54:39 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 05:55:53 | INFO | train_inner | epoch 021:     91 / 1191 loss=1.848, trans_loss=4.615, nll_loss=1.807, w2v_ctc_loss=0.564, task_loss=3.09, contrastive_loss=0.337, total=6760.63, n_correct=4841.65, ppl=3.5, accuracy=71.615, wps=11224.2, ups=0.83, wpb=13521.3, bsz=474.7, num_updates=23900, lr=9.14779e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=22673
2023-08-30 05:57:05 | INFO | train_inner | epoch 021:    191 / 1191 loss=1.839, trans_loss=4.609, nll_loss=1.799, w2v_ctc_loss=0.567, task_loss=3.103, contrastive_loss=0.204, total=6783.08, n_correct=4866.25, ppl=3.48, accuracy=71.741, wps=18728, ups=1.38, wpb=13566.2, bsz=471.6, num_updates=24000, lr=9.12871e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=22745
2023-08-30 05:57:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 05:57:38 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.739 | trans_loss 4.875 | nll_loss 2.095 | w2v_ctc_loss 1.188 | task_loss 11.902 | contrastive_loss 0.437 | total 6138.43 | n_correct 4363.57 | ppl 4.27 | accuracy 71.086 | uer 17.156 | wer 18.784 | raw_wer 18.784 | bleu 28.73 | wps 1750.8 | wpb 6138.4 | bsz 201.1 | num_updates 24000 | best_bleu 28.77
2023-08-30 05:57:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24000 updates
2023-08-30 05:57:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-30 05:57:40 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-30 05:57:45 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_21_24000.pt (epoch 21 @ 24000 updates, score 28.73) (writing took 7.212942540005315 seconds)
2023-08-30 05:58:57 | INFO | train_inner | epoch 021:    291 / 1191 loss=1.844, trans_loss=4.614, nll_loss=1.804, w2v_ctc_loss=0.576, task_loss=3.419, contrastive_loss=0.169, total=6641.78, n_correct=4754.88, ppl=3.49, accuracy=71.59, wps=11837, ups=0.89, wpb=13283.6, bsz=436, num_updates=24100, lr=9.10975e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=71, gb_free=15.2, wall=22857
2023-08-30 06:00:10 | INFO | train_inner | epoch 021:    391 / 1191 loss=1.844, trans_loss=4.618, nll_loss=1.811, w2v_ctc_loss=0.571, task_loss=3.336, contrastive_loss=0.189, total=6675.38, n_correct=4776.52, ppl=3.51, accuracy=71.554, wps=18453.1, ups=1.38, wpb=13350.8, bsz=450.4, num_updates=24200, lr=9.09091e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=12.4, wall=22930
2023-08-30 06:01:23 | INFO | train_inner | epoch 021:    491 / 1191 loss=1.849, trans_loss=4.615, nll_loss=1.806, w2v_ctc_loss=0.577, task_loss=3.449, contrastive_loss=0.207, total=6679.69, n_correct=4775.36, ppl=3.5, accuracy=71.491, wps=18248.6, ups=1.37, wpb=13359.4, bsz=437.8, num_updates=24300, lr=9.07218e-05, gnorm=0.409, clip=0, loss_scale=64, train_wall=73, gb_free=13, wall=23003
2023-08-30 06:02:36 | INFO | train_inner | epoch 021:    591 / 1191 loss=1.852, trans_loss=4.62, nll_loss=1.813, w2v_ctc_loss=0.585, task_loss=3.543, contrastive_loss=0.169, total=6618.89, n_correct=4727.12, ppl=3.51, accuracy=71.419, wps=18252.8, ups=1.38, wpb=13237.8, bsz=424, num_updates=24400, lr=9.05357e-05, gnorm=0.413, clip=0, loss_scale=64, train_wall=72, gb_free=12.8, wall=23075
2023-08-30 06:03:48 | INFO | train_inner | epoch 021:    691 / 1191 loss=1.854, trans_loss=4.623, nll_loss=1.817, w2v_ctc_loss=0.58, task_loss=3.246, contrastive_loss=0.248, total=6724.83, n_correct=4803.05, ppl=3.52, accuracy=71.423, wps=18460.9, ups=1.37, wpb=13449.7, bsz=465.4, num_updates=24500, lr=9.03508e-05, gnorm=0.411, clip=0, loss_scale=64, train_wall=72, gb_free=7.4, wall=23148
2023-08-30 06:05:01 | INFO | train_inner | epoch 021:    791 / 1191 loss=1.854, trans_loss=4.622, nll_loss=1.815, w2v_ctc_loss=0.574, task_loss=3.43, contrastive_loss=0.288, total=6629.21, n_correct=4731.98, ppl=3.52, accuracy=71.381, wps=18265.4, ups=1.38, wpb=13258.4, bsz=443.8, num_updates=24600, lr=9.0167e-05, gnorm=0.41, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=23221
2023-08-30 06:05:43 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 06:06:14 | INFO | train_inner | epoch 021:    892 / 1191 loss=1.852, trans_loss=4.619, nll_loss=1.812, w2v_ctc_loss=0.578, task_loss=3.296, contrastive_loss=0.238, total=6721.68, n_correct=4800, ppl=3.51, accuracy=71.411, wps=18326.9, ups=1.36, wpb=13443.4, bsz=449.9, num_updates=24700, lr=8.99843e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=73, gb_free=12.3, wall=23294
2023-08-30 06:07:28 | INFO | train_inner | epoch 021:    992 / 1191 loss=1.851, trans_loss=4.626, nll_loss=1.821, w2v_ctc_loss=0.574, task_loss=3.141, contrastive_loss=0.236, total=6803.81, n_correct=4858.03, ppl=3.53, accuracy=71.402, wps=18572.5, ups=1.36, wpb=13607.6, bsz=465.2, num_updates=24800, lr=8.98027e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=73, gb_free=12.7, wall=23367
2023-08-30 06:08:41 | INFO | train_inner | epoch 021:   1092 / 1191 loss=1.85, trans_loss=4.622, nll_loss=1.816, w2v_ctc_loss=0.577, task_loss=3.203, contrastive_loss=0.217, total=6727.98, n_correct=4803.08, ppl=3.52, accuracy=71.39, wps=18455.7, ups=1.37, wpb=13456, bsz=457.5, num_updates=24900, lr=8.96221e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=23440
2023-08-30 06:09:52 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 06:10:25 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.743 | trans_loss 4.869 | nll_loss 2.085 | w2v_ctc_loss 1.213 | task_loss 11.996 | contrastive_loss 0.432 | total 6138.43 | n_correct 4374 | ppl 4.24 | accuracy 71.256 | uer 17.185 | wer 18.803 | raw_wer 18.803 | bleu 28.6 | wps 1746.8 | wpb 6138.4 | bsz 201.1 | num_updates 24999 | best_bleu 28.77
2023-08-30 06:10:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24999 updates
2023-08-30 06:10:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6001.pt
2023-08-30 06:10:28 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6001.pt
2023-08-30 06:10:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.6001.pt (epoch 21 @ 24999 updates, score 28.6) (writing took 7.875603071996011 seconds)
2023-08-30 06:10:33 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2023-08-30 06:10:33 | INFO | train | epoch 021 | loss 1.848 | trans_loss 4.618 | nll_loss 1.811 | w2v_ctc_loss 0.575 | task_loss 3.3 | contrastive_loss 0.226 | total 6702.63 | n_correct 4792 | ppl 3.51 | accuracy 71.494 | wps 16720.4 | ups 1.25 | wpb 13405.3 | bsz 452 | num_updates 24999 | lr 8.94445e-05 | gnorm 0.41 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 13.4 | wall 23553
2023-08-30 06:10:33 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 06:10:33 | INFO | fairseq.trainer | begin training epoch 22
2023-08-30 06:10:33 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 06:10:41 | INFO | train_inner | epoch 022:      1 / 1191 loss=1.85, trans_loss=4.62, nll_loss=1.813, w2v_ctc_loss=0.574, task_loss=3.345, contrastive_loss=0.244, total=6667.93, n_correct=4764.98, ppl=3.51, accuracy=71.461, wps=11048.3, ups=0.83, wpb=13335.9, bsz=453.9, num_updates=25000, lr=8.94427e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=10.5, wall=23561
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 06:11:54 | INFO | train_inner | epoch 022:    101 / 1191 loss=1.83, trans_loss=4.601, nll_loss=1.788, w2v_ctc_loss=0.556, task_loss=3.24, contrastive_loss=0.187, total=6752.63, n_correct=4857.41, ppl=3.45, accuracy=71.934, wps=18680.9, ups=1.38, wpb=13505.3, bsz=456.3, num_updates=25100, lr=8.92644e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=23633
2023-08-30 06:13:06 | INFO | train_inner | epoch 022:    201 / 1191 loss=1.84, trans_loss=4.607, nll_loss=1.796, w2v_ctc_loss=0.566, task_loss=3.393, contrastive_loss=0.212, total=6655.06, n_correct=4771.86, ppl=3.47, accuracy=71.703, wps=18251.4, ups=1.37, wpb=13310.1, bsz=443.4, num_updates=25200, lr=8.90871e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=12, wall=23706
2023-08-30 06:14:19 | INFO | train_inner | epoch 022:    301 / 1191 loss=1.841, trans_loss=4.608, nll_loss=1.798, w2v_ctc_loss=0.565, task_loss=3.171, contrastive_loss=0.253, total=6760.33, n_correct=4852.99, ppl=3.48, accuracy=71.786, wps=18573.3, ups=1.37, wpb=13520.7, bsz=469.7, num_updates=25300, lr=8.89108e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=23779
2023-08-30 06:15:32 | INFO | train_inner | epoch 022:    401 / 1191 loss=1.839, trans_loss=4.606, nll_loss=1.796, w2v_ctc_loss=0.574, task_loss=3.29, contrastive_loss=0.184, total=6660.25, n_correct=4776.28, ppl=3.47, accuracy=71.713, wps=18246.6, ups=1.37, wpb=13320.5, bsz=455.7, num_updates=25400, lr=8.87357e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=15.1, wall=23852
2023-08-30 06:16:45 | INFO | train_inner | epoch 022:    501 / 1191 loss=1.849, trans_loss=4.615, nll_loss=1.806, w2v_ctc_loss=0.579, task_loss=3.278, contrastive_loss=0.244, total=6720.12, n_correct=4810.14, ppl=3.5, accuracy=71.578, wps=18555.2, ups=1.38, wpb=13440.2, bsz=457.6, num_updates=25500, lr=8.85615e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=23925
2023-08-30 06:17:58 | INFO | train_inner | epoch 022:    601 / 1191 loss=1.841, trans_loss=4.611, nll_loss=1.802, w2v_ctc_loss=0.571, task_loss=3.353, contrastive_loss=0.182, total=6704.25, n_correct=4802.6, ppl=3.49, accuracy=71.635, wps=18371.7, ups=1.37, wpb=13408.5, bsz=447.4, num_updates=25600, lr=8.83883e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=10.2, wall=23998
2023-08-30 06:19:10 | INFO | train_inner | epoch 022:    701 / 1191 loss=1.84, trans_loss=4.608, nll_loss=1.798, w2v_ctc_loss=0.563, task_loss=3.211, contrastive_loss=0.248, total=6710.51, n_correct=4812.34, ppl=3.48, accuracy=71.713, wps=18498, ups=1.38, wpb=13421, bsz=454.9, num_updates=25700, lr=8.82162e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=14.9, wall=24070
2023-08-30 06:20:22 | INFO | train_inner | epoch 022:    801 / 1191 loss=1.839, trans_loss=4.604, nll_loss=1.793, w2v_ctc_loss=0.565, task_loss=3.442, contrastive_loss=0.235, total=6572.69, n_correct=4719.93, ppl=3.46, accuracy=71.811, wps=18288, ups=1.39, wpb=13145.4, bsz=434.8, num_updates=25800, lr=8.80451e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=71, gb_free=11.6, wall=24142
2023-08-30 06:21:36 | INFO | train_inner | epoch 022:    901 / 1191 loss=1.855, trans_loss=4.618, nll_loss=1.811, w2v_ctc_loss=0.576, task_loss=3.336, contrastive_loss=0.305, total=6701.42, n_correct=4783.71, ppl=3.51, accuracy=71.384, wps=18099.3, ups=1.35, wpb=13402.8, bsz=452.1, num_updates=25900, lr=8.7875e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=74, gb_free=12.5, wall=24216
2023-08-30 06:22:49 | INFO | train_inner | epoch 022:   1001 / 1191 loss=1.841, trans_loss=4.61, nll_loss=1.8, w2v_ctc_loss=0.568, task_loss=3.131, contrastive_loss=0.209, total=6847.97, n_correct=4910.82, ppl=3.48, accuracy=71.712, wps=18862.2, ups=1.38, wpb=13695.9, bsz=468.2, num_updates=26000, lr=8.77058e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=24289
2023-08-30 06:22:49 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
2023-08-30 06:23:21 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.726 | trans_loss 4.869 | nll_loss 2.085 | w2v_ctc_loss 1.161 | task_loss 12.001 | contrastive_loss 0.429 | total 6138.43 | n_correct 4369.14 | ppl 4.24 | accuracy 71.177 | uer 17.188 | wer 18.71 | raw_wer 18.71 | bleu 28.45 | wps 1746.2 | wpb 6138.4 | bsz 201.1 | num_updates 26000 | best_bleu 28.77
2023-08-30 06:23:21 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26000 updates
2023-08-30 06:23:21 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-30 06:23:24 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-30 06:23:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_22_26000.pt (epoch 22 @ 26000 updates, score 28.45) (writing took 9.292184773017652 seconds)
2023-08-30 06:24:43 | INFO | train_inner | epoch 022:   1101 / 1191 loss=1.84, trans_loss=4.608, nll_loss=1.798, w2v_ctc_loss=0.568, task_loss=3.285, contrastive_loss=0.21, total=6699.81, n_correct=4803.91, ppl=3.48, accuracy=71.702, wps=11736.8, ups=0.88, wpb=13399.6, bsz=447.9, num_updates=26100, lr=8.75376e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=71, gb_free=12.9, wall=24403
2023-08-30 06:25:49 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 06:26:21 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.739 | trans_loss 4.867 | nll_loss 2.083 | w2v_ctc_loss 1.208 | task_loss 12.054 | contrastive_loss 0.426 | total 6138.43 | n_correct 4371.29 | ppl 4.24 | accuracy 71.212 | uer 17.185 | wer 18.836 | raw_wer 18.836 | bleu 28.7 | wps 1749.7 | wpb 6138.4 | bsz 201.1 | num_updates 26190 | best_bleu 28.77
2023-08-30 06:26:21 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26190 updates
2023-08-30 06:26:21 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.7003.pt
2023-08-30 06:26:24 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.7003.pt
2023-08-30 06:26:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.7003.pt (epoch 22 @ 26190 updates, score 28.7) (writing took 7.672425385011593 seconds)
2023-08-30 06:26:30 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2023-08-30 06:26:30 | INFO | train | epoch 022 | loss 1.842 | trans_loss 4.609 | nll_loss 1.799 | w2v_ctc_loss 0.569 | task_loss 3.297 | contrastive_loss 0.224 | total 6703.69 | n_correct 4805.52 | ppl 3.48 | accuracy 71.685 | wps 16692.7 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 26190 | lr 8.73871e-05 | gnorm 0.411 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.5 | wall 24510
2023-08-30 06:26:30 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 06:26:30 | INFO | fairseq.trainer | begin training epoch 23
2023-08-30 06:26:30 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 06:26:45 | INFO | train_inner | epoch 023:     10 / 1191 loss=1.848, trans_loss=4.616, nll_loss=1.808, w2v_ctc_loss=0.575, task_loss=3.519, contrastive_loss=0.21, total=6653.96, n_correct=4760.75, ppl=3.5, accuracy=71.548, wps=10906, ups=0.82, wpb=13307.9, bsz=432.5, num_updates=26200, lr=8.73704e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=24525
2023-08-30 06:27:58 | INFO | train_inner | epoch 023:    110 / 1191 loss=1.833, trans_loss=4.594, nll_loss=1.779, w2v_ctc_loss=0.562, task_loss=3.438, contrastive_loss=0.202, total=6649.43, n_correct=4788.67, ppl=3.43, accuracy=72.016, wps=18183.7, ups=1.37, wpb=13298.9, bsz=438.7, num_updates=26300, lr=8.72041e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=73, gb_free=5.3, wall=24598
2023-08-30 06:29:11 | INFO | train_inner | epoch 023:    210 / 1191 loss=1.833, trans_loss=4.6, nll_loss=1.788, w2v_ctc_loss=0.564, task_loss=3.119, contrastive_loss=0.199, total=6807.79, n_correct=4896.25, ppl=3.45, accuracy=71.921, wps=18643.1, ups=1.37, wpb=13615.6, bsz=473.5, num_updates=26400, lr=8.70388e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=13.7, wall=24671
2023-08-30 06:30:24 | INFO | train_inner | epoch 023:    310 / 1191 loss=1.823, trans_loss=4.591, nll_loss=1.776, w2v_ctc_loss=0.551, task_loss=3.144, contrastive_loss=0.164, total=6819.51, n_correct=4918.7, ppl=3.43, accuracy=72.127, wps=18813.5, ups=1.38, wpb=13639, bsz=464, num_updates=26500, lr=8.68744e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=72, gb_free=11.3, wall=24744
2023-08-30 06:31:37 | INFO | train_inner | epoch 023:    410 / 1191 loss=1.843, trans_loss=4.606, nll_loss=1.795, w2v_ctc_loss=0.563, task_loss=3.388, contrastive_loss=0.278, total=6727.48, n_correct=4822.74, ppl=3.47, accuracy=71.687, wps=18439.4, ups=1.37, wpb=13455, bsz=442.9, num_updates=26600, lr=8.6711e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=24817
2023-08-30 06:31:55 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-30 06:32:50 | INFO | train_inner | epoch 023:    511 / 1191 loss=1.833, trans_loss=4.598, nll_loss=1.785, w2v_ctc_loss=0.557, task_loss=3.267, contrastive_loss=0.236, total=6709.59, n_correct=4828.68, ppl=3.45, accuracy=71.967, wps=18204.1, ups=1.36, wpb=13419.2, bsz=452.9, num_updates=26700, lr=8.65485e-05, gnorm=0.407, clip=0, loss_scale=16, train_wall=73, gb_free=11.6, wall=24890
2023-08-30 06:34:03 | INFO | train_inner | epoch 023:    611 / 1191 loss=1.84, trans_loss=4.606, nll_loss=1.796, w2v_ctc_loss=0.568, task_loss=3.227, contrastive_loss=0.23, total=6678.91, n_correct=4797.62, ppl=3.47, accuracy=71.832, wps=18394.8, ups=1.38, wpb=13357.8, bsz=454.7, num_updates=26800, lr=8.63868e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=24963
2023-08-30 06:35:16 | INFO | train_inner | epoch 023:    711 / 1191 loss=1.838, trans_loss=4.601, nll_loss=1.789, w2v_ctc_loss=0.558, task_loss=3.421, contrastive_loss=0.277, total=6649.4, n_correct=4780.22, ppl=3.45, accuracy=71.889, wps=18285.7, ups=1.37, wpb=13298.8, bsz=440.6, num_updates=26900, lr=8.62261e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=72, gb_free=11.6, wall=25036
2023-08-30 06:36:29 | INFO | train_inner | epoch 023:    811 / 1191 loss=1.836, trans_loss=4.604, nll_loss=1.793, w2v_ctc_loss=0.567, task_loss=3.351, contrastive_loss=0.185, total=6727.03, n_correct=4828.21, ppl=3.46, accuracy=71.773, wps=18444.1, ups=1.37, wpb=13454.1, bsz=447.9, num_updates=27000, lr=8.60663e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=25109
2023-08-30 06:37:41 | INFO | train_inner | epoch 023:    911 / 1191 loss=1.829, trans_loss=4.592, nll_loss=1.778, w2v_ctc_loss=0.564, task_loss=3.177, contrastive_loss=0.178, total=6708.05, n_correct=4837.31, ppl=3.43, accuracy=72.112, wps=18617.9, ups=1.39, wpb=13416.1, bsz=464, num_updates=27100, lr=8.59074e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=72, gb_free=13.4, wall=25181
2023-08-30 06:38:53 | INFO | train_inner | epoch 023:   1011 / 1191 loss=1.834, trans_loss=4.598, nll_loss=1.786, w2v_ctc_loss=0.564, task_loss=3.152, contrastive_loss=0.229, total=6677.72, n_correct=4808.32, ppl=3.45, accuracy=72.005, wps=18412.5, ups=1.38, wpb=13355.4, bsz=465.6, num_updates=27200, lr=8.57493e-05, gnorm=0.407, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=25253
2023-08-30 06:40:06 | INFO | train_inner | epoch 023:   1111 / 1191 loss=1.838, trans_loss=4.605, nll_loss=1.795, w2v_ctc_loss=0.563, task_loss=3.433, contrastive_loss=0.219, total=6653.85, n_correct=4778.11, ppl=3.47, accuracy=71.81, wps=18290.4, ups=1.37, wpb=13307.7, bsz=443.4, num_updates=27300, lr=8.55921e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=12.9, wall=25326
2023-08-30 06:41:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 06:41:38 | INFO | dev_st | epoch 023 | valid on 'dev_st' subset | loss 3.733 | trans_loss 4.863 | nll_loss 2.078 | w2v_ctc_loss 1.202 | task_loss 12.016 | contrastive_loss 0.423 | total 6138.43 | n_correct 4375.14 | ppl 4.22 | accuracy 71.275 | uer 17.054 | wer 18.46 | raw_wer 18.46 | bleu 29.06 | wps 1730.2 | wpb 6138.4 | bsz 201.1 | num_updates 27380 | best_bleu 29.06
2023-08-30 06:41:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 27380 updates
2023-08-30 06:41:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 06:41:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 06:41:50 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 23 @ 27380 updates, score 29.06) (writing took 11.938214427995263 seconds)
2023-08-30 06:41:50 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2023-08-30 06:41:50 | INFO | train | epoch 023 | loss 1.835 | trans_loss 4.6 | nll_loss 1.788 | w2v_ctc_loss 0.562 | task_loss 3.294 | contrastive_loss 0.222 | total 6704.23 | n_correct 4820.92 | ppl 3.45 | accuracy 71.909 | wps 17342.8 | ups 1.29 | wpb 13408.5 | bsz 452.3 | num_updates 27380 | lr 8.5467e-05 | gnorm 0.41 | clip 0 | loss_scale 16 | train_wall 861 | gb_free 14.5 | wall 25430
2023-08-30 06:41:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 06:41:50 | INFO | fairseq.trainer | begin training epoch 24
2023-08-30 06:41:50 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 06:42:11 | INFO | train_inner | epoch 024:     20 / 1191 loss=1.842, trans_loss=4.603, nll_loss=1.792, w2v_ctc_loss=0.568, task_loss=3.45, contrastive_loss=0.26, total=6651.7, n_correct=4773.56, ppl=3.46, accuracy=71.765, wps=10641.6, ups=0.8, wpb=13303.4, bsz=438.9, num_updates=27400, lr=8.54358e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=73, gb_free=14, wall=25451
2023-08-30 06:43:23 | INFO | train_inner | epoch 024:    120 / 1191 loss=1.827, trans_loss=4.592, nll_loss=1.778, w2v_ctc_loss=0.553, task_loss=3.123, contrastive_loss=0.222, total=6758.03, n_correct=4870, ppl=3.43, accuracy=72.062, wps=18703.3, ups=1.38, wpb=13516.1, bsz=474.7, num_updates=27500, lr=8.52803e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=72, gb_free=12.4, wall=25523
2023-08-30 06:44:36 | INFO | train_inner | epoch 024:    220 / 1191 loss=1.824, trans_loss=4.587, nll_loss=1.772, w2v_ctc_loss=0.542, task_loss=2.992, contrastive_loss=0.288, total=6822.55, n_correct=4926.74, ppl=3.41, accuracy=72.213, wps=18859.8, ups=1.38, wpb=13645.1, bsz=482.1, num_updates=27600, lr=8.51257e-05, gnorm=0.397, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=25596
2023-08-30 06:45:48 | INFO | train_inner | epoch 024:    320 / 1191 loss=1.832, trans_loss=4.593, nll_loss=1.779, w2v_ctc_loss=0.56, task_loss=3.295, contrastive_loss=0.231, total=6734.94, n_correct=4853.47, ppl=3.43, accuracy=72.064, wps=18508.7, ups=1.37, wpb=13469.9, bsz=451.2, num_updates=27700, lr=8.49719e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=25668
2023-08-30 06:47:01 | INFO | train_inner | epoch 024:    420 / 1191 loss=1.829, trans_loss=4.591, nll_loss=1.776, w2v_ctc_loss=0.555, task_loss=3.48, contrastive_loss=0.192, total=6651.41, n_correct=4798.59, ppl=3.43, accuracy=72.144, wps=18355, ups=1.38, wpb=13302.8, bsz=434, num_updates=27800, lr=8.48189e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=72, gb_free=9.8, wall=25741
2023-08-30 06:48:15 | INFO | train_inner | epoch 024:    520 / 1191 loss=1.837, trans_loss=4.595, nll_loss=1.781, w2v_ctc_loss=0.561, task_loss=3.386, contrastive_loss=0.289, total=6662.72, n_correct=4795.06, ppl=3.44, accuracy=71.969, wps=18026.7, ups=1.35, wpb=13325.4, bsz=456, num_updates=27900, lr=8.46668e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=73, gb_free=11.6, wall=25815
2023-08-30 06:49:26 | INFO | train_inner | epoch 024:    620 / 1191 loss=1.832, trans_loss=4.592, nll_loss=1.777, w2v_ctc_loss=0.565, task_loss=3.586, contrastive_loss=0.159, total=6539.14, n_correct=4705.64, ppl=3.43, accuracy=71.961, wps=18392.8, ups=1.41, wpb=13078.3, bsz=417.5, num_updates=28000, lr=8.45154e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=71, gb_free=14.1, wall=25886
2023-08-30 06:49:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 06:49:58 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.758 | trans_loss 4.872 | nll_loss 2.088 | w2v_ctc_loss 1.263 | task_loss 11.991 | contrastive_loss 0.419 | total 6138.43 | n_correct 4370 | ppl 4.25 | accuracy 71.191 | uer 17.316 | wer 18.84 | raw_wer 18.84 | bleu 28.47 | wps 1757.3 | wpb 6138.4 | bsz 201.1 | num_updates 28000 | best_bleu 29.06
2023-08-30 06:49:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28000 updates
2023-08-30 06:49:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-30 06:50:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-30 06:50:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_24_28000.pt (epoch 24 @ 28000 updates, score 28.47) (writing took 8.493292806000682 seconds)
2023-08-30 06:51:20 | INFO | train_inner | epoch 024:    720 / 1191 loss=1.83, trans_loss=4.591, nll_loss=1.777, w2v_ctc_loss=0.56, task_loss=3.116, contrastive_loss=0.219, total=6750.17, n_correct=4866.16, ppl=3.43, accuracy=72.089, wps=11860.9, ups=0.88, wpb=13500.3, bsz=470.4, num_updates=28100, lr=8.43649e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=26000
2023-08-30 06:52:32 | INFO | train_inner | epoch 024:    820 / 1191 loss=1.828, trans_loss=4.588, nll_loss=1.772, w2v_ctc_loss=0.562, task_loss=3.283, contrastive_loss=0.18, total=6728.89, n_correct=4854.96, ppl=3.42, accuracy=72.151, wps=18566.2, ups=1.38, wpb=13457.8, bsz=448.8, num_updates=28200, lr=8.42152e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=72, gb_free=10.3, wall=26072
2023-08-30 06:53:45 | INFO | train_inner | epoch 024:    920 / 1191 loss=1.826, trans_loss=4.593, nll_loss=1.779, w2v_ctc_loss=0.553, task_loss=3.225, contrastive_loss=0.178, total=6726.66, n_correct=4851.23, ppl=3.43, accuracy=72.119, wps=18439.3, ups=1.37, wpb=13453.3, bsz=456.9, num_updates=28300, lr=8.40663e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=72, gb_free=13.6, wall=26145
2023-08-30 06:54:59 | INFO | train_inner | epoch 024:   1020 / 1191 loss=1.837, trans_loss=4.596, nll_loss=1.783, w2v_ctc_loss=0.558, task_loss=3.46, contrastive_loss=0.284, total=6595.75, n_correct=4747.24, ppl=3.44, accuracy=71.974, wps=17932.8, ups=1.36, wpb=13191.5, bsz=441.8, num_updates=28400, lr=8.39181e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=73, gb_free=13.7, wall=26219
2023-08-30 06:56:13 | INFO | train_inner | epoch 024:   1120 / 1191 loss=1.831, trans_loss=4.594, nll_loss=1.78, w2v_ctc_loss=0.559, task_loss=3.444, contrastive_loss=0.168, total=6708, n_correct=4828.49, ppl=3.44, accuracy=71.981, wps=18205.3, ups=1.36, wpb=13416, bsz=435, num_updates=28500, lr=8.37708e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=73, gb_free=8.4, wall=26292
2023-08-30 06:57:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 06:57:37 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.742 | trans_loss 4.861 | nll_loss 2.075 | w2v_ctc_loss 1.236 | task_loss 12.078 | contrastive_loss 0.418 | total 6138.43 | n_correct 4389.57 | ppl 4.21 | accuracy 71.51 | uer 17.265 | wer 18.691 | raw_wer 18.691 | bleu 28.95 | wps 1760.9 | wpb 6138.4 | bsz 201.1 | num_updates 28571 | best_bleu 29.06
2023-08-30 06:57:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28571 updates
2023-08-30 06:57:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9504.pt
2023-08-30 06:57:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9504.pt
2023-08-30 06:57:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9504.pt (epoch 24 @ 28571 updates, score 28.95) (writing took 6.9588879509828985 seconds)
2023-08-30 06:57:44 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2023-08-30 06:57:44 | INFO | train | epoch 024 | loss 1.83 | trans_loss 4.592 | nll_loss 1.778 | w2v_ctc_loss 0.557 | task_loss 3.297 | contrastive_loss 0.22 | total 6703.69 | n_correct 4830.64 | ppl 3.43 | accuracy 72.059 | wps 16737.3 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 28571 | lr 8.36666e-05 | gnorm 0.41 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 14.9 | wall 26384
2023-08-30 06:57:44 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 06:57:44 | INFO | fairseq.trainer | begin training epoch 25
2023-08-30 06:57:44 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 06:58:13 | INFO | train_inner | epoch 025:     29 / 1191 loss=1.832, trans_loss=4.591, nll_loss=1.776, w2v_ctc_loss=0.562, task_loss=3.32, contrastive_loss=0.22, total=6706.04, n_correct=4832.04, ppl=3.42, accuracy=72.055, wps=11174.1, ups=0.83, wpb=13412.1, bsz=449, num_updates=28600, lr=8.36242e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=13.8, wall=26412
2023-08-30 06:59:25 | INFO | train_inner | epoch 025:    129 / 1191 loss=1.822, trans_loss=4.574, nll_loss=1.754, w2v_ctc_loss=0.545, task_loss=3.491, contrastive_loss=0.266, total=6583.6, n_correct=4771.78, ppl=3.37, accuracy=72.48, wps=18154.1, ups=1.38, wpb=13167.2, bsz=436.5, num_updates=28700, lr=8.34784e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=26485
2023-08-30 07:00:38 | INFO | train_inner | epoch 025:    229 / 1191 loss=1.817, trans_loss=4.583, nll_loss=1.766, w2v_ctc_loss=0.545, task_loss=3.154, contrastive_loss=0.178, total=6780.64, n_correct=4904.77, ppl=3.4, accuracy=72.335, wps=18641.4, ups=1.37, wpb=13561.3, bsz=471, num_updates=28800, lr=8.33333e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=26558
2023-08-30 07:01:51 | INFO | train_inner | epoch 025:    329 / 1191 loss=1.827, trans_loss=4.582, nll_loss=1.764, w2v_ctc_loss=0.559, task_loss=3.465, contrastive_loss=0.191, total=6618.73, n_correct=4783.15, ppl=3.4, accuracy=72.267, wps=18001.5, ups=1.36, wpb=13237.5, bsz=431.7, num_updates=28900, lr=8.3189e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=73, gb_free=13.6, wall=26631
2023-08-30 07:03:04 | INFO | train_inner | epoch 025:    429 / 1191 loss=1.826, trans_loss=4.585, nll_loss=1.768, w2v_ctc_loss=0.555, task_loss=3.69, contrastive_loss=0.183, total=6559, n_correct=4733.16, ppl=3.41, accuracy=72.163, wps=18144.6, ups=1.38, wpb=13118, bsz=418.7, num_updates=29000, lr=8.30455e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=26704
2023-08-30 07:04:17 | INFO | train_inner | epoch 025:    529 / 1191 loss=1.82, trans_loss=4.583, nll_loss=1.766, w2v_ctc_loss=0.548, task_loss=2.98, contrastive_loss=0.202, total=6859.95, n_correct=4960.85, ppl=3.4, accuracy=72.316, wps=18802.8, ups=1.37, wpb=13719.9, bsz=486.8, num_updates=29100, lr=8.29027e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=26776
2023-08-30 07:05:29 | INFO | train_inner | epoch 025:    629 / 1191 loss=1.819, trans_loss=4.578, nll_loss=1.76, w2v_ctc_loss=0.547, task_loss=3.248, contrastive_loss=0.198, total=6758.81, n_correct=4893.03, ppl=3.39, accuracy=72.395, wps=18625.7, ups=1.38, wpb=13517.6, bsz=450.4, num_updates=29200, lr=8.27606e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=26849
2023-08-30 07:06:42 | INFO | train_inner | epoch 025:    729 / 1191 loss=1.832, trans_loss=4.588, nll_loss=1.773, w2v_ctc_loss=0.554, task_loss=3.339, contrastive_loss=0.293, total=6686.07, n_correct=4824.24, ppl=3.42, accuracy=72.154, wps=18412, ups=1.38, wpb=13372.1, bsz=450.8, num_updates=29300, lr=8.26192e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=26922
2023-08-30 07:07:54 | INFO | train_inner | epoch 025:    829 / 1191 loss=1.824, trans_loss=4.586, nll_loss=1.77, w2v_ctc_loss=0.551, task_loss=3.241, contrastive_loss=0.21, total=6724.86, n_correct=4853.39, ppl=3.41, accuracy=72.171, wps=18562.2, ups=1.38, wpb=13449.7, bsz=454.4, num_updates=29400, lr=8.24786e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=26994
2023-08-30 07:09:07 | INFO | train_inner | epoch 025:    929 / 1191 loss=1.821, trans_loss=4.582, nll_loss=1.766, w2v_ctc_loss=0.549, task_loss=3.094, contrastive_loss=0.206, total=6787.73, n_correct=4903.5, ppl=3.4, accuracy=72.241, wps=18574.3, ups=1.37, wpb=13575.5, bsz=474.6, num_updates=29500, lr=8.23387e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=12.4, wall=27067
2023-08-30 07:10:19 | INFO | train_inner | epoch 025:   1029 / 1191 loss=1.827, trans_loss=4.594, nll_loss=1.78, w2v_ctc_loss=0.55, task_loss=3.277, contrastive_loss=0.222, total=6654.71, n_correct=4791.12, ppl=3.43, accuracy=71.996, wps=18539.1, ups=1.39, wpb=13309.4, bsz=451.1, num_updates=29600, lr=8.21995e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=71, gb_free=12.5, wall=27139
2023-08-30 07:11:32 | INFO | train_inner | epoch 025:   1129 / 1191 loss=1.825, trans_loss=4.582, nll_loss=1.765, w2v_ctc_loss=0.558, task_loss=3.416, contrastive_loss=0.207, total=6685.06, n_correct=4829.53, ppl=3.4, accuracy=72.244, wps=18444, ups=1.38, wpb=13370.1, bsz=444.3, num_updates=29700, lr=8.2061e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=27212
2023-08-30 07:12:17 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 07:12:50 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 3.723 | trans_loss 4.86 | nll_loss 2.075 | w2v_ctc_loss 1.177 | task_loss 12.026 | contrastive_loss 0.418 | total 6138.43 | n_correct 4382 | ppl 4.21 | accuracy 71.386 | uer 16.974 | wer 18.531 | raw_wer 18.531 | bleu 28.93 | wps 1750.8 | wpb 6138.4 | bsz 201.1 | num_updates 29762 | best_bleu 29.06
2023-08-30 07:12:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 29762 updates
2023-08-30 07:12:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9307.pt
2023-08-30 07:12:52 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9307.pt
2023-08-30 07:12:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9307.pt (epoch 25 @ 29762 updates, score 28.93) (writing took 7.196086187992478 seconds)
2023-08-30 07:12:57 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2023-08-30 07:12:57 | INFO | train | epoch 025 | loss 1.824 | trans_loss 4.584 | nll_loss 1.767 | w2v_ctc_loss 0.551 | task_loss 3.296 | contrastive_loss 0.218 | total 6703.69 | n_correct 4842.86 | ppl 3.4 | accuracy 72.242 | wps 17481.9 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 29762 | lr 8.19755e-05 | gnorm 0.409 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 11.4 | wall 27297
2023-08-30 07:12:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 07:12:57 | INFO | fairseq.trainer | begin training epoch 26
2023-08-30 07:12:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 07:13:32 | INFO | train_inner | epoch 026:     38 / 1191 loss=1.827, trans_loss=4.586, nll_loss=1.77, w2v_ctc_loss=0.55, task_loss=3.136, contrastive_loss=0.251, total=6821.45, n_correct=4923.72, ppl=3.41, accuracy=72.18, wps=11309.2, ups=0.83, wpb=13642.9, bsz=465.1, num_updates=29800, lr=8.19232e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=10.1, wall=27332
2023-08-30 07:14:46 | INFO | train_inner | epoch 026:    138 / 1191 loss=1.813, trans_loss=4.573, nll_loss=1.754, w2v_ctc_loss=0.539, task_loss=3.32, contrastive_loss=0.196, total=6715.27, n_correct=4871.13, ppl=3.37, accuracy=72.538, wps=18233.7, ups=1.36, wpb=13430.5, bsz=454.7, num_updates=29900, lr=8.17861e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=73, gb_free=13, wall=27406
2023-08-30 07:15:58 | INFO | train_inner | epoch 026:    238 / 1191 loss=1.817, trans_loss=4.57, nll_loss=1.749, w2v_ctc_loss=0.547, task_loss=3.294, contrastive_loss=0.221, total=6666.23, n_correct=4837.15, ppl=3.36, accuracy=72.562, wps=18483.7, ups=1.39, wpb=13332.5, bsz=450.1, num_updates=30000, lr=8.16497e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=27478
2023-08-30 07:15:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 07:16:31 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.74 | trans_loss 4.86 | nll_loss 2.074 | w2v_ctc_loss 1.232 | task_loss 12.021 | contrastive_loss 0.414 | total 6138.43 | n_correct 4382.43 | ppl 4.21 | accuracy 71.393 | uer 17.027 | wer 18.62 | raw_wer 18.62 | bleu 28.83 | wps 1744 | wpb 6138.4 | bsz 201.1 | num_updates 30000 | best_bleu 29.06
2023-08-30 07:16:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30000 updates
2023-08-30 07:16:31 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-30 07:16:33 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-30 07:16:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_26_30000.pt (epoch 26 @ 30000 updates, score 28.83) (writing took 8.43941851001 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 07:17:53 | INFO | train_inner | epoch 026:    338 / 1191 loss=1.816, trans_loss=4.575, nll_loss=1.757, w2v_ctc_loss=0.539, task_loss=2.847, contrastive_loss=0.267, total=6899.8, n_correct=5000.95, ppl=3.38, accuracy=72.48, wps=12065.7, ups=0.87, wpb=13799.6, bsz=500.6, num_updates=30100, lr=8.15139e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=10.2, wall=27592
2023-08-30 07:19:05 | INFO | train_inner | epoch 026:    438 / 1191 loss=1.821, trans_loss=4.573, nll_loss=1.753, w2v_ctc_loss=0.55, task_loss=3.555, contrastive_loss=0.218, total=6569.02, n_correct=4757.83, ppl=3.37, accuracy=72.428, wps=18065.5, ups=1.38, wpb=13138, bsz=423, num_updates=30200, lr=8.13788e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=27665
2023-08-30 07:20:19 | INFO | train_inner | epoch 026:    538 / 1191 loss=1.818, trans_loss=4.572, nll_loss=1.751, w2v_ctc_loss=0.544, task_loss=3.322, contrastive_loss=0.234, total=6687.4, n_correct=4846.58, ppl=3.37, accuracy=72.473, wps=18235.1, ups=1.36, wpb=13374.8, bsz=452.8, num_updates=30300, lr=8.12444e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=73, gb_free=14.7, wall=27738
2023-08-30 07:21:31 | INFO | train_inner | epoch 026:    638 / 1191 loss=1.819, trans_loss=4.574, nll_loss=1.754, w2v_ctc_loss=0.544, task_loss=3.569, contrastive_loss=0.224, total=6600.22, n_correct=4779.18, ppl=3.37, accuracy=72.409, wps=18161.2, ups=1.38, wpb=13200.4, bsz=425.9, num_updates=30400, lr=8.11107e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=10.8, wall=27811
2023-08-30 07:22:45 | INFO | train_inner | epoch 026:    738 / 1191 loss=1.821, trans_loss=4.581, nll_loss=1.763, w2v_ctc_loss=0.55, task_loss=3.322, contrastive_loss=0.18, total=6782.32, n_correct=4909.07, ppl=3.39, accuracy=72.38, wps=18511.9, ups=1.36, wpb=13564.6, bsz=446.6, num_updates=30500, lr=8.09776e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=73, gb_free=12.2, wall=27884
2023-08-30 07:23:57 | INFO | train_inner | epoch 026:    838 / 1191 loss=1.815, trans_loss=4.571, nll_loss=1.751, w2v_ctc_loss=0.539, task_loss=3.211, contrastive_loss=0.23, total=6691.89, n_correct=4854.6, ppl=3.37, accuracy=72.545, wps=18545.8, ups=1.39, wpb=13383.8, bsz=458.3, num_updates=30600, lr=8.08452e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=27957
2023-08-30 07:25:09 | INFO | train_inner | epoch 026:    938 / 1191 loss=1.827, trans_loss=4.583, nll_loss=1.766, w2v_ctc_loss=0.552, task_loss=3.39, contrastive_loss=0.245, total=6663.94, n_correct=4811.12, ppl=3.4, accuracy=72.196, wps=18501.8, ups=1.39, wpb=13327.9, bsz=443.6, num_updates=30700, lr=8.07134e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=71, gb_free=10.5, wall=28029
2023-08-30 07:26:22 | INFO | train_inner | epoch 026:   1038 / 1191 loss=1.825, trans_loss=4.583, nll_loss=1.767, w2v_ctc_loss=0.559, task_loss=3.348, contrastive_loss=0.18, total=6693.53, n_correct=4833.03, ppl=3.4, accuracy=72.205, wps=18386.5, ups=1.37, wpb=13387.1, bsz=446.3, num_updates=30800, lr=8.05823e-05, gnorm=0.415, clip=0, loss_scale=64, train_wall=72, gb_free=5.7, wall=28101
2023-08-30 07:27:35 | INFO | train_inner | epoch 026:   1138 / 1191 loss=1.82, trans_loss=4.583, nll_loss=1.767, w2v_ctc_loss=0.547, task_loss=3.125, contrastive_loss=0.213, total=6798.29, n_correct=4915.89, ppl=3.4, accuracy=72.311, wps=18565, ups=1.37, wpb=13596.6, bsz=478.7, num_updates=30900, lr=8.04518e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=73, gb_free=10.5, wall=28175
2023-08-30 07:28:13 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
2023-08-30 07:28:46 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.743 | trans_loss 4.86 | nll_loss 2.075 | w2v_ctc_loss 1.24 | task_loss 11.964 | contrastive_loss 0.421 | total 6138.43 | n_correct 4382.43 | ppl 4.21 | accuracy 71.393 | uer 17.247 | wer 18.866 | raw_wer 18.866 | bleu 29.08 | wps 1773.1 | wpb 6138.4 | bsz 201.1 | num_updates 30953 | best_bleu 29.08
2023-08-30 07:28:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30953 updates
2023-08-30 07:28:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 07:28:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 07:29:00 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 26 @ 30953 updates, score 29.08) (writing took 14.2927144250134 seconds)
2023-08-30 07:29:00 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2023-08-30 07:29:00 | INFO | train | epoch 026 | loss 1.82 | trans_loss 4.577 | nll_loss 1.759 | w2v_ctc_loss 0.547 | task_loss 3.296 | contrastive_loss 0.216 | total 6703.69 | n_correct 4852.78 | ppl 3.38 | accuracy 72.39 | wps 16582.7 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 30953 | lr 8.03829e-05 | gnorm 0.409 | clip 0 | loss_scale 64 | train_wall 860 | gb_free 12.4 | wall 28260
2023-08-30 07:29:00 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 07:29:00 | INFO | fairseq.trainer | begin training epoch 27
2023-08-30 07:29:00 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 07:29:42 | INFO | train_inner | epoch 027:     47 / 1191 loss=1.818, trans_loss=4.576, nll_loss=1.757, w2v_ctc_loss=0.549, task_loss=3.385, contrastive_loss=0.173, total=6630.76, n_correct=4800.01, ppl=3.38, accuracy=72.39, wps=10455.7, ups=0.79, wpb=13261.5, bsz=438.4, num_updates=31000, lr=8.03219e-05, gnorm=0.411, clip=0, loss_scale=64, train_wall=72, gb_free=13.5, wall=28302
2023-08-30 07:30:55 | INFO | train_inner | epoch 027:    147 / 1191 loss=1.818, trans_loss=4.569, nll_loss=1.747, w2v_ctc_loss=0.544, task_loss=3.229, contrastive_loss=0.267, total=6722.36, n_correct=4877.9, ppl=3.36, accuracy=72.562, wps=18364.6, ups=1.37, wpb=13444.7, bsz=465.8, num_updates=31100, lr=8.01927e-05, gnorm=0.413, clip=0, loss_scale=64, train_wall=72, gb_free=11.6, wall=28375
2023-08-30 07:32:07 | INFO | train_inner | epoch 027:    247 / 1191 loss=1.807, trans_loss=4.564, nll_loss=1.742, w2v_ctc_loss=0.532, task_loss=3.035, contrastive_loss=0.232, total=6816.12, n_correct=4954.54, ppl=3.34, accuracy=72.689, wps=18790.3, ups=1.38, wpb=13632.2, bsz=481.5, num_updates=31200, lr=8.00641e-05, gnorm=0.399, clip=0, loss_scale=64, train_wall=72, gb_free=13, wall=28447
2023-08-30 07:33:13 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 07:33:21 | INFO | train_inner | epoch 027:    348 / 1191 loss=1.804, trans_loss=4.56, nll_loss=1.738, w2v_ctc_loss=0.532, task_loss=3.11, contrastive_loss=0.202, total=6748.74, n_correct=4917.72, ppl=3.33, accuracy=72.869, wps=18416.5, ups=1.36, wpb=13497.5, bsz=469.5, num_updates=31300, lr=7.99361e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=73, gb_free=12.5, wall=28521
2023-08-30 07:34:34 | INFO | train_inner | epoch 027:    448 / 1191 loss=1.821, trans_loss=4.577, nll_loss=1.758, w2v_ctc_loss=0.551, task_loss=3.505, contrastive_loss=0.213, total=6617.99, n_correct=4792.89, ppl=3.38, accuracy=72.422, wps=18044.4, ups=1.36, wpb=13236, bsz=437.6, num_updates=31400, lr=7.98087e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=73, gb_free=6.1, wall=28594
2023-08-30 07:35:47 | INFO | train_inner | epoch 027:    548 / 1191 loss=1.81, trans_loss=4.566, nll_loss=1.744, w2v_ctc_loss=0.54, task_loss=3.117, contrastive_loss=0.189, total=6786.76, n_correct=4927.04, ppl=3.35, accuracy=72.598, wps=18635.5, ups=1.37, wpb=13573.5, bsz=467.9, num_updates=31500, lr=7.96819e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=28667
2023-08-30 07:36:59 | INFO | train_inner | epoch 027:    648 / 1191 loss=1.817, trans_loss=4.57, nll_loss=1.749, w2v_ctc_loss=0.539, task_loss=3.372, contrastive_loss=0.26, total=6681.62, n_correct=4847.7, ppl=3.36, accuracy=72.553, wps=18486.2, ups=1.38, wpb=13363.2, bsz=444.4, num_updates=31600, lr=7.95557e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=28739
2023-08-30 07:38:12 | INFO | train_inner | epoch 027:    748 / 1191 loss=1.815, trans_loss=4.571, nll_loss=1.75, w2v_ctc_loss=0.545, task_loss=3.449, contrastive_loss=0.189, total=6672.74, n_correct=4840.58, ppl=3.36, accuracy=72.543, wps=18315.9, ups=1.37, wpb=13345.5, bsz=442.4, num_updates=31700, lr=7.94301e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=28812
2023-08-30 07:39:25 | INFO | train_inner | epoch 027:    848 / 1191 loss=1.817, trans_loss=4.571, nll_loss=1.751, w2v_ctc_loss=0.549, task_loss=3.47, contrastive_loss=0.184, total=6644.45, n_correct=4817.92, ppl=3.37, accuracy=72.51, wps=18276.7, ups=1.38, wpb=13288.9, bsz=439.2, num_updates=31800, lr=7.93052e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=28885
2023-08-30 07:40:38 | INFO | train_inner | epoch 027:    948 / 1191 loss=1.822, trans_loss=4.578, nll_loss=1.759, w2v_ctc_loss=0.55, task_loss=3.554, contrastive_loss=0.199, total=6643.34, n_correct=4809.75, ppl=3.39, accuracy=72.4, wps=18129.9, ups=1.36, wpb=13286.7, bsz=425.1, num_updates=31900, lr=7.91808e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=73, gb_free=10.6, wall=28958
2023-08-30 07:41:51 | INFO | train_inner | epoch 027:   1048 / 1191 loss=1.821, trans_loss=4.579, nll_loss=1.761, w2v_ctc_loss=0.545, task_loss=3.323, contrastive_loss=0.253, total=6650.56, n_correct=4813.17, ppl=3.39, accuracy=72.372, wps=18199.9, ups=1.37, wpb=13301.1, bsz=450.8, num_updates=32000, lr=7.90569e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=29031
2023-08-30 07:41:51 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 07:42:24 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.72 | trans_loss 4.856 | nll_loss 2.07 | w2v_ctc_loss 1.177 | task_loss 12.059 | contrastive_loss 0.418 | total 6138.43 | n_correct 4380.86 | ppl 4.2 | accuracy 71.368 | uer 16.803 | wer 18.367 | raw_wer 18.367 | bleu 28.71 | wps 1745.4 | wpb 6138.4 | bsz 201.1 | num_updates 32000 | best_bleu 29.08
2023-08-30 07:42:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32000 updates
2023-08-30 07:42:24 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-30 07:42:27 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-30 07:42:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_27_32000.pt (epoch 27 @ 32000 updates, score 28.71) (writing took 10.078768186009256 seconds)
2023-08-30 07:43:47 | INFO | train_inner | epoch 027:   1148 / 1191 loss=1.815, trans_loss=4.572, nll_loss=1.752, w2v_ctc_loss=0.541, task_loss=3.216, contrastive_loss=0.219, total=6756.52, n_correct=4898.17, ppl=3.37, accuracy=72.495, wps=11688.4, ups=0.86, wpb=13513, bsz=452.5, num_updates=32100, lr=7.89337e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=29147
2023-08-30 07:44:18 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 07:44:50 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.738 | trans_loss 4.856 | nll_loss 2.07 | w2v_ctc_loss 1.235 | task_loss 12.021 | contrastive_loss 0.413 | total 6138.43 | n_correct 4392.29 | ppl 4.2 | accuracy 71.554 | uer 16.779 | wer 18.334 | raw_wer 18.334 | bleu 28.84 | wps 1752.8 | wpb 6138.4 | bsz 201.1 | num_updates 32143 | best_bleu 29.08
2023-08-30 07:44:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32143 updates
2023-08-30 07:44:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8408.pt
2023-08-30 07:44:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8408.pt
2023-08-30 07:44:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8408.pt (epoch 27 @ 32143 updates, score 28.84) (writing took 7.1703117710130755 seconds)
2023-08-30 07:44:58 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2023-08-30 07:44:58 | INFO | train | epoch 027 | loss 1.814 | trans_loss 4.57 | nll_loss 1.749 | w2v_ctc_loss 0.542 | task_loss 3.294 | contrastive_loss 0.214 | total 6705.27 | n_correct 4865.8 | ppl 3.36 | accuracy 72.567 | wps 16663.2 | ups 1.24 | wpb 13410.5 | bsz 452.4 | num_updates 32143 | lr 7.88809e-05 | gnorm 0.408 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.3 | wall 29218
2023-08-30 07:44:58 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 07:44:58 | INFO | fairseq.trainer | begin training epoch 28
2023-08-30 07:44:58 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 07:45:47 | INFO | train_inner | epoch 028:     57 / 1191 loss=1.805, trans_loss=4.558, nll_loss=1.734, w2v_ctc_loss=0.533, task_loss=3.233, contrastive_loss=0.205, total=6701.35, n_correct=4875.08, ppl=3.33, accuracy=72.748, wps=11135.1, ups=0.83, wpb=13402.7, bsz=455.5, num_updates=32200, lr=7.8811e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=6.4, wall=29267
2023-08-30 07:47:00 | INFO | train_inner | epoch 028:    157 / 1191 loss=1.812, trans_loss=4.563, nll_loss=1.739, w2v_ctc_loss=0.55, task_loss=3.473, contrastive_loss=0.156, total=6662.36, n_correct=4846.14, ppl=3.34, accuracy=72.739, wps=18347.9, ups=1.38, wpb=13324.7, bsz=429.7, num_updates=32300, lr=7.86889e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=29340
2023-08-30 07:48:13 | INFO | train_inner | epoch 028:    257 / 1191 loss=1.808, trans_loss=4.562, nll_loss=1.739, w2v_ctc_loss=0.536, task_loss=3.285, contrastive_loss=0.209, total=6695.94, n_correct=4870.88, ppl=3.34, accuracy=72.744, wps=18362.6, ups=1.37, wpb=13391.9, bsz=454.4, num_updates=32400, lr=7.85674e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=29413
2023-08-30 07:49:26 | INFO | train_inner | epoch 028:    357 / 1191 loss=1.805, trans_loss=4.559, nll_loss=1.735, w2v_ctc_loss=0.536, task_loss=3.262, contrastive_loss=0.177, total=6727.32, n_correct=4897.13, ppl=3.33, accuracy=72.795, wps=18344.3, ups=1.36, wpb=13454.6, bsz=459.2, num_updates=32500, lr=7.84465e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=73, gb_free=13.4, wall=29486
2023-08-30 07:50:39 | INFO | train_inner | epoch 028:    457 / 1191 loss=1.815, trans_loss=4.564, nll_loss=1.741, w2v_ctc_loss=0.537, task_loss=3.148, contrastive_loss=0.299, total=6777.32, n_correct=4924.48, ppl=3.34, accuracy=72.661, wps=18461.9, ups=1.36, wpb=13554.6, bsz=471.8, num_updates=32600, lr=7.8326e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=73, gb_free=12.8, wall=29559
2023-08-30 07:51:51 | INFO | train_inner | epoch 028:    557 / 1191 loss=1.802, trans_loss=4.561, nll_loss=1.737, w2v_ctc_loss=0.53, task_loss=3.267, contrastive_loss=0.159, total=6695.22, n_correct=4877.23, ppl=3.33, accuracy=72.846, wps=18790.2, ups=1.4, wpb=13390.4, bsz=451.6, num_updates=32700, lr=7.82062e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=71, gb_free=13.3, wall=29631
2023-08-30 07:53:03 | INFO | train_inner | epoch 028:    657 / 1191 loss=1.807, trans_loss=4.559, nll_loss=1.736, w2v_ctc_loss=0.533, task_loss=3.206, contrastive_loss=0.227, total=6769.44, n_correct=4928.8, ppl=3.33, accuracy=72.81, wps=18755, ups=1.39, wpb=13538.9, bsz=460.3, num_updates=32800, lr=7.80869e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=29703
2023-08-30 07:54:16 | INFO | train_inner | epoch 028:    757 / 1191 loss=1.808, trans_loss=4.562, nll_loss=1.74, w2v_ctc_loss=0.537, task_loss=3.288, contrastive_loss=0.191, total=6697.15, n_correct=4868.28, ppl=3.34, accuracy=72.692, wps=18373.3, ups=1.37, wpb=13394.3, bsz=455.2, num_updates=32900, lr=7.79681e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=29776
2023-08-30 07:55:28 | INFO | train_inner | epoch 028:    857 / 1191 loss=1.81, trans_loss=4.564, nll_loss=1.741, w2v_ctc_loss=0.54, task_loss=3.296, contrastive_loss=0.196, total=6642.02, n_correct=4827.72, ppl=3.34, accuracy=72.685, wps=18343.4, ups=1.38, wpb=13284, bsz=451.4, num_updates=33000, lr=7.78499e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=29848
2023-08-30 07:56:41 | INFO | train_inner | epoch 028:    957 / 1191 loss=1.817, trans_loss=4.569, nll_loss=1.749, w2v_ctc_loss=0.543, task_loss=3.454, contrastive_loss=0.229, total=6645.42, n_correct=4824.25, ppl=3.36, accuracy=72.595, wps=18337.2, ups=1.38, wpb=13290.8, bsz=437.2, num_updates=33100, lr=7.77322e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=11.2, wall=29921
2023-08-30 07:57:54 | INFO | train_inner | epoch 028:   1057 / 1191 loss=1.819, trans_loss=4.571, nll_loss=1.751, w2v_ctc_loss=0.536, task_loss=3.436, contrastive_loss=0.29, total=6685.52, n_correct=4846.95, ppl=3.37, accuracy=72.499, wps=18332, ups=1.37, wpb=13371, bsz=440.5, num_updates=33200, lr=7.76151e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=29994
2023-08-30 07:59:07 | INFO | train_inner | epoch 028:   1157 / 1191 loss=1.81, trans_loss=4.564, nll_loss=1.742, w2v_ctc_loss=0.536, task_loss=3.414, contrastive_loss=0.2, total=6679.26, n_correct=4854.59, ppl=3.34, accuracy=72.682, wps=18238.4, ups=1.37, wpb=13358.5, bsz=444.1, num_updates=33300, lr=7.74984e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=12.5, wall=30067
2023-08-30 07:59:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 08:00:04 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 3.729 | trans_loss 4.859 | nll_loss 2.072 | w2v_ctc_loss 1.201 | task_loss 12.026 | contrastive_loss 0.418 | total 6138.43 | n_correct 4385.14 | ppl 4.2 | accuracy 71.438 | uer 16.84 | wer 18.479 | raw_wer 18.479 | bleu 29.14 | wps 1758.7 | wpb 6138.4 | bsz 201.1 | num_updates 33334 | best_bleu 29.14
2023-08-30 08:00:04 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 33334 updates
2023-08-30 08:00:04 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 08:00:10 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 08:00:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 28 @ 33334 updates, score 29.14) (writing took 12.550926997995703 seconds)
2023-08-30 08:00:17 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2023-08-30 08:00:17 | INFO | train | epoch 028 | loss 1.81 | trans_loss 4.563 | nll_loss 1.74 | w2v_ctc_loss 0.537 | task_loss 3.297 | contrastive_loss 0.214 | total 6703.69 | n_correct 4874.81 | ppl 3.34 | accuracy 72.718 | wps 17373.1 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 33334 | lr 7.74589e-05 | gnorm 0.408 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13 | wall 30137
2023-08-30 08:00:17 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 08:00:17 | INFO | fairseq.trainer | begin training epoch 29
2023-08-30 08:00:17 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 08:01:13 | INFO | train_inner | epoch 029:     66 / 1191 loss=1.796, trans_loss=4.546, nll_loss=1.719, w2v_ctc_loss=0.525, task_loss=3.015, contrastive_loss=0.21, total=6803.37, n_correct=4976.75, ppl=3.29, accuracy=73.151, wps=10794.7, ups=0.79, wpb=13606.7, bsz=476.6, num_updates=33400, lr=7.73823e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=15.2, wall=30193
2023-08-30 08:02:26 | INFO | train_inner | epoch 029:    166 / 1191 loss=1.797, trans_loss=4.551, nll_loss=1.724, w2v_ctc_loss=0.523, task_loss=3.368, contrastive_loss=0.163, total=6680.35, n_correct=4876.05, ppl=3.3, accuracy=72.991, wps=18354.2, ups=1.37, wpb=13360.7, bsz=438.8, num_updates=33500, lr=7.72667e-05, gnorm=0.407, clip=0, loss_scale=64, train_wall=72, gb_free=12.9, wall=30266
2023-08-30 08:02:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 08:03:39 | INFO | train_inner | epoch 029:    267 / 1191 loss=1.807, trans_loss=4.555, nll_loss=1.73, w2v_ctc_loss=0.523, task_loss=3.301, contrastive_loss=0.301, total=6664.57, n_correct=4860.43, ppl=3.32, accuracy=72.929, wps=18117.3, ups=1.36, wpb=13329.1, bsz=453.1, num_updates=33600, lr=7.71517e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=73, gb_free=13.9, wall=30339
2023-08-30 08:04:52 | INFO | train_inner | epoch 029:    367 / 1191 loss=1.8, trans_loss=4.555, nll_loss=1.73, w2v_ctc_loss=0.532, task_loss=3.308, contrastive_loss=0.164, total=6747.17, n_correct=4922.2, ppl=3.32, accuracy=72.952, wps=18510.8, ups=1.37, wpb=13494.3, bsz=452, num_updates=33700, lr=7.70371e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=30412
2023-08-30 08:06:05 | INFO | train_inner | epoch 029:    467 / 1191 loss=1.8, trans_loss=4.554, nll_loss=1.729, w2v_ctc_loss=0.525, task_loss=3.185, contrastive_loss=0.216, total=6772.8, n_correct=4941.99, ppl=3.32, accuracy=72.968, wps=18563.5, ups=1.37, wpb=13545.6, bsz=464.8, num_updates=33800, lr=7.69231e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=30485
2023-08-30 08:07:18 | INFO | train_inner | epoch 029:    567 / 1191 loss=1.811, trans_loss=4.56, nll_loss=1.736, w2v_ctc_loss=0.543, task_loss=3.641, contrastive_loss=0.198, total=6577.57, n_correct=4782.06, ppl=3.33, accuracy=72.703, wps=18113.3, ups=1.38, wpb=13155.1, bsz=421.4, num_updates=33900, lr=7.68095e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=30558
2023-08-30 08:08:30 | INFO | train_inner | epoch 029:    667 / 1191 loss=1.799, trans_loss=4.549, nll_loss=1.723, w2v_ctc_loss=0.53, task_loss=3.106, contrastive_loss=0.199, total=6760.39, n_correct=4940.29, ppl=3.3, accuracy=73.077, wps=18728.7, ups=1.39, wpb=13520.8, bsz=469.3, num_updates=34000, lr=7.66965e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=30630
2023-08-30 08:08:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 08:09:02 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.732 | trans_loss 4.858 | nll_loss 2.073 | w2v_ctc_loss 1.213 | task_loss 11.982 | contrastive_loss 0.415 | total 6138.43 | n_correct 4389 | ppl 4.21 | accuracy 71.5 | uer 17.049 | wer 18.706 | raw_wer 18.706 | bleu 28.93 | wps 1764.1 | wpb 6138.4 | bsz 201.1 | num_updates 34000 | best_bleu 29.14
2023-08-30 08:09:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34000 updates
2023-08-30 08:09:02 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-30 08:09:04 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-30 08:09:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_29_34000.pt (epoch 29 @ 34000 updates, score 28.93) (writing took 7.947171479987446 seconds)
2023-08-30 08:10:23 | INFO | train_inner | epoch 029:    767 / 1191 loss=1.8, trans_loss=4.552, nll_loss=1.726, w2v_ctc_loss=0.529, task_loss=3.315, contrastive_loss=0.191, total=6664.13, n_correct=4866.22, ppl=3.31, accuracy=73.021, wps=11814.8, ups=0.89, wpb=13328.3, bsz=450.3, num_updates=34100, lr=7.6584e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=71, gb_free=7.4, wall=30743
2023-08-30 08:11:36 | INFO | train_inner | epoch 029:    867 / 1191 loss=1.808, trans_loss=4.564, nll_loss=1.741, w2v_ctc_loss=0.54, task_loss=3.442, contrastive_loss=0.167, total=6659.43, n_correct=4841.39, ppl=3.34, accuracy=72.7, wps=18325.2, ups=1.38, wpb=13318.9, bsz=435.3, num_updates=34200, lr=7.64719e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=10.8, wall=30815
2023-08-30 08:12:48 | INFO | train_inner | epoch 029:    967 / 1191 loss=1.813, trans_loss=4.56, nll_loss=1.737, w2v_ctc_loss=0.535, task_loss=3.261, contrastive_loss=0.289, total=6728.65, n_correct=4889.79, ppl=3.33, accuracy=72.671, wps=18471.5, ups=1.37, wpb=13457.3, bsz=461.6, num_updates=34300, lr=7.63604e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=30888
2023-08-30 08:14:00 | INFO | train_inner | epoch 029:   1067 / 1191 loss=1.806, trans_loss=4.557, nll_loss=1.733, w2v_ctc_loss=0.532, task_loss=3.288, contrastive_loss=0.235, total=6711.89, n_correct=4891.55, ppl=3.32, accuracy=72.879, wps=18666.5, ups=1.39, wpb=13423.8, bsz=456.2, num_updates=34400, lr=7.62493e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=71, gb_free=14.3, wall=30960
2023-08-30 08:15:14 | INFO | train_inner | epoch 029:   1167 / 1191 loss=1.801, trans_loss=4.558, nll_loss=1.734, w2v_ctc_loss=0.526, task_loss=3.208, contrastive_loss=0.206, total=6748.65, n_correct=4924.43, ppl=3.33, accuracy=72.969, wps=18258.4, ups=1.35, wpb=13497.3, bsz=461.5, num_updates=34500, lr=7.61387e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=73, gb_free=15.3, wall=31034
2023-08-30 08:15:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 08:16:04 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.732 | trans_loss 4.855 | nll_loss 2.07 | w2v_ctc_loss 1.219 | task_loss 12.016 | contrastive_loss 0.422 | total 6138.43 | n_correct 4381.86 | ppl 4.2 | accuracy 71.384 | uer 16.971 | wer 18.561 | raw_wer 18.561 | bleu 29.02 | wps 1764 | wpb 6138.4 | bsz 201.1 | num_updates 34524 | best_bleu 29.14
2023-08-30 08:16:04 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34524 updates
2023-08-30 08:16:04 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0205.pt
2023-08-30 08:16:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0205.pt
2023-08-30 08:16:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0205.pt (epoch 29 @ 34524 updates, score 29.02) (writing took 8.758351090014912 seconds)
2023-08-30 08:16:13 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2023-08-30 08:16:13 | INFO | train | epoch 029 | loss 1.803 | trans_loss 4.555 | nll_loss 1.73 | w2v_ctc_loss 0.53 | task_loss 3.298 | contrastive_loss 0.211 | total 6703.45 | n_correct 4887.79 | ppl 3.32 | accuracy 72.915 | wps 16687 | ups 1.24 | wpb 13406.9 | bsz 452.2 | num_updates 34524 | lr 7.61122e-05 | gnorm 0.406 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.5 | wall 31093
2023-08-30 08:16:13 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 08:16:13 | INFO | fairseq.trainer | begin training epoch 30
2023-08-30 08:16:13 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 08:17:15 | INFO | train_inner | epoch 030:     76 / 1191 loss=1.791, trans_loss=4.545, nll_loss=1.718, w2v_ctc_loss=0.517, task_loss=2.944, contrastive_loss=0.202, total=6849.81, n_correct=5012.4, ppl=3.29, accuracy=73.176, wps=11343.7, ups=0.83, wpb=13699.6, bsz=486.1, num_updates=34600, lr=7.60286e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=71, gb_free=13.8, wall=31155
2023-08-30 08:18:27 | INFO | train_inner | epoch 030:    176 / 1191 loss=1.797, trans_loss=4.547, nll_loss=1.72, w2v_ctc_loss=0.522, task_loss=3.343, contrastive_loss=0.199, total=6657.78, n_correct=4867.07, ppl=3.29, accuracy=73.103, wps=18592.2, ups=1.4, wpb=13315.6, bsz=441, num_updates=34700, lr=7.5919e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=71, gb_free=14.5, wall=31227
2023-08-30 08:19:39 | INFO | train_inner | epoch 030:    276 / 1191 loss=1.795, trans_loss=4.54, nll_loss=1.712, w2v_ctc_loss=0.525, task_loss=3.153, contrastive_loss=0.21, total=6769.26, n_correct=4954.15, ppl=3.28, accuracy=73.186, wps=18663, ups=1.38, wpb=13538.5, bsz=465.3, num_updates=34800, lr=7.58098e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=31299
2023-08-30 08:20:52 | INFO | train_inner | epoch 030:    376 / 1191 loss=1.793, trans_loss=4.545, nll_loss=1.718, w2v_ctc_loss=0.518, task_loss=3.008, contrastive_loss=0.21, total=6850.27, n_correct=5012.24, ppl=3.29, accuracy=73.169, wps=18709.7, ups=1.37, wpb=13700.5, bsz=485.4, num_updates=34900, lr=7.57011e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=31372
2023-08-30 08:22:05 | INFO | train_inner | epoch 030:    476 / 1191 loss=1.799, trans_loss=4.548, nll_loss=1.722, w2v_ctc_loss=0.526, task_loss=3.433, contrastive_loss=0.199, total=6641.83, n_correct=4847.98, ppl=3.3, accuracy=72.992, wps=18224, ups=1.37, wpb=13283.7, bsz=444.7, num_updates=35000, lr=7.55929e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=31445
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 08:23:18 | INFO | train_inner | epoch 030:    576 / 1191 loss=1.801, trans_loss=4.55, nll_loss=1.723, w2v_ctc_loss=0.528, task_loss=3.356, contrastive_loss=0.218, total=6679.82, n_correct=4874.44, ppl=3.3, accuracy=72.973, wps=18338.9, ups=1.37, wpb=13359.6, bsz=445.4, num_updates=35100, lr=7.54851e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=11.3, wall=31518
2023-08-30 08:24:30 | INFO | train_inner | epoch 030:    676 / 1191 loss=1.802, trans_loss=4.548, nll_loss=1.72, w2v_ctc_loss=0.535, task_loss=3.6, contrastive_loss=0.179, total=6572.86, n_correct=4795.68, ppl=3.29, accuracy=72.962, wps=18187.9, ups=1.38, wpb=13145.7, bsz=422.5, num_updates=35200, lr=7.53778e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=71, gb_free=13.8, wall=31590
2023-08-30 08:25:44 | INFO | train_inner | epoch 030:    776 / 1191 loss=1.81, trans_loss=4.551, nll_loss=1.725, w2v_ctc_loss=0.531, task_loss=3.467, contrastive_loss=0.281, total=6650.65, n_correct=4847.21, ppl=3.31, accuracy=72.883, wps=18129.3, ups=1.36, wpb=13301.3, bsz=438.1, num_updates=35300, lr=7.5271e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=31664
2023-08-30 08:26:57 | INFO | train_inner | epoch 030:    876 / 1191 loss=1.8, trans_loss=4.552, nll_loss=1.726, w2v_ctc_loss=0.526, task_loss=3.374, contrastive_loss=0.21, total=6686.47, n_correct=4880.46, ppl=3.31, accuracy=72.99, wps=18366.5, ups=1.37, wpb=13372.9, bsz=447.2, num_updates=35400, lr=7.51646e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=15.6, wall=31736
2023-08-30 08:28:10 | INFO | train_inner | epoch 030:    976 / 1191 loss=1.804, trans_loss=4.552, nll_loss=1.726, w2v_ctc_loss=0.534, task_loss=3.443, contrastive_loss=0.216, total=6650.45, n_correct=4848.84, ppl=3.31, accuracy=72.91, wps=18178.6, ups=1.37, wpb=13300.9, bsz=445.3, num_updates=35500, lr=7.50587e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=31810
2023-08-30 08:29:23 | INFO | train_inner | epoch 030:   1076 / 1191 loss=1.801, trans_loss=4.555, nll_loss=1.73, w2v_ctc_loss=0.531, task_loss=3.236, contrastive_loss=0.167, total=6760.55, n_correct=4935.32, ppl=3.32, accuracy=73.002, wps=18454, ups=1.36, wpb=13521.1, bsz=455.7, num_updates=35600, lr=7.49532e-05, gnorm=0.407, clip=0, loss_scale=64, train_wall=73, gb_free=13, wall=31883
2023-08-30 08:30:36 | INFO | train_inner | epoch 030:   1176 / 1191 loss=1.805, trans_loss=4.561, nll_loss=1.739, w2v_ctc_loss=0.529, task_loss=3.268, contrastive_loss=0.225, total=6693.2, n_correct=4872.09, ppl=3.34, accuracy=72.792, wps=18426.6, ups=1.38, wpb=13386.4, bsz=453.9, num_updates=35700, lr=7.48481e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=72, gb_free=14.4, wall=31956
2023-08-30 08:30:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
2023-08-30 08:31:19 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 3.73 | trans_loss 4.852 | nll_loss 2.064 | w2v_ctc_loss 1.221 | task_loss 11.972 | contrastive_loss 0.418 | total 6138.43 | n_correct 4389.57 | ppl 4.18 | accuracy 71.51 | uer 16.877 | wer 18.49 | raw_wer 18.49 | bleu 28.71 | wps 1765.7 | wpb 6138.4 | bsz 201.1 | num_updates 35715 | best_bleu 29.14
2023-08-30 08:31:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 35715 updates
2023-08-30 08:31:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-30 08:31:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-30 08:31:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt (epoch 30 @ 35715 updates, score 28.71) (writing took 6.525620608997997 seconds)
2023-08-30 08:31:25 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2023-08-30 08:31:25 | INFO | train | epoch 030 | loss 1.8 | trans_loss 4.549 | nll_loss 1.723 | w2v_ctc_loss 0.527 | task_loss 3.298 | contrastive_loss 0.21 | total 6703.69 | n_correct 4894.55 | ppl 3.3 | accuracy 73.013 | wps 17506.5 | ups 1.31 | wpb 13407.4 | bsz 452.1 | num_updates 35715 | lr 7.48324e-05 | gnorm 0.408 | clip 0 | loss_scale 64 | train_wall 856 | gb_free 14.3 | wall 32005
2023-08-30 08:31:25 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 08:31:25 | INFO | fairseq.trainer | begin training epoch 31
2023-08-30 08:31:25 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 08:32:35 | INFO | train_inner | epoch 031:     85 / 1191 loss=1.8, trans_loss=4.544, nll_loss=1.716, w2v_ctc_loss=0.533, task_loss=3.61, contrastive_loss=0.181, total=6595.99, n_correct=4825.83, ppl=3.28, accuracy=73.163, wps=11053.3, ups=0.84, wpb=13192, bsz=419.6, num_updates=35800, lr=7.47435e-05, gnorm=0.412, clip=0, loss_scale=64, train_wall=72, gb_free=6.1, wall=32075
2023-08-30 08:33:48 | INFO | train_inner | epoch 031:    185 / 1191 loss=1.789, trans_loss=4.539, nll_loss=1.71, w2v_ctc_loss=0.515, task_loss=3.237, contrastive_loss=0.182, total=6732.15, n_correct=4933.33, ppl=3.27, accuracy=73.28, wps=18369.9, ups=1.36, wpb=13464.3, bsz=458.4, num_updates=35900, lr=7.46393e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=73, gb_free=13.4, wall=32148
2023-08-30 08:34:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 08:35:02 | INFO | train_inner | epoch 031:    286 / 1191 loss=1.799, trans_loss=4.541, nll_loss=1.712, w2v_ctc_loss=0.527, task_loss=3.555, contrastive_loss=0.218, total=6564.9, n_correct=4800.37, ppl=3.28, accuracy=73.122, wps=17819.6, ups=1.36, wpb=13129.8, bsz=431.4, num_updates=36000, lr=7.45356e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=73, gb_free=12.7, wall=32222
2023-08-30 08:35:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 08:35:35 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.738 | trans_loss 4.854 | nll_loss 2.067 | w2v_ctc_loss 1.242 | task_loss 11.991 | contrastive_loss 0.414 | total 6138.43 | n_correct 4386.71 | ppl 4.19 | accuracy 71.463 | uer 17.041 | wer 18.736 | raw_wer 18.736 | bleu 28.78 | wps 1746.9 | wpb 6138.4 | bsz 201.1 | num_updates 36000 | best_bleu 29.14
2023-08-30 08:35:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36000 updates
2023-08-30 08:35:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-30 08:35:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-30 08:35:42 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_31_36000.pt (epoch 31 @ 36000 updates, score 28.78) (writing took 7.195615845994325 seconds)
2023-08-30 08:36:55 | INFO | train_inner | epoch 031:    386 / 1191 loss=1.79, trans_loss=4.541, nll_loss=1.713, w2v_ctc_loss=0.521, task_loss=3.281, contrastive_loss=0.158, total=6740.71, n_correct=4937.38, ppl=3.28, accuracy=73.247, wps=11937, ups=0.89, wpb=13481.4, bsz=456.6, num_updates=36100, lr=7.44323e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=15.1, wall=32335
2023-08-30 08:38:07 | INFO | train_inner | epoch 031:    486 / 1191 loss=1.8, trans_loss=4.552, nll_loss=1.727, w2v_ctc_loss=0.526, task_loss=3.584, contrastive_loss=0.182, total=6663.24, n_correct=4862.78, ppl=3.31, accuracy=72.979, wps=18415.1, ups=1.38, wpb=13326.5, bsz=427.4, num_updates=36200, lr=7.43294e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=32407
2023-08-30 08:39:20 | INFO | train_inner | epoch 031:    586 / 1191 loss=1.798, trans_loss=4.543, nll_loss=1.715, w2v_ctc_loss=0.522, task_loss=3.269, contrastive_loss=0.242, total=6690.15, n_correct=4892.15, ppl=3.28, accuracy=73.125, wps=18493.6, ups=1.38, wpb=13380.3, bsz=452.9, num_updates=36300, lr=7.4227e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=12.5, wall=32480
2023-08-30 08:40:33 | INFO | train_inner | epoch 031:    686 / 1191 loss=1.794, trans_loss=4.541, nll_loss=1.713, w2v_ctc_loss=0.52, task_loss=3.044, contrastive_loss=0.234, total=6828.19, n_correct=4996.94, ppl=3.28, accuracy=73.181, wps=18760, ups=1.37, wpb=13656.4, bsz=475.7, num_updates=36400, lr=7.41249e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=8.8, wall=32552
2023-08-30 08:41:46 | INFO | train_inner | epoch 031:    786 / 1191 loss=1.794, trans_loss=4.543, nll_loss=1.716, w2v_ctc_loss=0.523, task_loss=3.079, contrastive_loss=0.213, total=6799.81, n_correct=4976.55, ppl=3.28, accuracy=73.187, wps=18503.1, ups=1.36, wpb=13599.6, bsz=477.8, num_updates=36500, lr=7.40233e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=73, gb_free=12.8, wall=32626
2023-08-30 08:42:59 | INFO | train_inner | epoch 031:    886 / 1191 loss=1.802, trans_loss=4.55, nll_loss=1.724, w2v_ctc_loss=0.528, task_loss=3.383, contrastive_loss=0.238, total=6621.33, n_correct=4834.68, ppl=3.3, accuracy=73.017, wps=18053.1, ups=1.36, wpb=13242.7, bsz=446.7, num_updates=36600, lr=7.39221e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=73, gb_free=6.1, wall=32699
2023-08-30 08:44:12 | INFO | train_inner | epoch 031:    986 / 1191 loss=1.799, trans_loss=4.544, nll_loss=1.717, w2v_ctc_loss=0.527, task_loss=3.307, contrastive_loss=0.22, total=6696.19, n_correct=4894.97, ppl=3.29, accuracy=73.101, wps=18492.3, ups=1.38, wpb=13392.4, bsz=451.6, num_updates=36700, lr=7.38213e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=10, wall=32772
2023-08-30 08:45:24 | INFO | train_inner | epoch 031:   1086 / 1191 loss=1.789, trans_loss=4.543, nll_loss=1.715, w2v_ctc_loss=0.514, task_loss=2.897, contrastive_loss=0.202, total=6891.63, n_correct=5047.29, ppl=3.28, accuracy=73.238, wps=19092.7, ups=1.39, wpb=13783.3, bsz=490.4, num_updates=36800, lr=7.3721e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=4.2, wall=32844
2023-08-30 08:46:36 | INFO | train_inner | epoch 031:   1186 / 1191 loss=1.798, trans_loss=4.546, nll_loss=1.719, w2v_ctc_loss=0.526, task_loss=3.363, contrastive_loss=0.224, total=6644.22, n_correct=4853.38, ppl=3.29, accuracy=73.047, wps=18382.5, ups=1.38, wpb=13288.4, bsz=443.7, num_updates=36900, lr=7.3621e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=32916
2023-08-30 08:46:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 08:47:13 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.716 | trans_loss 4.852 | nll_loss 2.066 | w2v_ctc_loss 1.171 | task_loss 11.999 | contrastive_loss 0.418 | total 6138.43 | n_correct 4388.86 | ppl 4.19 | accuracy 71.498 | uer 16.69 | wer 18.379 | raw_wer 18.379 | bleu 29.25 | wps 1747.6 | wpb 6138.4 | bsz 201.1 | num_updates 36905 | best_bleu 29.25
2023-08-30 08:47:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36905 updates
2023-08-30 08:47:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 08:47:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 08:47:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 31 @ 36905 updates, score 29.25) (writing took 13.156643336988054 seconds)
2023-08-30 08:47:26 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2023-08-30 08:47:26 | INFO | train | epoch 031 | loss 1.796 | trans_loss 4.544 | nll_loss 1.716 | w2v_ctc_loss 0.523 | task_loss 3.298 | contrastive_loss 0.208 | total 6704.58 | n_correct 4903.78 | ppl 3.29 | accuracy 73.141 | wps 16607.5 | ups 1.24 | wpb 13409.2 | bsz 452.2 | num_updates 36905 | lr 7.3616e-05 | gnorm 0.408 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 10 | wall 32966
2023-08-30 08:47:26 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 08:47:26 | INFO | fairseq.trainer | begin training epoch 32
2023-08-30 08:47:26 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 08:48:43 | INFO | train_inner | epoch 032:     95 / 1191 loss=1.785, trans_loss=4.528, nll_loss=1.696, w2v_ctc_loss=0.515, task_loss=3.199, contrastive_loss=0.181, total=6699.21, n_correct=4918.94, ppl=3.24, accuracy=73.426, wps=10598, ups=0.79, wpb=13398.4, bsz=454.5, num_updates=37000, lr=7.35215e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=11.6, wall=33043
2023-08-30 08:49:56 | INFO | train_inner | epoch 032:    195 / 1191 loss=1.796, trans_loss=4.537, nll_loss=1.708, w2v_ctc_loss=0.517, task_loss=3.164, contrastive_loss=0.288, total=6807.88, n_correct=4987.65, ppl=3.27, accuracy=73.263, wps=18705.4, ups=1.37, wpb=13615.8, bsz=467.3, num_updates=37100, lr=7.34223e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=33115
2023-08-30 08:51:08 | INFO | train_inner | epoch 032:    295 / 1191 loss=1.79, trans_loss=4.539, nll_loss=1.71, w2v_ctc_loss=0.518, task_loss=3.378, contrastive_loss=0.174, total=6684.79, n_correct=4897.05, ppl=3.27, accuracy=73.257, wps=18347.9, ups=1.37, wpb=13369.6, bsz=446.4, num_updates=37200, lr=7.33236e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=33188
2023-08-30 08:52:21 | INFO | train_inner | epoch 032:    395 / 1191 loss=1.784, trans_loss=4.529, nll_loss=1.696, w2v_ctc_loss=0.513, task_loss=3.19, contrastive_loss=0.176, total=6766.95, n_correct=4970.62, ppl=3.24, accuracy=73.454, wps=18636.8, ups=1.38, wpb=13533.9, bsz=460.3, num_updates=37300, lr=7.32252e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=72, gb_free=10.5, wall=33261
2023-08-30 08:53:34 | INFO | train_inner | epoch 032:    495 / 1191 loss=1.789, trans_loss=4.539, nll_loss=1.71, w2v_ctc_loss=0.52, task_loss=3.267, contrastive_loss=0.166, total=6728, n_correct=4929.63, ppl=3.27, accuracy=73.27, wps=18394.2, ups=1.37, wpb=13456, bsz=452.3, num_updates=37400, lr=7.31272e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=73, gb_free=14, wall=33334
2023-08-30 08:54:47 | INFO | train_inner | epoch 032:    595 / 1191 loss=1.787, trans_loss=4.536, nll_loss=1.706, w2v_ctc_loss=0.518, task_loss=3.357, contrastive_loss=0.159, total=6688.29, n_correct=4911.22, ppl=3.26, accuracy=73.43, wps=18303.3, ups=1.37, wpb=13376.6, bsz=443.7, num_updates=37500, lr=7.30297e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=13.6, wall=33407
2023-08-30 08:56:01 | INFO | train_inner | epoch 032:    695 / 1191 loss=1.79, trans_loss=4.532, nll_loss=1.701, w2v_ctc_loss=0.517, task_loss=3.538, contrastive_loss=0.204, total=6660.06, n_correct=4888.86, ppl=3.25, accuracy=73.406, wps=18080.5, ups=1.36, wpb=13320.1, bsz=435.2, num_updates=37600, lr=7.29325e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=73, gb_free=8.4, wall=33481
2023-08-30 08:57:14 | INFO | train_inner | epoch 032:    795 / 1191 loss=1.797, trans_loss=4.539, nll_loss=1.71, w2v_ctc_loss=0.52, task_loss=3.18, contrastive_loss=0.267, total=6785.45, n_correct=4966.89, ppl=3.27, accuracy=73.199, wps=18669.6, ups=1.38, wpb=13570.9, bsz=469.8, num_updates=37700, lr=7.28357e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=33554
2023-08-30 08:58:26 | INFO | train_inner | epoch 032:    895 / 1191 loss=1.798, trans_loss=4.541, nll_loss=1.713, w2v_ctc_loss=0.524, task_loss=3.422, contrastive_loss=0.226, total=6681.76, n_correct=4882.8, ppl=3.28, accuracy=73.077, wps=18383.5, ups=1.38, wpb=13363.5, bsz=442.9, num_updates=37800, lr=7.27393e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=33626
2023-08-30 08:59:39 | INFO | train_inner | epoch 032:    995 / 1191 loss=1.79, trans_loss=4.538, nll_loss=1.708, w2v_ctc_loss=0.519, task_loss=3.352, contrastive_loss=0.186, total=6611.9, n_correct=4847.41, ppl=3.27, accuracy=73.313, wps=18147.1, ups=1.37, wpb=13223.8, bsz=442, num_updates=37900, lr=7.26433e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=33699
2023-08-30 09:00:52 | INFO | train_inner | epoch 032:   1095 / 1191 loss=1.791, trans_loss=4.54, nll_loss=1.711, w2v_ctc_loss=0.522, task_loss=3.481, contrastive_loss=0.152, total=6609.05, n_correct=4837.94, ppl=3.27, accuracy=73.202, wps=18279.7, ups=1.38, wpb=13218.1, bsz=430.6, num_updates=38000, lr=7.25476e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=33771
2023-08-30 09:00:52 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:01:24 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.722 | trans_loss 4.854 | nll_loss 2.067 | w2v_ctc_loss 1.192 | task_loss 11.977 | contrastive_loss 0.415 | total 6138.43 | n_correct 4396.29 | ppl 4.19 | accuracy 71.619 | uer 16.589 | wer 18.096 | raw_wer 18.096 | bleu 29.15 | wps 1746.4 | wpb 6138.4 | bsz 201.1 | num_updates 38000 | best_bleu 29.25
2023-08-30 09:01:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38000 updates
2023-08-30 09:01:24 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-30 09:01:26 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-30 09:01:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_32_38000.pt (epoch 32 @ 38000 updates, score 29.15) (writing took 8.380030003987486 seconds)
2023-08-30 09:02:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:03:15 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.723 | trans_loss 4.857 | nll_loss 2.073 | w2v_ctc_loss 1.182 | task_loss 11.972 | contrastive_loss 0.419 | total 6138.43 | n_correct 4389.86 | ppl 4.21 | accuracy 71.514 | uer 16.73 | wer 18.304 | raw_wer 18.304 | bleu 28.85 | wps 1748.7 | wpb 6138.4 | bsz 201.1 | num_updates 38096 | best_bleu 29.25
2023-08-30 09:03:15 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38096 updates
2023-08-30 09:03:15 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8506.pt
2023-08-30 09:03:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8506.pt
2023-08-30 09:03:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.8506.pt (epoch 32 @ 38096 updates, score 28.85) (writing took 7.486626963014714 seconds)
2023-08-30 09:03:23 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2023-08-30 09:03:23 | INFO | train | epoch 032 | loss 1.791 | trans_loss 4.537 | nll_loss 1.707 | w2v_ctc_loss 0.518 | task_loss 3.294 | contrastive_loss 0.207 | total 6703.69 | n_correct 4913 | ppl 3.27 | accuracy 73.288 | wps 16692 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 38096 | lr 7.24562e-05 | gnorm 0.407 | clip 0 | loss_scale 64 | train_wall 860 | gb_free 11.4 | wall 33923
2023-08-30 09:03:23 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 09:03:23 | INFO | fairseq.trainer | begin training epoch 33
2023-08-30 09:03:23 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 09:03:33 | INFO | train_inner | epoch 033:      4 / 1191 loss=1.795, trans_loss=4.545, nll_loss=1.717, w2v_ctc_loss=0.512, task_loss=3.037, contrastive_loss=0.317, total=6715.16, n_correct=4910.42, ppl=3.29, accuracy=73.124, wps=8296.8, ups=0.62, wpb=13430.3, bsz=483.7, num_updates=38100, lr=7.24524e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=71, gb_free=15.1, wall=33933
2023-08-30 09:04:47 | INFO | train_inner | epoch 033:    104 / 1191 loss=1.781, trans_loss=4.529, nll_loss=1.697, w2v_ctc_loss=0.506, task_loss=3.177, contrastive_loss=0.173, total=6796.79, n_correct=4995.84, ppl=3.24, accuracy=73.503, wps=18492.1, ups=1.36, wpb=13593.6, bsz=466.2, num_updates=38200, lr=7.23575e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=73, gb_free=14.1, wall=34007
2023-08-30 09:05:06 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 09:05:59 | INFO | train_inner | epoch 033:    205 / 1191 loss=1.779, trans_loss=4.523, nll_loss=1.689, w2v_ctc_loss=0.505, task_loss=3.18, contrastive_loss=0.19, total=6770.24, n_correct=4987.62, ppl=3.23, accuracy=73.67, wps=18667.2, ups=1.38, wpb=13540.5, bsz=456.9, num_updates=38300, lr=7.22629e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=34079
2023-08-30 09:07:12 | INFO | train_inner | epoch 033:    305 / 1191 loss=1.791, trans_loss=4.53, nll_loss=1.698, w2v_ctc_loss=0.518, task_loss=3.517, contrastive_loss=0.222, total=6595.67, n_correct=4842.33, ppl=3.24, accuracy=73.417, wps=18081.4, ups=1.37, wpb=13191.3, bsz=434, num_updates=38400, lr=7.21688e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=34152
2023-08-30 09:08:25 | INFO | train_inner | epoch 033:    405 / 1191 loss=1.789, trans_loss=4.533, nll_loss=1.701, w2v_ctc_loss=0.515, task_loss=3.451, contrastive_loss=0.2, total=6592.1, n_correct=4840.27, ppl=3.25, accuracy=73.425, wps=18237.7, ups=1.38, wpb=13184.2, bsz=432.6, num_updates=38500, lr=7.2075e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=4, wall=34225
2023-08-30 09:09:37 | INFO | train_inner | epoch 033:    505 / 1191 loss=1.786, trans_loss=4.531, nll_loss=1.7, w2v_ctc_loss=0.514, task_loss=3.203, contrastive_loss=0.201, total=6691.29, n_correct=4913.64, ppl=3.25, accuracy=73.433, wps=18591.1, ups=1.39, wpb=13382.6, bsz=456.4, num_updates=38600, lr=7.19816e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=71, gb_free=14.8, wall=34297
2023-08-30 09:10:50 | INFO | train_inner | epoch 033:    605 / 1191 loss=1.789, trans_loss=4.527, nll_loss=1.695, w2v_ctc_loss=0.524, task_loss=3.385, contrastive_loss=0.181, total=6673.5, n_correct=4898.44, ppl=3.24, accuracy=73.401, wps=18292, ups=1.37, wpb=13347, bsz=446.7, num_updates=38700, lr=7.18885e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=11.4, wall=34370
2023-08-30 09:12:03 | INFO | train_inner | epoch 033:    705 / 1191 loss=1.788, trans_loss=4.533, nll_loss=1.703, w2v_ctc_loss=0.517, task_loss=3.37, contrastive_loss=0.187, total=6684.47, n_correct=4906.11, ppl=3.25, accuracy=73.396, wps=18248.4, ups=1.36, wpb=13368.9, bsz=443.1, num_updates=38800, lr=7.17958e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=73, gb_free=4.2, wall=34443
2023-08-30 09:13:16 | INFO | train_inner | epoch 033:    805 / 1191 loss=1.784, trans_loss=4.529, nll_loss=1.698, w2v_ctc_loss=0.506, task_loss=3.101, contrastive_loss=0.243, total=6794.84, n_correct=4994.47, ppl=3.24, accuracy=73.504, wps=18734.5, ups=1.38, wpb=13589.7, bsz=467.9, num_updates=38900, lr=7.17035e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=34515
2023-08-30 09:14:29 | INFO | train_inner | epoch 033:    905 / 1191 loss=1.79, trans_loss=4.536, nll_loss=1.705, w2v_ctc_loss=0.521, task_loss=3.201, contrastive_loss=0.186, total=6754.04, n_correct=4952.51, ppl=3.26, accuracy=73.327, wps=18343.9, ups=1.36, wpb=13508.1, bsz=463.2, num_updates=39000, lr=7.16115e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=13, wall=34589
2023-08-30 09:15:43 | INFO | train_inner | epoch 033:   1005 / 1191 loss=1.793, trans_loss=4.542, nll_loss=1.713, w2v_ctc_loss=0.521, task_loss=3.474, contrastive_loss=0.187, total=6679.84, n_correct=4894.39, ppl=3.28, accuracy=73.271, wps=18138.6, ups=1.36, wpb=13359.7, bsz=440.5, num_updates=39100, lr=7.15199e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=73, gb_free=4.3, wall=34663
2023-08-30 09:16:56 | INFO | train_inner | epoch 033:   1105 / 1191 loss=1.797, trans_loss=4.54, nll_loss=1.711, w2v_ctc_loss=0.527, task_loss=3.222, contrastive_loss=0.234, total=6749.49, n_correct=4939.82, ppl=3.27, accuracy=73.188, wps=18487.2, ups=1.37, wpb=13499, bsz=463.2, num_updates=39200, lr=7.14286e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=34736
2023-08-30 09:17:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:18:31 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 3.712 | trans_loss 4.851 | nll_loss 2.064 | w2v_ctc_loss 1.166 | task_loss 11.974 | contrastive_loss 0.416 | total 6138.43 | n_correct 4388.14 | ppl 4.18 | accuracy 71.486 | uer 16.621 | wer 18.353 | raw_wer 18.353 | bleu 29.04 | wps 1763 | wpb 6138.4 | bsz 201.1 | num_updates 39286 | best_bleu 29.25
2023-08-30 09:18:31 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 39286 updates
2023-08-30 09:18:31 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0407.pt
2023-08-30 09:18:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0407.pt
2023-08-30 09:18:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0407.pt (epoch 33 @ 39286 updates, score 29.04) (writing took 8.296501044998877 seconds)
2023-08-30 09:18:40 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2023-08-30 09:18:40 | INFO | train | epoch 033 | loss 1.788 | trans_loss 4.532 | nll_loss 1.701 | w2v_ctc_loss 0.516 | task_loss 3.292 | contrastive_loss 0.205 | total 6704.27 | n_correct 4921.64 | ppl 3.25 | accuracy 73.411 | wps 17402.4 | ups 1.3 | wpb 13408.5 | bsz 452.3 | num_updates 39286 | lr 7.13503e-05 | gnorm 0.407 | clip 0 | loss_scale 32 | train_wall 861 | gb_free 10.4 | wall 34839
2023-08-30 09:18:40 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 09:18:40 | INFO | fairseq.trainer | begin training epoch 34
2023-08-30 09:18:40 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 09:18:57 | INFO | train_inner | epoch 034:     14 / 1191 loss=1.788, trans_loss=4.532, nll_loss=1.701, w2v_ctc_loss=0.513, task_loss=3.166, contrastive_loss=0.259, total=6714.43, n_correct=4930.15, ppl=3.25, accuracy=73.426, wps=11097, ups=0.83, wpb=13428.9, bsz=468.7, num_updates=39300, lr=7.13376e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=34857
2023-08-30 09:20:09 | INFO | train_inner | epoch 034:    114 / 1191 loss=1.783, trans_loss=4.523, nll_loss=1.69, w2v_ctc_loss=0.502, task_loss=3.015, contrastive_loss=0.281, total=6812.86, n_correct=5014.28, ppl=3.23, accuracy=73.6, wps=18797.9, ups=1.38, wpb=13625.7, bsz=478.9, num_updates=39400, lr=7.1247e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=34929
2023-08-30 09:21:23 | INFO | train_inner | epoch 034:    214 / 1191 loss=1.785, trans_loss=4.525, nll_loss=1.691, w2v_ctc_loss=0.512, task_loss=3.402, contrastive_loss=0.22, total=6669.32, n_correct=4907.13, ppl=3.23, accuracy=73.578, wps=18182, ups=1.36, wpb=13338.6, bsz=448.9, num_updates=39500, lr=7.11568e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=73, gb_free=12.8, wall=35003
2023-08-30 09:22:36 | INFO | train_inner | epoch 034:    314 / 1191 loss=1.78, trans_loss=4.524, nll_loss=1.69, w2v_ctc_loss=0.512, task_loss=3.519, contrastive_loss=0.151, total=6597.66, n_correct=4852.08, ppl=3.23, accuracy=73.542, wps=18078.5, ups=1.37, wpb=13195.3, bsz=431.8, num_updates=39600, lr=7.10669e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=35076
2023-08-30 09:23:49 | INFO | train_inner | epoch 034:    414 / 1191 loss=1.785, trans_loss=4.529, nll_loss=1.697, w2v_ctc_loss=0.514, task_loss=3.476, contrastive_loss=0.166, total=6670.6, n_correct=4899.03, ppl=3.24, accuracy=73.442, wps=18261.8, ups=1.37, wpb=13341.2, bsz=433.1, num_updates=39700, lr=7.09773e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=73, gb_free=14.3, wall=35149
2023-08-30 09:25:02 | INFO | train_inner | epoch 034:    514 / 1191 loss=1.78, trans_loss=4.524, nll_loss=1.69, w2v_ctc_loss=0.507, task_loss=3.445, contrastive_loss=0.188, total=6672.9, n_correct=4915.09, ppl=3.23, accuracy=73.657, wps=18288.5, ups=1.37, wpb=13345.8, bsz=440, num_updates=39800, lr=7.08881e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=5.1, wall=35222
2023-08-30 09:26:15 | INFO | train_inner | epoch 034:    614 / 1191 loss=1.79, trans_loss=4.531, nll_loss=1.699, w2v_ctc_loss=0.515, task_loss=3.199, contrastive_loss=0.234, total=6739.24, n_correct=4946.81, ppl=3.25, accuracy=73.403, wps=18487, ups=1.37, wpb=13478.5, bsz=463.2, num_updates=39900, lr=7.07992e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=12.5, wall=35294
2023-08-30 09:27:27 | INFO | train_inner | epoch 034:    714 / 1191 loss=1.783, trans_loss=4.527, nll_loss=1.695, w2v_ctc_loss=0.509, task_loss=3.362, contrastive_loss=0.186, total=6627.68, n_correct=4872.6, ppl=3.24, accuracy=73.519, wps=18390.8, ups=1.39, wpb=13255.4, bsz=441.5, num_updates=40000, lr=7.07107e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=35367
2023-08-30 09:27:27 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:27:59 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.744 | trans_loss 4.855 | nll_loss 2.069 | w2v_ctc_loss 1.265 | task_loss 12.019 | contrastive_loss 0.408 | total 6138.43 | n_correct 4387 | ppl 4.19 | accuracy 71.468 | uer 16.894 | wer 18.546 | raw_wer 18.546 | bleu 28.96 | wps 1780.2 | wpb 6138.4 | bsz 201.1 | num_updates 40000 | best_bleu 29.25
2023-08-30 09:27:59 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40000 updates
2023-08-30 09:27:59 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-30 09:28:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-30 09:28:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_34_40000.pt (epoch 34 @ 40000 updates, score 28.96) (writing took 8.38233630900504 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 09:29:21 | INFO | train_inner | epoch 034:    814 / 1191 loss=1.782, trans_loss=4.523, nll_loss=1.69, w2v_ctc_loss=0.515, task_loss=3.34, contrastive_loss=0.186, total=6664.33, n_correct=4905.94, ppl=3.23, accuracy=73.615, wps=11671.9, ups=0.88, wpb=13328.7, bsz=454.5, num_updates=40100, lr=7.06225e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=35481
2023-08-30 09:30:34 | INFO | train_inner | epoch 034:    914 / 1191 loss=1.786, trans_loss=4.524, nll_loss=1.691, w2v_ctc_loss=0.518, task_loss=3.501, contrastive_loss=0.173, total=6654.7, n_correct=4890.67, ppl=3.23, accuracy=73.492, wps=18317.1, ups=1.38, wpb=13309.4, bsz=428.5, num_updates=40200, lr=7.05346e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=35553
2023-08-30 09:31:46 | INFO | train_inner | epoch 034:   1014 / 1191 loss=1.783, trans_loss=4.53, nll_loss=1.699, w2v_ctc_loss=0.512, task_loss=3.376, contrastive_loss=0.161, total=6667.27, n_correct=4898.88, ppl=3.25, accuracy=73.477, wps=18451.7, ups=1.38, wpb=13334.5, bsz=439.7, num_updates=40300, lr=7.0447e-05, gnorm=0.407, clip=0, loss_scale=64, train_wall=72, gb_free=12.1, wall=35626
2023-08-30 09:32:58 | INFO | train_inner | epoch 034:   1114 / 1191 loss=1.776, trans_loss=4.524, nll_loss=1.691, w2v_ctc_loss=0.499, task_loss=3.026, contrastive_loss=0.197, total=6861.81, n_correct=5050.31, ppl=3.23, accuracy=73.6, wps=18931.8, ups=1.38, wpb=13723.6, bsz=480.5, num_updates=40400, lr=7.03598e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=13.3, wall=35698
2023-08-30 09:33:54 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
2023-08-30 09:34:27 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.721 | trans_loss 4.853 | nll_loss 2.068 | w2v_ctc_loss 1.189 | task_loss 11.964 | contrastive_loss 0.411 | total 6138.43 | n_correct 4388.14 | ppl 4.19 | accuracy 71.486 | uer 16.594 | wer 18.122 | raw_wer 18.122 | bleu 28.97 | wps 1767.3 | wpb 6138.4 | bsz 201.1 | num_updates 40477 | best_bleu 29.25
2023-08-30 09:34:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40477 updates
2023-08-30 09:34:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9707.pt
2023-08-30 09:34:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9707.pt
2023-08-30 09:34:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_28.9707.pt (epoch 34 @ 40477 updates, score 28.97) (writing took 9.200613822991727 seconds)
2023-08-30 09:34:36 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2023-08-30 09:34:36 | INFO | train | epoch 034 | loss 1.783 | trans_loss 4.526 | nll_loss 1.693 | w2v_ctc_loss 0.51 | task_loss 3.295 | contrastive_loss 0.204 | total 6703.69 | n_correct 4929.81 | ppl 3.23 | accuracy 73.539 | wps 16691.2 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 40477 | lr 7.02928e-05 | gnorm 0.407 | clip 0 | loss_scale 64 | train_wall 859 | gb_free 13.8 | wall 35796
2023-08-30 09:34:37 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 09:34:37 | INFO | fairseq.trainer | begin training epoch 35
2023-08-30 09:34:37 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 09:35:01 | INFO | train_inner | epoch 035:     23 / 1191 loss=1.787, trans_loss=4.528, nll_loss=1.696, w2v_ctc_loss=0.51, task_loss=3.102, contrastive_loss=0.266, total=6766.65, n_correct=4974.45, ppl=3.24, accuracy=73.514, wps=11041, ups=0.82, wpb=13533.3, bsz=471.5, num_updates=40500, lr=7.02728e-05, gnorm=0.407, clip=0, loss_scale=64, train_wall=72, gb_free=10.7, wall=35821
2023-08-30 09:36:14 | INFO | train_inner | epoch 035:    123 / 1191 loss=1.777, trans_loss=4.518, nll_loss=1.682, w2v_ctc_loss=0.508, task_loss=3.302, contrastive_loss=0.164, total=6708.25, n_correct=4945.32, ppl=3.21, accuracy=73.72, wps=18460.1, ups=1.38, wpb=13416.5, bsz=451.4, num_updates=40600, lr=7.01862e-05, gnorm=0.405, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=35893
2023-08-30 09:37:26 | INFO | train_inner | epoch 035:    223 / 1191 loss=1.78, trans_loss=4.516, nll_loss=1.68, w2v_ctc_loss=0.502, task_loss=3.412, contrastive_loss=0.276, total=6627.47, n_correct=4890.25, ppl=3.21, accuracy=73.788, wps=18270.7, ups=1.38, wpb=13254.9, bsz=444.5, num_updates=40700, lr=7.01e-05, gnorm=0.413, clip=0, loss_scale=64, train_wall=72, gb_free=14.5, wall=35966
2023-08-30 09:38:38 | INFO | train_inner | epoch 035:    323 / 1191 loss=1.777, trans_loss=4.514, nll_loss=1.678, w2v_ctc_loss=0.505, task_loss=3.162, contrastive_loss=0.215, total=6767.84, n_correct=4996.33, ppl=3.2, accuracy=73.825, wps=18730.1, ups=1.38, wpb=13535.7, bsz=463.2, num_updates=40800, lr=7.0014e-05, gnorm=0.409, clip=0, loss_scale=64, train_wall=72, gb_free=12.9, wall=36038
2023-08-30 09:39:52 | INFO | train_inner | epoch 035:    423 / 1191 loss=1.781, trans_loss=4.522, nll_loss=1.687, w2v_ctc_loss=0.513, task_loss=3.686, contrastive_loss=0.148, total=6574.17, n_correct=4841.51, ppl=3.22, accuracy=73.644, wps=17975.2, ups=1.37, wpb=13148.3, bsz=420.7, num_updates=40900, lr=6.99284e-05, gnorm=0.412, clip=0, loss_scale=64, train_wall=73, gb_free=14.8, wall=36111
2023-08-30 09:41:04 | INFO | train_inner | epoch 035:    523 / 1191 loss=1.779, trans_loss=4.518, nll_loss=1.683, w2v_ctc_loss=0.51, task_loss=3.289, contrastive_loss=0.181, total=6726.43, n_correct=4956.2, ppl=3.21, accuracy=73.682, wps=18656.6, ups=1.39, wpb=13452.9, bsz=456.8, num_updates=41000, lr=6.9843e-05, gnorm=0.403, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=36184
2023-08-30 09:42:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 09:42:18 | INFO | train_inner | epoch 035:    624 / 1191 loss=1.776, trans_loss=4.517, nll_loss=1.682, w2v_ctc_loss=0.503, task_loss=3.375, contrastive_loss=0.176, total=6689.28, n_correct=4931.8, ppl=3.21, accuracy=73.727, wps=18121.6, ups=1.35, wpb=13378.6, bsz=443.4, num_updates=41100, lr=6.9758e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=73, gb_free=9.4, wall=36257
2023-08-30 09:43:31 | INFO | train_inner | epoch 035:    724 / 1191 loss=1.787, trans_loss=4.527, nll_loss=1.695, w2v_ctc_loss=0.512, task_loss=3.295, contrastive_loss=0.231, total=6709.59, n_correct=4929.94, ppl=3.24, accuracy=73.476, wps=18384.5, ups=1.37, wpb=13419.2, bsz=453.6, num_updates=41200, lr=6.96733e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=36330
2023-08-30 09:44:43 | INFO | train_inner | epoch 035:    824 / 1191 loss=1.782, trans_loss=4.528, nll_loss=1.697, w2v_ctc_loss=0.505, task_loss=3.166, contrastive_loss=0.213, total=6756.65, n_correct=4968.81, ppl=3.24, accuracy=73.54, wps=18590.1, ups=1.38, wpb=13513.3, bsz=459.7, num_updates=41300, lr=6.95889e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=36403
2023-08-30 09:45:55 | INFO | train_inner | epoch 035:    924 / 1191 loss=1.777, trans_loss=4.52, nll_loss=1.686, w2v_ctc_loss=0.499, task_loss=3.036, contrastive_loss=0.238, total=6770.43, n_correct=4993.34, ppl=3.22, accuracy=73.752, wps=18747.8, ups=1.38, wpb=13540.9, bsz=473.1, num_updates=41400, lr=6.95048e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=36475
2023-08-30 09:47:08 | INFO | train_inner | epoch 035:   1024 / 1191 loss=1.78, trans_loss=4.519, nll_loss=1.684, w2v_ctc_loss=0.512, task_loss=3.341, contrastive_loss=0.167, total=6727.5, n_correct=4952.61, ppl=3.21, accuracy=73.617, wps=18638.6, ups=1.39, wpb=13455, bsz=442.9, num_updates=41500, lr=6.9421e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=36547
2023-08-30 09:48:21 | INFO | train_inner | epoch 035:   1124 / 1191 loss=1.782, trans_loss=4.528, nll_loss=1.696, w2v_ctc_loss=0.514, task_loss=3.401, contrastive_loss=0.163, total=6632.13, n_correct=4874.89, ppl=3.24, accuracy=73.504, wps=18106.3, ups=1.37, wpb=13264.3, bsz=443.4, num_updates=41600, lr=6.93375e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=73, gb_free=13.4, wall=36621
2023-08-30 09:49:10 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:49:42 | INFO | dev_st | epoch 035 | valid on 'dev_st' subset | loss 3.737 | trans_loss 4.854 | nll_loss 2.066 | w2v_ctc_loss 1.242 | task_loss 12.069 | contrastive_loss 0.412 | total 6138.43 | n_correct 4395.29 | ppl 4.19 | accuracy 71.603 | uer 16.99 | wer 18.624 | raw_wer 18.624 | bleu 29.08 | wps 1747.5 | wpb 6138.4 | bsz 201.1 | num_updates 41667 | best_bleu 29.25
2023-08-30 09:49:42 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 35 @ 41667 updates
2023-08-30 09:49:42 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0809.pt
2023-08-30 09:49:45 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0809.pt
2023-08-30 09:49:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.0809.pt (epoch 35 @ 41667 updates, score 29.08) (writing took 6.933778450009413 seconds)
2023-08-30 09:49:50 | INFO | fairseq_cli.train | end of epoch 35 (average epoch stats below)
2023-08-30 09:49:50 | INFO | train | epoch 035 | loss 1.78 | trans_loss 4.521 | nll_loss 1.687 | w2v_ctc_loss 0.507 | task_loss 3.295 | contrastive_loss 0.202 | total 6703.05 | n_correct 4937.4 | ppl 3.22 | accuracy 73.659 | wps 17458.5 | ups 1.3 | wpb 13406.1 | bsz 452 | num_updates 41667 | lr 6.92818e-05 | gnorm 0.407 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 14.1 | wall 36710
2023-08-30 09:49:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 09:49:50 | INFO | fairseq.trainer | begin training epoch 36
2023-08-30 09:49:50 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 09:50:22 | INFO | train_inner | epoch 036:     33 / 1191 loss=1.779, trans_loss=4.519, nll_loss=1.685, w2v_ctc_loss=0.503, task_loss=3.183, contrastive_loss=0.235, total=6723.84, n_correct=4954.78, ppl=3.21, accuracy=73.69, wps=11106.5, ups=0.83, wpb=13447.7, bsz=466.4, num_updates=41700, lr=6.92543e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=36742
2023-08-30 09:51:34 | INFO | train_inner | epoch 036:    133 / 1191 loss=1.777, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.504, task_loss=3.395, contrastive_loss=0.245, total=6619.6, n_correct=4889.54, ppl=3.18, accuracy=73.865, wps=18281.3, ups=1.38, wpb=13239.2, bsz=440.5, num_updates=41800, lr=6.91714e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=36814
2023-08-30 09:52:47 | INFO | train_inner | epoch 036:    233 / 1191 loss=1.762, trans_loss=4.502, nll_loss=1.662, w2v_ctc_loss=0.493, task_loss=3.085, contrastive_loss=0.159, total=6746.42, n_correct=5000.8, ppl=3.17, accuracy=74.125, wps=18713.5, ups=1.39, wpb=13492.8, bsz=471.8, num_updates=41900, lr=6.90889e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=36886
2023-08-30 09:53:59 | INFO | train_inner | epoch 036:    333 / 1191 loss=1.767, trans_loss=4.511, nll_loss=1.674, w2v_ctc_loss=0.496, task_loss=3.143, contrastive_loss=0.164, total=6782.22, n_correct=5018.8, ppl=3.19, accuracy=73.999, wps=18637.1, ups=1.37, wpb=13564.4, bsz=465.7, num_updates=42000, lr=6.90066e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=36959
2023-08-30 09:53:59 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 09:54:32 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.731 | trans_loss 4.856 | nll_loss 2.068 | w2v_ctc_loss 1.22 | task_loss 12.064 | contrastive_loss 0.412 | total 6138.43 | n_correct 4391.57 | ppl 4.19 | accuracy 71.542 | uer 16.594 | wer 18.364 | raw_wer 18.364 | bleu 29.01 | wps 1747.5 | wpb 6138.4 | bsz 201.1 | num_updates 42000 | best_bleu 29.25
2023-08-30 09:54:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42000 updates
2023-08-30 09:54:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-30 09:54:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-30 09:54:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_36_42000.pt (epoch 36 @ 42000 updates, score 29.01) (writing took 8.21818733701366 seconds)
2023-08-30 09:55:54 | INFO | train_inner | epoch 036:    433 / 1191 loss=1.773, trans_loss=4.514, nll_loss=1.678, w2v_ctc_loss=0.503, task_loss=3.114, contrastive_loss=0.201, total=6792.65, n_correct=5015.75, ppl=3.2, accuracy=73.841, wps=11891.5, ups=0.88, wpb=13585.3, bsz=471.5, num_updates=42100, lr=6.89246e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=37073
2023-08-30 09:57:07 | INFO | train_inner | epoch 036:    533 / 1191 loss=1.786, trans_loss=4.524, nll_loss=1.691, w2v_ctc_loss=0.505, task_loss=3.083, contrastive_loss=0.295, total=6799.2, n_correct=5002.32, ppl=3.23, accuracy=73.572, wps=18612.4, ups=1.37, wpb=13598.4, bsz=476.6, num_updates=42200, lr=6.88428e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=37146
2023-08-30 09:58:19 | INFO | train_inner | epoch 036:    633 / 1191 loss=1.775, trans_loss=4.513, nll_loss=1.677, w2v_ctc_loss=0.508, task_loss=3.385, contrastive_loss=0.154, total=6677.2, n_correct=4925.82, ppl=3.2, accuracy=73.771, wps=18502.5, ups=1.39, wpb=13354.4, bsz=440.8, num_updates=42300, lr=6.87614e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=37219
2023-08-30 09:59:31 | INFO | train_inner | epoch 036:    733 / 1191 loss=1.78, trans_loss=4.518, nll_loss=1.682, w2v_ctc_loss=0.507, task_loss=3.303, contrastive_loss=0.222, total=6721.98, n_correct=4952.57, ppl=3.21, accuracy=73.677, wps=18521, ups=1.38, wpb=13444, bsz=451.5, num_updates=42400, lr=6.86803e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=37291
2023-08-30 10:00:45 | INFO | train_inner | epoch 036:    833 / 1191 loss=1.778, trans_loss=4.524, nll_loss=1.691, w2v_ctc_loss=0.508, task_loss=3.439, contrastive_loss=0.158, total=6667.94, n_correct=4909.49, ppl=3.23, accuracy=73.628, wps=18145.3, ups=1.36, wpb=13335.9, bsz=443.4, num_updates=42500, lr=6.85994e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=73, gb_free=14.4, wall=37365
2023-08-30 10:01:58 | INFO | train_inner | epoch 036:    933 / 1191 loss=1.785, trans_loss=4.52, nll_loss=1.686, w2v_ctc_loss=0.509, task_loss=3.525, contrastive_loss=0.243, total=6687.67, n_correct=4920.41, ppl=3.22, accuracy=73.574, wps=18279, ups=1.37, wpb=13375.3, bsz=433.6, num_updates=42600, lr=6.85189e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=73, gb_free=13.8, wall=37438
2023-08-30 10:03:10 | INFO | train_inner | epoch 036:   1033 / 1191 loss=1.777, trans_loss=4.522, nll_loss=1.688, w2v_ctc_loss=0.505, task_loss=3.2, contrastive_loss=0.184, total=6704.37, n_correct=4935.28, ppl=3.22, accuracy=73.613, wps=18641.3, ups=1.39, wpb=13408.7, bsz=460.9, num_updates=42700, lr=6.84386e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=71, gb_free=14, wall=37510
2023-08-30 10:04:23 | INFO | train_inner | epoch 036:   1133 / 1191 loss=1.78, trans_loss=4.516, nll_loss=1.68, w2v_ctc_loss=0.516, task_loss=3.476, contrastive_loss=0.159, total=6606.86, n_correct=4866.09, ppl=3.21, accuracy=73.652, wps=18206.4, ups=1.38, wpb=13213.7, bsz=434.3, num_updates=42800, lr=6.83586e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=14.8, wall=37582
2023-08-30 10:05:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 10:05:37 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.733 | trans_loss 4.852 | nll_loss 2.064 | w2v_ctc_loss 1.238 | task_loss 11.996 | contrastive_loss 0.407 | total 6138.43 | n_correct 4393.71 | ppl 4.18 | accuracy 71.577 | uer 16.586 | wer 18.222 | raw_wer 18.222 | bleu 29.14 | wps 1746.8 | wpb 6138.4 | bsz 201.1 | num_updates 42858 | best_bleu 29.25
2023-08-30 10:05:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42858 updates
2023-08-30 10:05:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1400.pt
2023-08-30 10:05:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1400.pt
2023-08-30 10:05:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1400.pt (epoch 36 @ 42858 updates, score 29.14) (writing took 7.421751946996665 seconds)
2023-08-30 10:05:45 | INFO | fairseq_cli.train | end of epoch 36 (average epoch stats below)
2023-08-30 10:05:45 | INFO | train | epoch 036 | loss 1.777 | trans_loss 4.516 | nll_loss 1.681 | w2v_ctc_loss 0.505 | task_loss 3.295 | contrastive_loss 0.201 | total 6703.69 | n_correct 4943.04 | ppl 3.21 | accuracy 73.736 | wps 16719.8 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 42858 | lr 6.83123e-05 | gnorm 0.41 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 12.7 | wall 37665
2023-08-30 10:05:45 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 10:05:45 | INFO | fairseq.trainer | begin training epoch 37
2023-08-30 10:05:45 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 10:06:23 | INFO | train_inner | epoch 037:     42 / 1191 loss=1.779, trans_loss=4.518, nll_loss=1.683, w2v_ctc_loss=0.506, task_loss=3.419, contrastive_loss=0.206, total=6674.02, n_correct=4918.48, ppl=3.21, accuracy=73.696, wps=11055.5, ups=0.83, wpb=13348, bsz=440.6, num_updates=42900, lr=6.82789e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=37703
2023-08-30 10:07:36 | INFO | train_inner | epoch 037:    142 / 1191 loss=1.777, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.498, task_loss=3.137, contrastive_loss=0.28, total=6760.41, n_correct=4994.68, ppl=3.19, accuracy=73.881, wps=18595.1, ups=1.38, wpb=13520.8, bsz=463.7, num_updates=43000, lr=6.81994e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=11.7, wall=37776
2023-08-30 10:08:48 | INFO | train_inner | epoch 037:    242 / 1191 loss=1.77, trans_loss=4.505, nll_loss=1.667, w2v_ctc_loss=0.501, task_loss=3.293, contrastive_loss=0.188, total=6707.07, n_correct=4959.37, ppl=3.17, accuracy=73.942, wps=18569.1, ups=1.38, wpb=13414.1, bsz=452.4, num_updates=43100, lr=6.81203e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=37848
2023-08-30 10:10:01 | INFO | train_inner | epoch 037:    342 / 1191 loss=1.774, trans_loss=4.511, nll_loss=1.674, w2v_ctc_loss=0.505, task_loss=3.407, contrastive_loss=0.178, total=6641.38, n_correct=4904.61, ppl=3.19, accuracy=73.849, wps=18285.6, ups=1.38, wpb=13282.8, bsz=438.6, num_updates=43200, lr=6.80414e-05, gnorm=0.413, clip=0, loss_scale=64, train_wall=72, gb_free=12.7, wall=37921
2023-08-30 10:11:13 | INFO | train_inner | epoch 037:    442 / 1191 loss=1.765, trans_loss=4.503, nll_loss=1.664, w2v_ctc_loss=0.49, task_loss=3.293, contrastive_loss=0.176, total=6697.52, n_correct=4960.87, ppl=3.17, accuracy=74.07, wps=18480.7, ups=1.38, wpb=13395, bsz=447.4, num_updates=43300, lr=6.79628e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=72, gb_free=14.5, wall=37993
2023-08-30 10:12:26 | INFO | train_inner | epoch 037:    542 / 1191 loss=1.773, trans_loss=4.51, nll_loss=1.673, w2v_ctc_loss=0.504, task_loss=3.372, contrastive_loss=0.193, total=6636.39, n_correct=4898.93, ppl=3.19, accuracy=73.819, wps=18224.7, ups=1.37, wpb=13272.8, bsz=449.3, num_updates=43400, lr=6.78844e-05, gnorm=0.41, clip=0, loss_scale=64, train_wall=72, gb_free=14.9, wall=38066
2023-08-30 10:12:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-30 10:13:40 | INFO | train_inner | epoch 037:    643 / 1191 loss=1.778, trans_loss=4.517, nll_loss=1.681, w2v_ctc_loss=0.504, task_loss=3.535, contrastive_loss=0.185, total=6640.13, n_correct=4893.99, ppl=3.21, accuracy=73.703, wps=18016.3, ups=1.36, wpb=13280.3, bsz=428.3, num_updates=43500, lr=6.78064e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=73, gb_free=12.2, wall=38140
2023-08-30 10:14:53 | INFO | train_inner | epoch 037:    743 / 1191 loss=1.772, trans_loss=4.508, nll_loss=1.671, w2v_ctc_loss=0.499, task_loss=3.286, contrastive_loss=0.204, total=6719.07, n_correct=4967.44, ppl=3.18, accuracy=73.93, wps=18283.3, ups=1.36, wpb=13438.1, bsz=451.8, num_updates=43600, lr=6.77285e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=73, gb_free=13.3, wall=38213
2023-08-30 10:16:06 | INFO | train_inner | epoch 037:    843 / 1191 loss=1.772, trans_loss=4.516, nll_loss=1.681, w2v_ctc_loss=0.498, task_loss=3.156, contrastive_loss=0.202, total=6808.88, n_correct=5027.97, ppl=3.21, accuracy=73.844, wps=18669.2, ups=1.37, wpb=13617.8, bsz=466.8, num_updates=43700, lr=6.7651e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=38286
2023-08-30 10:17:20 | INFO | train_inner | epoch 037:    943 / 1191 loss=1.768, trans_loss=4.509, nll_loss=1.673, w2v_ctc_loss=0.492, task_loss=2.889, contrastive_loss=0.238, total=6855.49, n_correct=5069.05, ppl=3.19, accuracy=73.941, wps=18615.4, ups=1.36, wpb=13711, bsz=499.9, num_updates=43800, lr=6.75737e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=73, gb_free=13, wall=38360
2023-08-30 10:18:33 | INFO | train_inner | epoch 037:   1043 / 1191 loss=1.769, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.501, task_loss=3.443, contrastive_loss=0.149, total=6689.96, n_correct=4948.19, ppl=3.18, accuracy=73.964, wps=18408.4, ups=1.38, wpb=13379.9, bsz=441.4, num_updates=43900, lr=6.74967e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=38433
2023-08-30 10:19:45 | INFO | train_inner | epoch 037:   1143 / 1191 loss=1.783, trans_loss=4.521, nll_loss=1.687, w2v_ctc_loss=0.511, task_loss=3.412, contrastive_loss=0.223, total=6631.9, n_correct=4879.11, ppl=3.22, accuracy=73.57, wps=18288.5, ups=1.38, wpb=13263.8, bsz=443.6, num_updates=44000, lr=6.742e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=38505
2023-08-30 10:19:45 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 10:20:21 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.714 | trans_loss 4.85 | nll_loss 2.063 | w2v_ctc_loss 1.178 | task_loss 12.026 | contrastive_loss 0.407 | total 6138.43 | n_correct 4394.86 | ppl 4.18 | accuracy 71.596 | uer 16.709 | wer 18.371 | raw_wer 18.371 | bleu 29 | wps 1601 | wpb 6138.4 | bsz 201.1 | num_updates 44000 | best_bleu 29.25
2023-08-30 10:20:21 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44000 updates
2023-08-30 10:20:21 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-30 10:20:24 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-30 10:20:30 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_37_44000.pt (epoch 37 @ 44000 updates, score 29.0) (writing took 8.811371573974611 seconds)
2023-08-30 10:21:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 10:21:38 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.715 | trans_loss 4.848 | nll_loss 2.06 | w2v_ctc_loss 1.188 | task_loss 12.071 | contrastive_loss 0.404 | total 6138.43 | n_correct 4397.43 | ppl 4.17 | accuracy 71.638 | uer 16.816 | wer 18.561 | raw_wer 18.561 | bleu 29.3 | wps 1726.4 | wpb 6138.4 | bsz 201.1 | num_updates 44048 | best_bleu 29.3
2023-08-30 10:21:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44048 updates
2023-08-30 10:21:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 10:21:45 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt
2023-08-30 10:21:52 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_best.pt (epoch 37 @ 44048 updates, score 29.3) (writing took 13.764948270982131 seconds)
2023-08-30 10:21:52 | INFO | fairseq_cli.train | end of epoch 37 (average epoch stats below)
2023-08-30 10:21:52 | INFO | train | epoch 037 | loss 1.773 | trans_loss 4.511 | nll_loss 1.674 | w2v_ctc_loss 0.5 | task_loss 3.295 | contrastive_loss 0.199 | total 6704.19 | n_correct 4952.43 | ppl 3.19 | accuracy 73.871 | wps 16499.9 | ups 1.23 | wpb 13408.4 | bsz 452.2 | num_updates 44048 | lr 6.73832e-05 | gnorm 0.408 | clip 0 | loss_scale 32 | train_wall 860 | gb_free 13.5 | wall 38632
2023-08-30 10:21:52 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 10:21:52 | INFO | fairseq.trainer | begin training epoch 38
2023-08-30 10:21:52 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 10:22:37 | INFO | train_inner | epoch 038:     52 / 1191 loss=1.769, trans_loss=4.511, nll_loss=1.674, w2v_ctc_loss=0.496, task_loss=3.475, contrastive_loss=0.154, total=6590.11, n_correct=4871.27, ppl=3.19, accuracy=73.918, wps=7669.9, ups=0.58, wpb=13180.2, bsz=432.1, num_updates=44100, lr=6.73435e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=38677
2023-08-30 10:23:50 | INFO | train_inner | epoch 038:    152 / 1191 loss=1.765, trans_loss=4.499, nll_loss=1.658, w2v_ctc_loss=0.495, task_loss=3.268, contrastive_loss=0.175, total=6707.39, n_correct=4974.45, ppl=3.16, accuracy=74.164, wps=18487.7, ups=1.38, wpb=13414.8, bsz=449.4, num_updates=44200, lr=6.72673e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=72, gb_free=8, wall=38750
2023-08-30 10:25:03 | INFO | train_inner | epoch 038:    252 / 1191 loss=1.776, trans_loss=4.506, nll_loss=1.667, w2v_ctc_loss=0.496, task_loss=3.283, contrastive_loss=0.29, total=6683.44, n_correct=4939.28, ppl=3.18, accuracy=73.903, wps=18315.9, ups=1.37, wpb=13366.9, bsz=456.5, num_updates=44300, lr=6.71913e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=38823
2023-08-30 10:26:16 | INFO | train_inner | epoch 038:    352 / 1191 loss=1.766, trans_loss=4.499, nll_loss=1.659, w2v_ctc_loss=0.497, task_loss=3.383, contrastive_loss=0.157, total=6695.6, n_correct=4961.11, ppl=3.16, accuracy=74.095, wps=18381.1, ups=1.37, wpb=13391.2, bsz=443, num_updates=44400, lr=6.71156e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=38895
2023-08-30 10:27:29 | INFO | train_inner | epoch 038:    452 / 1191 loss=1.767, trans_loss=4.506, nll_loss=1.668, w2v_ctc_loss=0.492, task_loss=3.108, contrastive_loss=0.223, total=6755.69, n_correct=5003.97, ppl=3.18, accuracy=74.07, wps=18491.3, ups=1.37, wpb=13511.4, bsz=476.3, num_updates=44500, lr=6.70402e-05, gnorm=0.408, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=38968
2023-08-30 10:28:42 | INFO | train_inner | epoch 038:    552 / 1191 loss=1.767, trans_loss=4.503, nll_loss=1.665, w2v_ctc_loss=0.494, task_loss=3.187, contrastive_loss=0.213, total=6799.96, n_correct=5037.45, ppl=3.17, accuracy=74.081, wps=18652.1, ups=1.37, wpb=13599.9, bsz=463.7, num_updates=44600, lr=6.6965e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=72, gb_free=11.7, wall=39041
2023-08-30 10:29:54 | INFO | train_inner | epoch 038:    652 / 1191 loss=1.773, trans_loss=4.514, nll_loss=1.678, w2v_ctc_loss=0.495, task_loss=3.032, contrastive_loss=0.227, total=6826.7, n_correct=5043.91, ppl=3.2, accuracy=73.885, wps=18734, ups=1.37, wpb=13653.4, bsz=474.6, num_updates=44700, lr=6.689e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=39114
2023-08-30 10:31:07 | INFO | train_inner | epoch 038:    752 / 1191 loss=1.769, trans_loss=4.508, nll_loss=1.67, w2v_ctc_loss=0.497, task_loss=3.216, contrastive_loss=0.213, total=6730.12, n_correct=4976.8, ppl=3.18, accuracy=73.948, wps=18443.3, ups=1.37, wpb=13460.2, bsz=464.2, num_updates=44800, lr=6.68153e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=39187
2023-08-30 10:32:20 | INFO | train_inner | epoch 038:    852 / 1191 loss=1.77, trans_loss=4.506, nll_loss=1.668, w2v_ctc_loss=0.502, task_loss=3.437, contrastive_loss=0.151, total=6687.39, n_correct=4941.47, ppl=3.18, accuracy=73.892, wps=18338.9, ups=1.37, wpb=13374.8, bsz=435.4, num_updates=44900, lr=6.67409e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=11.5, wall=39260
2023-08-30 10:33:33 | INFO | train_inner | epoch 038:    952 / 1191 loss=1.77, trans_loss=4.508, nll_loss=1.671, w2v_ctc_loss=0.497, task_loss=3.327, contrastive_loss=0.177, total=6685.88, n_correct=4945.45, ppl=3.18, accuracy=73.969, wps=18345.5, ups=1.37, wpb=13371.8, bsz=446, num_updates=45000, lr=6.66667e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=10.6, wall=39333
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:0')
2023-08-30 10:34:45 | INFO | train_inner | epoch 038:   1052 / 1191 loss=1.774, trans_loss=4.507, nll_loss=1.669, w2v_ctc_loss=0.502, task_loss=3.459, contrastive_loss=0.208, total=6622.97, n_correct=4895.18, ppl=3.18, accuracy=73.912, wps=18401.7, ups=1.39, wpb=13245.9, bsz=440.1, num_updates=45100, lr=6.65927e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=71, gb_free=12.2, wall=39405
2023-08-30 10:35:58 | INFO | train_inner | epoch 038:   1152 / 1191 loss=1.769, trans_loss=4.509, nll_loss=1.672, w2v_ctc_loss=0.497, task_loss=3.317, contrastive_loss=0.18, total=6688.64, n_correct=4941.69, ppl=3.19, accuracy=73.882, wps=18508, ups=1.38, wpb=13377.3, bsz=448.4, num_updates=45200, lr=6.6519e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=39477
2023-08-30 10:35:59 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-30 10:36:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2476, device='cuda:5')
2023-08-30 10:36:58 | INFO | dev_st | epoch 038 | valid on 'dev_st' subset | loss 3.719 | trans_loss 4.851 | nll_loss 2.062 | w2v_ctc_loss 1.193 | task_loss 12.071 | contrastive_loss 0.406 | total 6138.43 | n_correct 4390.57 | ppl 4.18 | accuracy 71.526 | uer 16.685 | wer 18.442 | raw_wer 18.442 | bleu 29.11 | wps 1758.1 | wpb 6138.4 | bsz 201.1 | num_updates 45238 | best_bleu 29.3
2023-08-30 10:36:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 38 @ 45238 updates
2023-08-30 10:36:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1100.pt
2023-08-30 10:37:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1100.pt
2023-08-30 10:37:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1100.pt (epoch 38 @ 45238 updates, score 29.11) (writing took 7.165438080992317 seconds)
2023-08-30 10:37:06 | INFO | fairseq_cli.train | end of epoch 38 (average epoch stats below)
2023-08-30 10:37:06 | INFO | train | epoch 038 | loss 1.769 | trans_loss 4.506 | nll_loss 1.668 | w2v_ctc_loss 0.496 | task_loss 3.293 | contrastive_loss 0.199 | total 6703.83 | n_correct 4959.89 | ppl 3.18 | accuracy 73.986 | wps 17462.7 | ups 1.3 | wpb 13407.7 | bsz 452.2 | num_updates 45238 | lr 6.64911e-05 | gnorm 0.409 | clip 0 | loss_scale 16 | train_wall 858 | gb_free 13.9 | wall 39546
2023-08-30 10:37:06 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 10:37:06 | INFO | fairseq.trainer | begin training epoch 39
2023-08-30 10:37:06 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 10:38:00 | INFO | train_inner | epoch 039:     62 / 1191 loss=1.768, trans_loss=4.506, nll_loss=1.667, w2v_ctc_loss=0.497, task_loss=3.725, contrastive_loss=0.158, total=6523.3, n_correct=4828.81, ppl=3.18, accuracy=74.024, wps=10691.7, ups=0.82, wpb=13046.6, bsz=420.4, num_updates=45300, lr=6.64455e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=73, gb_free=14.2, wall=39599
2023-08-30 10:39:13 | INFO | train_inner | epoch 039:    162 / 1191 loss=1.759, trans_loss=4.493, nll_loss=1.651, w2v_ctc_loss=0.49, task_loss=3.325, contrastive_loss=0.156, total=6693.26, n_correct=4971.82, ppl=3.14, accuracy=74.281, wps=18279.4, ups=1.37, wpb=13386.5, bsz=442.6, num_updates=45400, lr=6.63723e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=73, gb_free=12, wall=39673
2023-08-30 10:40:25 | INFO | train_inner | epoch 039:    262 / 1191 loss=1.77, trans_loss=4.506, nll_loss=1.667, w2v_ctc_loss=0.495, task_loss=3.414, contrastive_loss=0.225, total=6667.98, n_correct=4932.6, ppl=3.18, accuracy=73.974, wps=18395.5, ups=1.38, wpb=13336, bsz=443.1, num_updates=45500, lr=6.62994e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=13.1, wall=39745
2023-08-30 10:41:38 | INFO | train_inner | epoch 039:    362 / 1191 loss=1.768, trans_loss=4.502, nll_loss=1.662, w2v_ctc_loss=0.498, task_loss=3.583, contrastive_loss=0.174, total=6598.38, n_correct=4884.23, ppl=3.17, accuracy=74.022, wps=18065.8, ups=1.37, wpb=13196.8, bsz=427.5, num_updates=45600, lr=6.62266e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=10.4, wall=39818
2023-08-30 10:42:51 | INFO | train_inner | epoch 039:    462 / 1191 loss=1.765, trans_loss=4.499, nll_loss=1.658, w2v_ctc_loss=0.488, task_loss=3.191, contrastive_loss=0.231, total=6750.43, n_correct=5000.4, ppl=3.16, accuracy=74.075, wps=18625.2, ups=1.38, wpb=13500.9, bsz=462.1, num_updates=45700, lr=6.61541e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=39891
2023-08-30 10:44:04 | INFO | train_inner | epoch 039:    562 / 1191 loss=1.763, trans_loss=4.498, nll_loss=1.658, w2v_ctc_loss=0.489, task_loss=3.283, contrastive_loss=0.185, total=6701.53, n_correct=4970.01, ppl=3.16, accuracy=74.162, wps=18330.9, ups=1.37, wpb=13403.1, bsz=451.9, num_updates=45800, lr=6.60819e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=39964
2023-08-30 10:45:17 | INFO | train_inner | epoch 039:    662 / 1191 loss=1.768, trans_loss=4.504, nll_loss=1.665, w2v_ctc_loss=0.494, task_loss=3.252, contrastive_loss=0.219, total=6717.92, n_correct=4969.52, ppl=3.17, accuracy=73.974, wps=18454.8, ups=1.37, wpb=13435.8, bsz=463.2, num_updates=45900, lr=6.60098e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=6.1, wall=40037
2023-08-30 10:46:30 | INFO | train_inner | epoch 039:    762 / 1191 loss=1.768, trans_loss=4.505, nll_loss=1.666, w2v_ctc_loss=0.495, task_loss=3.269, contrastive_loss=0.202, total=6736.15, n_correct=4988.78, ppl=3.17, accuracy=74.06, wps=18458.7, ups=1.37, wpb=13472.3, bsz=455.3, num_updates=46000, lr=6.5938e-05, gnorm=0.408, clip=0, loss_scale=16, train_wall=72, gb_free=12.7, wall=40110
2023-08-30 10:46:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 10:47:02 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.727 | trans_loss 4.85 | nll_loss 2.062 | w2v_ctc_loss 1.219 | task_loss 12.001 | contrastive_loss 0.415 | total 6138.43 | n_correct 4395.71 | ppl 4.18 | accuracy 71.61 | uer 16.551 | wer 18.167 | raw_wer 18.167 | bleu 29.19 | wps 1761.2 | wpb 6138.4 | bsz 201.1 | num_updates 46000 | best_bleu 29.3
2023-08-30 10:47:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46000 updates
2023-08-30 10:47:02 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-30 10:47:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-30 10:47:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_39_46000.pt (epoch 39 @ 46000 updates, score 29.19) (writing took 8.606846791983116 seconds)
2023-08-30 10:48:24 | INFO | train_inner | epoch 039:    862 / 1191 loss=1.765, trans_loss=4.504, nll_loss=1.666, w2v_ctc_loss=0.493, task_loss=3.125, contrastive_loss=0.194, total=6798.2, n_correct=5034.57, ppl=3.17, accuracy=74.057, wps=11928.1, ups=0.88, wpb=13596.4, bsz=472.1, num_updates=46100, lr=6.58665e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=40224
2023-08-30 10:49:37 | INFO | train_inner | epoch 039:    962 / 1191 loss=1.762, trans_loss=4.497, nll_loss=1.656, w2v_ctc_loss=0.489, task_loss=3.028, contrastive_loss=0.219, total=6835.31, n_correct=5068.85, ppl=3.15, accuracy=74.157, wps=18787.4, ups=1.37, wpb=13670.6, bsz=480.9, num_updates=46200, lr=6.57952e-05, gnorm=0.4, clip=0, loss_scale=16, train_wall=72, gb_free=13.6, wall=40296
2023-08-30 10:50:49 | INFO | train_inner | epoch 039:   1062 / 1191 loss=1.763, trans_loss=4.5, nll_loss=1.66, w2v_ctc_loss=0.488, task_loss=3.2, contrastive_loss=0.205, total=6757.98, n_correct=5012.35, ppl=3.16, accuracy=74.169, wps=18569.6, ups=1.37, wpb=13516, bsz=459.7, num_updates=46300, lr=6.57241e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=40369
2023-08-30 10:52:02 | INFO | train_inner | epoch 039:   1162 / 1191 loss=1.773, trans_loss=4.505, nll_loss=1.666, w2v_ctc_loss=0.506, task_loss=3.469, contrastive_loss=0.18, total=6582.59, n_correct=4867.05, ppl=3.17, accuracy=73.938, wps=18202.1, ups=1.38, wpb=13165.2, bsz=428.8, num_updates=46400, lr=6.56532e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=72, gb_free=14, wall=40441
2023-08-30 10:52:22 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 10:52:55 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.717 | trans_loss 4.849 | nll_loss 2.059 | w2v_ctc_loss 1.194 | task_loss 11.904 | contrastive_loss 0.4 | total 6138.43 | n_correct 4394.43 | ppl 4.17 | accuracy 71.589 | uer 16.126 | wer 17.862 | raw_wer 17.862 | bleu 29.26 | wps 1761.6 | wpb 6138.4 | bsz 201.1 | num_updates 46429 | best_bleu 29.3
2023-08-30 10:52:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46429 updates
2023-08-30 10:52:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.2602.pt
2023-08-30 10:52:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.2602.pt
2023-08-30 10:53:03 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.2602.pt (epoch 39 @ 46429 updates, score 29.26) (writing took 8.488347611011704 seconds)
2023-08-30 10:53:04 | INFO | fairseq_cli.train | end of epoch 39 (average epoch stats below)
2023-08-30 10:53:04 | INFO | train | epoch 039 | loss 1.766 | trans_loss 4.501 | nll_loss 1.661 | w2v_ctc_loss 0.493 | task_loss 3.295 | contrastive_loss 0.197 | total 6703.69 | n_correct 4966.35 | ppl 3.16 | accuracy 74.084 | wps 16667.6 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 46429 | lr 6.56327e-05 | gnorm 0.41 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 13.1 | wall 40504
2023-08-30 10:53:04 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 10:53:04 | INFO | fairseq.trainer | begin training epoch 40
2023-08-30 10:53:04 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 10:54:03 | INFO | train_inner | epoch 040:     71 / 1191 loss=1.758, trans_loss=4.492, nll_loss=1.649, w2v_ctc_loss=0.486, task_loss=3.132, contrastive_loss=0.182, total=6767.38, n_correct=5027.01, ppl=3.14, accuracy=74.283, wps=11167.2, ups=0.83, wpb=13534.8, bsz=468.9, num_updates=46500, lr=6.55826e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=72, gb_free=13.2, wall=40563
2023-08-30 10:55:15 | INFO | train_inner | epoch 040:    171 / 1191 loss=1.755, trans_loss=4.489, nll_loss=1.646, w2v_ctc_loss=0.49, task_loss=3.278, contrastive_loss=0.145, total=6723.92, n_correct=5005.95, ppl=3.13, accuracy=74.45, wps=18677.3, ups=1.39, wpb=13447.8, bsz=450.2, num_updates=46600, lr=6.55122e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=71, gb_free=13.9, wall=40635
2023-08-30 10:56:28 | INFO | train_inner | epoch 040:    271 / 1191 loss=1.755, trans_loss=4.491, nll_loss=1.648, w2v_ctc_loss=0.483, task_loss=3.135, contrastive_loss=0.18, total=6753.31, n_correct=5019.12, ppl=3.13, accuracy=74.321, wps=18531.4, ups=1.37, wpb=13506.6, bsz=465.8, num_updates=46700, lr=6.5442e-05, gnorm=0.402, clip=0, loss_scale=16, train_wall=72, gb_free=14.8, wall=40708
2023-08-30 10:57:42 | INFO | train_inner | epoch 040:    371 / 1191 loss=1.763, trans_loss=4.493, nll_loss=1.651, w2v_ctc_loss=0.49, task_loss=3.51, contrastive_loss=0.21, total=6618.47, n_correct=4911.58, ppl=3.14, accuracy=74.21, wps=17922.8, ups=1.35, wpb=13236.9, bsz=438.2, num_updates=46800, lr=6.5372e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=73, gb_free=14.2, wall=40781
2023-08-30 10:58:54 | INFO | train_inner | epoch 040:    471 / 1191 loss=1.757, trans_loss=4.494, nll_loss=1.653, w2v_ctc_loss=0.485, task_loss=3.252, contrastive_loss=0.145, total=6719.05, n_correct=4990.57, ppl=3.14, accuracy=74.275, wps=18626.7, ups=1.39, wpb=13438.1, bsz=454.8, num_updates=46900, lr=6.53023e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=71, gb_free=13.8, wall=40854
2023-08-30 11:00:07 | INFO | train_inner | epoch 040:    571 / 1191 loss=1.758, trans_loss=4.493, nll_loss=1.65, w2v_ctc_loss=0.478, task_loss=3.23, contrastive_loss=0.252, total=6684.61, n_correct=4972.43, ppl=3.14, accuracy=74.386, wps=18372.3, ups=1.37, wpb=13369.2, bsz=455.8, num_updates=47000, lr=6.52328e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=72, gb_free=11.9, wall=40926
2023-08-30 11:01:20 | INFO | train_inner | epoch 040:    671 / 1191 loss=1.77, trans_loss=4.499, nll_loss=1.658, w2v_ctc_loss=0.493, task_loss=3.328, contrastive_loss=0.261, total=6699.46, n_correct=4966.12, ppl=3.16, accuracy=74.127, wps=18317.5, ups=1.37, wpb=13398.9, bsz=447.6, num_updates=47100, lr=6.51635e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=73, gb_free=7.6, wall=40999
2023-08-30 11:02:32 | INFO | train_inner | epoch 040:    771 / 1191 loss=1.764, trans_loss=4.499, nll_loss=1.658, w2v_ctc_loss=0.496, task_loss=3.392, contrastive_loss=0.161, total=6659.73, n_correct=4939.8, ppl=3.16, accuracy=74.174, wps=18359.9, ups=1.38, wpb=13319.5, bsz=443.6, num_updates=47200, lr=6.50945e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=12.3, wall=41072
2023-08-30 11:03:45 | INFO | train_inner | epoch 040:    871 / 1191 loss=1.768, trans_loss=4.501, nll_loss=1.662, w2v_ctc_loss=0.497, task_loss=3.423, contrastive_loss=0.192, total=6696.57, n_correct=4960.61, ppl=3.16, accuracy=74.077, wps=18285.8, ups=1.37, wpb=13393.1, bsz=441.7, num_updates=47300, lr=6.50256e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=73, gb_free=14.2, wall=41145
2023-08-30 11:04:58 | INFO | train_inner | epoch 040:    971 / 1191 loss=1.768, trans_loss=4.504, nll_loss=1.665, w2v_ctc_loss=0.491, task_loss=3.23, contrastive_loss=0.228, total=6694.1, n_correct=4959.25, ppl=3.17, accuracy=74.084, wps=18395.7, ups=1.37, wpb=13388.2, bsz=455.1, num_updates=47400, lr=6.4957e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=10.2, wall=41218
2023-08-30 11:06:11 | INFO | train_inner | epoch 040:   1071 / 1191 loss=1.763, trans_loss=4.497, nll_loss=1.657, w2v_ctc_loss=0.494, task_loss=3.288, contrastive_loss=0.18, total=6744.49, n_correct=5004.29, ppl=3.15, accuracy=74.198, wps=18476.2, ups=1.37, wpb=13489, bsz=455.8, num_updates=47500, lr=6.48886e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=41291
2023-08-30 11:06:14 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-30 11:07:25 | INFO | train_inner | epoch 040:   1172 / 1191 loss=1.761, trans_loss=4.499, nll_loss=1.659, w2v_ctc_loss=0.484, task_loss=3.207, contrastive_loss=0.21, total=6700.64, n_correct=4965.86, ppl=3.16, accuracy=74.11, wps=18290.1, ups=1.36, wpb=13401.3, bsz=461.8, num_updates=47600, lr=6.48204e-05, gnorm=0.405, clip=0, loss_scale=16, train_wall=73, gb_free=12.6, wall=41364
2023-08-30 11:07:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 11:08:11 | INFO | dev_st | epoch 040 | valid on 'dev_st' subset | loss 3.728 | trans_loss 4.851 | nll_loss 2.064 | w2v_ctc_loss 1.222 | task_loss 12.074 | contrastive_loss 0.411 | total 6138.43 | n_correct 4393.14 | ppl 4.18 | accuracy 71.568 | uer 16.49 | wer 18.129 | raw_wer 18.129 | bleu 28.96 | wps 1754.6 | wpb 6138.4 | bsz 201.1 | num_updates 47619 | best_bleu 29.3
2023-08-30 11:08:11 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 40 @ 47619 updates
2023-08-30 11:08:11 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-30 11:08:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt
2023-08-30 11:08:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_last.pt (epoch 40 @ 47619 updates, score 28.96) (writing took 8.277142330975039 seconds)
2023-08-30 11:08:19 | INFO | fairseq_cli.train | end of epoch 40 (average epoch stats below)
2023-08-30 11:08:19 | INFO | train | epoch 040 | loss 1.762 | trans_loss 4.496 | nll_loss 1.655 | w2v_ctc_loss 0.489 | task_loss 3.293 | contrastive_loss 0.196 | total 6703.69 | n_correct 4975.25 | ppl 3.15 | accuracy 74.217 | wps 17438.8 | ups 1.3 | wpb 13407.4 | bsz 452.2 | num_updates 47619 | lr 6.48074e-05 | gnorm 0.409 | clip 0 | loss_scale 16 | train_wall 858 | gb_free 12.1 | wall 41419
2023-08-30 11:08:19 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 11:08:19 | INFO | fairseq.trainer | begin training epoch 41
2023-08-30 11:08:19 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 11:09:26 | INFO | train_inner | epoch 041:     81 / 1191 loss=1.761, trans_loss=4.494, nll_loss=1.653, w2v_ctc_loss=0.488, task_loss=3.239, contrastive_loss=0.216, total=6722.93, n_correct=4992.61, ppl=3.14, accuracy=74.262, wps=11096.6, ups=0.83, wpb=13445.9, bsz=464.5, num_updates=47700, lr=6.47524e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=72, gb_free=14, wall=41486
2023-08-30 11:10:38 | INFO | train_inner | epoch 041:    181 / 1191 loss=1.764, trans_loss=4.49, nll_loss=1.647, w2v_ctc_loss=0.486, task_loss=3.37, contrastive_loss=0.246, total=6672.05, n_correct=4954.93, ppl=3.13, accuracy=74.264, wps=18392.2, ups=1.38, wpb=13344.1, bsz=445, num_updates=47800, lr=6.46846e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=72, gb_free=11.6, wall=41558
2023-08-30 11:11:52 | INFO | train_inner | epoch 041:    281 / 1191 loss=1.754, trans_loss=4.489, nll_loss=1.646, w2v_ctc_loss=0.477, task_loss=3.084, contrastive_loss=0.204, total=6804.18, n_correct=5062.56, ppl=3.13, accuracy=74.404, wps=18334.3, ups=1.35, wpb=13608.4, bsz=478.8, num_updates=47900, lr=6.46171e-05, gnorm=0.4, clip=0, loss_scale=16, train_wall=74, gb_free=12.9, wall=41632
2023-08-30 11:13:05 | INFO | train_inner | epoch 041:    381 / 1191 loss=1.754, trans_loss=4.491, nll_loss=1.648, w2v_ctc_loss=0.485, task_loss=3.179, contrastive_loss=0.148, total=6779.91, n_correct=5042.94, ppl=3.13, accuracy=74.381, wps=18640.9, ups=1.37, wpb=13559.8, bsz=459.7, num_updates=48000, lr=6.45497e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=41705
2023-08-30 11:13:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 11:13:37 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.719 | trans_loss 4.853 | nll_loss 2.067 | w2v_ctc_loss 1.191 | task_loss 11.979 | contrastive_loss 0.407 | total 6138.43 | n_correct 4395.43 | ppl 4.19 | accuracy 71.605 | uer 16.23 | wer 17.813 | raw_wer 17.813 | bleu 29.26 | wps 1777.4 | wpb 6138.4 | bsz 201.1 | num_updates 48000 | best_bleu 29.3
2023-08-30 11:13:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48000 updates
2023-08-30 11:13:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-30 11:13:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-30 11:13:45 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_41_48000.pt (epoch 41 @ 48000 updates, score 29.26) (writing took 7.209397400991293 seconds)
2023-08-30 11:14:58 | INFO | train_inner | epoch 041:    481 / 1191 loss=1.755, trans_loss=4.49, nll_loss=1.647, w2v_ctc_loss=0.488, task_loss=3.181, contrastive_loss=0.143, total=6790.05, n_correct=5051.4, ppl=3.13, accuracy=74.394, wps=12063.4, ups=0.89, wpb=13580.1, bsz=461.9, num_updates=48100, lr=6.44826e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=72, gb_free=12.3, wall=41818
2023-08-30 11:16:10 | INFO | train_inner | epoch 041:    581 / 1191 loss=1.751, trans_loss=4.485, nll_loss=1.64, w2v_ctc_loss=0.478, task_loss=3.154, contrastive_loss=0.166, total=6773.53, n_correct=5045.66, ppl=3.12, accuracy=74.491, wps=18781, ups=1.39, wpb=13547.1, bsz=458, num_updates=48200, lr=6.44157e-05, gnorm=0.404, clip=0, loss_scale=16, train_wall=71, gb_free=10.9, wall=41890
2023-08-30 11:17:23 | INFO | train_inner | epoch 041:    681 / 1191 loss=1.761, trans_loss=4.492, nll_loss=1.65, w2v_ctc_loss=0.492, task_loss=3.322, contrastive_loss=0.19, total=6677.75, n_correct=4958.59, ppl=3.14, accuracy=74.255, wps=18388.8, ups=1.38, wpb=13355.5, bsz=448.7, num_updates=48300, lr=6.43489e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=10.3, wall=41962
2023-08-30 11:18:36 | INFO | train_inner | epoch 041:    781 / 1191 loss=1.762, trans_loss=4.491, nll_loss=1.648, w2v_ctc_loss=0.492, task_loss=3.614, contrastive_loss=0.179, total=6547.43, n_correct=4858.47, ppl=3.13, accuracy=74.204, wps=17827.5, ups=1.36, wpb=13094.9, bsz=422.4, num_updates=48400, lr=6.42824e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=73, gb_free=12.8, wall=42036
2023-08-30 11:19:49 | INFO | train_inner | epoch 041:    881 / 1191 loss=1.763, trans_loss=4.491, nll_loss=1.648, w2v_ctc_loss=0.494, task_loss=3.533, contrastive_loss=0.184, total=6581.95, n_correct=4885.77, ppl=3.13, accuracy=74.23, wps=18035, ups=1.37, wpb=13163.9, bsz=427.6, num_updates=48500, lr=6.42161e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=10.4, wall=42109
2023-08-30 11:21:02 | INFO | train_inner | epoch 041:    981 / 1191 loss=1.767, trans_loss=4.5, nll_loss=1.66, w2v_ctc_loss=0.492, task_loss=3.44, contrastive_loss=0.218, total=6677.96, n_correct=4943.79, ppl=3.16, accuracy=74.031, wps=18293.8, ups=1.37, wpb=13355.9, bsz=444.6, num_updates=48600, lr=6.415e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=72, gb_free=13.8, wall=42182
2023-08-30 11:22:15 | INFO | train_inner | epoch 041:   1081 / 1191 loss=1.757, trans_loss=4.495, nll_loss=1.654, w2v_ctc_loss=0.482, task_loss=3.057, contrastive_loss=0.205, total=6841.34, n_correct=5081.44, ppl=3.15, accuracy=74.276, wps=18716.6, ups=1.37, wpb=13682.7, bsz=478.7, num_updates=48700, lr=6.40841e-05, gnorm=0.401, clip=0, loss_scale=16, train_wall=72, gb_free=14.2, wall=42255
2023-08-30 11:23:27 | INFO | train_inner | epoch 041:   1181 / 1191 loss=1.764, trans_loss=4.496, nll_loss=1.655, w2v_ctc_loss=0.488, task_loss=3.492, contrastive_loss=0.224, total=6589.42, n_correct=4888.72, ppl=3.15, accuracy=74.19, wps=18274.8, ups=1.39, wpb=13178.8, bsz=431.4, num_updates=48800, lr=6.40184e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=71, gb_free=13.2, wall=42327
2023-08-30 11:23:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 11:24:07 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.724 | trans_loss 4.854 | nll_loss 2.067 | w2v_ctc_loss 1.207 | task_loss 11.996 | contrastive_loss 0.403 | total 6138.43 | n_correct 4390.29 | ppl 4.19 | accuracy 71.521 | uer 16.474 | wer 18.23 | raw_wer 18.23 | bleu 29.18 | wps 1757.6 | wpb 6138.4 | bsz 201.1 | num_updates 48810 | best_bleu 29.3
2023-08-30 11:24:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48810 updates
2023-08-30 11:24:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1806.pt
2023-08-30 11:24:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1806.pt
2023-08-30 11:24:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint.best_bleu_29.1806.pt (epoch 41 @ 48810 updates, score 29.18) (writing took 7.80875408402062 seconds)
2023-08-30 11:24:15 | INFO | fairseq_cli.train | end of epoch 41 (average epoch stats below)
2023-08-30 11:24:15 | INFO | train | epoch 041 | loss 1.759 | trans_loss 4.492 | nll_loss 1.649 | w2v_ctc_loss 0.486 | task_loss 3.296 | contrastive_loss 0.194 | total 6703.69 | n_correct 4980.36 | ppl 3.14 | accuracy 74.293 | wps 16700.2 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 48810 | lr 6.40119e-05 | gnorm 0.41 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 11.3 | wall 42375
2023-08-30 11:24:15 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-30 11:24:15 | INFO | fairseq.trainer | begin training epoch 42
2023-08-30 11:24:15 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-30 11:25:29 | INFO | train_inner | epoch 042:     90 / 1191 loss=1.75, trans_loss=4.482, nll_loss=1.638, w2v_ctc_loss=0.474, task_loss=2.965, contrastive_loss=0.215, total=6824.86, n_correct=5088.9, ppl=3.11, accuracy=74.564, wps=11258.2, ups=0.82, wpb=13649.7, bsz=483.3, num_updates=48900, lr=6.39529e-05, gnorm=0.403, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=42448
2023-08-30 11:26:42 | INFO | train_inner | epoch 042:    190 / 1191 loss=1.764, trans_loss=4.489, nll_loss=1.646, w2v_ctc_loss=0.485, task_loss=3.414, contrastive_loss=0.27, total=6671.53, n_correct=4954.83, ppl=3.13, accuracy=74.268, wps=18244.3, ups=1.37, wpb=13343.1, bsz=441.1, num_updates=49000, lr=6.38877e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=73, gb_free=13.5, wall=42522
2023-08-30 11:27:55 | INFO | train_inner | epoch 042:    290 / 1191 loss=1.759, trans_loss=4.483, nll_loss=1.638, w2v_ctc_loss=0.492, task_loss=3.377, contrastive_loss=0.198, total=6650.86, n_correct=4950.37, ppl=3.11, accuracy=74.432, wps=18174.9, ups=1.37, wpb=13301.7, bsz=445.5, num_updates=49100, lr=6.38226e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=42595
2023-08-30 11:29:08 | INFO | train_inner | epoch 042:    390 / 1191 loss=1.752, trans_loss=4.482, nll_loss=1.637, w2v_ctc_loss=0.481, task_loss=3.386, contrastive_loss=0.185, total=6626.36, n_correct=4934.03, ppl=3.11, accuracy=74.461, wps=18213.3, ups=1.37, wpb=13252.7, bsz=447.3, num_updates=49200, lr=6.37577e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=42667
2023-08-30 11:30:21 | INFO | train_inner | epoch 042:    490 / 1191 loss=1.759, trans_loss=4.491, nll_loss=1.647, w2v_ctc_loss=0.489, task_loss=3.693, contrastive_loss=0.14, total=6622.87, n_correct=4921.32, ppl=3.13, accuracy=74.308, wps=18061, ups=1.36, wpb=13245.7, bsz=418.4, num_updates=49300, lr=6.3693e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=73, gb_free=14.2, wall=42741
2023-08-30 11:31:34 | INFO | train_inner | epoch 042:    590 / 1191 loss=1.764, trans_loss=4.492, nll_loss=1.65, w2v_ctc_loss=0.493, task_loss=3.529, contrastive_loss=0.22, total=6598.24, n_correct=4897.39, ppl=3.14, accuracy=74.223, wps=18112.6, ups=1.37, wpb=13196.5, bsz=431.9, num_updates=49400, lr=6.36285e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=12, wall=42814
2023-08-30 11:32:46 | INFO | train_inner | epoch 042:    690 / 1191 loss=1.753, trans_loss=4.489, nll_loss=1.645, w2v_ctc_loss=0.477, task_loss=3.008, contrastive_loss=0.207, total=6827.49, n_correct=5078.75, ppl=3.13, accuracy=74.387, wps=18850.5, ups=1.38, wpb=13655, bsz=480.8, num_updates=49500, lr=6.35642e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=72, gb_free=8.5, wall=42886
2023-08-30 11:33:59 | INFO | train_inner | epoch 042:    790 / 1191 loss=1.758, trans_loss=4.492, nll_loss=1.65, w2v_ctc_loss=0.485, task_loss=3.167, contrastive_loss=0.19, total=6715.54, n_correct=4992.31, ppl=3.14, accuracy=74.34, wps=18536.9, ups=1.38, wpb=13431.1, bsz=463.9, num_updates=49600, lr=6.35001e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=42959
2023-08-30 11:35:10 | INFO | train_inner | epoch 042:    890 / 1191 loss=1.752, trans_loss=4.482, nll_loss=1.637, w2v_ctc_loss=0.484, task_loss=3.393, contrastive_loss=0.151, total=6567.62, n_correct=4895.33, ppl=3.11, accuracy=74.537, wps=18326.8, ups=1.4, wpb=13135.2, bsz=440.7, num_updates=49700, lr=6.34361e-05, gnorm=0.412, clip=0, loss_scale=32, train_wall=71, gb_free=13.1, wall=43030
2023-08-30 11:36:23 | INFO | train_inner | epoch 042:    990 / 1191 loss=1.757, trans_loss=4.49, nll_loss=1.647, w2v_ctc_loss=0.481, task_loss=2.995, contrastive_loss=0.228, total=6827.16, n_correct=5076.01, ppl=3.13, accuracy=74.35, wps=18706.9, ups=1.37, wpb=13654.3, bsz=484, num_updates=49800, lr=6.33724e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=43103
2023-08-30 11:37:36 | INFO | train_inner | epoch 042:   1090 / 1191 loss=1.757, trans_loss=4.491, nll_loss=1.648, w2v_ctc_loss=0.487, task_loss=3.592, contrastive_loss=0.135, total=6664.62, n_correct=4948.72, ppl=3.13, accuracy=74.254, wps=18345.2, ups=1.38, wpb=13329.2, bsz=421.6, num_updates=49900, lr=6.33089e-05, gnorm=0.407, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=43176
2023-08-30 11:38:50 | INFO | train_inner | epoch 042:   1190 / 1191 loss=1.754, trans_loss=4.487, nll_loss=1.643, w2v_ctc_loss=0.483, task_loss=3.181, contrastive_loss=0.168, total=6824.38, n_correct=5082.8, ppl=3.12, accuracy=74.48, wps=18563.4, ups=1.36, wpb=13648.8, bsz=463.9, num_updates=50000, lr=6.32456e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=73, gb_free=14.2, wall=43249
2023-08-30 11:38:50 | INFO | fairseq_cli.train | Stopping training due to num_updates: 50000 >= max_update: 50000
2023-08-30 11:38:50 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-30 11:39:22 | INFO | dev_st | epoch 042 | valid on 'dev_st' subset | loss 3.726 | trans_loss 4.852 | nll_loss 2.063 | w2v_ctc_loss 1.216 | task_loss 11.996 | contrastive_loss 0.402 | total 6138.43 | n_correct 4398.14 | ppl 4.18 | accuracy 71.649 | uer 16.597 | wer 18.304 | raw_wer 18.304 | bleu 29.11 | wps 1758.6 | wpb 6138.4 | bsz 201.1 | num_updates 50000 | best_bleu 29.3
2023-08-30 11:39:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 42 @ 50000 updates
2023-08-30 11:39:22 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_42_50000.pt
2023-08-30 11:39:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_42_50000.pt
2023-08-30 11:39:32 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0830_both_topCL_AT_sentence_mixup0109_scale3.5_alpha1.0_mt0.5_nograd/checkpoint_42_50000.pt (epoch 42 @ 50000 updates, score 29.11) (writing took 9.670528871996794 seconds)
2023-08-30 11:39:32 | INFO | fairseq_cli.train | end of epoch 42 (average epoch stats below)
2023-08-30 11:39:32 | INFO | train | epoch 042 | loss 1.757 | trans_loss 4.488 | nll_loss 1.644 | w2v_ctc_loss 0.484 | task_loss 3.294 | contrastive_loss 0.194 | total 6705.54 | n_correct 4987.8 | ppl 3.13 | accuracy 74.383 | wps 17397.9 | ups 1.3 | wpb 13411.1 | bsz 452.3 | num_updates 50000 | lr 6.32456e-05 | gnorm 0.41 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 14.2 | wall 43292
2023-08-30 11:39:32 | INFO | fairseq_cli.train | done training in 43238.4 seconds
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    raise EOFError
EOFError
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    raise EOFError
EOFError
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1728 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
