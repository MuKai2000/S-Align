2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:13943
2023-08-27 00:50:35 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-27 00:50:36 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:50:36 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-27 00:50:40 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:13943', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 11000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 11000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-27 00:50:40 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 9,999
2023-08-27 00:50:40 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 9,999
2023-08-27 00:50:40 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-27 00:50:40 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-27 00:50:40 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline
2023-08-27 00:50:44 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-27 00:50:44 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_enfr_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-27 00:50:44 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-27 00:50:46 | INFO | root | load pretrained hubert
2023-08-27 00:50:53 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline
2023-08-27 00:50:58 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt
Traceback (most recent call last):
  File "/mnt/zhangyh/fairseq-AT/fairseq_cli/train.py", line 564, in <module>
    cli_main()
  File "/mnt/zhangyh/fairseq-AT/fairseq_cli/train.py", line 557, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/mnt/zhangyh/fairseq-AT/fairseq/distributed/utils.py", line 344, in call_main
    torch.multiprocessing.spawn(
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 239, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method='spawn')
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 197, in start_processes
    while not context.join():
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 160, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/multiprocessing/spawn.py", line 69, in _wrap
    fn(i, *args)
  File "/mnt/zhangyh/fairseq-AT/fairseq/distributed/utils.py", line 328, in distributed_main
    main(cfg, **kwargs)
  File "/mnt/zhangyh/fairseq-AT/fairseq_cli/train.py", line 96, in main
    model = task.build_model(cfg.model)
  File "/mnt/zhangyh/fairseq-AT/fairseq/tasks/joint_triple_pretraining_merge.py", line 420, in build_model
    models = super(SpeechToTextTask, self).build_model(args)
  File "/mnt/zhangyh/fairseq-AT/fairseq/tasks/fairseq_task.py", line 675, in build_model
    model = models.build_model(args, self, from_checkpoint)
  File "/mnt/zhangyh/fairseq-AT/fairseq/models/__init__.py", line 106, in build_model
    return model.build_model(cfg, task)
  File "/mnt/zhangyh/fairseq-AT/fairseq/models/speech_to_text/s2t_joint.py", line 613, in build_model
    decoder = cls.build_decoder(args, task, decoder_embed_tokens)
  File "/mnt/zhangyh/fairseq-AT/fairseq/models/speech_to_text/s2t_joint.py", line 563, in build_decoder
    decoder.load_state_dict(state["model"], strict=True)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/modules/module.py", line 2041, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for TransformerDecoderScriptable:
	size mismatch for embed_tokens.weight: copying a param with shape torch.Size([9998, 512]) from checkpoint, the shape in current model is torch.Size([9999, 512]).
	size mismatch for output_projection.weight: copying a param with shape torch.Size([9998, 512]) from checkpoint, the shape in current model is torch.Size([9999, 512]).

2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:14108
2023-08-27 00:54:37 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-27 00:54:37 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-27 00:54:38 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-27 00:54:38 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-27 00:54:42 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:14108', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 11000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 11000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-27 00:54:42 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 9,998
2023-08-27 00:54:42 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 9,998
2023-08-27 00:54:42 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-27 00:54:42 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-27 00:54:42 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline
2023-08-27 00:54:46 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-27 00:54:46 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_enfr_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-27 00:54:46 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-27 00:54:47 | INFO | root | load pretrained hubert
2023-08-27 00:54:55 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_mustc_enfr_baseline
2023-08-27 00:54:57 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt
2023-08-27 00:55:03 | INFO | root | load pretrained decoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/mustc/enfr-baseline/last8.ensemble.pt
2023-08-27 00:55:03 | INFO | root | share the sematic adapter and textual encoder
2023-08-27 00:55:04 | INFO | fairseq_cli.train | S2TJoint(
  (acoustic_encoder): AcousticEncoder(
    (compress_ffn): Linear(in_features=768, out_features=512, bias=True)
    (proj): Linear(in_features=512, out_features=9998, bias=False)
    (w2v_model): HubertModel(
      (feature_extractor): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Fp32GroupNorm(512, 512, eps=1e-05, affine=True)
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
        )
      )
      (post_extract_proj): Linear(in_features=512, out_features=768, bias=True)
      (dropout_input): Dropout(p=0.0, inplace=False)
      (dropout_features): Dropout(p=0.1, inplace=False)
      (encoder): TransformerEncoder(
        (pos_conv): Sequential(
          (0): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
          (1): SamePad()
          (2): GELU(approximate='none')
        )
        (layers): ModuleList(
          (0-11): 12 x TransformerSentenceEncoderLayer(
            (self_attn): MultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
            (dropout3): Dropout(p=0.1, inplace=False)
            (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
          )
        )
        (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      (final_proj): None
    )
    (noad): NormalAdapter(
      (subsample): Conv1dSubsampler(
        (conv_layers): ModuleList(
          (0): Conv1d(512, 512, kernel_size=(5,), stride=(2,), padding=(2,))
          (1): Conv1d(256, 1024, kernel_size=(5,), stride=(2,), padding=(2,))
        )
      )
      (layers): ModuleList()
    )
    (sead): SemanticAdapter(
      (embed_positions): SinusoidalPositionalEmbedding()
      (layers): ModuleList(
        (0-5): 6 x TransformerEncoderLayerBase(
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (fc1): Linear(in_features=512, out_features=1024, bias=True)
          (fc2): Linear(in_features=1024, out_features=512, bias=True)
          (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        )
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    )
    (final_dropout): Dropout(p=0.1, inplace=False)
    (shrink_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (textual_encoder): MTModelEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9998, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayerBase(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoderScriptable(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9998, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=1024, bias=True)
        (fc2): Linear(in_features=1024, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=512, out_features=9998, bias=False)
  )
  (task_net): TaskNetwork(
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (down_proj): Linear(in_features=512, out_features=256, bias=True)
    (up_proj): Linear(in_features=256, out_features=512, bias=True)
    (dropout_module): FairseqDropout()
    (task_proj): Linear(in_features=512, out_features=1, bias=False)
  )
)
2023-08-27 00:55:04 | INFO | fairseq_cli.train | task: JointTriplePretrainingMergeTask
2023-08-27 00:55:04 | INFO | fairseq_cli.train | model: S2TJoint
2023-08-27 00:55:04 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropywithW2vCtcShrinkJointATMerge
2023-08-27 00:55:04 | INFO | fairseq_cli.train | num. shared model params: 134,448,256 (num. trained: 134,448,256)
2023-08-27 00:55:04 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2023-08-27 00:55:04 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-27 00:55:04 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-27 00:55:04 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-27 00:55:04 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="dev_st", n_samples=1408, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-27 00:55:20 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:2 to store for rank: 0
2023-08-27 00:55:21 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- textual_encoder.embed_tokens.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.embed_tokens.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.output_projection.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.0.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.1.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.2.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.3.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.4.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.5.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.6.0.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- decoder.output_projection.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- task_net.task_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.weight <- textual_encoder.layers.0.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.bias <- textual_encoder.layers.0.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.weight <- textual_encoder.layers.0.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.bias <- textual_encoder.layers.0.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.weight <- textual_encoder.layers.0.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.bias <- textual_encoder.layers.0.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.weight <- textual_encoder.layers.0.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.bias <- textual_encoder.layers.0.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.weight <- textual_encoder.layers.0.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.bias <- textual_encoder.layers.0.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.weight <- textual_encoder.layers.0.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.bias <- textual_encoder.layers.0.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.weight <- textual_encoder.layers.0.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.bias <- textual_encoder.layers.0.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.weight <- textual_encoder.layers.0.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.bias <- textual_encoder.layers.0.final_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.weight <- textual_encoder.layers.1.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.bias <- textual_encoder.layers.1.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.weight <- textual_encoder.layers.1.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.bias <- textual_encoder.layers.1.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.weight <- textual_encoder.layers.1.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.bias <- textual_encoder.layers.1.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.weight <- textual_encoder.layers.1.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.bias <- textual_encoder.layers.1.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.weight <- textual_encoder.layers.1.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.bias <- textual_encoder.layers.1.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.weight <- textual_encoder.layers.1.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.bias <- textual_encoder.layers.1.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.weight <- textual_encoder.layers.1.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.bias <- textual_encoder.layers.1.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.weight <- textual_encoder.layers.1.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.bias <- textual_encoder.layers.1.final_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.weight <- textual_encoder.layers.2.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.bias <- textual_encoder.layers.2.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.weight <- textual_encoder.layers.2.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.bias <- textual_encoder.layers.2.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.weight <- textual_encoder.layers.2.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.bias <- textual_encoder.layers.2.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.weight <- textual_encoder.layers.2.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.bias <- textual_encoder.layers.2.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.weight <- textual_encoder.layers.2.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.bias <- textual_encoder.layers.2.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.weight <- textual_encoder.layers.2.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.bias <- textual_encoder.layers.2.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.weight <- textual_encoder.layers.2.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.bias <- textual_encoder.layers.2.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.weight <- textual_encoder.layers.2.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.bias <- textual_encoder.layers.2.final_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.weight <- textual_encoder.layers.3.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.bias <- textual_encoder.layers.3.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.weight <- textual_encoder.layers.3.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.bias <- textual_encoder.layers.3.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.weight <- textual_encoder.layers.3.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.bias <- textual_encoder.layers.3.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.weight <- textual_encoder.layers.3.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.bias <- textual_encoder.layers.3.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.weight <- textual_encoder.layers.3.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.bias <- textual_encoder.layers.3.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.weight <- textual_encoder.layers.3.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.bias <- textual_encoder.layers.3.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.weight <- textual_encoder.layers.3.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.bias <- textual_encoder.layers.3.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.weight <- textual_encoder.layers.3.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.bias <- textual_encoder.layers.3.final_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.weight <- textual_encoder.layers.4.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.bias <- textual_encoder.layers.4.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.weight <- textual_encoder.layers.4.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.bias <- textual_encoder.layers.4.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.weight <- textual_encoder.layers.4.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.bias <- textual_encoder.layers.4.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.weight <- textual_encoder.layers.4.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.bias <- textual_encoder.layers.4.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.weight <- textual_encoder.layers.4.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.bias <- textual_encoder.layers.4.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.weight <- textual_encoder.layers.4.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.bias <- textual_encoder.layers.4.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.weight <- textual_encoder.layers.4.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.bias <- textual_encoder.layers.4.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.weight <- textual_encoder.layers.4.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.bias <- textual_encoder.layers.4.final_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.weight <- textual_encoder.layers.5.self_attn.k_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.bias <- textual_encoder.layers.5.self_attn.k_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.weight <- textual_encoder.layers.5.self_attn.v_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.bias <- textual_encoder.layers.5.self_attn.v_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.weight <- textual_encoder.layers.5.self_attn.q_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.bias <- textual_encoder.layers.5.self_attn.q_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.weight <- textual_encoder.layers.5.self_attn.out_proj.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.bias <- textual_encoder.layers.5.self_attn.out_proj.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.weight <- textual_encoder.layers.5.self_attn_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.bias <- textual_encoder.layers.5.self_attn_layer_norm.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.weight <- textual_encoder.layers.5.fc1.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.bias <- textual_encoder.layers.5.fc1.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.weight <- textual_encoder.layers.5.fc2.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.bias <- textual_encoder.layers.5.fc2.bias
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.weight <- textual_encoder.layers.5.final_layer_norm.weight
2023-08-27 00:55:21 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.bias <- textual_encoder.layers.5.final_layer_norm.bias
2023-08-27 00:55:22 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   1: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   2: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   3: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   4: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   5: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   6: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | rank   7: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-27 00:55:22 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-27 00:55:22 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)
2023-08-27 00:55:22 | INFO | fairseq_cli.train | max tokens per device = 11000 and max sentences per device = None
2023-08-27 00:55:22 | INFO | fairseq.trainer | Preparing to load checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 00:55:22 | INFO | fairseq.trainer | No existing checkpoint found ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 00:55:22 | INFO | fairseq.trainer | loading train data for epoch 1
2023-08-27 00:55:22 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-27 00:55:22 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-27 00:55:22 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-27 00:55:24 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_asr", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-27 00:55:26 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_st", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-27 00:56:15 | INFO | fairseq.optim.adam | using FusedAdam
2023-08-27 00:56:15 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 00:56:15 | INFO | fairseq.trainer | begin training epoch 1
2023-08-27 00:56:15 | INFO | fairseq_cli.train | Start iterating over samples
True False
None None None
2023-08-27 00:56:27 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
2023-08-27 00:57:35 | INFO | train_inner | epoch 001:    101 / 1191 loss=19.269, trans_loss=5.217, nll_loss=3.719, w2v_ctc_loss=21.358, task_loss=3.07, contrastive_loss=3.71, total=6744.77, n_correct=488.43, ppl=13.17, accuracy=7.242, wps=28925, ups=1.48, wpb=19532.8, bsz=684.7, num_updates=100, lr=4.098e-06, gnorm=1.298, clip=0, loss_scale=64, train_wall=72, gb_free=17.9, wall=133
2023-08-27 00:58:24 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 00:58:42 | INFO | train_inner | epoch 001:    202 / 1191 loss=17.007, trans_loss=5.206, nll_loss=3.764, w2v_ctc_loss=17.967, task_loss=2.977, contrastive_loss=3.671, total=6677.06, n_correct=437.23, ppl=13.58, accuracy=6.548, wps=28673.5, ups=1.48, wpb=19351.4, bsz=676.1, num_updates=200, lr=8.096e-06, gnorm=4.766, clip=2, loss_scale=32, train_wall=67, gb_free=18.1, wall=201
2023-08-27 00:59:51 | INFO | train_inner | epoch 001:    302 / 1191 loss=9.903, trans_loss=5.393, nll_loss=4.018, w2v_ctc_loss=6.792, task_loss=2.392, contrastive_loss=3.708, total=6864.64, n_correct=439.38, ppl=16.2, accuracy=6.401, wps=29040.4, ups=1.46, wpb=19894.5, bsz=719.8, num_updates=300, lr=1.2094e-05, gnorm=2.315, clip=2, loss_scale=32, train_wall=68, gb_free=18.4, wall=269
2023-08-27 01:00:58 | INFO | train_inner | epoch 001:    402 / 1191 loss=9.179, trans_loss=5.4, nll_loss=4.042, w2v_ctc_loss=5.812, task_loss=2.61, contrastive_loss=3.565, total=6664.2, n_correct=429.29, ppl=16.47, accuracy=6.442, wps=28911.5, ups=1.5, wpb=19324, bsz=657.6, num_updates=400, lr=1.6092e-05, gnorm=0.657, clip=0, loss_scale=32, train_wall=66, gb_free=18.2, wall=336
2023-08-27 01:02:04 | INFO | train_inner | epoch 001:    502 / 1191 loss=9.108, trans_loss=5.568, nll_loss=4.247, w2v_ctc_loss=5.537, task_loss=2.322, contrastive_loss=3.577, total=6743.88, n_correct=456.97, ppl=18.98, accuracy=6.776, wps=29309.6, ups=1.5, wpb=19536.7, bsz=687.8, num_updates=500, lr=2.009e-05, gnorm=0.482, clip=0, loss_scale=32, train_wall=66, gb_free=18, wall=403
2023-08-27 01:03:11 | INFO | train_inner | epoch 001:    602 / 1191 loss=9.051, trans_loss=5.691, nll_loss=4.397, w2v_ctc_loss=5.417, task_loss=2.247, contrastive_loss=3.478, total=6761.26, n_correct=410.48, ppl=21.06, accuracy=6.071, wps=29448.2, ups=1.5, wpb=19590.9, bsz=685.7, num_updates=600, lr=2.4088e-05, gnorm=0.546, clip=0, loss_scale=32, train_wall=66, gb_free=19.2, wall=469
2023-08-27 01:04:17 | INFO | train_inner | epoch 001:    702 / 1191 loss=8.832, trans_loss=5.631, nll_loss=4.323, w2v_ctc_loss=5.296, task_loss=2.22, contrastive_loss=3.419, total=6642.51, n_correct=425.88, ppl=20.01, accuracy=6.411, wps=29038.3, ups=1.51, wpb=19237.1, bsz=677.7, num_updates=700, lr=2.8086e-05, gnorm=0.772, clip=0, loss_scale=32, train_wall=66, gb_free=17.9, wall=535
2023-08-27 01:05:24 | INFO | train_inner | epoch 001:    802 / 1191 loss=8.626, trans_loss=5.546, nll_loss=4.224, w2v_ctc_loss=5.208, task_loss=2.113, contrastive_loss=3.285, total=6747.81, n_correct=453.28, ppl=18.68, accuracy=6.717, wps=29283.2, ups=1.5, wpb=19542.8, bsz=688.1, num_updates=800, lr=3.2084e-05, gnorm=1.022, clip=0, loss_scale=32, train_wall=66, gb_free=18, wall=602
2023-08-27 01:06:31 | INFO | train_inner | epoch 001:    902 / 1191 loss=8.342, trans_loss=5.478, nll_loss=4.144, w2v_ctc_loss=5.072, task_loss=2.228, contrastive_loss=3.147, total=6700.77, n_correct=482.1, ppl=17.69, accuracy=7.195, wps=28790.5, ups=1.48, wpb=19418, bsz=674.4, num_updates=900, lr=3.6082e-05, gnorm=1.3, clip=0, loss_scale=32, train_wall=67, gb_free=19.2, wall=670
2023-08-27 01:07:38 | INFO | train_inner | epoch 001:   1002 / 1191 loss=8.062, trans_loss=5.433, nll_loss=4.096, w2v_ctc_loss=4.934, task_loss=2.298, contrastive_loss=2.959, total=6678.46, n_correct=509.71, ppl=17.1, accuracy=7.632, wps=29019.4, ups=1.5, wpb=19348.8, bsz=662.4, num_updates=1000, lr=4.008e-05, gnorm=1.83, clip=0, loss_scale=32, train_wall=66, gb_free=19.2, wall=736
2023-08-27 01:08:44 | INFO | train_inner | epoch 001:   1102 / 1191 loss=7.762, trans_loss=5.394, nll_loss=4.051, w2v_ctc_loss=4.76, task_loss=2.317, contrastive_loss=2.741, total=6555.89, n_correct=531.09, ppl=16.58, accuracy=8.101, wps=28910.2, ups=1.52, wpb=18987.4, bsz=643.4, num_updates=1100, lr=4.4078e-05, gnorm=2.01, clip=0, loss_scale=32, train_wall=65, gb_free=19.2, wall=802
2023-08-27 01:09:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2023-08-27 01:10:25 | INFO | dev_st | epoch 001 | valid on 'dev_st' subset | loss 10.47 | trans_loss 10.905 | nll_loss 9.935 | w2v_ctc_loss 6.306 | task_loss 14.021 | contrastive_loss 3.665 | total 6138.43 | n_correct 604.857 | ppl 978.64 | accuracy 9.854 | uer 84.601 | wer 83.042 | raw_wer 83.042 | bleu 0.01 | wps 1233.3 | wpb 6138.4 | bsz 201.1 | num_updates 1189
2023-08-27 01:10:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 1189 updates
2023-08-27 01:10:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:10:27 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:10:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 1 @ 1189 updates, score 0.01) (writing took 3.7146612429933157 seconds)
2023-08-27 01:10:29 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-08-27 01:10:29 | INFO | train | epoch 001 | loss 10.255 | trans_loss 5.444 | nll_loss 4.087 | w2v_ctc_loss 7.766 | task_loss 2.417 | contrastive_loss 3.34 | total 6703.15 | n_correct 468.377 | ppl 17 | accuracy 6.987 | wps 27438.7 | ups 1.41 | wpb 19421.1 | bsz 678 | num_updates 1189 | lr 4.76362e-05 | gnorm 1.588 | clip 0.3 | loss_scale 32 | train_wall 792 | gb_free 18.8 | wall 907
2023-08-27 01:10:29 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 01:10:29 | INFO | fairseq.trainer | begin training epoch 2
2023-08-27 01:10:29 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 01:10:46 | INFO | train_inner | epoch 002:     11 / 1191 loss=7.511, trans_loss=5.357, nll_loss=4.01, w2v_ctc_loss=4.57, task_loss=2.156, contrastive_loss=2.695, total=6641.52, n_correct=566.8, ppl=16.11, accuracy=8.534, wps=15716.5, ups=0.82, wpb=19248.9, bsz=683.9, num_updates=1200, lr=4.8076e-05, gnorm=2.094, clip=0, loss_scale=32, train_wall=65, gb_free=19, wall=924
2023-08-27 01:11:52 | INFO | train_inner | epoch 002:    111 / 1191 loss=7.2, trans_loss=5.358, nll_loss=4.008, w2v_ctc_loss=4.393, task_loss=2.264, contrastive_loss=2.452, total=6614.37, n_correct=568.18, ppl=16.09, accuracy=8.59, wps=28947.5, ups=1.51, wpb=19154.9, bsz=661.2, num_updates=1300, lr=5.2074e-05, gnorm=2.022, clip=0, loss_scale=32, train_wall=66, gb_free=18.3, wall=991
2023-08-27 01:12:59 | INFO | train_inner | epoch 002:    211 / 1191 loss=6.946, trans_loss=5.34, nll_loss=3.987, w2v_ctc_loss=4.221, task_loss=2.225, contrastive_loss=2.236, total=6725.54, n_correct=591.95, ppl=15.86, accuracy=8.802, wps=28986.2, ups=1.49, wpb=19480.3, bsz=673.3, num_updates=1400, lr=5.6072e-05, gnorm=2.395, clip=0, loss_scale=32, train_wall=66, gb_free=18.3, wall=1058
2023-08-27 01:14:07 | INFO | train_inner | epoch 002:    311 / 1191 loss=6.721, trans_loss=5.329, nll_loss=3.975, w2v_ctc_loss=4.057, task_loss=2.123, contrastive_loss=2.089, total=6761.98, n_correct=608.29, ppl=15.73, accuracy=8.996, wps=29182.1, ups=1.49, wpb=19593.7, bsz=688.1, num_updates=1500, lr=6.007e-05, gnorm=2.331, clip=0, loss_scale=32, train_wall=67, gb_free=18.5, wall=1125
2023-08-27 01:15:13 | INFO | train_inner | epoch 002:    411 / 1191 loss=6.514, trans_loss=5.324, nll_loss=3.969, w2v_ctc_loss=3.893, task_loss=2.15, contrastive_loss=2.01, total=6723.78, n_correct=605.96, ppl=15.66, accuracy=9.012, wps=29424.5, ups=1.51, wpb=19488.4, bsz=690.5, num_updates=1600, lr=6.4068e-05, gnorm=2.395, clip=0, loss_scale=32, train_wall=66, gb_free=18.8, wall=1191
2023-08-27 01:16:19 | INFO | train_inner | epoch 002:    511 / 1191 loss=6.314, trans_loss=5.313, nll_loss=3.956, w2v_ctc_loss=3.75, task_loss=2.22, contrastive_loss=1.924, total=6699.63, n_correct=614.74, ppl=15.52, accuracy=9.176, wps=29404.3, ups=1.51, wpb=19416.3, bsz=681.4, num_updates=1700, lr=6.8066e-05, gnorm=2.191, clip=0, loss_scale=32, train_wall=65, gb_free=17.8, wall=1257
2023-08-27 01:17:25 | INFO | train_inner | epoch 002:    611 / 1191 loss=6.095, trans_loss=5.302, nll_loss=3.939, w2v_ctc_loss=3.598, task_loss=2.286, contrastive_loss=1.773, total=6630.47, n_correct=622.54, ppl=15.34, accuracy=9.389, wps=28985.6, ups=1.51, wpb=19200, bsz=655.2, num_updates=1800, lr=7.2064e-05, gnorm=2.188, clip=0, loss_scale=32, train_wall=66, gb_free=18.5, wall=1323
2023-08-27 01:18:31 | INFO | train_inner | epoch 002:    711 / 1191 loss=5.95, trans_loss=5.285, nll_loss=3.919, w2v_ctc_loss=3.451, task_loss=2.095, contrastive_loss=1.7, total=6799.26, n_correct=654.24, ppl=15.13, accuracy=9.622, wps=29733.7, ups=1.51, wpb=19684.8, bsz=702.6, num_updates=1900, lr=7.6062e-05, gnorm=1.97, clip=0, loss_scale=32, train_wall=66, gb_free=17.9, wall=1390
2023-08-27 01:19:38 | INFO | train_inner | epoch 002:    811 / 1191 loss=5.768, trans_loss=5.264, nll_loss=3.894, w2v_ctc_loss=3.343, task_loss=2.15, contrastive_loss=1.5, total=6733.17, n_correct=670.06, ppl=14.87, accuracy=9.952, wps=29397, ups=1.51, wpb=19507.2, bsz=675.5, num_updates=2000, lr=8.006e-05, gnorm=2.136, clip=0, loss_scale=32, train_wall=66, gb_free=19.3, wall=1456
2023-08-27 01:19:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 01:20:21 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 9.025 | trans_loss 10.519 | nll_loss 9.454 | w2v_ctc_loss 4.347 | task_loss 14.015 | contrastive_loss 2.018 | total 6138.43 | n_correct 686.429 | ppl 701.42 | accuracy 11.182 | uer 63.148 | wer 60.878 | raw_wer 60.878 | bleu 0.02 | wps 1219.6 | wpb 6138.4 | bsz 201.1 | num_updates 2000 | best_bleu 0.02
2023-08-27 01:20:21 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2000 updates
2023-08-27 01:20:21 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-27 01:20:23 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-27 01:20:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.02) (writing took 10.131181231001392 seconds)
2023-08-27 01:21:38 | INFO | train_inner | epoch 002:    911 / 1191 loss=5.637, trans_loss=5.247, nll_loss=3.874, w2v_ctc_loss=3.22, task_loss=2.109, contrastive_loss=1.585, total=6730.16, n_correct=687.68, ppl=14.67, accuracy=10.218, wps=16265.3, ups=0.83, wpb=19506, bsz=703.6, num_updates=2100, lr=8.4058e-05, gnorm=1.761, clip=0, loss_scale=32, train_wall=66, gb_free=19.3, wall=1576
2023-08-27 01:22:44 | INFO | train_inner | epoch 002:   1011 / 1191 loss=5.491, trans_loss=5.229, nll_loss=3.854, w2v_ctc_loss=3.136, task_loss=2.164, contrastive_loss=1.42, total=6779.61, n_correct=709.31, ppl=14.46, accuracy=10.462, wps=29568.8, ups=1.5, wpb=19656.6, bsz=690.2, num_updates=2200, lr=8.8056e-05, gnorm=1.53, clip=0, loss_scale=32, train_wall=66, gb_free=18.6, wall=1642
2023-08-27 01:23:50 | INFO | train_inner | epoch 002:   1111 / 1191 loss=5.344, trans_loss=5.208, nll_loss=3.823, w2v_ctc_loss=3.046, task_loss=2.265, contrastive_loss=1.288, total=6673.29, n_correct=735.94, ppl=14.15, accuracy=11.028, wps=29416.8, ups=1.52, wpb=19328.4, bsz=659.8, num_updates=2300, lr=9.2054e-05, gnorm=1.495, clip=0, loss_scale=64, train_wall=65, gb_free=18.1, wall=1708
2023-08-27 01:24:43 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 01:25:26 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 8.518 | trans_loss 10.228 | nll_loss 9.085 | w2v_ctc_loss 3.83 | task_loss 14.015 | contrastive_loss 1.563 | total 6138.43 | n_correct 835.714 | ppl 543.23 | accuracy 13.614 | uer 58.222 | wer 56.199 | raw_wer 56.199 | bleu 0.05 | wps 1225.1 | wpb 6138.4 | bsz 201.1 | num_updates 2380 | best_bleu 0.05
2023-08-27 01:25:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2380 updates
2023-08-27 01:25:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:25:31 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:25:37 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 2 @ 2380 updates, score 0.05) (writing took 10.85991337399173 seconds)
2023-08-27 01:25:37 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-08-27 01:25:37 | INFO | train | epoch 002 | loss 6.129 | trans_loss 5.285 | nll_loss 3.92 | w2v_ctc_loss 3.609 | task_loss 2.194 | contrastive_loss 1.791 | total 6703.69 | n_correct 647.447 | ppl 15.14 | accuracy 9.658 | wps 25466.5 | ups 1.31 | wpb 19422.7 | bsz 678.2 | num_updates 2380 | lr 9.52524e-05 | gnorm 1.999 | clip 0 | loss_scale 64 | train_wall 783 | gb_free 18 | wall 1815
2023-08-27 01:25:37 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 01:25:37 | INFO | fairseq.trainer | begin training epoch 3
2023-08-27 01:25:37 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 01:25:58 | INFO | train_inner | epoch 003:     20 / 1191 loss=5.25, trans_loss=5.197, nll_loss=3.812, w2v_ctc_loss=2.976, task_loss=2.332, contrastive_loss=1.312, total=6595.48, n_correct=731.47, ppl=14.04, accuracy=11.09, wps=14928.4, ups=0.78, wpb=19119.7, bsz=656.3, num_updates=2400, lr=9.6052e-05, gnorm=1.439, clip=0, loss_scale=64, train_wall=66, gb_free=18.5, wall=1836
2023-08-27 01:27:04 | INFO | train_inner | epoch 003:    120 / 1191 loss=5.145, trans_loss=5.171, nll_loss=3.78, w2v_ctc_loss=2.882, task_loss=2.17, contrastive_loss=1.263, total=6692.7, n_correct=772.63, ppl=13.73, accuracy=11.544, wps=29132.6, ups=1.5, wpb=19403.6, bsz=684.3, num_updates=2500, lr=0.00010005, gnorm=1.288, clip=0, loss_scale=64, train_wall=66, gb_free=19.4, wall=1903
2023-08-27 01:28:11 | INFO | train_inner | epoch 003:    220 / 1191 loss=5.037, trans_loss=5.162, nll_loss=3.767, w2v_ctc_loss=2.789, task_loss=2.119, contrastive_loss=1.221, total=6725.36, n_correct=792.29, ppl=13.61, accuracy=11.781, wps=29139.7, ups=1.5, wpb=19489.1, bsz=687.9, num_updates=2600, lr=0.000104048, gnorm=1.213, clip=0, loss_scale=64, train_wall=66, gb_free=17.7, wall=1970
2023-08-27 01:29:17 | INFO | train_inner | epoch 003:    320 / 1191 loss=4.917, trans_loss=5.146, nll_loss=3.744, w2v_ctc_loss=2.763, task_loss=2.52, contrastive_loss=1.028, total=6563.99, n_correct=787.19, ppl=13.4, accuracy=11.993, wps=28746.5, ups=1.51, wpb=19008, bsz=622.1, num_updates=2700, lr=0.000108046, gnorm=1.203, clip=0, loss_scale=64, train_wall=65, gb_free=17.8, wall=2036
2023-08-27 01:30:23 | INFO | train_inner | epoch 003:    420 / 1191 loss=4.863, trans_loss=5.123, nll_loss=3.717, w2v_ctc_loss=2.671, task_loss=2.172, contrastive_loss=1.157, total=6684.68, n_correct=830.47, ppl=13.15, accuracy=12.423, wps=29464, ups=1.52, wpb=19370.9, bsz=686, num_updates=2800, lr=0.000112044, gnorm=0.961, clip=0, loss_scale=64, train_wall=65, gb_free=18.3, wall=2102
2023-08-27 01:31:30 | INFO | train_inner | epoch 003:    520 / 1191 loss=4.786, trans_loss=5.117, nll_loss=3.71, w2v_ctc_loss=2.641, task_loss=2.154, contrastive_loss=0.96, total=6758.8, n_correct=851.29, ppl=13.08, accuracy=12.595, wps=29413.2, ups=1.5, wpb=19583.9, bsz=680.5, num_updates=2900, lr=0.000116042, gnorm=0.963, clip=0, loss_scale=64, train_wall=66, gb_free=18.6, wall=2168
2023-08-27 01:32:36 | INFO | train_inner | epoch 003:    620 / 1191 loss=4.711, trans_loss=5.096, nll_loss=3.684, w2v_ctc_loss=2.596, task_loss=2.227, contrastive_loss=0.938, total=6749.81, n_correct=867.69, ppl=12.85, accuracy=12.855, wps=29491, ups=1.51, wpb=19563.6, bsz=664, num_updates=3000, lr=0.00012004, gnorm=0.93, clip=0, loss_scale=64, train_wall=66, gb_free=18.4, wall=2235
2023-08-27 01:32:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 01:32:38 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-27 01:32:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-27 01:32:41 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
2023-08-27 01:34:25 | INFO | train_inner | epoch 003:    724 / 1191 loss=3.926, trans_loss=4.335, nll_loss=2.679, w2v_ctc_loss=2.26, task_loss=1.55, contrastive_loss=0.93, total=6725.16, n_correct=2017.85, ppl=6.4, accuracy=30.004, wps=17900, ups=0.92, wpb=19491.2, bsz=695.5, num_updates=3100, lr=0.000124038, gnorm=1.998, clip=1, loss_scale=4, train_wall=108, gb_free=14.5, wall=2343
2023-08-27 01:36:08 | INFO | train_inner | epoch 003:    824 / 1191 loss=3.365, trans_loss=4.037, nll_loss=2.288, w2v_ctc_loss=1.986, task_loss=1.447, contrastive_loss=0.683, total=6767.26, n_correct=2626.05, ppl=4.88, accuracy=38.805, wps=18983.5, ups=0.97, wpb=19615.8, bsz=703.5, num_updates=3200, lr=0.000128036, gnorm=1.182, clip=0, loss_scale=4, train_wall=103, gb_free=13.7, wall=2447
2023-08-27 01:37:51 | INFO | train_inner | epoch 003:    924 / 1191 loss=3.156, trans_loss=3.935, nll_loss=2.152, w2v_ctc_loss=1.851, task_loss=1.393, contrastive_loss=0.592, total=6810.72, n_correct=2897.72, ppl=4.44, accuracy=42.546, wps=19223.9, ups=0.97, wpb=19727.4, bsz=717.9, num_updates=3300, lr=0.000132034, gnorm=1.081, clip=0, loss_scale=4, train_wall=102, gb_free=13.1, wall=2549
2023-08-27 01:39:36 | INFO | train_inner | epoch 003:   1024 / 1191 loss=3.021, trans_loss=3.89, nll_loss=2.092, w2v_ctc_loss=1.799, task_loss=1.787, contrastive_loss=0.471, total=6546.4, n_correct=2904.58, ppl=4.26, accuracy=44.369, wps=18128, ups=0.96, wpb=18970.7, bsz=618.6, num_updates=3400, lr=0.000136032, gnorm=1.024, clip=0, loss_scale=4, train_wall=104, gb_free=13.5, wall=2654
2023-08-27 01:41:20 | INFO | train_inner | epoch 003:   1124 / 1191 loss=2.906, trans_loss=3.822, nll_loss=2.002, w2v_ctc_loss=1.689, task_loss=1.483, contrastive_loss=0.507, total=6759.46, n_correct=3184.97, ppl=4.01, accuracy=47.119, wps=18705.5, ups=0.96, wpb=19569.3, bsz=704, num_updates=3500, lr=0.00014003, gnorm=0.919, clip=0, loss_scale=4, train_wall=104, gb_free=14, wall=2759
2023-08-27 01:42:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 01:43:10 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 4.932 | trans_loss 6.174 | nll_loss 3.675 | w2v_ctc_loss 2.052 | task_loss 7.537 | contrastive_loss 0.543 | total 6138.43 | n_correct 3229.43 | ppl 12.78 | accuracy 52.61 | uer 32.717 | wer 32.428 | raw_wer 32.428 | bleu 11.15 | wps 1324.2 | wpb 6138.4 | bsz 201.1 | num_updates 3567 | best_bleu 11.15
2023-08-27 01:43:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 3567 updates
2023-08-27 01:43:10 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:43:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 01:43:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 3 @ 3567 updates, score 11.15) (writing took 11.71429958799854 seconds)
2023-08-27 01:43:22 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-08-27 01:43:22 | INFO | train | epoch 003 | loss 4.109 | trans_loss 4.584 | nll_loss 3.006 | w2v_ctc_loss 2.326 | task_loss 1.887 | contrastive_loss 0.872 | total 6703.78 | n_correct 1755.43 | ppl 8.03 | accuracy 26.186 | wps 21642.5 | ups 1.11 | wpb 19423 | bsz 678.3 | num_updates 3567 | lr 0.000142709 | gnorm 1.147 | clip 0.1 | loss_scale 4 | train_wall 998 | gb_free 15.3 | wall 2881
2023-08-27 01:43:22 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 01:43:22 | INFO | fairseq.trainer | begin training epoch 4
2023-08-27 01:43:22 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 01:44:04 | INFO | train_inner | epoch 004:     33 / 1191 loss=2.805, trans_loss=3.783, nll_loss=1.948, w2v_ctc_loss=1.634, task_loss=1.604, contrastive_loss=0.435, total=6584.98, n_correct=3206.1, ppl=3.86, accuracy=48.688, wps=11607, ups=0.61, wpb=19058.3, bsz=650.5, num_updates=3600, lr=0.000144028, gnorm=0.875, clip=0, loss_scale=4, train_wall=104, gb_free=13.6, wall=2923
2023-08-27 01:45:49 | INFO | train_inner | epoch 004:    133 / 1191 loss=2.709, trans_loss=3.733, nll_loss=1.886, w2v_ctc_loss=1.573, task_loss=1.588, contrastive_loss=0.357, total=6725.65, n_correct=3388.79, ppl=3.7, accuracy=50.386, wps=18574.6, ups=0.95, wpb=19481.6, bsz=657.2, num_updates=3700, lr=0.000148026, gnorm=0.849, clip=0, loss_scale=4, train_wall=104, gb_free=12.3, wall=3028
2023-08-27 01:47:33 | INFO | train_inner | epoch 004:    233 / 1191 loss=2.698, trans_loss=3.707, nll_loss=1.853, w2v_ctc_loss=1.531, task_loss=1.495, contrastive_loss=0.528, total=6748.29, n_correct=3477.68, ppl=3.61, accuracy=51.534, wps=18932, ups=0.97, wpb=19555.5, bsz=700.2, num_updates=3800, lr=0.000152024, gnorm=0.879, clip=0, loss_scale=4, train_wall=103, gb_free=11.9, wall=3131
2023-08-27 01:49:15 | INFO | train_inner | epoch 004:    333 / 1191 loss=2.613, trans_loss=3.687, nll_loss=1.828, w2v_ctc_loss=1.503, task_loss=1.54, contrastive_loss=0.337, total=6673.75, n_correct=3501.46, ppl=3.55, accuracy=52.466, wps=18819, ups=0.97, wpb=19340, bsz=664.8, num_updates=3900, lr=0.000156022, gnorm=0.802, clip=0, loss_scale=4, train_wall=102, gb_free=13.4, wall=3234
2023-08-27 01:51:00 | INFO | train_inner | epoch 004:    433 / 1191 loss=2.614, trans_loss=3.671, nll_loss=1.806, w2v_ctc_loss=1.484, task_loss=1.557, contrastive_loss=0.473, total=6706.67, n_correct=3561.43, ppl=3.5, accuracy=53.103, wps=18645.3, ups=0.96, wpb=19435.3, bsz=683.2, num_updates=4000, lr=0.00016002, gnorm=0.805, clip=0, loss_scale=4, train_wall=104, gb_free=14.4, wall=3338
2023-08-27 01:51:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 01:51:37 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 4.588 | trans_loss 5.847 | nll_loss 3.243 | w2v_ctc_loss 1.768 | task_loss 7.903 | contrastive_loss 0.413 | total 6138.43 | n_correct 3528.71 | ppl 9.47 | accuracy 57.486 | uer 28.57 | wer 29.223 | raw_wer 29.223 | bleu 16.77 | wps 1461.2 | wpb 6138.4 | bsz 201.1 | num_updates 4000 | best_bleu 16.77
2023-08-27 01:51:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4000 updates
2023-08-27 01:51:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-27 01:51:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-27 01:51:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt (epoch 4 @ 4000 updates, score 16.77) (writing took 10.812702708994038 seconds)
2023-08-27 01:53:32 | INFO | train_inner | epoch 004:    533 / 1191 loss=2.535, trans_loss=3.649, nll_loss=1.777, w2v_ctc_loss=1.451, task_loss=1.591, contrastive_loss=0.292, total=6664.83, n_correct=3602.52, ppl=3.43, accuracy=54.053, wps=12640, ups=0.65, wpb=19309.1, bsz=662.9, num_updates=4100, lr=0.000164018, gnorm=0.776, clip=0, loss_scale=4, train_wall=103, gb_free=13, wall=3491
2023-08-27 01:55:17 | INFO | train_inner | epoch 004:    633 / 1191 loss=2.53, trans_loss=3.635, nll_loss=1.763, w2v_ctc_loss=1.427, task_loss=1.461, contrastive_loss=0.394, total=6836.09, n_correct=3740.35, ppl=3.39, accuracy=54.715, wps=18919.1, ups=0.95, wpb=19815.3, bsz=714.8, num_updates=4200, lr=0.000168016, gnorm=0.775, clip=0, loss_scale=4, train_wall=104, gb_free=15.2, wall=3596
2023-08-27 01:57:00 | INFO | train_inner | epoch 004:    733 / 1191 loss=2.494, trans_loss=3.619, nll_loss=1.738, w2v_ctc_loss=1.395, task_loss=1.525, contrastive_loss=0.404, total=6692.34, n_correct=3706.54, ppl=3.34, accuracy=55.385, wps=18884.5, ups=0.97, wpb=19385.6, bsz=683.6, num_updates=4300, lr=0.000172014, gnorm=0.755, clip=0, loss_scale=4, train_wall=102, gb_free=15, wall=3698
2023-08-27 01:58:45 | INFO | train_inner | epoch 004:    833 / 1191 loss=2.463, trans_loss=3.614, nll_loss=1.732, w2v_ctc_loss=1.369, task_loss=1.437, contrastive_loss=0.379, total=6858.25, n_correct=3831.12, ppl=3.32, accuracy=55.861, wps=18894.2, ups=0.95, wpb=19861.5, bsz=722.4, num_updates=4400, lr=0.000176012, gnorm=0.742, clip=0, loss_scale=4, train_wall=105, gb_free=11.5, wall=3803
2023-08-27 02:00:29 | INFO | train_inner | epoch 004:    933 / 1191 loss=2.431, trans_loss=3.593, nll_loss=1.705, w2v_ctc_loss=1.355, task_loss=1.468, contrastive_loss=0.342, total=6733.97, n_correct=3818.42, ppl=3.26, accuracy=56.704, wps=18748.8, ups=0.96, wpb=19496.2, bsz=702.5, num_updates=4500, lr=0.00018001, gnorm=0.728, clip=0, loss_scale=4, train_wall=103, gb_free=13.1, wall=3907
2023-08-27 02:02:15 | INFO | train_inner | epoch 004:   1033 / 1191 loss=2.417, trans_loss=3.594, nll_loss=1.708, w2v_ctc_loss=1.357, task_loss=1.64, contrastive_loss=0.303, total=6643.72, n_correct=3766.66, ppl=3.27, accuracy=56.695, wps=18213.1, ups=0.95, wpb=19244.1, bsz=662.2, num_updates=4600, lr=0.000184008, gnorm=0.727, clip=0, loss_scale=4, train_wall=105, gb_free=14.4, wall=4013
2023-08-27 02:03:58 | INFO | train_inner | epoch 004:   1133 / 1191 loss=2.369, trans_loss=3.577, nll_loss=1.687, w2v_ctc_loss=1.338, task_loss=1.658, contrastive_loss=0.216, total=6564.89, n_correct=3753.26, ppl=3.22, accuracy=57.172, wps=18375.2, ups=0.97, wpb=19032.7, bsz=632.2, num_updates=4700, lr=0.000188006, gnorm=0.708, clip=0, loss_scale=4, train_wall=103, gb_free=14.3, wall=4117
2023-08-27 02:04:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 02:05:34 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 4.348 | trans_loss 5.612 | nll_loss 2.939 | w2v_ctc_loss 1.549 | task_loss 8.079 | contrastive_loss 0.359 | total 6138.43 | n_correct 3743.57 | ppl 7.67 | accuracy 60.986 | uer 25.684 | wer 26.999 | raw_wer 26.999 | bleu 21.01 | wps 1498.1 | wpb 6138.4 | bsz 201.1 | num_updates 4758 | best_bleu 21.01
2023-08-27 02:05:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4758 updates
2023-08-27 02:05:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:05:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:05:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 4 @ 4758 updates, score 21.01) (writing took 10.329425179006648 seconds)
2023-08-27 02:05:44 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-08-27 02:05:44 | INFO | train | epoch 004 | loss 2.532 | trans_loss 3.643 | nll_loss 1.771 | w2v_ctc_loss 1.435 | task_loss 1.547 | contrastive_loss 0.361 | total 6703.69 | n_correct 3645.84 | ppl 3.41 | accuracy 54.386 | wps 17238.8 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 4758 | lr 0.000190325 | gnorm 0.776 | clip 0 | loss_scale 4 | train_wall 1232 | gb_free 13.5 | wall 4223
2023-08-27 02:05:44 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 02:05:44 | INFO | fairseq.trainer | begin training epoch 5
2023-08-27 02:05:44 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 02:06:34 | INFO | train_inner | epoch 005:     42 / 1191 loss=2.348, trans_loss=3.546, nll_loss=1.648, w2v_ctc_loss=1.3, task_loss=1.452, contrastive_loss=0.3, total=6756.35, n_correct=3934.09, ppl=3.13, accuracy=58.228, wps=12537, ups=0.64, wpb=19580.7, bsz=706.7, num_updates=4800, lr=0.000192004, gnorm=0.702, clip=0, loss_scale=4, train_wall=102, gb_free=13.6, wall=4273
2023-08-27 02:08:19 | INFO | train_inner | epoch 005:    142 / 1191 loss=2.322, trans_loss=3.544, nll_loss=1.643, w2v_ctc_loss=1.273, task_loss=1.538, contrastive_loss=0.302, total=6729.54, n_correct=3942.84, ppl=3.12, accuracy=58.59, wps=18706.1, ups=0.96, wpb=19497.4, bsz=684.1, num_updates=4900, lr=0.000196002, gnorm=0.694, clip=0, loss_scale=4, train_wall=104, gb_free=13.6, wall=4377
2023-08-27 02:10:02 | INFO | train_inner | epoch 005:    242 / 1191 loss=2.298, trans_loss=3.53, nll_loss=1.626, w2v_ctc_loss=1.258, task_loss=1.413, contrastive_loss=0.263, total=6861.39, n_correct=4055.51, ppl=3.09, accuracy=59.106, wps=19142.6, ups=0.96, wpb=19875.8, bsz=728.4, num_updates=5000, lr=0.0002, gnorm=0.685, clip=0, loss_scale=4, train_wall=103, gb_free=13.6, wall=4481
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:0')
2023-08-27 02:11:46 | INFO | train_inner | epoch 005:    342 / 1191 loss=2.279, trans_loss=3.529, nll_loss=1.624, w2v_ctc_loss=1.248, task_loss=1.613, contrastive_loss=0.266, total=6617.98, n_correct=3920.91, ppl=3.08, accuracy=59.246, wps=18448.6, ups=0.96, wpb=19172.5, bsz=661.2, num_updates=5100, lr=0.00019803, gnorm=0.453, clip=0, loss_scale=8, train_wall=103, gb_free=14.3, wall=4585
2023-08-27 02:13:30 | INFO | train_inner | epoch 005:    442 / 1191 loss=2.285, trans_loss=3.522, nll_loss=1.617, w2v_ctc_loss=1.25, task_loss=1.549, contrastive_loss=0.297, total=6686.19, n_correct=3971.22, ppl=3.07, accuracy=59.394, wps=18708.7, ups=0.97, wpb=19384.7, bsz=678.6, num_updates=5200, lr=0.000196116, gnorm=0.447, clip=0, loss_scale=8, train_wall=103, gb_free=13.7, wall=4688
2023-08-27 02:15:14 | INFO | train_inner | epoch 005:    542 / 1191 loss=2.282, trans_loss=3.521, nll_loss=1.614, w2v_ctc_loss=1.235, task_loss=1.576, contrastive_loss=0.349, total=6670.49, n_correct=3975.08, ppl=3.06, accuracy=59.592, wps=18517.9, ups=0.96, wpb=19320.9, bsz=674.2, num_updates=5300, lr=0.000194257, gnorm=0.461, clip=0, loss_scale=8, train_wall=104, gb_free=12.9, wall=4793
2023-08-27 02:16:57 | INFO | train_inner | epoch 005:    642 / 1191 loss=2.242, trans_loss=3.515, nll_loss=1.605, w2v_ctc_loss=1.228, task_loss=1.562, contrastive_loss=0.199, total=6700.63, n_correct=4026.97, ppl=3.04, accuracy=60.098, wps=18841, ups=0.97, wpb=19400.3, bsz=669.7, num_updates=5400, lr=0.00019245, gnorm=0.441, clip=0, loss_scale=8, train_wall=102, gb_free=14, wall=4896
2023-08-27 02:18:43 | INFO | train_inner | epoch 005:    742 / 1191 loss=2.249, trans_loss=3.503, nll_loss=1.594, w2v_ctc_loss=1.216, task_loss=1.543, contrastive_loss=0.297, total=6723.35, n_correct=4056.38, ppl=3.02, accuracy=60.333, wps=18476.7, ups=0.95, wpb=19489.5, bsz=686.6, num_updates=5500, lr=0.000190693, gnorm=0.443, clip=0, loss_scale=8, train_wall=105, gb_free=14.5, wall=5001
2023-08-27 02:20:27 | INFO | train_inner | epoch 005:    842 / 1191 loss=2.226, trans_loss=3.497, nll_loss=1.584, w2v_ctc_loss=1.202, task_loss=1.509, contrastive_loss=0.278, total=6774.08, n_correct=4103.47, ppl=3, accuracy=60.576, wps=18858, ups=0.96, wpb=19618.7, bsz=688.1, num_updates=5600, lr=0.000188982, gnorm=0.438, clip=0, loss_scale=8, train_wall=103, gb_free=14.1, wall=5105
2023-08-27 02:22:11 | INFO | train_inner | epoch 005:    942 / 1191 loss=2.222, trans_loss=3.501, nll_loss=1.592, w2v_ctc_loss=1.207, task_loss=1.64, contrastive_loss=0.258, total=6585.76, n_correct=3983.56, ppl=3.01, accuracy=60.487, wps=18280.3, ups=0.96, wpb=19088.7, bsz=652.1, num_updates=5700, lr=0.000187317, gnorm=0.438, clip=0, loss_scale=8, train_wall=104, gb_free=10.6, wall=5210
2023-08-27 02:23:55 | INFO | train_inner | epoch 005:   1042 / 1191 loss=2.208, trans_loss=3.499, nll_loss=1.588, w2v_ctc_loss=1.195, task_loss=1.644, contrastive_loss=0.24, total=6644.61, n_correct=4032.73, ppl=3.01, accuracy=60.692, wps=18487.7, ups=0.96, wpb=19250.1, bsz=649.3, num_updates=5800, lr=0.000185695, gnorm=0.43, clip=0, loss_scale=8, train_wall=104, gb_free=14.7, wall=5314
2023-08-27 02:25:39 | INFO | train_inner | epoch 005:   1142 / 1191 loss=2.209, trans_loss=3.492, nll_loss=1.58, w2v_ctc_loss=1.193, task_loss=1.571, contrastive_loss=0.251, total=6713.59, n_correct=4092.24, ppl=2.99, accuracy=60.955, wps=18833.9, ups=0.97, wpb=19450.3, bsz=671.6, num_updates=5900, lr=0.000184115, gnorm=0.437, clip=0, loss_scale=8, train_wall=103, gb_free=14, wall=5417
2023-08-27 02:26:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.5124, device='cuda:1')
2023-08-27 02:27:02 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.159 | trans_loss 5.447 | nll_loss 2.726 | w2v_ctc_loss 1.325 | task_loss 8.233 | contrastive_loss 0.318 | total 6138.43 | n_correct 3901.71 | ppl 6.61 | accuracy 63.562 | uer 21.689 | wer 23.183 | raw_wer 23.183 | bleu 23.33 | wps 1761.5 | wpb 6138.4 | bsz 201.1 | num_updates 5949 | best_bleu 23.33
2023-08-27 02:27:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 5949 updates
2023-08-27 02:27:02 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:27:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:27:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 5 @ 5949 updates, score 23.33) (writing took 9.713460486003896 seconds)
2023-08-27 02:27:12 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-08-27 02:27:12 | INFO | train | epoch 005 | loss 2.257 | trans_loss 3.513 | nll_loss 1.605 | w2v_ctc_loss 1.227 | task_loss 1.551 | contrastive_loss 0.276 | total 6703.69 | n_correct 4017.51 | ppl 3.04 | accuracy 59.93 | wps 17967.8 | ups 0.93 | wpb 19422.7 | bsz 678.2 | num_updates 5949 | lr 0.000183355 | gnorm 0.492 | clip 0 | loss_scale 8 | train_wall 1230 | gb_free 11.4 | wall 5510
2023-08-27 02:27:12 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 02:27:12 | INFO | fairseq.trainer | begin training epoch 6
2023-08-27 02:27:12 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 02:28:11 | INFO | train_inner | epoch 006:     51 / 1191 loss=2.164, trans_loss=3.462, nll_loss=1.541, w2v_ctc_loss=1.147, task_loss=1.581, contrastive_loss=0.279, total=6648.35, n_correct=4116.76, ppl=2.91, accuracy=61.922, wps=12638.6, ups=0.66, wpb=19266.5, bsz=660.3, num_updates=6000, lr=0.000182574, gnorm=0.428, clip=0, loss_scale=8, train_wall=102, gb_free=13.2, wall=5569
2023-08-27 02:28:11 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 02:28:44 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.159 | trans_loss 5.44 | nll_loss 2.708 | w2v_ctc_loss 1.356 | task_loss 8.23 | contrastive_loss 0.305 | total 6138.43 | n_correct 3915.14 | ppl 6.53 | accuracy 63.781 | uer 21.739 | wer 23.34 | raw_wer 23.34 | bleu 23.56 | wps 1709 | wpb 6138.4 | bsz 201.1 | num_updates 6000 | best_bleu 23.56
2023-08-27 02:28:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 6000 updates
2023-08-27 02:28:44 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-27 02:28:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-27 02:28:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt (epoch 6 @ 6000 updates, score 23.56) (writing took 11.058742869994603 seconds)
2023-08-27 02:30:40 | INFO | train_inner | epoch 006:    151 / 1191 loss=2.132, trans_loss=3.455, nll_loss=1.529, w2v_ctc_loss=1.125, task_loss=1.562, contrastive_loss=0.225, total=6729.16, n_correct=4185.74, ppl=2.89, accuracy=62.203, wps=13117.9, ups=0.67, wpb=19481, bsz=681.4, num_updates=6100, lr=0.000181071, gnorm=0.42, clip=0, loss_scale=8, train_wall=104, gb_free=12.3, wall=5718
2023-08-27 02:32:23 | INFO | train_inner | epoch 006:    251 / 1191 loss=2.146, trans_loss=3.448, nll_loss=1.523, w2v_ctc_loss=1.125, task_loss=1.465, contrastive_loss=0.289, total=6816.33, n_correct=4261.17, ppl=2.87, accuracy=62.514, wps=19075.5, ups=0.97, wpb=19749, bsz=710.9, num_updates=6200, lr=0.000179605, gnorm=0.423, clip=0, loss_scale=8, train_wall=103, gb_free=15, wall=5822
2023-08-27 02:34:09 | INFO | train_inner | epoch 006:    351 / 1191 loss=2.121, trans_loss=3.452, nll_loss=1.527, w2v_ctc_loss=1.124, task_loss=1.557, contrastive_loss=0.184, total=6739.97, n_correct=4205.78, ppl=2.88, accuracy=62.401, wps=18494.4, ups=0.95, wpb=19518.7, bsz=680.9, num_updates=6300, lr=0.000178174, gnorm=0.415, clip=0, loss_scale=8, train_wall=105, gb_free=10.4, wall=5927
2023-08-27 02:35:52 | INFO | train_inner | epoch 006:    451 / 1191 loss=2.136, trans_loss=3.45, nll_loss=1.526, w2v_ctc_loss=1.136, task_loss=1.629, contrastive_loss=0.255, total=6567.77, n_correct=4098.17, ppl=2.88, accuracy=62.398, wps=18501.3, ups=0.97, wpb=19034.6, bsz=647.5, num_updates=6400, lr=0.000176777, gnorm=0.425, clip=0, loss_scale=8, train_wall=102, gb_free=14.1, wall=6030
2023-08-27 02:37:37 | INFO | train_inner | epoch 006:    551 / 1191 loss=2.104, trans_loss=3.443, nll_loss=1.519, w2v_ctc_loss=1.116, task_loss=1.59, contrastive_loss=0.173, total=6698.06, n_correct=4194.59, ppl=2.87, accuracy=62.624, wps=18491.6, ups=0.95, wpb=19417.2, bsz=666, num_updates=6500, lr=0.000175412, gnorm=0.417, clip=0, loss_scale=8, train_wall=104, gb_free=14.5, wall=6135
2023-08-27 02:39:20 | INFO | train_inner | epoch 006:    651 / 1191 loss=2.114, trans_loss=3.451, nll_loss=1.527, w2v_ctc_loss=1.107, task_loss=1.641, contrastive_loss=0.245, total=6670.55, n_correct=4177.34, ppl=2.88, accuracy=62.624, wps=18614, ups=0.96, wpb=19319.8, bsz=653.8, num_updates=6600, lr=0.000174078, gnorm=0.415, clip=0, loss_scale=8, train_wall=103, gb_free=9.9, wall=6239
2023-08-27 02:41:04 | INFO | train_inner | epoch 006:    751 / 1191 loss=2.132, trans_loss=3.439, nll_loss=1.514, w2v_ctc_loss=1.108, task_loss=1.453, contrastive_loss=0.317, total=6837.55, n_correct=4307.51, ppl=2.86, accuracy=62.998, wps=19062.4, ups=0.96, wpb=19807.9, bsz=721.1, num_updates=6700, lr=0.000172774, gnorm=0.423, clip=0, loss_scale=8, train_wall=103, gb_free=13.6, wall=6343
2023-08-27 02:42:49 | INFO | train_inner | epoch 006:    851 / 1191 loss=2.114, trans_loss=3.438, nll_loss=1.516, w2v_ctc_loss=1.117, task_loss=1.603, contrastive_loss=0.225, total=6622.6, n_correct=4162.33, ppl=2.86, accuracy=62.85, wps=18314.4, ups=0.95, wpb=19204.8, bsz=672.6, num_updates=6800, lr=0.000171499, gnorm=0.416, clip=0, loss_scale=8, train_wall=104, gb_free=14.3, wall=6448
2023-08-27 02:44:34 | INFO | train_inner | epoch 006:    951 / 1191 loss=2.128, trans_loss=3.453, nll_loss=1.531, w2v_ctc_loss=1.115, task_loss=1.698, contrastive_loss=0.291, total=6630.12, n_correct=4152.13, ppl=2.89, accuracy=62.625, wps=18314.3, ups=0.95, wpb=19206, bsz=642.3, num_updates=6900, lr=0.000170251, gnorm=0.415, clip=0, loss_scale=8, train_wall=104, gb_free=15, wall=6552
2023-08-27 02:46:18 | INFO | train_inner | epoch 006:   1051 / 1191 loss=2.101, trans_loss=3.433, nll_loss=1.508, w2v_ctc_loss=1.088, task_loss=1.557, contrastive_loss=0.285, total=6685.75, n_correct=4225.75, ppl=2.84, accuracy=63.205, wps=18709.7, ups=0.97, wpb=19375.3, bsz=672.5, num_updates=7000, lr=0.000169031, gnorm=0.408, clip=0, loss_scale=8, train_wall=103, gb_free=13.6, wall=6656
2023-08-27 02:48:00 | INFO | train_inner | epoch 006:   1151 / 1191 loss=2.069, trans_loss=3.427, nll_loss=1.501, w2v_ctc_loss=1.08, task_loss=1.426, contrastive_loss=0.165, total=6760.7, n_correct=4292.84, ppl=2.83, accuracy=63.497, wps=19078.6, ups=0.97, wpb=19594.8, bsz=714.1, num_updates=7100, lr=0.000167836, gnorm=0.412, clip=0, loss_scale=16, train_wall=102, gb_free=14.4, wall=6759
2023-08-27 02:48:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 02:49:16 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.085 | trans_loss 5.372 | nll_loss 2.63 | w2v_ctc_loss 1.262 | task_loss 8.358 | contrastive_loss 0.307 | total 6138.43 | n_correct 3966.57 | ppl 6.19 | accuracy 64.619 | uer 20.969 | wer 22.707 | raw_wer 22.707 | bleu 24.57 | wps 1600 | wpb 6138.4 | bsz 201.1 | num_updates 7140 | best_bleu 24.57
2023-08-27 02:49:16 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 7140 updates
2023-08-27 02:49:16 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:49:22 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 02:49:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 6 @ 7140 updates, score 24.57) (writing took 10.732364629002404 seconds)
2023-08-27 02:49:27 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-08-27 02:49:27 | INFO | train | epoch 006 | loss 2.117 | trans_loss 3.444 | nll_loss 1.519 | w2v_ctc_loss 1.112 | task_loss 1.556 | contrastive_loss 0.242 | total 6703.69 | n_correct 4205.56 | ppl 2.87 | accuracy 62.735 | wps 17327.9 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 7140 | lr 0.000167365 | gnorm 0.417 | clip 0 | loss_scale 16 | train_wall 1230 | gb_free 13.7 | wall 6845
2023-08-27 02:49:27 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 02:49:27 | INFO | fairseq.trainer | begin training epoch 7
2023-08-27 02:49:27 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 02:50:36 | INFO | train_inner | epoch 007:     60 / 1191 loss=2.072, trans_loss=3.419, nll_loss=1.486, w2v_ctc_loss=1.064, task_loss=1.503, contrastive_loss=0.274, total=6736.11, n_correct=4290.91, ppl=2.8, accuracy=63.7, wps=12491.5, ups=0.64, wpb=19500.7, bsz=693.1, num_updates=7200, lr=0.000166667, gnorm=0.407, clip=0, loss_scale=16, train_wall=103, gb_free=14.6, wall=6915
2023-08-27 02:52:21 | INFO | train_inner | epoch 007:    160 / 1191 loss=2.047, trans_loss=3.403, nll_loss=1.47, w2v_ctc_loss=1.049, task_loss=1.61, contrastive_loss=0.254, total=6654.46, n_correct=4264.77, ppl=2.77, accuracy=64.089, wps=18376.6, ups=0.95, wpb=19304.2, bsz=668.5, num_updates=7300, lr=0.000165521, gnorm=0.408, clip=0, loss_scale=16, train_wall=104, gb_free=12.9, wall=7020
2023-08-27 02:54:05 | INFO | train_inner | epoch 007:    260 / 1191 loss=2.033, trans_loss=3.399, nll_loss=1.462, w2v_ctc_loss=1.05, task_loss=1.546, contrastive_loss=0.169, total=6696.07, n_correct=4306.74, ppl=2.75, accuracy=64.317, wps=18785.6, ups=0.97, wpb=19401.8, bsz=677, num_updates=7400, lr=0.000164399, gnorm=0.408, clip=0, loss_scale=16, train_wall=103, gb_free=14.4, wall=7123
2023-08-27 02:55:47 | INFO | train_inner | epoch 007:    360 / 1191 loss=2.005, trans_loss=3.391, nll_loss=1.453, w2v_ctc_loss=1.024, task_loss=1.501, contrastive_loss=0.149, total=6730.93, n_correct=4356.08, ppl=2.74, accuracy=64.717, wps=19118.1, ups=0.98, wpb=19507.5, bsz=689.7, num_updates=7500, lr=0.000163299, gnorm=0.401, clip=0, loss_scale=16, train_wall=101, gb_free=12.6, wall=7225
2023-08-27 02:57:30 | INFO | train_inner | epoch 007:    460 / 1191 loss=2.035, trans_loss=3.402, nll_loss=1.467, w2v_ctc_loss=1.034, task_loss=1.45, contrastive_loss=0.244, total=6794.45, n_correct=4372.21, ppl=2.77, accuracy=64.35, wps=19058.1, ups=0.97, wpb=19686.8, bsz=712.1, num_updates=7600, lr=0.000162221, gnorm=0.407, clip=0, loss_scale=16, train_wall=103, gb_free=14.2, wall=7328
2023-08-27 02:59:15 | INFO | train_inner | epoch 007:    560 / 1191 loss=2.027, trans_loss=3.406, nll_loss=1.472, w2v_ctc_loss=1.043, task_loss=1.611, contrastive_loss=0.169, total=6686.65, n_correct=4295.2, ppl=2.77, accuracy=64.235, wps=18535.1, ups=0.96, wpb=19371.4, bsz=667.1, num_updates=7700, lr=0.000161165, gnorm=0.4, clip=0, loss_scale=16, train_wall=104, gb_free=11.3, wall=7433
2023-08-27 03:00:59 | INFO | train_inner | epoch 007:    660 / 1191 loss=2.034, trans_loss=3.407, nll_loss=1.473, w2v_ctc_loss=1.027, task_loss=1.524, contrastive_loss=0.248, total=6757.98, n_correct=4340.4, ppl=2.78, accuracy=64.226, wps=18755.9, ups=0.96, wpb=19580.8, bsz=692.3, num_updates=7800, lr=0.000160128, gnorm=0.402, clip=0, loss_scale=16, train_wall=104, gb_free=13.5, wall=7537
2023-08-27 03:02:42 | INFO | train_inner | epoch 007:    760 / 1191 loss=2.015, trans_loss=3.405, nll_loss=1.47, w2v_ctc_loss=1.033, task_loss=1.583, contrastive_loss=0.159, total=6682.96, n_correct=4302.5, ppl=2.77, accuracy=64.38, wps=18758.5, ups=0.97, wpb=19354.4, bsz=672.3, num_updates=7900, lr=0.000159111, gnorm=0.399, clip=0, loss_scale=16, train_wall=103, gb_free=14.1, wall=7641
2023-08-27 03:04:11 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-27 03:04:28 | INFO | train_inner | epoch 007:    861 / 1191 loss=2.023, trans_loss=3.408, nll_loss=1.474, w2v_ctc_loss=1.024, task_loss=1.614, contrastive_loss=0.232, total=6669.46, n_correct=4286.7, ppl=2.78, accuracy=64.274, wps=18327.5, ups=0.95, wpb=19313.5, bsz=656.5, num_updates=8000, lr=0.000158114, gnorm=0.403, clip=0, loss_scale=8, train_wall=105, gb_free=13.1, wall=7746
2023-08-27 03:04:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 03:05:01 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.056 | trans_loss 5.318 | nll_loss 2.559 | w2v_ctc_loss 1.304 | task_loss 8.441 | contrastive_loss 0.292 | total 6138.43 | n_correct 4025.14 | ppl 5.89 | accuracy 65.573 | uer 19.595 | wer 21.242 | raw_wer 21.242 | bleu 25.59 | wps 1672.2 | wpb 6138.4 | bsz 201.1 | num_updates 8000 | best_bleu 25.59
2023-08-27 03:05:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8000 updates
2023-08-27 03:05:01 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-27 03:05:03 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-27 03:05:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt (epoch 7 @ 8000 updates, score 25.59) (writing took 10.526743330992758 seconds)
2023-08-27 03:06:56 | INFO | train_inner | epoch 007:    961 / 1191 loss=2.006, trans_loss=3.402, nll_loss=1.467, w2v_ctc_loss=1.027, task_loss=1.672, contrastive_loss=0.171, total=6616.88, n_correct=4271.02, ppl=2.77, accuracy=64.547, wps=12873.4, ups=0.67, wpb=19171.8, bsz=639.8, num_updates=8100, lr=0.000157135, gnorm=0.401, clip=0, loss_scale=8, train_wall=104, gb_free=11.3, wall=7895
2023-08-27 03:08:40 | INFO | train_inner | epoch 007:   1061 / 1191 loss=2.032, trans_loss=3.398, nll_loss=1.462, w2v_ctc_loss=1.024, task_loss=1.516, contrastive_loss=0.276, total=6683.03, n_correct=4322.59, ppl=2.76, accuracy=64.68, wps=18654.9, ups=0.96, wpb=19348.3, bsz=694.2, num_updates=8200, lr=0.000156174, gnorm=0.406, clip=0, loss_scale=8, train_wall=103, gb_free=13.7, wall=7999
2023-08-27 03:10:24 | INFO | train_inner | epoch 007:   1161 / 1191 loss=2.026, trans_loss=3.403, nll_loss=1.473, w2v_ctc_loss=1.025, task_loss=1.565, contrastive_loss=0.25, total=6730.91, n_correct=4335.63, ppl=2.78, accuracy=64.414, wps=18807.6, ups=0.96, wpb=19511.5, bsz=682.6, num_updates=8300, lr=0.00015523, gnorm=0.403, clip=0, loss_scale=8, train_wall=103, gb_free=13.5, wall=8102
2023-08-27 03:10:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 03:11:28 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.021 | trans_loss 5.312 | nll_loss 2.556 | w2v_ctc_loss 1.21 | task_loss 8.354 | contrastive_loss 0.283 | total 6138.43 | n_correct 4030.86 | ppl 5.88 | accuracy 65.666 | uer 19.103 | wer 20.837 | raw_wer 20.837 | bleu 24.96 | wps 1759.9 | wpb 6138.4 | bsz 201.1 | num_updates 8330 | best_bleu 25.59
2023-08-27 03:11:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8330 updates
2023-08-27 03:11:28 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_24.9608.pt
2023-08-27 03:11:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_24.9608.pt
2023-08-27 03:11:35 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_24.9608.pt (epoch 7 @ 8330 updates, score 24.96) (writing took 7.025432051988901 seconds)
2023-08-27 03:11:35 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-08-27 03:11:35 | INFO | train | epoch 007 | loss 2.027 | trans_loss 3.402 | nll_loss 1.468 | w2v_ctc_loss 1.034 | task_loss 1.559 | contrastive_loss 0.216 | total 6703.84 | n_correct 4315.39 | ppl 2.77 | accuracy 64.372 | wps 17400.4 | ups 0.9 | wpb 19423 | bsz 678 | num_updates 8330 | lr 0.00015495 | gnorm 0.404 | clip 0 | loss_scale 8 | train_wall 1230 | gb_free 12.9 | wall 8173
2023-08-27 03:11:35 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 03:11:35 | INFO | fairseq.trainer | begin training epoch 8
2023-08-27 03:11:35 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 03:12:55 | INFO | train_inner | epoch 008:     70 / 1191 loss=1.966, trans_loss=3.377, nll_loss=1.434, w2v_ctc_loss=0.989, task_loss=1.562, contrastive_loss=0.135, total=6730.54, n_correct=4397.99, ppl=2.7, accuracy=65.344, wps=12913.3, ups=0.66, wpb=19489.8, bsz=668, num_updates=8400, lr=0.000154303, gnorm=0.394, clip=0, loss_scale=8, train_wall=103, gb_free=12.9, wall=8253
2023-08-27 03:14:39 | INFO | train_inner | epoch 008:    170 / 1191 loss=1.986, trans_loss=3.366, nll_loss=1.424, w2v_ctc_loss=0.98, task_loss=1.491, contrastive_loss=0.286, total=6744.24, n_correct=4412.53, ppl=2.68, accuracy=65.427, wps=18779.2, ups=0.96, wpb=19557.6, bsz=714.2, num_updates=8500, lr=0.000153393, gnorm=0.401, clip=0, loss_scale=8, train_wall=103, gb_free=14.5, wall=8357
2023-08-27 03:16:24 | INFO | train_inner | epoch 008:    270 / 1191 loss=1.974, trans_loss=3.374, nll_loss=1.432, w2v_ctc_loss=0.983, task_loss=1.549, contrastive_loss=0.207, total=6744.09, n_correct=4416, ppl=2.7, accuracy=65.48, wps=18643, ups=0.95, wpb=19538.4, bsz=691.2, num_updates=8600, lr=0.000152499, gnorm=0.397, clip=0, loss_scale=8, train_wall=104, gb_free=14.4, wall=8462
2023-08-27 03:18:09 | INFO | train_inner | epoch 008:    370 / 1191 loss=1.961, trans_loss=3.381, nll_loss=1.442, w2v_ctc_loss=0.992, task_loss=1.692, contrastive_loss=0.132, total=6638.8, n_correct=4320.85, ppl=2.72, accuracy=65.085, wps=18277.8, ups=0.95, wpb=19244.1, bsz=639.1, num_updates=8700, lr=0.00015162, gnorm=0.396, clip=0, loss_scale=8, train_wall=105, gb_free=14.2, wall=8568
2023-08-27 03:19:54 | INFO | train_inner | epoch 008:    470 / 1191 loss=1.975, trans_loss=3.373, nll_loss=1.431, w2v_ctc_loss=0.988, task_loss=1.588, contrastive_loss=0.202, total=6672.44, n_correct=4362.89, ppl=2.7, accuracy=65.387, wps=18453.2, ups=0.95, wpb=19339.8, bsz=667.9, num_updates=8800, lr=0.000150756, gnorm=0.402, clip=0, loss_scale=8, train_wall=104, gb_free=12.1, wall=8672
2023-08-27 03:21:37 | INFO | train_inner | epoch 008:    570 / 1191 loss=1.958, trans_loss=3.375, nll_loss=1.434, w2v_ctc_loss=0.97, task_loss=1.604, contrastive_loss=0.21, total=6676.91, n_correct=4368.76, ppl=2.7, accuracy=65.431, wps=18747.3, ups=0.97, wpb=19346.2, bsz=671.5, num_updates=8900, lr=0.000149906, gnorm=0.394, clip=0, loss_scale=8, train_wall=103, gb_free=13.8, wall=8776
2023-08-27 03:23:20 | INFO | train_inner | epoch 008:    670 / 1191 loss=1.952, trans_loss=3.376, nll_loss=1.435, w2v_ctc_loss=0.977, task_loss=1.533, contrastive_loss=0.136, total=6735.41, n_correct=4412.92, ppl=2.7, accuracy=65.518, wps=18968.1, ups=0.97, wpb=19514.6, bsz=679.1, num_updates=9000, lr=0.000149071, gnorm=0.392, clip=0, loss_scale=8, train_wall=102, gb_free=14.7, wall=8878
2023-08-27 03:25:04 | INFO | train_inner | epoch 008:    770 / 1191 loss=1.97, trans_loss=3.379, nll_loss=1.44, w2v_ctc_loss=0.982, task_loss=1.603, contrastive_loss=0.216, total=6676.21, n_correct=4361.09, ppl=2.71, accuracy=65.323, wps=18597.6, ups=0.96, wpb=19347.4, bsz=667.7, num_updates=9100, lr=0.00014825, gnorm=0.394, clip=0, loss_scale=8, train_wall=103, gb_free=11.7, wall=8983
2023-08-27 03:26:47 | INFO | train_inner | epoch 008:    870 / 1191 loss=1.96, trans_loss=3.37, nll_loss=1.428, w2v_ctc_loss=0.979, task_loss=1.455, contrastive_loss=0.166, total=6793.29, n_correct=4462.77, ppl=2.69, accuracy=65.694, wps=19095.4, ups=0.97, wpb=19684.1, bsz=704.6, num_updates=9200, lr=0.000147442, gnorm=0.396, clip=0, loss_scale=8, train_wall=102, gb_free=12.2, wall=9086
2023-08-27 03:28:31 | INFO | train_inner | epoch 008:    970 / 1191 loss=1.985, trans_loss=3.387, nll_loss=1.449, w2v_ctc_loss=0.981, task_loss=1.611, contrastive_loss=0.265, total=6661.73, n_correct=4340.71, ppl=2.73, accuracy=65.159, wps=18561.2, ups=0.96, wpb=19290.2, bsz=660.9, num_updates=9300, lr=0.000146647, gnorm=0.398, clip=0, loss_scale=8, train_wall=103, gb_free=13.8, wall=9190
2023-08-27 03:30:14 | INFO | train_inner | epoch 008:   1070 / 1191 loss=1.948, trans_loss=3.38, nll_loss=1.437, w2v_ctc_loss=0.977, task_loss=1.598, contrastive_loss=0.124, total=6683.31, n_correct=4378.49, ppl=2.71, accuracy=65.514, wps=18718.4, ups=0.97, wpb=19336.8, bsz=662.3, num_updates=9400, lr=0.000145865, gnorm=0.396, clip=0, loss_scale=8, train_wall=103, gb_free=14.2, wall=9293
2023-08-27 03:31:57 | INFO | train_inner | epoch 008:   1170 / 1191 loss=1.974, trans_loss=3.365, nll_loss=1.425, w2v_ctc_loss=0.959, task_loss=1.44, contrastive_loss=0.314, total=6727.93, n_correct=4428.74, ppl=2.68, accuracy=65.826, wps=19022.5, ups=0.98, wpb=19499.6, bsz=718.4, num_updates=9500, lr=0.000145095, gnorm=0.4, clip=0, loss_scale=8, train_wall=102, gb_free=12.3, wall=9395
2023-08-27 03:32:19 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 03:32:53 | INFO | dev_st | epoch 008 | valid on 'dev_st' subset | loss 3.997 | trans_loss 5.287 | nll_loss 2.523 | w2v_ctc_loss 1.197 | task_loss 8.457 | contrastive_loss 0.266 | total 6138.43 | n_correct 4056.29 | ppl 5.75 | accuracy 66.08 | uer 18.217 | wer 19.996 | raw_wer 19.996 | bleu 26.02 | wps 1592.5 | wpb 6138.4 | bsz 201.1 | num_updates 9521 | best_bleu 26.02
2023-08-27 03:32:53 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 9521 updates
2023-08-27 03:32:53 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 03:32:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 03:33:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 8 @ 9521 updates, score 26.02) (writing took 10.433733662008308 seconds)
2023-08-27 03:33:04 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-08-27 03:33:04 | INFO | train | epoch 008 | loss 1.967 | trans_loss 3.374 | nll_loss 1.433 | w2v_ctc_loss 0.979 | task_loss 1.56 | contrastive_loss 0.205 | total 6703.69 | n_correct 4387.91 | ppl 2.7 | accuracy 65.455 | wps 17943.1 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 9521 | lr 0.000144935 | gnorm 0.397 | clip 0 | loss_scale 8 | train_wall 1228 | gb_free 14.2 | wall 9463
2023-08-27 03:33:04 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 03:33:04 | INFO | fairseq.trainer | begin training epoch 9
2023-08-27 03:33:04 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 03:34:33 | INFO | train_inner | epoch 009:     79 / 1191 loss=1.925, trans_loss=3.348, nll_loss=1.399, w2v_ctc_loss=0.936, task_loss=1.565, contrastive_loss=0.224, total=6681.43, n_correct=4433.28, ppl=2.64, accuracy=66.352, wps=12415, ups=0.64, wpb=19356.2, bsz=676, num_updates=9600, lr=0.000144338, gnorm=0.388, clip=0, loss_scale=8, train_wall=102, gb_free=11.8, wall=9551
2023-08-27 03:36:17 | INFO | train_inner | epoch 009:    179 / 1191 loss=1.911, trans_loss=3.341, nll_loss=1.392, w2v_ctc_loss=0.929, task_loss=1.524, contrastive_loss=0.197, total=6757.86, n_correct=4492.88, ppl=2.62, accuracy=66.484, wps=18771.3, ups=0.96, wpb=19588.1, bsz=692.6, num_updates=9700, lr=0.000143592, gnorm=0.386, clip=0, loss_scale=8, train_wall=104, gb_free=14.7, wall=9656
2023-08-27 03:38:00 | INFO | train_inner | epoch 009:    279 / 1191 loss=1.922, trans_loss=3.355, nll_loss=1.407, w2v_ctc_loss=0.95, task_loss=1.483, contrastive_loss=0.142, total=6797.76, n_correct=4501.97, ppl=2.65, accuracy=66.227, wps=19087.6, ups=0.97, wpb=19677.4, bsz=701.1, num_updates=9800, lr=0.000142857, gnorm=0.392, clip=0, loss_scale=8, train_wall=103, gb_free=9.6, wall=9759
2023-08-27 03:39:46 | INFO | train_inner | epoch 009:    379 / 1191 loss=1.918, trans_loss=3.351, nll_loss=1.404, w2v_ctc_loss=0.935, task_loss=1.531, contrastive_loss=0.195, total=6775.76, n_correct=4490.1, ppl=2.65, accuracy=66.267, wps=18596.1, ups=0.95, wpb=19634.3, bsz=694.7, num_updates=9900, lr=0.000142134, gnorm=0.388, clip=0, loss_scale=8, train_wall=105, gb_free=13.1, wall=9864
2023-08-27 03:41:31 | INFO | train_inner | epoch 009:    479 / 1191 loss=1.932, trans_loss=3.354, nll_loss=1.41, w2v_ctc_loss=0.948, task_loss=1.559, contrastive_loss=0.184, total=6696.55, n_correct=4435.55, ppl=2.66, accuracy=66.236, wps=18552.2, ups=0.96, wpb=19408.4, bsz=685.4, num_updates=10000, lr=0.000141421, gnorm=0.394, clip=0, loss_scale=8, train_wall=104, gb_free=14.1, wall=9969
2023-08-27 03:41:31 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 03:42:03 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.985 | trans_loss 5.281 | nll_loss 2.517 | w2v_ctc_loss 1.168 | task_loss 8.466 | contrastive_loss 0.274 | total 6138.43 | n_correct 4055.43 | ppl 5.72 | accuracy 66.066 | uer 17.824 | wer 19.55 | raw_wer 19.55 | bleu 25.51 | wps 1751.2 | wpb 6138.4 | bsz 201.1 | num_updates 10000 | best_bleu 26.02
2023-08-27 03:42:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10000 updates
2023-08-27 03:42:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-27 03:42:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-27 03:42:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt (epoch 9 @ 10000 updates, score 25.51) (writing took 6.4158695269870805 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 03:43:52 | INFO | train_inner | epoch 009:    579 / 1191 loss=1.91, trans_loss=3.348, nll_loss=1.401, w2v_ctc_loss=0.928, task_loss=1.588, contrastive_loss=0.185, total=6631.46, n_correct=4402.76, ppl=2.64, accuracy=66.392, wps=13545.4, ups=0.71, wpb=19212.3, bsz=667.7, num_updates=10100, lr=0.00014072, gnorm=0.31, clip=0, loss_scale=16, train_wall=102, gb_free=14.1, wall=10111
2023-08-27 03:45:36 | INFO | train_inner | epoch 009:    679 / 1191 loss=1.93, trans_loss=3.361, nll_loss=1.416, w2v_ctc_loss=0.943, task_loss=1.726, contrastive_loss=0.224, total=6564.56, n_correct=4335.49, ppl=2.67, accuracy=66.044, wps=18399.5, ups=0.97, wpb=19011.2, bsz=625.6, num_updates=10200, lr=0.000140028, gnorm=0.314, clip=0, loss_scale=16, train_wall=103, gb_free=15.3, wall=10214
2023-08-27 03:47:20 | INFO | train_inner | epoch 009:    779 / 1191 loss=1.936, trans_loss=3.357, nll_loss=1.414, w2v_ctc_loss=0.935, task_loss=1.55, contrastive_loss=0.246, total=6697.76, n_correct=4436.06, ppl=2.67, accuracy=66.232, wps=18602, ups=0.96, wpb=19409.9, bsz=686.9, num_updates=10300, lr=0.000139347, gnorm=0.315, clip=0, loss_scale=16, train_wall=104, gb_free=14.4, wall=10318
2023-08-27 03:49:03 | INFO | train_inner | epoch 009:    879 / 1191 loss=1.911, trans_loss=3.357, nll_loss=1.414, w2v_ctc_loss=0.939, task_loss=1.575, contrastive_loss=0.144, total=6725.6, n_correct=4453.08, ppl=2.66, accuracy=66.211, wps=18848.3, ups=0.97, wpb=19490.8, bsz=666.1, num_updates=10400, lr=0.000138675, gnorm=0.311, clip=0, loss_scale=16, train_wall=103, gb_free=13.9, wall=10422
2023-08-27 03:50:48 | INFO | train_inner | epoch 009:    979 / 1191 loss=1.922, trans_loss=3.355, nll_loss=1.41, w2v_ctc_loss=0.934, task_loss=1.561, contrastive_loss=0.205, total=6712.81, n_correct=4447.4, ppl=2.66, accuracy=66.252, wps=18563, ups=0.95, wpb=19443.8, bsz=681.9, num_updates=10500, lr=0.000138013, gnorm=0.311, clip=0, loss_scale=16, train_wall=104, gb_free=13, wall=10527
2023-08-27 03:52:31 | INFO | train_inner | epoch 009:   1079 / 1191 loss=1.931, trans_loss=3.353, nll_loss=1.41, w2v_ctc_loss=0.932, task_loss=1.539, contrastive_loss=0.265, total=6663.32, n_correct=4423.7, ppl=2.66, accuracy=66.389, wps=18754.3, ups=0.97, wpb=19311.7, bsz=678.6, num_updates=10600, lr=0.000137361, gnorm=0.312, clip=0, loss_scale=16, train_wall=102, gb_free=13.7, wall=10630
2023-08-27 03:54:15 | INFO | train_inner | epoch 009:   1179 / 1191 loss=1.916, trans_loss=3.353, nll_loss=1.41, w2v_ctc_loss=0.948, task_loss=1.614, contrastive_loss=0.134, total=6698.09, n_correct=4438.36, ppl=2.66, accuracy=66.263, wps=18701.9, ups=0.96, wpb=19412.6, bsz=660.3, num_updates=10700, lr=0.000136717, gnorm=0.311, clip=0, loss_scale=16, train_wall=103, gb_free=12.1, wall=10733
2023-08-27 03:54:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
2023-08-27 03:55:01 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.978 | trans_loss 5.269 | nll_loss 2.498 | w2v_ctc_loss 1.169 | task_loss 8.432 | contrastive_loss 0.27 | total 6138.43 | n_correct 4071.71 | ppl 5.65 | accuracy 66.332 | uer 18.094 | wer 20.007 | raw_wer 20.007 | bleu 26.04 | wps 1684.5 | wpb 6138.4 | bsz 201.1 | num_updates 10712 | best_bleu 26.04
2023-08-27 03:55:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10712 updates
2023-08-27 03:55:01 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 03:55:06 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 03:55:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 9 @ 10712 updates, score 26.04) (writing took 10.893219525998575 seconds)
2023-08-27 03:55:12 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-08-27 03:55:12 | INFO | train | epoch 009 | loss 1.921 | trans_loss 3.352 | nll_loss 1.407 | w2v_ctc_loss 0.937 | task_loss 1.561 | contrastive_loss 0.193 | total 6703.69 | n_correct 4444.23 | ppl 2.65 | accuracy 66.295 | wps 17418.9 | ups 0.9 | wpb 19422.7 | bsz 678.2 | num_updates 10712 | lr 0.000136641 | gnorm 0.343 | clip 0 | loss_scale 16 | train_wall 1229 | gb_free 14.6 | wall 10791
2023-08-27 03:55:12 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 03:55:12 | INFO | fairseq.trainer | begin training epoch 10
2023-08-27 03:55:12 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 03:56:51 | INFO | train_inner | epoch 010:     88 / 1191 loss=1.864, trans_loss=3.322, nll_loss=1.369, w2v_ctc_loss=0.897, task_loss=1.587, contrastive_loss=0.129, total=6635.56, n_correct=4468.09, ppl=2.58, accuracy=67.336, wps=12328.3, ups=0.64, wpb=19225.9, bsz=666.3, num_updates=10800, lr=0.000136083, gnorm=0.309, clip=0, loss_scale=16, train_wall=103, gb_free=7.1, wall=10889
2023-08-27 03:58:34 | INFO | train_inner | epoch 010:    188 / 1191 loss=1.89, trans_loss=3.335, nll_loss=1.385, w2v_ctc_loss=0.91, task_loss=1.561, contrastive_loss=0.187, total=6683.77, n_correct=4473.94, ppl=2.61, accuracy=66.937, wps=18792.8, ups=0.97, wpb=19364.3, bsz=682.4, num_updates=10900, lr=0.000135457, gnorm=0.311, clip=0, loss_scale=16, train_wall=102, gb_free=14.1, wall=10992
2023-08-27 04:00:18 | INFO | train_inner | epoch 010:    288 / 1191 loss=1.892, trans_loss=3.33, nll_loss=1.378, w2v_ctc_loss=0.901, task_loss=1.54, contrastive_loss=0.233, total=6747.3, n_correct=4529.66, ppl=2.6, accuracy=67.133, wps=18861.9, ups=0.97, wpb=19544.4, bsz=686.8, num_updates=11000, lr=0.00013484, gnorm=0.309, clip=0, loss_scale=16, train_wall=103, gb_free=12.9, wall=11096
2023-08-27 04:02:02 | INFO | train_inner | epoch 010:    388 / 1191 loss=1.909, trans_loss=3.332, nll_loss=1.381, w2v_ctc_loss=0.906, task_loss=1.442, contrastive_loss=0.272, total=6844.06, n_correct=4588.6, ppl=2.61, accuracy=67.045, wps=19006.8, ups=0.96, wpb=19828.5, bsz=731.6, num_updates=11100, lr=0.000134231, gnorm=0.308, clip=0, loss_scale=16, train_wall=104, gb_free=14.1, wall=11200
2023-08-27 04:03:46 | INFO | train_inner | epoch 010:    488 / 1191 loss=1.89, trans_loss=3.334, nll_loss=1.382, w2v_ctc_loss=0.92, task_loss=1.568, contrastive_loss=0.147, total=6740.33, n_correct=4512.08, ppl=2.61, accuracy=66.942, wps=18821.1, ups=0.96, wpb=19516.8, bsz=675.3, num_updates=11200, lr=0.000133631, gnorm=0.309, clip=0, loss_scale=16, train_wall=103, gb_free=14.8, wall=11304
2023-08-27 04:05:29 | INFO | train_inner | epoch 010:    588 / 1191 loss=1.889, trans_loss=3.338, nll_loss=1.388, w2v_ctc_loss=0.908, task_loss=1.598, contrastive_loss=0.19, total=6674.26, n_correct=4463.17, ppl=2.62, accuracy=66.871, wps=18789.2, ups=0.97, wpb=19333.8, bsz=659.7, num_updates=11300, lr=0.000133038, gnorm=0.311, clip=0, loss_scale=16, train_wall=102, gb_free=13.5, wall=11407
2023-08-27 04:07:13 | INFO | train_inner | epoch 010:    688 / 1191 loss=1.892, trans_loss=3.334, nll_loss=1.385, w2v_ctc_loss=0.91, task_loss=1.506, contrastive_loss=0.183, total=6780.39, n_correct=4545.64, ppl=2.61, accuracy=67.041, wps=18783.2, ups=0.96, wpb=19647.9, bsz=704.3, num_updates=11400, lr=0.000132453, gnorm=0.308, clip=0, loss_scale=16, train_wall=104, gb_free=13.2, wall=11512
2023-08-27 04:08:57 | INFO | train_inner | epoch 010:    788 / 1191 loss=1.867, trans_loss=3.335, nll_loss=1.386, w2v_ctc_loss=0.906, task_loss=1.651, contrastive_loss=0.105, total=6651.17, n_correct=4456.86, ppl=2.61, accuracy=67.009, wps=18567.5, ups=0.96, wpb=19273.7, bsz=652.3, num_updates=11500, lr=0.000131876, gnorm=0.307, clip=0, loss_scale=16, train_wall=103, gb_free=12.9, wall=11615
2023-08-27 04:10:42 | INFO | train_inner | epoch 010:    888 / 1191 loss=1.894, trans_loss=3.337, nll_loss=1.389, w2v_ctc_loss=0.916, task_loss=1.7, contrastive_loss=0.188, total=6538.32, n_correct=4374.78, ppl=2.62, accuracy=66.91, wps=18118.2, ups=0.96, wpb=18949.3, bsz=637, num_updates=11600, lr=0.000131306, gnorm=0.314, clip=0, loss_scale=16, train_wall=104, gb_free=14.5, wall=11720
2023-08-27 04:12:25 | INFO | train_inner | epoch 010:    988 / 1191 loss=1.876, trans_loss=3.332, nll_loss=1.383, w2v_ctc_loss=0.906, task_loss=1.499, contrastive_loss=0.139, total=6754.89, n_correct=4533.85, ppl=2.61, accuracy=67.12, wps=18921.3, ups=0.97, wpb=19571, bsz=687.6, num_updates=11700, lr=0.000130744, gnorm=0.305, clip=0, loss_scale=16, train_wall=103, gb_free=14.4, wall=11823
2023-08-27 04:14:09 | INFO | train_inner | epoch 010:   1088 / 1191 loss=1.884, trans_loss=3.331, nll_loss=1.383, w2v_ctc_loss=0.918, task_loss=1.558, contrastive_loss=0.135, total=6679.13, n_correct=4480.39, ppl=2.61, accuracy=67.08, wps=18603.7, ups=0.96, wpb=19365.7, bsz=675.9, num_updates=11800, lr=0.000130189, gnorm=0.308, clip=0, loss_scale=16, train_wall=104, gb_free=9.9, wall=11927
2023-08-27 04:15:52 | INFO | train_inner | epoch 010:   1188 / 1191 loss=1.912, trans_loss=3.34, nll_loss=1.392, w2v_ctc_loss=0.904, task_loss=1.526, contrastive_loss=0.32, total=6732.47, n_correct=4498.91, ppl=2.62, accuracy=66.824, wps=18879.5, ups=0.97, wpb=19499.8, bsz=688.7, num_updates=11900, lr=0.000129641, gnorm=0.317, clip=0, loss_scale=16, train_wall=103, gb_free=14.5, wall=12031
2023-08-27 04:15:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 04:16:29 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 3.948 | trans_loss 5.24 | nll_loss 2.464 | w2v_ctc_loss 1.148 | task_loss 8.494 | contrastive_loss 0.256 | total 6138.43 | n_correct 4091.57 | ppl 5.52 | accuracy 66.655 | uer 17.618 | wer 19.424 | raw_wer 19.424 | bleu 26.56 | wps 1637.9 | wpb 6138.4 | bsz 201.1 | num_updates 11903 | best_bleu 26.56
2023-08-27 04:16:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 11903 updates
2023-08-27 04:16:29 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 04:16:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 04:16:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 10 @ 11903 updates, score 26.56) (writing took 10.89437525399262 seconds)
2023-08-27 04:16:41 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-08-27 04:16:41 | INFO | train | epoch 010 | loss 1.888 | trans_loss 3.333 | nll_loss 1.383 | w2v_ctc_loss 0.908 | task_loss 1.561 | contrastive_loss 0.187 | total 6703.69 | n_correct 4492.96 | ppl 2.61 | accuracy 67.022 | wps 17954.1 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 11903 | lr 0.000129624 | gnorm 0.31 | clip 0 | loss_scale 16 | train_wall 1229 | gb_free 12.3 | wall 12079
2023-08-27 04:16:41 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 04:16:41 | INFO | fairseq.trainer | begin training epoch 11
2023-08-27 04:16:41 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 04:18:29 | INFO | train_inner | epoch 011:     97 / 1191 loss=1.86, trans_loss=3.312, nll_loss=1.357, w2v_ctc_loss=0.892, task_loss=1.667, contrastive_loss=0.159, total=6629.5, n_correct=4481.84, ppl=2.56, accuracy=67.604, wps=12292.7, ups=0.64, wpb=19215.2, bsz=646.6, num_updates=12000, lr=0.000129099, gnorm=0.311, clip=0, loss_scale=16, train_wall=103, gb_free=12.9, wall=12187
2023-08-27 04:18:29 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 04:19:02 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.979 | trans_loss 5.254 | nll_loss 2.473 | w2v_ctc_loss 1.217 | task_loss 8.558 | contrastive_loss 0.263 | total 6138.43 | n_correct 4087.43 | ppl 5.55 | accuracy 66.588 | uer 17.688 | wer 19.331 | raw_wer 19.331 | bleu 26.28 | wps 1652.7 | wpb 6138.4 | bsz 201.1 | num_updates 12000 | best_bleu 26.56
2023-08-27 04:19:02 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 12000 updates
2023-08-27 04:19:02 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-27 04:19:04 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-27 04:19:09 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt (epoch 11 @ 12000 updates, score 26.28) (writing took 6.317424392007524 seconds)
2023-08-27 04:20:51 | INFO | train_inner | epoch 011:    197 / 1191 loss=1.855, trans_loss=3.312, nll_loss=1.355, w2v_ctc_loss=0.871, task_loss=1.535, contrastive_loss=0.221, total=6695.87, n_correct=4538.82, ppl=2.56, accuracy=67.785, wps=13577.9, ups=0.7, wpb=19390.4, bsz=686.9, num_updates=12100, lr=0.000128565, gnorm=0.306, clip=0, loss_scale=32, train_wall=102, gb_free=14.4, wall=12330
2023-08-27 04:22:35 | INFO | train_inner | epoch 011:    297 / 1191 loss=1.852, trans_loss=3.312, nll_loss=1.356, w2v_ctc_loss=0.879, task_loss=1.594, contrastive_loss=0.181, total=6605.27, n_correct=4473.18, ppl=2.56, accuracy=67.721, wps=18470.8, ups=0.97, wpb=19137.7, bsz=664.2, num_updates=12200, lr=0.000128037, gnorm=0.309, clip=0, loss_scale=32, train_wall=103, gb_free=13.3, wall=12433
2023-08-27 04:24:19 | INFO | train_inner | epoch 011:    397 / 1191 loss=1.868, trans_loss=3.314, nll_loss=1.36, w2v_ctc_loss=0.881, task_loss=1.61, contrastive_loss=0.238, total=6597.68, n_correct=4460.71, ppl=2.57, accuracy=67.61, wps=18445.6, ups=0.96, wpb=19125.4, bsz=664.1, num_updates=12300, lr=0.000127515, gnorm=0.313, clip=0, loss_scale=32, train_wall=103, gb_free=10.9, wall=12537
2023-08-27 04:26:03 | INFO | train_inner | epoch 011:    497 / 1191 loss=1.851, trans_loss=3.32, nll_loss=1.368, w2v_ctc_loss=0.891, task_loss=1.673, contrastive_loss=0.108, total=6643.92, n_correct=4481.84, ppl=2.58, accuracy=67.458, wps=18541, ups=0.96, wpb=19259.8, bsz=646.3, num_updates=12400, lr=0.000127, gnorm=0.31, clip=0, loss_scale=32, train_wall=103, gb_free=11.2, wall=12641
2023-08-27 04:27:45 | INFO | train_inner | epoch 011:    597 / 1191 loss=1.849, trans_loss=3.315, nll_loss=1.364, w2v_ctc_loss=0.891, task_loss=1.565, contrastive_loss=0.107, total=6663.6, n_correct=4500.77, ppl=2.57, accuracy=67.543, wps=18881.6, ups=0.98, wpb=19323.3, bsz=673.3, num_updates=12500, lr=0.000126491, gnorm=0.308, clip=0, loss_scale=32, train_wall=102, gb_free=13.5, wall=12743
2023-08-27 04:29:30 | INFO | train_inner | epoch 011:    697 / 1191 loss=1.852, trans_loss=3.316, nll_loss=1.365, w2v_ctc_loss=0.881, task_loss=1.618, contrastive_loss=0.157, total=6694.31, n_correct=4523.45, ppl=2.58, accuracy=67.572, wps=18542.6, ups=0.96, wpb=19409, bsz=667.3, num_updates=12600, lr=0.000125988, gnorm=0.307, clip=0, loss_scale=32, train_wall=104, gb_free=4.9, wall=12848
2023-08-27 04:31:14 | INFO | train_inner | epoch 011:    797 / 1191 loss=1.873, trans_loss=3.322, nll_loss=1.371, w2v_ctc_loss=0.894, task_loss=1.521, contrastive_loss=0.175, total=6797.24, n_correct=4585.09, ppl=2.59, accuracy=67.455, wps=18935.8, ups=0.96, wpb=19694.2, bsz=704.4, num_updates=12700, lr=0.000125491, gnorm=0.31, clip=0, loss_scale=32, train_wall=103, gb_free=12, wall=12952
2023-08-27 04:32:58 | INFO | train_inner | epoch 011:    897 / 1191 loss=1.853, trans_loss=3.323, nll_loss=1.369, w2v_ctc_loss=0.876, task_loss=1.54, contrastive_loss=0.162, total=6767.48, n_correct=4573.15, ppl=2.58, accuracy=67.575, wps=18807.1, ups=0.96, wpb=19590.9, bsz=680, num_updates=12800, lr=0.000125, gnorm=0.304, clip=0, loss_scale=32, train_wall=104, gb_free=11, wall=13056
2023-08-27 04:34:43 | INFO | train_inner | epoch 011:    997 / 1191 loss=1.864, trans_loss=3.319, nll_loss=1.366, w2v_ctc_loss=0.865, task_loss=1.461, contrastive_loss=0.243, total=6800.24, n_correct=4606.95, ppl=2.58, accuracy=67.747, wps=18780.3, ups=0.95, wpb=19686.1, bsz=710.6, num_updates=12900, lr=0.000124515, gnorm=0.306, clip=0, loss_scale=32, train_wall=104, gb_free=14.5, wall=13161
2023-08-27 04:36:26 | INFO | train_inner | epoch 011:   1097 / 1191 loss=1.874, trans_loss=3.316, nll_loss=1.364, w2v_ctc_loss=0.882, task_loss=1.464, contrastive_loss=0.259, total=6767.7, n_correct=4578.72, ppl=2.57, accuracy=67.655, wps=19059.1, ups=0.97, wpb=19611.7, bsz=704, num_updates=13000, lr=0.000124035, gnorm=0.308, clip=0, loss_scale=32, train_wall=102, gb_free=13.2, wall=13264
2023-08-27 04:38:03 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 04:38:38 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.963 | trans_loss 5.233 | nll_loss 2.45 | w2v_ctc_loss 1.213 | task_loss 8.484 | contrastive_loss 0.259 | total 6138.43 | n_correct 4096.14 | ppl 5.47 | accuracy 66.73 | uer 17.538 | wer 19.528 | raw_wer 19.528 | bleu 26.2 | wps 1598.7 | wpb 6138.4 | bsz 201.1 | num_updates 13094 | best_bleu 26.56
2023-08-27 04:38:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 13094 updates
2023-08-27 04:38:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.2001.pt
2023-08-27 04:38:40 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.2001.pt
2023-08-27 04:38:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.2001.pt (epoch 11 @ 13094 updates, score 26.2) (writing took 6.191744543000823 seconds)
2023-08-27 04:38:44 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-08-27 04:38:44 | INFO | train | epoch 011 | loss 1.859 | trans_loss 3.317 | nll_loss 1.364 | w2v_ctc_loss 0.882 | task_loss 1.562 | contrastive_loss 0.181 | total 6703.69 | n_correct 4531.87 | ppl 2.57 | accuracy 67.603 | wps 17478.7 | ups 0.9 | wpb 19422.7 | bsz 678.2 | num_updates 13094 | lr 0.000123589 | gnorm 0.308 | clip 0 | loss_scale 32 | train_wall 1227 | gb_free 13.4 | wall 13402
2023-08-27 04:38:44 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 04:38:44 | INFO | fairseq.trainer | begin training epoch 12
2023-08-27 04:38:44 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 04:38:58 | INFO | train_inner | epoch 012:      6 / 1191 loss=1.854, trans_loss=3.322, nll_loss=1.369, w2v_ctc_loss=0.879, task_loss=1.472, contrastive_loss=0.157, total=6794.94, n_correct=4593.73, ppl=2.58, accuracy=67.605, wps=12892.9, ups=0.66, wpb=19667.6, bsz=708.4, num_updates=13100, lr=0.00012356, gnorm=0.306, clip=0, loss_scale=32, train_wall=103, gb_free=12.2, wall=13417
2023-08-27 04:40:43 | INFO | train_inner | epoch 012:    106 / 1191 loss=1.808, trans_loss=3.293, nll_loss=1.332, w2v_ctc_loss=0.852, task_loss=1.577, contrastive_loss=0.105, total=6733.34, n_correct=4604.86, ppl=2.52, accuracy=68.389, wps=18676.7, ups=0.96, wpb=19508, bsz=668.8, num_updates=13200, lr=0.000123091, gnorm=0.305, clip=0, loss_scale=32, train_wall=104, gb_free=13.9, wall=13521
2023-08-27 04:42:26 | INFO | train_inner | epoch 012:    206 / 1191 loss=1.83, trans_loss=3.3, nll_loss=1.341, w2v_ctc_loss=0.858, task_loss=1.571, contrastive_loss=0.175, total=6717.37, n_correct=4576.21, ppl=2.53, accuracy=68.125, wps=18801.4, ups=0.97, wpb=19462.2, bsz=668.3, num_updates=13300, lr=0.000122628, gnorm=0.306, clip=0, loss_scale=32, train_wall=103, gb_free=12.3, wall=13625
2023-08-27 04:44:10 | INFO | train_inner | epoch 012:    306 / 1191 loss=1.849, trans_loss=3.302, nll_loss=1.345, w2v_ctc_loss=0.862, task_loss=1.53, contrastive_loss=0.235, total=6703.8, n_correct=4565.91, ppl=2.54, accuracy=68.109, wps=18679, ups=0.96, wpb=19428.9, bsz=689.6, num_updates=13400, lr=0.000122169, gnorm=0.309, clip=0, loss_scale=32, train_wall=103, gb_free=13.9, wall=13729
2023-08-27 04:45:53 | INFO | train_inner | epoch 012:    406 / 1191 loss=1.83, trans_loss=3.3, nll_loss=1.342, w2v_ctc_loss=0.846, task_loss=1.46, contrastive_loss=0.209, total=6770.13, n_correct=4619.35, ppl=2.54, accuracy=68.231, wps=18994.3, ups=0.97, wpb=19616.1, bsz=706, num_updates=13500, lr=0.000121716, gnorm=0.305, clip=0, loss_scale=32, train_wall=103, gb_free=14.6, wall=13832
2023-08-27 04:47:37 | INFO | train_inner | epoch 012:    506 / 1191 loss=1.809, trans_loss=3.299, nll_loss=1.34, w2v_ctc_loss=0.846, task_loss=1.492, contrastive_loss=0.112, total=6749.24, n_correct=4608.87, ppl=2.53, accuracy=68.287, wps=18908.7, ups=0.97, wpb=19550.5, bsz=693.1, num_updates=13600, lr=0.000121268, gnorm=0.307, clip=0, loss_scale=32, train_wall=103, gb_free=15.3, wall=13935
2023-08-27 04:49:22 | INFO | train_inner | epoch 012:    606 / 1191 loss=1.843, trans_loss=3.304, nll_loss=1.347, w2v_ctc_loss=0.865, task_loss=1.615, contrastive_loss=0.199, total=6723.44, n_correct=4574.91, ppl=2.54, accuracy=68.044, wps=18578.1, ups=0.95, wpb=19479, bsz=675.6, num_updates=13700, lr=0.000120824, gnorm=0.31, clip=0, loss_scale=32, train_wall=104, gb_free=14.7, wall=14040
2023-08-27 04:51:05 | INFO | train_inner | epoch 012:    706 / 1191 loss=1.845, trans_loss=3.297, nll_loss=1.342, w2v_ctc_loss=0.858, task_loss=1.496, contrastive_loss=0.256, total=6762.5, n_correct=4607.22, ppl=2.54, accuracy=68.129, wps=18888.6, ups=0.96, wpb=19610, bsz=697.1, num_updates=13800, lr=0.000120386, gnorm=0.307, clip=0, loss_scale=32, train_wall=103, gb_free=13.9, wall=14144
2023-08-27 04:52:49 | INFO | train_inner | epoch 012:    806 / 1191 loss=1.837, trans_loss=3.312, nll_loss=1.357, w2v_ctc_loss=0.866, task_loss=1.605, contrastive_loss=0.154, total=6657.14, n_correct=4523.12, ppl=2.56, accuracy=67.944, wps=18583.7, ups=0.96, wpb=19280.5, bsz=663.1, num_updates=13900, lr=0.000119952, gnorm=0.312, clip=0, loss_scale=32, train_wall=103, gb_free=12.9, wall=14248
2023-08-27 04:54:34 | INFO | train_inner | epoch 012:    906 / 1191 loss=1.846, trans_loss=3.316, nll_loss=1.363, w2v_ctc_loss=0.868, task_loss=1.669, contrastive_loss=0.183, total=6647.96, n_correct=4504.24, ppl=2.57, accuracy=67.754, wps=18358.3, ups=0.95, wpb=19253, bsz=655.7, num_updates=14000, lr=0.000119523, gnorm=0.311, clip=0, loss_scale=32, train_wall=104, gb_free=12.9, wall=14353
2023-08-27 04:54:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 04:55:08 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.97 | trans_loss 5.239 | nll_loss 2.456 | w2v_ctc_loss 1.217 | task_loss 8.503 | contrastive_loss 0.274 | total 6138.43 | n_correct 4104.57 | ppl 5.49 | accuracy 66.867 | uer 17.811 | wer 19.736 | raw_wer 19.736 | bleu 26.43 | wps 1661.2 | wpb 6138.4 | bsz 201.1 | num_updates 14000 | best_bleu 26.56
2023-08-27 04:55:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14000 updates
2023-08-27 04:55:08 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-27 04:55:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-27 04:55:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt (epoch 12 @ 14000 updates, score 26.43) (writing took 6.712535598009708 seconds)
2023-08-27 04:56:58 | INFO | train_inner | epoch 012:   1006 / 1191 loss=1.839, trans_loss=3.306, nll_loss=1.354, w2v_ctc_loss=0.874, task_loss=1.606, contrastive_loss=0.149, total=6608.71, n_correct=4494.88, ppl=2.56, accuracy=68.014, wps=13365.9, ups=0.7, wpb=19165.5, bsz=664.6, num_updates=14100, lr=0.000119098, gnorm=0.314, clip=0, loss_scale=32, train_wall=102, gb_free=14.6, wall=14496
2023-08-27 04:58:42 | INFO | train_inner | epoch 012:   1106 / 1191 loss=1.841, trans_loss=3.311, nll_loss=1.357, w2v_ctc_loss=0.861, task_loss=1.592, contrastive_loss=0.201, total=6665.67, n_correct=4533.6, ppl=2.56, accuracy=68.014, wps=18468.5, ups=0.96, wpb=19306.4, bsz=675.8, num_updates=14200, lr=0.000118678, gnorm=0.311, clip=0, loss_scale=64, train_wall=104, gb_free=14.6, wall=14600
2023-08-27 05:00:10 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 05:00:44 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.961 | trans_loss 5.231 | nll_loss 2.45 | w2v_ctc_loss 1.21 | task_loss 8.512 | contrastive_loss 0.263 | total 6138.43 | n_correct 4109.43 | ppl 5.47 | accuracy 66.946 | uer 17.391 | wer 19.029 | raw_wer 19.029 | bleu 26.69 | wps 1669.4 | wpb 6138.4 | bsz 201.1 | num_updates 14285 | best_bleu 26.69
2023-08-27 05:00:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14285 updates
2023-08-27 05:00:44 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:00:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:00:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 12 @ 14285 updates, score 26.69) (writing took 11.427922255999874 seconds)
2023-08-27 05:00:55 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-08-27 05:00:55 | INFO | train | epoch 012 | loss 1.834 | trans_loss 3.304 | nll_loss 1.348 | w2v_ctc_loss 0.86 | task_loss 1.563 | contrastive_loss 0.175 | total 6703.69 | n_correct 4565.04 | ppl 2.55 | accuracy 68.097 | wps 17376.1 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 14285 | lr 0.000118325 | gnorm 0.309 | clip 0 | loss_scale 64 | train_wall 1230 | gb_free 14.1 | wall 14734
2023-08-27 05:00:56 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 05:00:56 | INFO | fairseq.trainer | begin training epoch 13
2023-08-27 05:00:56 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 05:01:19 | INFO | train_inner | epoch 013:     15 / 1191 loss=1.821, trans_loss=3.306, nll_loss=1.35, w2v_ctc_loss=0.86, task_loss=1.597, contrastive_loss=0.116, total=6686.63, n_correct=4559.65, ppl=2.55, accuracy=68.191, wps=12343.6, ups=0.64, wpb=19364.4, bsz=663.9, num_updates=14300, lr=0.000118262, gnorm=0.306, clip=0, loss_scale=64, train_wall=104, gb_free=13.1, wall=14757
2023-08-27 05:03:04 | INFO | train_inner | epoch 013:    115 / 1191 loss=1.795, trans_loss=3.281, nll_loss=1.318, w2v_ctc_loss=0.835, task_loss=1.644, contrastive_loss=0.126, total=6709.41, n_correct=4617.3, ppl=2.49, accuracy=68.818, wps=18531.5, ups=0.95, wpb=19440.2, bsz=661.5, num_updates=14400, lr=0.000117851, gnorm=0.305, clip=0, loss_scale=64, train_wall=104, gb_free=12, wall=14862
2023-08-27 05:04:48 | INFO | train_inner | epoch 013:    215 / 1191 loss=1.826, trans_loss=3.291, nll_loss=1.331, w2v_ctc_loss=0.835, task_loss=1.537, contrastive_loss=0.264, total=6640.19, n_correct=4548.28, ppl=2.52, accuracy=68.496, wps=18526.5, ups=0.96, wpb=19238.7, bsz=693.4, num_updates=14500, lr=0.000117444, gnorm=0.31, clip=0, loss_scale=64, train_wall=103, gb_free=9.9, wall=14966
2023-08-27 05:04:54 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 05:06:32 | INFO | train_inner | epoch 013:    316 / 1191 loss=1.82, trans_loss=3.285, nll_loss=1.324, w2v_ctc_loss=0.824, task_loss=1.472, contrastive_loss=0.266, total=6722.42, n_correct=4626.06, ppl=2.5, accuracy=68.815, wps=18698.8, ups=0.96, wpb=19474.2, bsz=709.2, num_updates=14600, lr=0.000117041, gnorm=0.308, clip=0, loss_scale=32, train_wall=103, gb_free=13.1, wall=15070
2023-08-27 05:08:16 | INFO | train_inner | epoch 013:    416 / 1191 loss=1.797, trans_loss=3.29, nll_loss=1.33, w2v_ctc_loss=0.841, task_loss=1.543, contrastive_loss=0.096, total=6753.67, n_correct=4633.99, ppl=2.51, accuracy=68.614, wps=18774.1, ups=0.96, wpb=19572.6, bsz=678.7, num_updates=14700, lr=0.000116642, gnorm=0.304, clip=0, loss_scale=32, train_wall=104, gb_free=13.5, wall=15175
2023-08-27 05:10:00 | INFO | train_inner | epoch 013:    516 / 1191 loss=1.822, trans_loss=3.296, nll_loss=1.338, w2v_ctc_loss=0.844, task_loss=1.657, contrastive_loss=0.195, total=6638.04, n_correct=4538.34, ppl=2.53, accuracy=68.369, wps=18450.6, ups=0.96, wpb=19233.6, bsz=655.6, num_updates=14800, lr=0.000116248, gnorm=0.312, clip=0, loss_scale=32, train_wall=104, gb_free=14.9, wall=15279
2023-08-27 05:11:45 | INFO | train_inner | epoch 013:    616 / 1191 loss=1.812, trans_loss=3.296, nll_loss=1.337, w2v_ctc_loss=0.849, task_loss=1.611, contrastive_loss=0.143, total=6702.58, n_correct=4584.08, ppl=2.53, accuracy=68.393, wps=18636.5, ups=0.96, wpb=19417.2, bsz=654.1, num_updates=14900, lr=0.000115857, gnorm=0.309, clip=0, loss_scale=32, train_wall=104, gb_free=13.6, wall=15383
2023-08-27 05:13:29 | INFO | train_inner | epoch 013:    716 / 1191 loss=1.8, trans_loss=3.293, nll_loss=1.334, w2v_ctc_loss=0.843, task_loss=1.645, contrastive_loss=0.101, total=6640, n_correct=4550.23, ppl=2.52, accuracy=68.528, wps=18341.4, ups=0.95, wpb=19234, bsz=654.1, num_updates=15000, lr=0.00011547, gnorm=0.306, clip=0, loss_scale=32, train_wall=104, gb_free=15.2, wall=15488
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 05:14:42 | INFO | train_inner | epoch 013:    816 / 1191 loss=1.914, trans_loss=4.748, nll_loss=1.925, w2v_ctc_loss=0.604, task_loss=2.253, contrastive_loss=0.12, total=6754.21, n_correct=4627.16, ppl=3.8, accuracy=68.508, wps=18779.3, ups=1.38, wpb=13574.6, bsz=462.3, num_updates=15100, lr=0.000115087, gnorm=0.386, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=15560
2023-08-27 05:15:54 | INFO | train_inner | epoch 013:    916 / 1191 loss=1.924, trans_loss=4.779, nll_loss=1.944, w2v_ctc_loss=0.618, task_loss=2.599, contrastive_loss=0.098, total=6564.2, n_correct=4480.13, ppl=3.85, accuracy=68.251, wps=18137.3, ups=1.38, wpb=13128.4, bsz=422.2, num_updates=15200, lr=0.000114708, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=15633
2023-08-27 05:17:06 | INFO | train_inner | epoch 013:   1016 / 1191 loss=1.912, trans_loss=4.772, nll_loss=1.936, w2v_ctc_loss=0.603, task_loss=2.234, contrastive_loss=0.083, total=6796.22, n_correct=4658.36, ppl=3.83, accuracy=68.543, wps=18830.9, ups=1.39, wpb=13592.4, bsz=468.6, num_updates=15300, lr=0.000114332, gnorm=0.388, clip=0, loss_scale=32, train_wall=72, gb_free=12.4, wall=15705
2023-08-27 05:18:18 | INFO | train_inner | epoch 013:   1116 / 1191 loss=1.924, trans_loss=4.779, nll_loss=1.945, w2v_ctc_loss=0.613, task_loss=2.265, contrastive_loss=0.145, total=6753.73, n_correct=4615.58, ppl=3.85, accuracy=68.341, wps=18765.8, ups=1.39, wpb=13507.5, bsz=465.1, num_updates=15400, lr=0.000113961, gnorm=0.392, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=15777
2023-08-27 05:19:13 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
2023-08-27 05:19:46 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 3.951 | trans_loss 5.216 | nll_loss 2.431 | w2v_ctc_loss 1.211 | task_loss 8.532 | contrastive_loss 0.264 | total 6138.43 | n_correct 4124.71 | ppl 5.39 | accuracy 67.195 | uer 17.418 | wer 19.107 | raw_wer 19.107 | bleu 26.72 | wps 1702.7 | wpb 6138.4 | bsz 201.1 | num_updates 15475 | best_bleu 26.72
2023-08-27 05:19:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 15475 updates
2023-08-27 05:19:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:19:51 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:19:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 13 @ 15475 updates, score 26.72) (writing took 10.452873912989162 seconds)
2023-08-27 05:19:56 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-08-27 05:19:56 | INFO | train | epoch 013 | loss 1.845 | trans_loss 3.757 | nll_loss 1.522 | w2v_ctc_loss 0.766 | task_loss 1.806 | contrastive_loss 0.156 | total 6703.2 | n_correct 4592.75 | ppl 2.87 | accuracy 68.516 | wps 17750.6 | ups 1.04 | wpb 17019.5 | bsz 587 | num_updates 15475 | lr 0.000113684 | gnorm 0.34 | clip 0 | loss_scale 32 | train_wall 1082 | gb_free 9.9 | wall 15875
2023-08-27 05:19:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 05:19:57 | INFO | fairseq.trainer | begin training epoch 14
2023-08-27 05:19:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 05:20:22 | INFO | train_inner | epoch 014:     25 / 1191 loss=1.917, trans_loss=4.766, nll_loss=1.929, w2v_ctc_loss=0.607, task_loss=2.185, contrastive_loss=0.139, total=6745.72, n_correct=4630.33, ppl=3.81, accuracy=68.641, wps=10926.9, ups=0.81, wpb=13491.4, bsz=465.6, num_updates=15500, lr=0.000113592, gnorm=0.382, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=15900
2023-08-27 05:21:33 | INFO | train_inner | epoch 014:    125 / 1191 loss=1.908, trans_loss=4.745, nll_loss=1.9, w2v_ctc_loss=0.601, task_loss=2.31, contrastive_loss=0.154, total=6649.06, n_correct=4590.75, ppl=3.73, accuracy=69.044, wps=18715.3, ups=1.41, wpb=13298.1, bsz=449.5, num_updates=15600, lr=0.000113228, gnorm=0.386, clip=0, loss_scale=32, train_wall=71, gb_free=14.3, wall=15971
2023-08-27 05:22:44 | INFO | train_inner | epoch 014:    225 / 1191 loss=1.901, trans_loss=4.751, nll_loss=1.907, w2v_ctc_loss=0.595, task_loss=2.392, contrastive_loss=0.086, total=6640.19, n_correct=4576.28, ppl=3.75, accuracy=68.918, wps=18541, ups=1.4, wpb=13280.4, bsz=445.2, num_updates=15700, lr=0.000112867, gnorm=0.387, clip=0, loss_scale=32, train_wall=71, gb_free=14.1, wall=16043
2023-08-27 05:23:57 | INFO | train_inner | epoch 014:    325 / 1191 loss=1.913, trans_loss=4.754, nll_loss=1.913, w2v_ctc_loss=0.603, task_loss=2.393, contrastive_loss=0.153, total=6727.18, n_correct=4627.79, ppl=3.76, accuracy=68.792, wps=18522.1, ups=1.38, wpb=13454.4, bsz=448.4, num_updates=15800, lr=0.000112509, gnorm=0.39, clip=0, loss_scale=32, train_wall=72, gb_free=15.3, wall=16115
2023-08-27 05:25:10 | INFO | train_inner | epoch 014:    425 / 1191 loss=1.899, trans_loss=4.749, nll_loss=1.907, w2v_ctc_loss=0.593, task_loss=2.24, contrastive_loss=0.091, total=6815.51, n_correct=4704.31, ppl=3.75, accuracy=69.024, wps=18683.6, ups=1.37, wpb=13631, bsz=469.3, num_updates=15900, lr=0.000112154, gnorm=0.382, clip=0, loss_scale=32, train_wall=72, gb_free=10.2, wall=16188
2023-08-27 05:26:23 | INFO | train_inner | epoch 014:    525 / 1191 loss=1.914, trans_loss=4.753, nll_loss=1.912, w2v_ctc_loss=0.6, task_loss=2.318, contrastive_loss=0.18, total=6712.88, n_correct=4619.72, ppl=3.76, accuracy=68.819, wps=18508.7, ups=1.38, wpb=13425.8, bsz=457.4, num_updates=16000, lr=0.000111803, gnorm=0.39, clip=0, loss_scale=32, train_wall=72, gb_free=11.3, wall=16261
2023-08-27 05:26:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 05:26:55 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.928 | trans_loss 5.215 | nll_loss 2.43 | w2v_ctc_loss 1.142 | task_loss 8.535 | contrastive_loss 0.253 | total 6138.43 | n_correct 4125 | ppl 5.39 | accuracy 67.2 | uer 17.006 | wer 18.899 | raw_wer 18.899 | bleu 26.74 | wps 1741.5 | wpb 6138.4 | bsz 201.1 | num_updates 16000 | best_bleu 26.74
2023-08-27 05:26:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16000 updates
2023-08-27 05:26:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-27 05:26:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-27 05:27:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt (epoch 14 @ 16000 updates, score 26.74) (writing took 10.794617275998462 seconds)
2023-08-27 05:28:18 | INFO | train_inner | epoch 014:    625 / 1191 loss=1.909, trans_loss=4.758, nll_loss=1.919, w2v_ctc_loss=0.606, task_loss=2.275, contrastive_loss=0.11, total=6813.07, n_correct=4686.39, ppl=3.78, accuracy=68.785, wps=11817.1, ups=0.87, wpb=13626.1, bsz=465.5, num_updates=16100, lr=0.000111456, gnorm=0.387, clip=0, loss_scale=32, train_wall=71, gb_free=13.1, wall=16376
2023-08-27 05:29:30 | INFO | train_inner | epoch 014:    725 / 1191 loss=1.918, trans_loss=4.758, nll_loss=1.918, w2v_ctc_loss=0.609, task_loss=2.367, contrastive_loss=0.166, total=6696.46, n_correct=4607.85, ppl=3.78, accuracy=68.81, wps=18550.5, ups=1.39, wpb=13392.9, bsz=448.9, num_updates=16200, lr=0.000111111, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=16448
2023-08-27 05:30:42 | INFO | train_inner | epoch 014:    825 / 1191 loss=1.921, trans_loss=4.768, nll_loss=1.931, w2v_ctc_loss=0.607, task_loss=2.373, contrastive_loss=0.201, total=6693.66, n_correct=4592.58, ppl=3.81, accuracy=68.611, wps=18540.9, ups=1.38, wpb=13387.3, bsz=458.7, num_updates=16300, lr=0.00011077, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=16521
2023-08-27 05:31:54 | INFO | train_inner | epoch 014:    925 / 1191 loss=1.907, trans_loss=4.76, nll_loss=1.922, w2v_ctc_loss=0.604, task_loss=2.369, contrastive_loss=0.082, total=6650.35, n_correct=4575.27, ppl=3.79, accuracy=68.797, wps=18489, ups=1.39, wpb=13300.7, bsz=446.5, num_updates=16400, lr=0.000110432, gnorm=0.391, clip=0, loss_scale=32, train_wall=71, gb_free=14.4, wall=16593
2023-08-27 05:33:07 | INFO | train_inner | epoch 014:   1025 / 1191 loss=1.92, trans_loss=4.774, nll_loss=1.94, w2v_ctc_loss=0.62, task_loss=2.646, contrastive_loss=0.073, total=6555.51, n_correct=4486.39, ppl=3.84, accuracy=68.437, wps=18140.9, ups=1.38, wpb=13111, bsz=417.3, num_updates=16500, lr=0.000110096, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=16665
2023-08-27 05:34:18 | INFO | train_inner | epoch 014:   1125 / 1191 loss=1.908, trans_loss=4.758, nll_loss=1.92, w2v_ctc_loss=0.601, task_loss=2.16, contrastive_loss=0.125, total=6806.29, n_correct=4688.75, ppl=3.78, accuracy=68.888, wps=18961.4, ups=1.39, wpb=13612.6, bsz=476.8, num_updates=16600, lr=0.000109764, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=13.5, wall=16737
2023-08-27 05:35:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 05:35:38 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.935 | trans_loss 5.216 | nll_loss 2.43 | w2v_ctc_loss 1.164 | task_loss 8.564 | contrastive_loss 0.253 | total 6138.43 | n_correct 4129.14 | ppl 5.39 | accuracy 67.267 | uer 16.998 | wer 18.75 | raw_wer 18.75 | bleu 26.95 | wps 1710.8 | wpb 6138.4 | bsz 201.1 | num_updates 16666 | best_bleu 26.95
2023-08-27 05:35:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16666 updates
2023-08-27 05:35:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:35:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 05:35:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 14 @ 16666 updates, score 26.95) (writing took 10.632177705992945 seconds)
2023-08-27 05:35:50 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2023-08-27 05:35:50 | INFO | train | epoch 014 | loss 1.911 | trans_loss 4.757 | nll_loss 1.917 | w2v_ctc_loss 0.603 | task_loss 2.347 | contrastive_loss 0.128 | total 6703.69 | n_correct 4613.51 | ppl 3.78 | accuracy 68.82 | wps 16750.6 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 16666 | lr 0.000109547 | gnorm 0.389 | clip 0 | loss_scale 64 | train_wall 851 | gb_free 14.6 | wall 16828
2023-08-27 05:35:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 05:35:50 | INFO | fairseq.trainer | begin training epoch 15
2023-08-27 05:35:50 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 05:36:21 | INFO | train_inner | epoch 015:     34 / 1191 loss=1.909, trans_loss=4.751, nll_loss=1.911, w2v_ctc_loss=0.603, task_loss=2.333, contrastive_loss=0.132, total=6697.04, n_correct=4619.26, ppl=3.76, accuracy=68.975, wps=10874.2, ups=0.81, wpb=13394.1, bsz=449.8, num_updates=16700, lr=0.000109435, gnorm=0.392, clip=0, loss_scale=64, train_wall=71, gb_free=10.7, wall=16860
2023-08-27 05:37:33 | INFO | train_inner | epoch 015:    134 / 1191 loss=1.896, trans_loss=4.731, nll_loss=1.883, w2v_ctc_loss=0.595, task_loss=2.287, contrastive_loss=0.125, total=6739.18, n_correct=4674.86, ppl=3.69, accuracy=69.368, wps=18774.5, ups=1.39, wpb=13478.4, bsz=457.1, num_updates=16800, lr=0.000109109, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=10.5, wall=16932
2023-08-27 05:38:18 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 05:38:46 | INFO | train_inner | epoch 015:    235 / 1191 loss=1.893, trans_loss=4.733, nll_loss=1.886, w2v_ctc_loss=0.596, task_loss=2.379, contrastive_loss=0.072, total=6665.91, n_correct=4623.1, ppl=3.7, accuracy=69.354, wps=18372.2, ups=1.38, wpb=13331.8, bsz=441.8, num_updates=16900, lr=0.000108786, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=17004
2023-08-27 05:39:58 | INFO | train_inner | epoch 015:    335 / 1191 loss=1.89, trans_loss=4.73, nll_loss=1.882, w2v_ctc_loss=0.588, task_loss=2.357, contrastive_loss=0.092, total=6665.88, n_correct=4629.57, ppl=3.69, accuracy=69.452, wps=18561.7, ups=1.39, wpb=13331.8, bsz=446.9, num_updates=17000, lr=0.000108465, gnorm=0.389, clip=0, loss_scale=32, train_wall=71, gb_free=13.3, wall=17076
2023-08-27 05:41:10 | INFO | train_inner | epoch 015:    435 / 1191 loss=1.905, trans_loss=4.748, nll_loss=1.906, w2v_ctc_loss=0.602, task_loss=2.366, contrastive_loss=0.118, total=6733.73, n_correct=4645.1, ppl=3.75, accuracy=68.983, wps=18604.9, ups=1.38, wpb=13467.5, bsz=456.4, num_updates=17100, lr=0.000108148, gnorm=0.389, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=17148
2023-08-27 05:42:23 | INFO | train_inner | epoch 015:    535 / 1191 loss=1.904, trans_loss=4.742, nll_loss=1.899, w2v_ctc_loss=0.601, task_loss=2.319, contrastive_loss=0.129, total=6700.53, n_correct=4634.45, ppl=3.73, accuracy=69.165, wps=18496.9, ups=1.38, wpb=13401.1, bsz=460.4, num_updates=17200, lr=0.000107833, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=14.7, wall=17221
2023-08-27 05:43:34 | INFO | train_inner | epoch 015:    635 / 1191 loss=1.913, trans_loss=4.752, nll_loss=1.91, w2v_ctc_loss=0.612, task_loss=2.665, contrastive_loss=0.115, total=6598.77, n_correct=4539.69, ppl=3.76, accuracy=68.796, wps=18345.1, ups=1.39, wpb=13197.5, bsz=410.4, num_updates=17300, lr=0.000107521, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=17293
2023-08-27 05:44:47 | INFO | train_inner | epoch 015:    735 / 1191 loss=1.905, trans_loss=4.741, nll_loss=1.898, w2v_ctc_loss=0.593, task_loss=2.372, contrastive_loss=0.204, total=6644.1, n_correct=4594.11, ppl=3.73, accuracy=69.146, wps=18419.9, ups=1.39, wpb=13288.2, bsz=454.2, num_updates=17400, lr=0.000107211, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=17365
2023-08-27 05:45:59 | INFO | train_inner | epoch 015:    835 / 1191 loss=1.896, trans_loss=4.743, nll_loss=1.9, w2v_ctc_loss=0.6, task_loss=2.335, contrastive_loss=0.074, total=6725.66, n_correct=4656.49, ppl=3.73, accuracy=69.235, wps=18592, ups=1.38, wpb=13451.3, bsz=448.3, num_updates=17500, lr=0.000106904, gnorm=0.384, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=17437
2023-08-27 05:47:12 | INFO | train_inner | epoch 015:    935 / 1191 loss=1.902, trans_loss=4.744, nll_loss=1.902, w2v_ctc_loss=0.592, task_loss=2.23, contrastive_loss=0.179, total=6750.02, n_correct=4671.61, ppl=3.74, accuracy=69.209, wps=18539.4, ups=1.37, wpb=13500, bsz=473.6, num_updates=17600, lr=0.0001066, gnorm=0.384, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=17510
2023-08-27 05:48:24 | INFO | train_inner | epoch 015:   1035 / 1191 loss=1.897, trans_loss=4.747, nll_loss=1.906, w2v_ctc_loss=0.594, task_loss=2.332, contrastive_loss=0.096, total=6700.78, n_correct=4633.55, ppl=3.75, accuracy=69.149, wps=18597.5, ups=1.39, wpb=13401.6, bsz=454.3, num_updates=17700, lr=0.000106299, gnorm=0.387, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=17582
2023-08-27 05:49:36 | INFO | train_inner | epoch 015:   1135 / 1191 loss=1.907, trans_loss=4.757, nll_loss=1.92, w2v_ctc_loss=0.601, task_loss=2.377, contrastive_loss=0.112, total=6753.24, n_correct=4652.55, ppl=3.78, accuracy=68.894, wps=18655.4, ups=1.38, wpb=13506.5, bsz=446, num_updates=17800, lr=0.000106, gnorm=0.385, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=17655
2023-08-27 05:50:17 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 05:50:50 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 3.931 | trans_loss 5.208 | nll_loss 2.421 | w2v_ctc_loss 1.171 | task_loss 8.51 | contrastive_loss 0.253 | total 6138.43 | n_correct 4127.57 | ppl 5.35 | accuracy 67.241 | uer 17.083 | wer 18.996 | raw_wer 18.996 | bleu 26.48 | wps 1678.2 | wpb 6138.4 | bsz 201.1 | num_updates 17856 | best_bleu 26.95
2023-08-27 05:50:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 17856 updates
2023-08-27 05:50:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.4803.pt
2023-08-27 05:50:52 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.4803.pt
2023-08-27 05:50:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_26.4803.pt (epoch 15 @ 17856 updates, score 26.48) (writing took 6.180871056989417 seconds)
2023-08-27 05:50:57 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2023-08-27 05:50:57 | INFO | train | epoch 015 | loss 1.901 | trans_loss 4.743 | nll_loss 1.899 | w2v_ctc_loss 0.597 | task_loss 2.349 | contrastive_loss 0.124 | total 6701.79 | n_correct 4635.09 | ppl 3.73 | accuracy 69.162 | wps 17579.1 | ups 1.31 | wpb 13403.6 | bsz 451.7 | num_updates 17856 | lr 0.000105833 | gnorm 0.389 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 11.8 | wall 17735
2023-08-27 05:50:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 05:50:57 | INFO | fairseq.trainer | begin training epoch 16
2023-08-27 05:50:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 05:51:36 | INFO | train_inner | epoch 016:     44 / 1191 loss=1.9, trans_loss=4.738, nll_loss=1.894, w2v_ctc_loss=0.587, task_loss=2.293, contrastive_loss=0.187, total=6683.77, n_correct=4632.97, ppl=3.72, accuracy=69.317, wps=11152.5, ups=0.83, wpb=13367.5, bsz=454.6, num_updates=17900, lr=0.000105703, gnorm=0.389, clip=0, loss_scale=32, train_wall=71, gb_free=14.2, wall=17775
2023-08-27 05:52:49 | INFO | train_inner | epoch 016:    144 / 1191 loss=1.891, trans_loss=4.727, nll_loss=1.879, w2v_ctc_loss=0.59, task_loss=2.403, contrastive_loss=0.109, total=6721.68, n_correct=4674.26, ppl=3.68, accuracy=69.54, wps=18520.8, ups=1.38, wpb=13443.4, bsz=446.2, num_updates=18000, lr=0.000105409, gnorm=0.387, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=17847
2023-08-27 05:52:49 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 05:53:23 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.94 | trans_loss 5.211 | nll_loss 2.421 | w2v_ctc_loss 1.193 | task_loss 8.556 | contrastive_loss 0.253 | total 6138.43 | n_correct 4136.43 | ppl 5.36 | accuracy 67.386 | uer 17.025 | wer 18.914 | raw_wer 18.914 | bleu 26.84 | wps 1646.3 | wpb 6138.4 | bsz 201.1 | num_updates 18000 | best_bleu 26.95
2023-08-27 05:53:23 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 18000 updates
2023-08-27 05:53:23 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-27 05:53:24 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-27 05:53:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt (epoch 16 @ 18000 updates, score 26.84) (writing took 5.817127868998796 seconds)
2023-08-27 05:54:41 | INFO | train_inner | epoch 016:    244 / 1191 loss=1.892, trans_loss=4.725, nll_loss=1.876, w2v_ctc_loss=0.591, task_loss=2.432, contrastive_loss=0.124, total=6694.44, n_correct=4655.32, ppl=3.67, accuracy=69.54, wps=11962, ups=0.89, wpb=13388.9, bsz=440.6, num_updates=18100, lr=0.000105118, gnorm=0.387, clip=0, loss_scale=32, train_wall=71, gb_free=13.4, wall=17959
2023-08-27 05:55:53 | INFO | train_inner | epoch 016:    344 / 1191 loss=1.891, trans_loss=4.728, nll_loss=1.882, w2v_ctc_loss=0.589, task_loss=2.249, contrastive_loss=0.124, total=6766.61, n_correct=4704.88, ppl=3.69, accuracy=69.531, wps=18744.2, ups=1.39, wpb=13533.2, bsz=461.2, num_updates=18200, lr=0.000104828, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=18031
2023-08-27 05:57:04 | INFO | train_inner | epoch 016:    444 / 1191 loss=1.889, trans_loss=4.729, nll_loss=1.882, w2v_ctc_loss=0.596, task_loss=2.333, contrastive_loss=0.078, total=6682.58, n_correct=4644.8, ppl=3.68, accuracy=69.506, wps=18766.3, ups=1.4, wpb=13365.2, bsz=450, num_updates=18300, lr=0.000104542, gnorm=0.391, clip=0, loss_scale=32, train_wall=71, gb_free=13.2, wall=18102
2023-08-27 05:58:17 | INFO | train_inner | epoch 016:    544 / 1191 loss=1.89, trans_loss=4.727, nll_loss=1.879, w2v_ctc_loss=0.585, task_loss=2.381, contrastive_loss=0.128, total=6679.83, n_correct=4648.39, ppl=3.68, accuracy=69.588, wps=18389.6, ups=1.38, wpb=13359.7, bsz=445.7, num_updates=18400, lr=0.000104257, gnorm=0.385, clip=0, loss_scale=32, train_wall=72, gb_free=12.4, wall=18175
2023-08-27 05:59:30 | INFO | train_inner | epoch 016:    644 / 1191 loss=1.896, trans_loss=4.733, nll_loss=1.888, w2v_ctc_loss=0.592, task_loss=2.359, contrastive_loss=0.144, total=6709.38, n_correct=4655.4, ppl=3.7, accuracy=69.386, wps=18341.9, ups=1.37, wpb=13418.8, bsz=455.6, num_updates=18500, lr=0.000103975, gnorm=0.393, clip=0, loss_scale=32, train_wall=73, gb_free=13.8, wall=18248
2023-08-27 06:00:41 | INFO | train_inner | epoch 016:    744 / 1191 loss=1.888, trans_loss=4.725, nll_loss=1.878, w2v_ctc_loss=0.591, task_loss=2.379, contrastive_loss=0.105, total=6649.58, n_correct=4628.4, ppl=3.67, accuracy=69.604, wps=18619.5, ups=1.4, wpb=13299.2, bsz=447.6, num_updates=18600, lr=0.000103695, gnorm=0.389, clip=0, loss_scale=32, train_wall=71, gb_free=15.4, wall=18320
2023-08-27 06:01:54 | INFO | train_inner | epoch 016:    844 / 1191 loss=1.897, trans_loss=4.741, nll_loss=1.898, w2v_ctc_loss=0.597, task_loss=2.458, contrastive_loss=0.106, total=6697.41, n_correct=4641.17, ppl=3.73, accuracy=69.298, wps=18452.4, ups=1.38, wpb=13394.8, bsz=439.9, num_updates=18700, lr=0.000103418, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=14.8, wall=18392
2023-08-27 06:03:06 | INFO | train_inner | epoch 016:    944 / 1191 loss=1.889, trans_loss=4.733, nll_loss=1.889, w2v_ctc_loss=0.586, task_loss=2.245, contrastive_loss=0.118, total=6750.33, n_correct=4688.18, ppl=3.7, accuracy=69.451, wps=18642.5, ups=1.38, wpb=13500.7, bsz=468.6, num_updates=18800, lr=0.000103142, gnorm=0.388, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=18465
2023-08-27 06:04:19 | INFO | train_inner | epoch 016:   1044 / 1191 loss=1.898, trans_loss=4.734, nll_loss=1.89, w2v_ctc_loss=0.598, task_loss=2.347, contrastive_loss=0.141, total=6671.1, n_correct=4625.74, ppl=3.71, accuracy=69.34, wps=18487.7, ups=1.39, wpb=13342.2, bsz=455.1, num_updates=18900, lr=0.000102869, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=18537
2023-08-27 06:05:31 | INFO | train_inner | epoch 016:   1144 / 1191 loss=1.893, trans_loss=4.738, nll_loss=1.897, w2v_ctc_loss=0.588, task_loss=2.19, contrastive_loss=0.135, total=6800.42, n_correct=4719.32, ppl=3.72, accuracy=69.397, wps=18659.7, ups=1.37, wpb=13600.8, bsz=479.2, num_updates=19000, lr=0.000102598, gnorm=0.383, clip=0, loss_scale=64, train_wall=72, gb_free=13.6, wall=18610
2023-08-27 06:06:05 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 06:06:38 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.932 | trans_loss 5.201 | nll_loss 2.415 | w2v_ctc_loss 1.187 | task_loss 8.514 | contrastive_loss 0.254 | total 6138.43 | n_correct 4139.71 | ppl 5.33 | accuracy 67.439 | uer 17.252 | wer 19 | raw_wer 19 | bleu 27.07 | wps 1726.6 | wpb 6138.4 | bsz 201.1 | num_updates 19047 | best_bleu 27.07
2023-08-27 06:06:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 19047 updates
2023-08-27 06:06:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:06:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:06:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 16 @ 19047 updates, score 27.07) (writing took 10.710411630003364 seconds)
2023-08-27 06:06:49 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2023-08-27 06:06:49 | INFO | train | epoch 016 | loss 1.893 | trans_loss 4.731 | nll_loss 1.885 | w2v_ctc_loss 0.591 | task_loss 2.346 | contrastive_loss 0.124 | total 6703.69 | n_correct 4656.83 | ppl 3.69 | accuracy 69.467 | wps 16773.4 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 19047 | lr 0.000102471 | gnorm 0.389 | clip 0 | loss_scale 64 | train_wall 854 | gb_free 13.8 | wall 18687
2023-08-27 06:06:49 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 06:06:49 | INFO | fairseq.trainer | begin training epoch 17
2023-08-27 06:06:49 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 06:07:35 | INFO | train_inner | epoch 017:     53 / 1191 loss=1.893, trans_loss=4.728, nll_loss=1.881, w2v_ctc_loss=0.588, task_loss=2.438, contrastive_loss=0.147, total=6599.44, n_correct=4585.64, ppl=3.68, accuracy=69.485, wps=10706, ups=0.81, wpb=13198.9, bsz=438, num_updates=19100, lr=0.000102329, gnorm=0.398, clip=0, loss_scale=64, train_wall=71, gb_free=13.6, wall=18733
2023-08-27 06:08:47 | INFO | train_inner | epoch 017:    153 / 1191 loss=1.881, trans_loss=4.71, nll_loss=1.858, w2v_ctc_loss=0.583, task_loss=2.382, contrastive_loss=0.13, total=6686.83, n_correct=4671.92, ppl=3.62, accuracy=69.867, wps=18612.7, ups=1.39, wpb=13373.7, bsz=447.9, num_updates=19200, lr=0.000102062, gnorm=0.387, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=18805
2023-08-27 06:09:59 | INFO | train_inner | epoch 017:    253 / 1191 loss=1.87, trans_loss=4.7, nll_loss=1.845, w2v_ctc_loss=0.58, task_loss=2.203, contrastive_loss=0.082, total=6836.91, n_correct=4798.39, ppl=3.59, accuracy=70.184, wps=18925.6, ups=1.38, wpb=13673.8, bsz=477.7, num_updates=19300, lr=0.000101797, gnorm=0.376, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=18877
2023-08-27 06:11:11 | INFO | train_inner | epoch 017:    353 / 1191 loss=1.882, trans_loss=4.719, nll_loss=1.87, w2v_ctc_loss=0.587, task_loss=2.406, contrastive_loss=0.083, total=6636.25, n_correct=4626.39, ppl=3.66, accuracy=69.714, wps=18407.6, ups=1.39, wpb=13272.5, bsz=441.6, num_updates=19400, lr=0.000101535, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=18949
2023-08-27 06:12:23 | INFO | train_inner | epoch 017:    453 / 1191 loss=1.891, trans_loss=4.725, nll_loss=1.877, w2v_ctc_loss=0.588, task_loss=2.399, contrastive_loss=0.132, total=6699.29, n_correct=4659.87, ppl=3.67, accuracy=69.558, wps=18468.6, ups=1.38, wpb=13398.6, bsz=443.3, num_updates=19500, lr=0.000101274, gnorm=0.393, clip=0, loss_scale=64, train_wall=72, gb_free=10.4, wall=19022
2023-08-27 06:13:35 | INFO | train_inner | epoch 017:    553 / 1191 loss=1.893, trans_loss=4.727, nll_loss=1.88, w2v_ctc_loss=0.587, task_loss=2.363, contrastive_loss=0.161, total=6686.83, n_correct=4652.67, ppl=3.68, accuracy=69.58, wps=18580.3, ups=1.39, wpb=13373.7, bsz=443.6, num_updates=19600, lr=0.000101015, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=19094
2023-08-27 06:14:48 | INFO | train_inner | epoch 017:    653 / 1191 loss=1.883, trans_loss=4.719, nll_loss=1.871, w2v_ctc_loss=0.587, task_loss=2.307, contrastive_loss=0.102, total=6693.12, n_correct=4666.15, ppl=3.66, accuracy=69.716, wps=18509.7, ups=1.38, wpb=13386.2, bsz=457.7, num_updates=19700, lr=0.000100759, gnorm=0.393, clip=0, loss_scale=64, train_wall=72, gb_free=11.9, wall=19166
2023-08-27 06:16:00 | INFO | train_inner | epoch 017:    753 / 1191 loss=1.886, trans_loss=4.727, nll_loss=1.88, w2v_ctc_loss=0.59, task_loss=2.443, contrastive_loss=0.071, total=6658.69, n_correct=4633.65, ppl=3.68, accuracy=69.588, wps=18443.7, ups=1.38, wpb=13317.4, bsz=433.5, num_updates=19800, lr=0.000100504, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=19238
2023-08-27 06:17:12 | INFO | train_inner | epoch 017:    853 / 1191 loss=1.895, trans_loss=4.728, nll_loss=1.883, w2v_ctc_loss=0.59, task_loss=2.526, contrastive_loss=0.163, total=6597.99, n_correct=4591.78, ppl=3.69, accuracy=69.594, wps=18243.1, ups=1.38, wpb=13196, bsz=434.5, num_updates=19900, lr=0.000100251, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=19311
2023-08-27 06:18:24 | INFO | train_inner | epoch 017:    953 / 1191 loss=1.885, trans_loss=4.716, nll_loss=1.869, w2v_ctc_loss=0.57, task_loss=2.058, contrastive_loss=0.22, total=6827, n_correct=4770.48, ppl=3.65, accuracy=69.877, wps=18960.3, ups=1.39, wpb=13654, bsz=497.7, num_updates=20000, lr=0.0001, gnorm=0.384, clip=0, loss_scale=64, train_wall=71, gb_free=14.4, wall=19383
2023-08-27 06:18:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 06:18:57 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.938 | trans_loss 5.197 | nll_loss 2.406 | w2v_ctc_loss 1.213 | task_loss 8.535 | contrastive_loss 0.258 | total 6138.43 | n_correct 4148 | ppl 5.3 | accuracy 67.574 | uer 16.902 | wer 18.579 | raw_wer 18.579 | bleu 27.18 | wps 1762.2 | wpb 6138.4 | bsz 201.1 | num_updates 20000 | best_bleu 27.18
2023-08-27 06:18:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20000 updates
2023-08-27 06:18:57 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-27 06:18:58 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-27 06:19:07 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt (epoch 17 @ 20000 updates, score 27.18) (writing took 10.413840397988679 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 06:20:20 | INFO | train_inner | epoch 017:   1053 / 1191 loss=1.882, trans_loss=4.719, nll_loss=1.871, w2v_ctc_loss=0.582, task_loss=2.399, contrastive_loss=0.114, total=6650.1, n_correct=4641.96, ppl=3.66, accuracy=69.803, wps=11509.6, ups=0.87, wpb=13300.2, bsz=443.2, num_updates=20100, lr=9.97509e-05, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=13.1, wall=19498
2023-08-27 06:21:32 | INFO | train_inner | epoch 017:   1153 / 1191 loss=1.883, trans_loss=4.721, nll_loss=1.875, w2v_ctc_loss=0.589, task_loss=2.339, contrastive_loss=0.1, total=6758.75, n_correct=4716.25, ppl=3.67, accuracy=69.78, wps=18764, ups=1.39, wpb=13517.5, bsz=451.8, num_updates=20200, lr=9.95037e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=5.4, wall=19570
2023-08-27 06:22:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
2023-08-27 06:22:32 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.929 | trans_loss 5.195 | nll_loss 2.405 | w2v_ctc_loss 1.191 | task_loss 8.542 | contrastive_loss 0.254 | total 6138.43 | n_correct 4151.43 | ppl 5.3 | accuracy 67.63 | uer 16.958 | wer 18.68 | raw_wer 18.68 | bleu 27.18 | wps 1743.4 | wpb 6138.4 | bsz 201.1 | num_updates 20238 | best_bleu 27.18
2023-08-27 06:22:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20238 updates
2023-08-27 06:22:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:22:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:22:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 17 @ 20238 updates, score 27.18) (writing took 11.175942232992384 seconds)
2023-08-27 06:22:44 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2023-08-27 06:22:44 | INFO | train | epoch 017 | loss 1.884 | trans_loss 4.719 | nll_loss 1.871 | w2v_ctc_loss 0.585 | task_loss 2.344 | contrastive_loss 0.123 | total 6703.69 | n_correct 4675.9 | ppl 3.66 | accuracy 69.751 | wps 16717.5 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 20238 | lr 9.94103e-05 | gnorm 0.388 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 14.4 | wall 19643
2023-08-27 06:22:44 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 06:22:44 | INFO | fairseq.trainer | begin training epoch 18
2023-08-27 06:22:44 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 06:23:36 | INFO | train_inner | epoch 018:     62 / 1191 loss=1.869, trans_loss=4.699, nll_loss=1.845, w2v_ctc_loss=0.569, task_loss=2.248, contrastive_loss=0.116, total=6800.71, n_correct=4772.29, ppl=3.59, accuracy=70.173, wps=10960.5, ups=0.81, wpb=13601.4, bsz=463.8, num_updates=20300, lr=9.92583e-05, gnorm=0.384, clip=0, loss_scale=64, train_wall=71, gb_free=13.6, wall=19694
2023-08-27 06:24:48 | INFO | train_inner | epoch 018:    162 / 1191 loss=1.878, trans_loss=4.708, nll_loss=1.855, w2v_ctc_loss=0.586, task_loss=2.581, contrastive_loss=0.082, total=6654.58, n_correct=4653.33, ppl=3.62, accuracy=69.927, wps=18375.1, ups=1.38, wpb=13309.2, bsz=425.6, num_updates=20400, lr=9.90148e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=19767
2023-08-27 06:26:00 | INFO | train_inner | epoch 018:    262 / 1191 loss=1.881, trans_loss=4.703, nll_loss=1.849, w2v_ctc_loss=0.579, task_loss=2.395, contrastive_loss=0.184, total=6609.78, n_correct=4634.73, ppl=3.6, accuracy=70.119, wps=18377.2, ups=1.39, wpb=13219.6, bsz=444.8, num_updates=20500, lr=9.8773e-05, gnorm=0.387, clip=0, loss_scale=64, train_wall=71, gb_free=13.4, wall=19839
2023-08-27 06:27:12 | INFO | train_inner | epoch 018:    362 / 1191 loss=1.876, trans_loss=4.703, nll_loss=1.85, w2v_ctc_loss=0.574, task_loss=2.302, contrastive_loss=0.152, total=6733.43, n_correct=4718.44, ppl=3.61, accuracy=70.075, wps=18711.8, ups=1.39, wpb=13466.9, bsz=460.8, num_updates=20600, lr=9.85329e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=71, gb_free=14.2, wall=19911
2023-08-27 06:28:24 | INFO | train_inner | epoch 018:    462 / 1191 loss=1.871, trans_loss=4.705, nll_loss=1.854, w2v_ctc_loss=0.572, task_loss=2.327, contrastive_loss=0.098, total=6707.66, n_correct=4704.79, ppl=3.61, accuracy=70.141, wps=18620.6, ups=1.39, wpb=13415.3, bsz=455, num_updates=20700, lr=9.82946e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=14, wall=19983
2023-08-27 06:29:36 | INFO | train_inner | epoch 018:    562 / 1191 loss=1.872, trans_loss=4.704, nll_loss=1.853, w2v_ctc_loss=0.574, task_loss=2.193, contrastive_loss=0.114, total=6819.92, n_correct=4783.42, ppl=3.61, accuracy=70.139, wps=19000.6, ups=1.39, wpb=13639.8, bsz=475.9, num_updates=20800, lr=9.80581e-05, gnorm=0.383, clip=0, loss_scale=64, train_wall=71, gb_free=12.1, wall=20055
2023-08-27 06:30:47 | INFO | train_inner | epoch 018:    662 / 1191 loss=1.875, trans_loss=4.706, nll_loss=1.854, w2v_ctc_loss=0.58, task_loss=2.49, contrastive_loss=0.097, total=6575.74, n_correct=4606.14, ppl=3.61, accuracy=70.047, wps=18496.1, ups=1.41, wpb=13151.5, bsz=431, num_updates=20900, lr=9.78232e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=71, gb_free=13.7, wall=20126
2023-08-27 06:32:00 | INFO | train_inner | epoch 018:    762 / 1191 loss=1.873, trans_loss=4.714, nll_loss=1.865, w2v_ctc_loss=0.579, task_loss=2.252, contrastive_loss=0.081, total=6831.22, n_correct=4780.73, ppl=3.64, accuracy=69.984, wps=18783.3, ups=1.37, wpb=13662.4, bsz=469.7, num_updates=21000, lr=9.759e-05, gnorm=0.385, clip=0, loss_scale=128, train_wall=72, gb_free=12.5, wall=20198
2023-08-27 06:32:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-27 06:33:14 | INFO | train_inner | epoch 018:    863 / 1191 loss=1.886, trans_loss=4.724, nll_loss=1.878, w2v_ctc_loss=0.589, task_loss=2.375, contrastive_loss=0.111, total=6710.24, n_correct=4676.71, ppl=3.67, accuracy=69.695, wps=18270.7, ups=1.36, wpb=13420.5, bsz=449.5, num_updates=21100, lr=9.73585e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=73, gb_free=13.4, wall=20272
2023-08-27 06:34:25 | INFO | train_inner | epoch 018:    963 / 1191 loss=1.872, trans_loss=4.707, nll_loss=1.856, w2v_ctc_loss=0.582, task_loss=2.297, contrastive_loss=0.073, total=6702.56, n_correct=4696.44, ppl=3.62, accuracy=70.069, wps=18763.2, ups=1.4, wpb=13405.1, bsz=452.7, num_updates=21200, lr=9.71286e-05, gnorm=0.383, clip=0, loss_scale=64, train_wall=71, gb_free=11.4, wall=20343
2023-08-27 06:35:37 | INFO | train_inner | epoch 018:   1063 / 1191 loss=1.884, trans_loss=4.719, nll_loss=1.872, w2v_ctc_loss=0.584, task_loss=2.473, contrastive_loss=0.134, total=6587.43, n_correct=4599.5, ppl=3.66, accuracy=69.822, wps=18349.4, ups=1.39, wpb=13174.9, bsz=434.9, num_updates=21300, lr=9.69003e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=20415
2023-08-27 06:36:49 | INFO | train_inner | epoch 018:   1163 / 1191 loss=1.883, trans_loss=4.714, nll_loss=1.866, w2v_ctc_loss=0.581, task_loss=2.284, contrastive_loss=0.148, total=6769.67, n_correct=4728.11, ppl=3.65, accuracy=69.843, wps=18730.5, ups=1.38, wpb=13539.3, bsz=466.9, num_updates=21400, lr=9.66736e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=15.1, wall=20487
2023-08-27 06:37:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 06:37:41 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 3.942 | trans_loss 5.196 | nll_loss 2.407 | w2v_ctc_loss 1.231 | task_loss 8.546 | contrastive_loss 0.257 | total 6138.43 | n_correct 4143.14 | ppl 5.3 | accuracy 67.495 | uer 17.049 | wer 18.691 | raw_wer 18.691 | bleu 27.26 | wps 1724.3 | wpb 6138.4 | bsz 201.1 | num_updates 21428 | best_bleu 27.26
2023-08-27 06:37:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 21428 updates
2023-08-27 06:37:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:37:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 06:37:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 18 @ 21428 updates, score 27.26) (writing took 12.42925187300716 seconds)
2023-08-27 06:37:54 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2023-08-27 06:37:54 | INFO | train | epoch 018 | loss 1.876 | trans_loss 4.708 | nll_loss 1.857 | w2v_ctc_loss 0.578 | task_loss 2.349 | contrastive_loss 0.119 | total 6703.19 | n_correct 4693.81 | ppl 3.62 | accuracy 70.023 | wps 17528.8 | ups 1.31 | wpb 13406.4 | bsz 451.9 | num_updates 21428 | lr 9.66105e-05 | gnorm 0.388 | clip 0 | loss_scale 64 | train_wall 850 | gb_free 14 | wall 20553
2023-08-27 06:37:54 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 06:37:54 | INFO | fairseq.trainer | begin training epoch 19
2023-08-27 06:37:54 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 06:38:55 | INFO | train_inner | epoch 019:     72 / 1191 loss=1.867, trans_loss=4.692, nll_loss=1.835, w2v_ctc_loss=0.569, task_loss=2.502, contrastive_loss=0.124, total=6585.47, n_correct=4633.24, ppl=3.57, accuracy=70.355, wps=10490.9, ups=0.8, wpb=13170.9, bsz=425.2, num_updates=21500, lr=9.64486e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=13.9, wall=20613
2023-08-27 06:40:06 | INFO | train_inner | epoch 019:    172 / 1191 loss=1.854, trans_loss=4.681, nll_loss=1.822, w2v_ctc_loss=0.561, task_loss=2.375, contrastive_loss=0.072, total=6683.38, n_correct=4722.92, ppl=3.54, accuracy=70.667, wps=18704.4, ups=1.4, wpb=13366.8, bsz=446.6, num_updates=21600, lr=9.6225e-05, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=12.3, wall=20684
2023-08-27 06:41:18 | INFO | train_inner | epoch 019:    272 / 1191 loss=1.862, trans_loss=4.685, nll_loss=1.827, w2v_ctc_loss=0.567, task_loss=2.235, contrastive_loss=0.126, total=6766.59, n_correct=4771.5, ppl=3.55, accuracy=70.516, wps=18733.5, ups=1.38, wpb=13533.2, bsz=464.3, num_updates=21700, lr=9.60031e-05, gnorm=0.385, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=20757
2023-08-27 06:42:30 | INFO | train_inner | epoch 019:    372 / 1191 loss=1.861, trans_loss=4.694, nll_loss=1.839, w2v_ctc_loss=0.566, task_loss=2.325, contrastive_loss=0.065, total=6694.81, n_correct=4709.96, ppl=3.58, accuracy=70.352, wps=18740.4, ups=1.4, wpb=13389.6, bsz=444.8, num_updates=21800, lr=9.57826e-05, gnorm=0.387, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=20828
2023-08-27 06:43:42 | INFO | train_inner | epoch 019:    472 / 1191 loss=1.874, trans_loss=4.699, nll_loss=1.846, w2v_ctc_loss=0.571, task_loss=2.194, contrastive_loss=0.166, total=6775.29, n_correct=4756.65, ppl=3.6, accuracy=70.206, wps=18826.8, ups=1.39, wpb=13550.6, bsz=476.3, num_updates=21900, lr=9.55637e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=71, gb_free=14.7, wall=20900
2023-08-27 06:44:55 | INFO | train_inner | epoch 019:    572 / 1191 loss=1.865, trans_loss=4.7, nll_loss=1.847, w2v_ctc_loss=0.57, task_loss=2.31, contrastive_loss=0.092, total=6762.36, n_correct=4751.69, ppl=3.6, accuracy=70.267, wps=18533.1, ups=1.37, wpb=13524.7, bsz=464.5, num_updates=22000, lr=9.53463e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=73, gb_free=13.9, wall=20973
2023-08-27 06:44:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 06:45:27 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.937 | trans_loss 5.197 | nll_loss 2.405 | w2v_ctc_loss 1.213 | task_loss 8.53 | contrastive_loss 0.255 | total 6138.43 | n_correct 4151.14 | ppl 5.3 | accuracy 67.625 | uer 16.682 | wer 18.501 | raw_wer 18.501 | bleu 27.31 | wps 1749.8 | wpb 6138.4 | bsz 201.1 | num_updates 22000 | best_bleu 27.31
2023-08-27 06:45:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22000 updates
2023-08-27 06:45:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-27 06:45:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-27 06:45:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt (epoch 19 @ 22000 updates, score 27.31) (writing took 10.717113371007144 seconds)
2023-08-27 06:46:50 | INFO | train_inner | epoch 019:    672 / 1191 loss=1.871, trans_loss=4.696, nll_loss=1.842, w2v_ctc_loss=0.563, task_loss=2.346, contrastive_loss=0.187, total=6661.24, n_correct=4681.43, ppl=3.59, accuracy=70.279, wps=11543.7, ups=0.87, wpb=13322.5, bsz=452.2, num_updates=22100, lr=9.51303e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=21089
2023-08-27 06:48:02 | INFO | train_inner | epoch 019:    772 / 1191 loss=1.872, trans_loss=4.703, nll_loss=1.852, w2v_ctc_loss=0.578, task_loss=2.311, contrastive_loss=0.098, total=6750.51, n_correct=4736.42, ppl=3.61, accuracy=70.164, wps=18763.1, ups=1.39, wpb=13501, bsz=460.9, num_updates=22200, lr=9.49158e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=71, gb_free=14.7, wall=21161
2023-08-27 06:49:14 | INFO | train_inner | epoch 019:    872 / 1191 loss=1.882, trans_loss=4.709, nll_loss=1.858, w2v_ctc_loss=0.581, task_loss=2.426, contrastive_loss=0.161, total=6623.43, n_correct=4632.71, ppl=3.63, accuracy=69.944, wps=18318.7, ups=1.38, wpb=13246.9, bsz=440.6, num_updates=22300, lr=9.47027e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=21233
2023-08-27 06:50:26 | INFO | train_inner | epoch 019:    972 / 1191 loss=1.87, trans_loss=4.701, nll_loss=1.849, w2v_ctc_loss=0.575, task_loss=2.508, contrastive_loss=0.1, total=6609.43, n_correct=4638.4, ppl=3.6, accuracy=70.179, wps=18503.3, ups=1.4, wpb=13218.9, bsz=434.4, num_updates=22400, lr=9.44911e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=14.7, wall=21304
2023-08-27 06:51:38 | INFO | train_inner | epoch 019:   1072 / 1191 loss=1.874, trans_loss=4.705, nll_loss=1.855, w2v_ctc_loss=0.576, task_loss=2.291, contrastive_loss=0.122, total=6735.66, n_correct=4722.69, ppl=3.62, accuracy=70.115, wps=18756, ups=1.39, wpb=13471.3, bsz=454.1, num_updates=22500, lr=9.42809e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=71, gb_free=13.9, wall=21376
2023-08-27 06:52:51 | INFO | train_inner | epoch 019:   1172 / 1191 loss=1.881, trans_loss=4.719, nll_loss=1.873, w2v_ctc_loss=0.578, task_loss=2.329, contrastive_loss=0.143, total=6787.63, n_correct=4741.53, ppl=3.66, accuracy=69.855, wps=18587.8, ups=1.37, wpb=13575.3, bsz=457.1, num_updates=22600, lr=9.40721e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=21449
2023-08-27 06:53:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 06:53:37 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.938 | trans_loss 5.197 | nll_loss 2.41 | w2v_ctc_loss 1.217 | task_loss 8.485 | contrastive_loss 0.256 | total 6138.43 | n_correct 4149.57 | ppl 5.32 | accuracy 67.6 | uer 16.974 | wer 18.754 | raw_wer 18.754 | bleu 27.16 | wps 1736.5 | wpb 6138.4 | bsz 201.1 | num_updates 22619 | best_bleu 27.31
2023-08-27 06:53:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22619 updates
2023-08-27 06:53:37 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1608.pt
2023-08-27 06:53:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1608.pt
2023-08-27 06:53:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1608.pt (epoch 19 @ 22619 updates, score 27.16) (writing took 6.525522925992846 seconds)
2023-08-27 06:53:44 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2023-08-27 06:53:44 | INFO | train | epoch 019 | loss 1.869 | trans_loss 4.699 | nll_loss 1.846 | w2v_ctc_loss 0.571 | task_loss 2.345 | contrastive_loss 0.119 | total 6703.69 | n_correct 4708.23 | ppl 3.6 | accuracy 70.233 | wps 16815.1 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 22619 | lr 9.40326e-05 | gnorm 0.391 | clip 0 | loss_scale 64 | train_wall 851 | gb_free 14.5 | wall 21502
2023-08-27 06:53:44 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 06:53:44 | INFO | fairseq.trainer | begin training epoch 20
2023-08-27 06:53:44 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 06:54:50 | INFO | train_inner | epoch 020:     81 / 1191 loss=1.859, trans_loss=4.682, nll_loss=1.823, w2v_ctc_loss=0.565, task_loss=2.362, contrastive_loss=0.105, total=6698.36, n_correct=4726.66, ppl=3.54, accuracy=70.564, wps=11199.3, ups=0.84, wpb=13396.7, bsz=452.9, num_updates=22700, lr=9.38647e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=21569
2023-08-27 06:56:02 | INFO | train_inner | epoch 020:    181 / 1191 loss=1.858, trans_loss=4.679, nll_loss=1.819, w2v_ctc_loss=0.562, task_loss=2.435, contrastive_loss=0.121, total=6607.23, n_correct=4673.06, ppl=3.53, accuracy=70.726, wps=18370.1, ups=1.39, wpb=13214.5, bsz=438.8, num_updates=22800, lr=9.36586e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=21641
2023-08-27 06:57:14 | INFO | train_inner | epoch 020:    281 / 1191 loss=1.862, trans_loss=4.687, nll_loss=1.83, w2v_ctc_loss=0.563, task_loss=2.327, contrastive_loss=0.13, total=6763.55, n_correct=4772.24, ppl=3.56, accuracy=70.558, wps=18778.1, ups=1.39, wpb=13527.1, bsz=457, num_updates=22900, lr=9.34539e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=11.9, wall=21713
2023-08-27 06:58:26 | INFO | train_inner | epoch 020:    381 / 1191 loss=1.858, trans_loss=4.686, nll_loss=1.829, w2v_ctc_loss=0.568, task_loss=2.224, contrastive_loss=0.075, total=6785.07, n_correct=4784.94, ppl=3.55, accuracy=70.522, wps=18943.4, ups=1.4, wpb=13570.1, bsz=465.8, num_updates=23000, lr=9.32505e-05, gnorm=0.385, clip=0, loss_scale=64, train_wall=71, gb_free=15, wall=21784
2023-08-27 06:59:38 | INFO | train_inner | epoch 020:    481 / 1191 loss=1.859, trans_loss=4.684, nll_loss=1.826, w2v_ctc_loss=0.565, task_loss=2.337, contrastive_loss=0.112, total=6697.03, n_correct=4728.56, ppl=3.54, accuracy=70.607, wps=18596.1, ups=1.39, wpb=13394.1, bsz=447.1, num_updates=23100, lr=9.30484e-05, gnorm=0.389, clip=0, loss_scale=128, train_wall=71, gb_free=12.6, wall=21856
2023-08-27 06:59:56 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-27 07:00:51 | INFO | train_inner | epoch 020:    582 / 1191 loss=1.872, trans_loss=4.692, nll_loss=1.837, w2v_ctc_loss=0.572, task_loss=2.469, contrastive_loss=0.171, total=6598.26, n_correct=4640.85, ppl=3.57, accuracy=70.334, wps=18087.3, ups=1.37, wpb=13196.5, bsz=433.5, num_updates=23200, lr=9.28477e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=21929
2023-08-27 07:02:03 | INFO | train_inner | epoch 020:    682 / 1191 loss=1.857, trans_loss=4.685, nll_loss=1.829, w2v_ctc_loss=0.551, task_loss=2.201, contrastive_loss=0.159, total=6711.24, n_correct=4745.47, ppl=3.55, accuracy=70.709, wps=18679, ups=1.39, wpb=13422.5, bsz=470.5, num_updates=23300, lr=9.26482e-05, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=13.7, wall=22001
2023-08-27 07:03:14 | INFO | train_inner | epoch 020:    782 / 1191 loss=1.862, trans_loss=4.689, nll_loss=1.835, w2v_ctc_loss=0.565, task_loss=2.243, contrastive_loss=0.119, total=6749.91, n_correct=4759.32, ppl=3.57, accuracy=70.509, wps=18935.1, ups=1.4, wpb=13499.8, bsz=458.6, num_updates=23400, lr=9.245e-05, gnorm=0.385, clip=0, loss_scale=64, train_wall=71, gb_free=13.8, wall=22073
2023-08-27 07:04:27 | INFO | train_inner | epoch 020:    882 / 1191 loss=1.863, trans_loss=4.695, nll_loss=1.841, w2v_ctc_loss=0.57, task_loss=2.411, contrastive_loss=0.08, total=6725.15, n_correct=4734.82, ppl=3.58, accuracy=70.405, wps=18523.7, ups=1.38, wpb=13450.3, bsz=447.2, num_updates=23500, lr=9.22531e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=13.3, wall=22145
2023-08-27 07:05:40 | INFO | train_inner | epoch 020:    982 / 1191 loss=1.857, trans_loss=4.692, nll_loss=1.837, w2v_ctc_loss=0.559, task_loss=2.527, contrastive_loss=0.073, total=6666.28, n_correct=4696.57, ppl=3.57, accuracy=70.453, wps=18298.7, ups=1.37, wpb=13332.6, bsz=433.5, num_updates=23600, lr=9.20575e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=13.3, wall=22218
2023-08-27 07:06:51 | INFO | train_inner | epoch 020:   1082 / 1191 loss=1.86, trans_loss=4.691, nll_loss=1.838, w2v_ctc_loss=0.572, task_loss=2.31, contrastive_loss=0.069, total=6748.86, n_correct=4754.16, ppl=3.57, accuracy=70.444, wps=18880.1, ups=1.4, wpb=13497.7, bsz=458, num_updates=23700, lr=9.1863e-05, gnorm=0.387, clip=0, loss_scale=64, train_wall=71, gb_free=13.4, wall=22290
2023-08-27 07:08:04 | INFO | train_inner | epoch 020:   1182 / 1191 loss=1.868, trans_loss=4.704, nll_loss=1.853, w2v_ctc_loss=0.568, task_loss=2.372, contrastive_loss=0.111, total=6683.47, n_correct=4693.26, ppl=3.61, accuracy=70.222, wps=18387.1, ups=1.38, wpb=13366.9, bsz=452.7, num_updates=23800, lr=9.16698e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=14.1, wall=22362
2023-08-27 07:08:10 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 07:08:44 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 3.921 | trans_loss 5.182 | nll_loss 2.387 | w2v_ctc_loss 1.195 | task_loss 8.555 | contrastive_loss 0.254 | total 6138.43 | n_correct 4169.43 | ppl 5.23 | accuracy 67.923 | uer 16.688 | wer 18.483 | raw_wer 18.483 | bleu 27.12 | wps 1679.5 | wpb 6138.4 | bsz 201.1 | num_updates 23809 | best_bleu 27.31
2023-08-27 07:08:44 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 23809 updates
2023-08-27 07:08:44 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1203.pt
2023-08-27 07:08:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1203.pt
2023-08-27 07:08:51 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1203.pt (epoch 20 @ 23809 updates, score 27.12) (writing took 7.213284529992961 seconds)
2023-08-27 07:08:51 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2023-08-27 07:08:51 | INFO | train | epoch 020 | loss 1.861 | trans_loss 4.689 | nll_loss 1.833 | w2v_ctc_loss 0.565 | task_loss 2.349 | contrastive_loss 0.114 | total 6701.22 | n_correct 4724.79 | ppl 3.56 | accuracy 70.507 | wps 17582.1 | ups 1.31 | wpb 13402.4 | bsz 451.3 | num_updates 23809 | lr 9.16525e-05 | gnorm 0.388 | clip 0 | loss_scale 64 | train_wall 852 | gb_free 15.4 | wall 22409
2023-08-27 07:08:51 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 07:08:51 | INFO | fairseq.trainer | begin training epoch 21
2023-08-27 07:08:51 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 07:10:04 | INFO | train_inner | epoch 021:     91 / 1191 loss=1.855, trans_loss=4.669, nll_loss=1.808, w2v_ctc_loss=0.548, task_loss=2.201, contrastive_loss=0.227, total=6760.63, n_correct=4795.32, ppl=3.5, accuracy=70.93, wps=11253.8, ups=0.83, wpb=13521.3, bsz=474.7, num_updates=23900, lr=9.14779e-05, gnorm=0.383, clip=0, loss_scale=64, train_wall=71, gb_free=12.5, wall=22482
2023-08-27 07:11:15 | INFO | train_inner | epoch 021:    191 / 1191 loss=1.842, trans_loss=4.663, nll_loss=1.8, w2v_ctc_loss=0.551, task_loss=2.201, contrastive_loss=0.096, total=6783.08, n_correct=4826.89, ppl=3.48, accuracy=71.161, wps=18971.7, ups=1.4, wpb=13566.2, bsz=471.6, num_updates=24000, lr=9.12871e-05, gnorm=0.383, clip=0, loss_scale=64, train_wall=71, gb_free=14.2, wall=22554
2023-08-27 07:11:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 07:11:48 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.936 | trans_loss 5.193 | nll_loss 2.4 | w2v_ctc_loss 1.214 | task_loss 8.54 | contrastive_loss 0.262 | total 6138.43 | n_correct 4149.71 | ppl 5.28 | accuracy 67.602 | uer 16.698 | wer 18.505 | raw_wer 18.505 | bleu 27.18 | wps 1751.6 | wpb 6138.4 | bsz 201.1 | num_updates 24000 | best_bleu 27.31
2023-08-27 07:11:48 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24000 updates
2023-08-27 07:11:48 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-27 07:11:50 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-27 07:11:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt (epoch 21 @ 24000 updates, score 27.18) (writing took 10.786273325997172 seconds)
2023-08-27 07:13:10 | INFO | train_inner | epoch 021:    291 / 1191 loss=1.848, trans_loss=4.673, nll_loss=1.811, w2v_ctc_loss=0.558, task_loss=2.431, contrastive_loss=0.062, total=6641.78, n_correct=4711.15, ppl=3.51, accuracy=70.932, wps=11553.3, ups=0.87, wpb=13283.6, bsz=436, num_updates=24100, lr=9.10975e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=15.4, wall=22669
2023-08-27 07:14:22 | INFO | train_inner | epoch 021:    391 / 1191 loss=1.85, trans_loss=4.678, nll_loss=1.82, w2v_ctc_loss=0.556, task_loss=2.375, contrastive_loss=0.084, total=6675.38, n_correct=4724.25, ppl=3.53, accuracy=70.771, wps=18574.4, ups=1.39, wpb=13350.8, bsz=450.4, num_updates=24200, lr=9.09091e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=71, gb_free=12.7, wall=22741
2023-08-27 07:15:34 | INFO | train_inner | epoch 021:    491 / 1191 loss=1.856, trans_loss=4.678, nll_loss=1.818, w2v_ctc_loss=0.562, task_loss=2.453, contrastive_loss=0.102, total=6679.69, n_correct=4722.23, ppl=3.53, accuracy=70.695, wps=18528.5, ups=1.39, wpb=13359.4, bsz=437.8, num_updates=24300, lr=9.07218e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=71, gb_free=13.3, wall=22813
2023-08-27 07:16:46 | INFO | train_inner | epoch 021:    591 / 1191 loss=1.86, trans_loss=4.687, nll_loss=1.83, w2v_ctc_loss=0.569, task_loss=2.521, contrastive_loss=0.063, total=6618.89, n_correct=4666.25, ppl=3.56, accuracy=70.499, wps=18448.5, ups=1.39, wpb=13237.8, bsz=424, num_updates=24400, lr=9.05357e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=71, gb_free=13.1, wall=22885
2023-08-27 07:17:58 | INFO | train_inner | epoch 021:    691 / 1191 loss=1.862, trans_loss=4.686, nll_loss=1.83, w2v_ctc_loss=0.566, task_loss=2.308, contrastive_loss=0.131, total=6724.83, n_correct=4747.57, ppl=3.55, accuracy=70.598, wps=18646.8, ups=1.39, wpb=13449.7, bsz=465.4, num_updates=24500, lr=9.03508e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=7.6, wall=22957
2023-08-27 07:19:11 | INFO | train_inner | epoch 021:    791 / 1191 loss=1.864, trans_loss=4.685, nll_loss=1.828, w2v_ctc_loss=0.561, task_loss=2.438, contrastive_loss=0.181, total=6629.21, n_correct=4678.19, ppl=3.55, accuracy=70.569, wps=18323.4, ups=1.38, wpb=13258.4, bsz=443.8, num_updates=24600, lr=9.0167e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=72, gb_free=13.6, wall=23029
2023-08-27 07:20:23 | INFO | train_inner | epoch 021:    891 / 1191 loss=1.859, trans_loss=4.683, nll_loss=1.826, w2v_ctc_loss=0.561, task_loss=2.32, contrastive_loss=0.126, total=6739.57, n_correct=4761.76, ppl=3.55, accuracy=70.654, wps=18714.9, ups=1.39, wpb=13479.1, bsz=453.1, num_updates=24700, lr=8.99843e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=23101
2023-08-27 07:21:35 | INFO | train_inner | epoch 021:    991 / 1191 loss=1.86, trans_loss=4.692, nll_loss=1.839, w2v_ctc_loss=0.559, task_loss=2.252, contrastive_loss=0.128, total=6793.05, n_correct=4788.25, ppl=3.58, accuracy=70.487, wps=18681.3, ups=1.38, wpb=13586.1, bsz=464, num_updates=24800, lr=8.98027e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=12.1, wall=23174
2023-08-27 07:22:48 | INFO | train_inner | epoch 021:   1091 / 1191 loss=1.859, trans_loss=4.69, nll_loss=1.836, w2v_ctc_loss=0.562, task_loss=2.292, contrastive_loss=0.107, total=6727.98, n_correct=4740.71, ppl=3.57, accuracy=70.463, wps=18655.9, ups=1.39, wpb=13456, bsz=456.2, num_updates=24900, lr=8.96221e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=14, wall=23246
2023-08-27 07:24:00 | INFO | train_inner | epoch 021:   1191 / 1191 loss=1.859, trans_loss=4.688, nll_loss=1.834, w2v_ctc_loss=0.558, task_loss=2.386, contrastive_loss=0.13, total=6662.99, n_correct=4709.29, ppl=3.57, accuracy=70.678, wps=18503.3, ups=1.39, wpb=13326, bsz=453.1, num_updates=25000, lr=8.94427e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=71, gb_free=13.7, wall=23318
2023-08-27 07:24:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 07:24:32 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.917 | trans_loss 5.186 | nll_loss 2.394 | w2v_ctc_loss 1.173 | task_loss 8.558 | contrastive_loss 0.252 | total 6138.43 | n_correct 4158.14 | ppl 5.25 | accuracy 67.74 | uer 16.495 | wer 18.196 | raw_wer 18.196 | bleu 27.09 | wps 1739.6 | wpb 6138.4 | bsz 201.1 | num_updates 25000 | best_bleu 27.31
2023-08-27 07:24:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 25000 updates
2023-08-27 07:24:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.0909.pt
2023-08-27 07:24:35 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.0909.pt
2023-08-27 07:24:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.0909.pt (epoch 21 @ 25000 updates, score 27.09) (writing took 6.753851964997011 seconds)
2023-08-27 07:24:39 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2023-08-27 07:24:39 | INFO | train | epoch 021 | loss 1.856 | trans_loss 4.681 | nll_loss 1.823 | w2v_ctc_loss 0.559 | task_loss 2.347 | contrastive_loss 0.117 | total 6703.69 | n_correct 4740.26 | ppl 3.54 | accuracy 70.711 | wps 16839.8 | ups 1.26 | wpb 13407.4 | bsz 452.1 | num_updates 25000 | lr 8.94427e-05 | gnorm 0.39 | clip 0 | loss_scale 64 | train_wall 851 | gb_free 13.7 | wall 23358
2023-08-27 07:24:39 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 07:24:39 | INFO | fairseq.trainer | begin training epoch 22
2023-08-27 07:24:39 | INFO | fairseq_cli.train | Start iterating over samples
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 07:25:59 | INFO | train_inner | epoch 022:    100 / 1191 loss=1.832, trans_loss=4.653, nll_loss=1.787, w2v_ctc_loss=0.539, task_loss=2.298, contrastive_loss=0.084, total=6760.58, n_correct=4826.32, ppl=3.45, accuracy=71.389, wps=11325.1, ups=0.84, wpb=13521.2, bsz=458.1, num_updates=25100, lr=8.92644e-05, gnorm=0.381, clip=0, loss_scale=64, train_wall=71, gb_free=11.6, wall=23437
2023-08-27 07:26:55 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-27 07:27:12 | INFO | train_inner | epoch 022:    201 / 1191 loss=1.846, trans_loss=4.668, nll_loss=1.806, w2v_ctc_loss=0.551, task_loss=2.426, contrastive_loss=0.103, total=6651.48, n_correct=4722.65, ppl=3.5, accuracy=71.001, wps=18202.1, ups=1.37, wpb=13303, bsz=441, num_updates=25200, lr=8.90871e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=73, gb_free=12.2, wall=23510
2023-08-27 07:28:24 | INFO | train_inner | epoch 022:    301 / 1191 loss=1.846, trans_loss=4.662, nll_loss=1.799, w2v_ctc_loss=0.549, task_loss=2.26, contrastive_loss=0.141, total=6760.33, n_correct=4812.06, ppl=3.48, accuracy=71.181, wps=18740.8, ups=1.39, wpb=13520.7, bsz=469.7, num_updates=25300, lr=8.89108e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=13.3, wall=23583
2023-08-27 07:29:36 | INFO | train_inner | epoch 022:    401 / 1191 loss=1.846, trans_loss=4.67, nll_loss=1.81, w2v_ctc_loss=0.557, task_loss=2.335, contrastive_loss=0.076, total=6660.25, n_correct=4724.53, ppl=3.51, accuracy=70.936, wps=18448.9, ups=1.38, wpb=13320.5, bsz=455.7, num_updates=25400, lr=8.87357e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=15.3, wall=23655
2023-08-27 07:30:48 | INFO | train_inner | epoch 022:    501 / 1191 loss=1.856, trans_loss=4.676, nll_loss=1.817, w2v_ctc_loss=0.562, task_loss=2.336, contrastive_loss=0.132, total=6720.12, n_correct=4761.28, ppl=3.52, accuracy=70.851, wps=18651.5, ups=1.39, wpb=13440.2, bsz=457.6, num_updates=25500, lr=8.85615e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=14, wall=23727
2023-08-27 07:32:01 | INFO | train_inner | epoch 022:    601 / 1191 loss=1.848, trans_loss=4.674, nll_loss=1.815, w2v_ctc_loss=0.556, task_loss=2.387, contrastive_loss=0.074, total=6704.25, n_correct=4750.88, ppl=3.52, accuracy=70.864, wps=18528.4, ups=1.38, wpb=13408.5, bsz=447.4, num_updates=25600, lr=8.83883e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=10.5, wall=23799
2023-08-27 07:33:13 | INFO | train_inner | epoch 022:    701 / 1191 loss=1.849, trans_loss=4.673, nll_loss=1.814, w2v_ctc_loss=0.548, task_loss=2.281, contrastive_loss=0.139, total=6710.51, n_correct=4760.35, ppl=3.52, accuracy=70.939, wps=18642.5, ups=1.39, wpb=13421, bsz=454.9, num_updates=25700, lr=8.82162e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=15.2, wall=23871
2023-08-27 07:34:24 | INFO | train_inner | epoch 022:    801 / 1191 loss=1.848, trans_loss=4.669, nll_loss=1.809, w2v_ctc_loss=0.55, task_loss=2.449, contrastive_loss=0.127, total=6572.69, n_correct=4666.4, ppl=3.5, accuracy=70.997, wps=18466, ups=1.4, wpb=13145.4, bsz=434.8, num_updates=25800, lr=8.80451e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=71, gb_free=11.8, wall=23942
2023-08-27 07:35:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 07:35:38 | INFO | train_inner | epoch 022:    902 / 1191 loss=1.862, trans_loss=4.685, nll_loss=1.829, w2v_ctc_loss=0.564, task_loss=2.395, contrastive_loss=0.149, total=6690.56, n_correct=4723.18, ppl=3.55, accuracy=70.595, wps=18176.3, ups=1.36, wpb=13381.1, bsz=448.1, num_updates=25900, lr=8.7875e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=73, gb_free=13.5, wall=24016
2023-08-27 07:36:50 | INFO | train_inner | epoch 022:   1002 / 1191 loss=1.849, trans_loss=4.677, nll_loss=1.82, w2v_ctc_loss=0.553, task_loss=2.24, contrastive_loss=0.097, total=6836.61, n_correct=4841.37, ppl=3.53, accuracy=70.815, wps=18949.8, ups=1.39, wpb=13673.2, bsz=466.1, num_updates=26000, lr=8.77058e-05, gnorm=0.384, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=24088
2023-08-27 07:36:50 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
2023-08-27 07:37:23 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.929 | trans_loss 5.186 | nll_loss 2.397 | w2v_ctc_loss 1.21 | task_loss 8.574 | contrastive_loss 0.256 | total 6138.43 | n_correct 4162.71 | ppl 5.27 | accuracy 67.814 | uer 16.728 | wer 18.52 | raw_wer 18.52 | bleu 27.09 | wps 1680.7 | wpb 6138.4 | bsz 201.1 | num_updates 26000 | best_bleu 27.31
2023-08-27 07:37:23 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26000 updates
2023-08-27 07:37:23 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-27 07:37:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-27 07:37:30 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt (epoch 22 @ 26000 updates, score 27.09) (writing took 6.801221767993411 seconds)
2023-08-27 07:38:41 | INFO | train_inner | epoch 022:   1102 / 1191 loss=1.848, trans_loss=4.675, nll_loss=1.816, w2v_ctc_loss=0.552, task_loss=2.346, contrastive_loss=0.103, total=6701.53, n_correct=4749.1, ppl=3.52, accuracy=70.866, wps=12010.4, ups=0.9, wpb=13403.1, bsz=447.4, num_updates=26100, lr=8.75376e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=70, gb_free=11.9, wall=24200
2023-08-27 07:39:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 07:40:19 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.936 | trans_loss 5.19 | nll_loss 2.399 | w2v_ctc_loss 1.226 | task_loss 8.56 | contrastive_loss 0.254 | total 6138.43 | n_correct 4153.43 | ppl 5.28 | accuracy 67.663 | uer 16.907 | wer 18.728 | raw_wer 18.728 | bleu 27.47 | wps 1736.4 | wpb 6138.4 | bsz 201.1 | num_updates 26189 | best_bleu 27.47
2023-08-27 07:40:19 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26189 updates
2023-08-27 07:40:19 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 07:40:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 07:40:30 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 22 @ 26189 updates, score 27.47) (writing took 10.898348146001808 seconds)
2023-08-27 07:40:30 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2023-08-27 07:40:30 | INFO | train | epoch 022 | loss 1.849 | trans_loss 4.672 | nll_loss 1.813 | w2v_ctc_loss 0.554 | task_loss 2.35 | contrastive_loss 0.111 | total 6701.63 | n_correct 4752.96 | ppl 3.51 | accuracy 70.922 | wps 16761.5 | ups 1.25 | wpb 13403.3 | bsz 451.5 | num_updates 26189 | lr 8.73888e-05 | gnorm 0.39 | clip 0 | loss_scale 32 | train_wall 852 | gb_free 13.7 | wall 24309
2023-08-27 07:40:30 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 07:40:30 | INFO | fairseq.trainer | begin training epoch 23
2023-08-27 07:40:30 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 07:40:46 | INFO | train_inner | epoch 023:     11 / 1191 loss=1.858, trans_loss=4.683, nll_loss=1.827, w2v_ctc_loss=0.562, task_loss=2.496, contrastive_loss=0.105, total=6652.47, n_correct=4701.74, ppl=3.55, accuracy=70.677, wps=10708.2, ups=0.8, wpb=13304.9, bsz=433.4, num_updates=26200, lr=8.73704e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=24324
2023-08-27 07:41:58 | INFO | train_inner | epoch 023:    111 / 1191 loss=1.839, trans_loss=4.654, nll_loss=1.787, w2v_ctc_loss=0.548, task_loss=2.45, contrastive_loss=0.094, total=6652.39, n_correct=4749.1, ppl=3.45, accuracy=71.389, wps=18424.9, ups=1.38, wpb=13304.8, bsz=438.7, num_updates=26300, lr=8.72041e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=24396
2023-08-27 07:43:10 | INFO | train_inner | epoch 023:    211 / 1191 loss=1.837, trans_loss=4.657, nll_loss=1.793, w2v_ctc_loss=0.546, task_loss=2.212, contrastive_loss=0.087, total=6813.04, n_correct=4854.21, ppl=3.47, accuracy=71.249, wps=18848.8, ups=1.38, wpb=13626.1, bsz=474, num_updates=26400, lr=8.70388e-05, gnorm=0.387, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=24469
2023-08-27 07:44:22 | INFO | train_inner | epoch 023:    311 / 1191 loss=1.832, trans_loss=4.654, nll_loss=1.788, w2v_ctc_loss=0.536, task_loss=2.232, contrastive_loss=0.095, total=6827.7, n_correct=4874.47, ppl=3.45, accuracy=71.393, wps=18952.2, ups=1.39, wpb=13655.4, bsz=466.9, num_updates=26500, lr=8.68744e-05, gnorm=0.382, clip=0, loss_scale=32, train_wall=72, gb_free=10, wall=24541
2023-08-27 07:45:35 | INFO | train_inner | epoch 023:    411 / 1191 loss=1.848, trans_loss=4.667, nll_loss=1.805, w2v_ctc_loss=0.552, task_loss=2.442, contrastive_loss=0.134, total=6708.92, n_correct=4765.2, ppl=3.49, accuracy=71.028, wps=18406.3, ups=1.37, wpb=13417.8, bsz=437.8, num_updates=26600, lr=8.6711e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=11.5, wall=24614
2023-08-27 07:46:47 | INFO | train_inner | epoch 023:    511 / 1191 loss=1.841, trans_loss=4.661, nll_loss=1.797, w2v_ctc_loss=0.541, task_loss=2.318, contrastive_loss=0.129, total=6708.89, n_correct=4777.23, ppl=3.48, accuracy=71.207, wps=18696.1, ups=1.39, wpb=13417.8, bsz=453.5, num_updates=26700, lr=8.65485e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=71, gb_free=11.9, wall=24685
2023-08-27 07:47:59 | INFO | train_inner | epoch 023:    611 / 1191 loss=1.848, trans_loss=4.669, nll_loss=1.809, w2v_ctc_loss=0.553, task_loss=2.302, contrastive_loss=0.122, total=6678.91, n_correct=4739.23, ppl=3.5, accuracy=70.958, wps=18591.3, ups=1.39, wpb=13357.8, bsz=454.7, num_updates=26800, lr=8.63868e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=13.7, wall=24757
2023-08-27 07:49:11 | INFO | train_inner | epoch 023:    711 / 1191 loss=1.848, trans_loss=4.668, nll_loss=1.806, w2v_ctc_loss=0.542, task_loss=2.445, contrastive_loss=0.172, total=6649.4, n_correct=4724.95, ppl=3.5, accuracy=71.058, wps=18436.6, ups=1.39, wpb=13298.8, bsz=440.6, num_updates=26900, lr=8.62261e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=24829
2023-08-27 07:50:23 | INFO | train_inner | epoch 023:    811 / 1191 loss=1.844, trans_loss=4.671, nll_loss=1.812, w2v_ctc_loss=0.551, task_loss=2.385, contrastive_loss=0.078, total=6727.03, n_correct=4779.66, ppl=3.51, accuracy=71.052, wps=18606.3, ups=1.38, wpb=13454.1, bsz=447.9, num_updates=27000, lr=8.60663e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=24902
2023-08-27 07:51:35 | INFO | train_inner | epoch 023:    911 / 1191 loss=1.837, trans_loss=4.659, nll_loss=1.797, w2v_ctc_loss=0.548, task_loss=2.259, contrastive_loss=0.072, total=6708.05, n_correct=4783.76, ppl=3.47, accuracy=71.314, wps=18690, ups=1.39, wpb=13416.1, bsz=464, num_updates=27100, lr=8.59074e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=24973
2023-08-27 07:52:47 | INFO | train_inner | epoch 023:   1011 / 1191 loss=1.843, trans_loss=4.666, nll_loss=1.806, w2v_ctc_loss=0.55, task_loss=2.246, contrastive_loss=0.118, total=6677.72, n_correct=4751.46, ppl=3.5, accuracy=71.154, wps=18655.7, ups=1.4, wpb=13355.4, bsz=465.6, num_updates=27200, lr=8.57493e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=71, gb_free=13.7, wall=25045
2023-08-27 07:53:59 | INFO | train_inner | epoch 023:   1111 / 1191 loss=1.849, trans_loss=4.677, nll_loss=1.819, w2v_ctc_loss=0.549, task_loss=2.435, contrastive_loss=0.114, total=6653.85, n_correct=4712.53, ppl=3.53, accuracy=70.824, wps=18457.2, ups=1.39, wpb=13307.7, bsz=443.4, num_updates=27300, lr=8.55921e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=25117
2023-08-27 07:54:57 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 07:55:30 | INFO | dev_st | epoch 023 | valid on 'dev_st' subset | loss 3.923 | trans_loss 5.184 | nll_loss 2.389 | w2v_ctc_loss 1.202 | task_loss 8.56 | contrastive_loss 0.249 | total 6138.43 | n_correct 4162.43 | ppl 5.24 | accuracy 67.809 | uer 16.401 | wer 18.062 | raw_wer 18.062 | bleu 27.07 | wps 1735.9 | wpb 6138.4 | bsz 201.1 | num_updates 27380 | best_bleu 27.47
2023-08-27 07:55:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 27380 updates
2023-08-27 07:55:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 07:55:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 07:55:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 23 @ 27380 updates, score 27.07) (writing took 5.843960660000448 seconds)
2023-08-27 07:55:36 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2023-08-27 07:55:36 | INFO | train | epoch 023 | loss 1.843 | trans_loss 4.665 | nll_loss 1.803 | w2v_ctc_loss 0.547 | task_loss 2.346 | contrastive_loss 0.114 | total 6703.69 | n_correct 4767.63 | ppl 3.49 | accuracy 71.119 | wps 17630.7 | ups 1.32 | wpb 13407.4 | bsz 452.1 | num_updates 27380 | lr 8.5467e-05 | gnorm 0.391 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 14.7 | wall 25214
2023-08-27 07:55:36 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 07:55:36 | INFO | fairseq.trainer | begin training epoch 24
2023-08-27 07:55:36 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 07:55:58 | INFO | train_inner | epoch 024:     20 / 1191 loss=1.853, trans_loss=4.672, nll_loss=1.814, w2v_ctc_loss=0.553, task_loss=2.453, contrastive_loss=0.155, total=6651.7, n_correct=4710.3, ppl=3.52, accuracy=70.813, wps=11191.4, ups=0.84, wpb=13303.4, bsz=438.9, num_updates=27400, lr=8.54358e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=25236
2023-08-27 07:57:09 | INFO | train_inner | epoch 024:    120 / 1191 loss=1.832, trans_loss=4.648, nll_loss=1.782, w2v_ctc_loss=0.539, task_loss=2.225, contrastive_loss=0.112, total=6758.03, n_correct=4827.66, ppl=3.44, accuracy=71.436, wps=18860.9, ups=1.4, wpb=13516.1, bsz=474.7, num_updates=27500, lr=8.52803e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=71, gb_free=12.6, wall=25308
2023-08-27 07:58:21 | INFO | train_inner | epoch 024:    220 / 1191 loss=1.833, trans_loss=4.647, nll_loss=1.781, w2v_ctc_loss=0.529, task_loss=2.13, contrastive_loss=0.18, total=6822.55, n_correct=4880.77, ppl=3.44, accuracy=71.539, wps=18965.8, ups=1.39, wpb=13645.1, bsz=482.1, num_updates=27600, lr=8.51257e-05, gnorm=0.382, clip=0, loss_scale=32, train_wall=71, gb_free=13.8, wall=25380
2023-08-27 07:59:33 | INFO | train_inner | epoch 024:    320 / 1191 loss=1.839, trans_loss=4.656, nll_loss=1.792, w2v_ctc_loss=0.543, task_loss=2.348, contrastive_loss=0.126, total=6734.94, n_correct=4805.6, ppl=3.46, accuracy=71.353, wps=18663.2, ups=1.39, wpb=13469.9, bsz=451.2, num_updates=27700, lr=8.49719e-05, gnorm=0.389, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=25452
2023-08-27 08:00:45 | INFO | train_inner | epoch 024:    420 / 1191 loss=1.834, trans_loss=4.654, nll_loss=1.789, w2v_ctc_loss=0.541, task_loss=2.482, contrastive_loss=0.085, total=6651.41, n_correct=4748.22, ppl=3.46, accuracy=71.387, wps=18489.4, ups=1.39, wpb=13302.8, bsz=434, num_updates=27800, lr=8.48189e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=71, gb_free=10, wall=25524
2023-08-27 08:01:58 | INFO | train_inner | epoch 024:    520 / 1191 loss=1.847, trans_loss=4.661, nll_loss=1.799, w2v_ctc_loss=0.548, task_loss=2.411, contrastive_loss=0.176, total=6662.72, n_correct=4740.41, ppl=3.48, accuracy=71.148, wps=18358.9, ups=1.38, wpb=13325.4, bsz=456, num_updates=27900, lr=8.46668e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=25596
2023-08-27 08:03:08 | INFO | train_inner | epoch 024:    620 / 1191 loss=1.84, trans_loss=4.661, nll_loss=1.798, w2v_ctc_loss=0.551, task_loss=2.547, contrastive_loss=0.055, total=6539.14, n_correct=4652.97, ppl=3.48, accuracy=71.156, wps=18613.9, ups=1.42, wpb=13078.3, bsz=417.5, num_updates=28000, lr=8.45154e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=70, gb_free=14.3, wall=25667
2023-08-27 08:03:08 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:03:41 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.948 | trans_loss 5.196 | nll_loss 2.404 | w2v_ctc_loss 1.248 | task_loss 8.539 | contrastive_loss 0.261 | total 6138.43 | n_correct 4156.43 | ppl 5.29 | accuracy 67.712 | uer 16.792 | wer 18.605 | raw_wer 18.605 | bleu 27.39 | wps 1740.8 | wpb 6138.4 | bsz 201.1 | num_updates 28000 | best_bleu 27.47
2023-08-27 08:03:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28000 updates
2023-08-27 08:03:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-27 08:03:43 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-27 08:03:47 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt (epoch 24 @ 28000 updates, score 27.39) (writing took 6.024631585998577 seconds)
2023-08-27 08:04:59 | INFO | train_inner | epoch 024:    720 / 1191 loss=1.839, trans_loss=4.658, nll_loss=1.796, w2v_ctc_loss=0.546, task_loss=2.223, contrastive_loss=0.11, total=6750.17, n_correct=4809.66, ppl=3.47, accuracy=71.252, wps=12213.6, ups=0.9, wpb=13500.3, bsz=470.4, num_updates=28100, lr=8.43649e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=14.3, wall=25777
2023-08-27 08:06:11 | INFO | train_inner | epoch 024:    820 / 1191 loss=1.835, trans_loss=4.654, nll_loss=1.79, w2v_ctc_loss=0.547, task_loss=2.334, contrastive_loss=0.072, total=6728.89, n_correct=4801.78, ppl=3.46, accuracy=71.361, wps=18704.8, ups=1.39, wpb=13457.8, bsz=448.8, num_updates=28200, lr=8.42152e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=71, gb_free=10.5, wall=25849
2023-08-27 08:07:23 | INFO | train_inner | epoch 024:    920 / 1191 loss=1.832, trans_loss=4.66, nll_loss=1.797, w2v_ctc_loss=0.539, task_loss=2.295, contrastive_loss=0.071, total=6726.66, n_correct=4795.06, ppl=3.48, accuracy=71.284, wps=18565.6, ups=1.38, wpb=13453.3, bsz=456.9, num_updates=28300, lr=8.40663e-05, gnorm=0.387, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=25922
2023-08-27 08:08:36 | INFO | train_inner | epoch 024:   1020 / 1191 loss=1.849, trans_loss=4.669, nll_loss=1.81, w2v_ctc_loss=0.544, task_loss=2.461, contrastive_loss=0.177, total=6595.75, n_correct=4685.35, ppl=3.51, accuracy=71.036, wps=18169.6, ups=1.38, wpb=13191.5, bsz=441.8, num_updates=28400, lr=8.39181e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=25994
2023-08-27 08:09:49 | INFO | train_inner | epoch 024:   1120 / 1191 loss=1.838, trans_loss=4.664, nll_loss=1.803, w2v_ctc_loss=0.545, task_loss=2.455, contrastive_loss=0.063, total=6708, n_correct=4771.2, ppl=3.49, accuracy=71.127, wps=18399.9, ups=1.37, wpb=13416, bsz=435, num_updates=28500, lr=8.37708e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=8.6, wall=26067
2023-08-27 08:10:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:11:12 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.929 | trans_loss 5.188 | nll_loss 2.399 | w2v_ctc_loss 1.208 | task_loss 8.578 | contrastive_loss 0.258 | total 6138.43 | n_correct 4158 | ppl 5.27 | accuracy 67.737 | uer 16.554 | wer 18.271 | raw_wer 18.271 | bleu 27.5 | wps 1775.8 | wpb 6138.4 | bsz 201.1 | num_updates 28571 | best_bleu 27.5
2023-08-27 08:11:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28571 updates
2023-08-27 08:11:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 08:11:18 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 08:11:23 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 24 @ 28571 updates, score 27.5) (writing took 10.88602356899355 seconds)
2023-08-27 08:11:23 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2023-08-27 08:11:23 | INFO | train | epoch 024 | loss 1.838 | trans_loss 4.658 | nll_loss 1.795 | w2v_ctc_loss 0.543 | task_loss 2.348 | contrastive_loss 0.113 | total 6703.69 | n_correct 4777.98 | ppl 3.47 | accuracy 71.274 | wps 16851.9 | ups 1.26 | wpb 13407.4 | bsz 452.1 | num_updates 28571 | lr 8.36666e-05 | gnorm 0.391 | clip 0 | loss_scale 64 | train_wall 851 | gb_free 15.2 | wall 26162
2023-08-27 08:11:24 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 08:11:24 | INFO | fairseq.trainer | begin training epoch 25
2023-08-27 08:11:24 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 08:11:52 | INFO | train_inner | epoch 025:     29 / 1191 loss=1.841, trans_loss=4.66, nll_loss=1.797, w2v_ctc_loss=0.547, task_loss=2.366, contrastive_loss=0.11, total=6706.04, n_correct=4778.68, ppl=3.48, accuracy=71.259, wps=10916.7, ups=0.81, wpb=13412.1, bsz=449, num_updates=28600, lr=8.36242e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=71, gb_free=14, wall=26190
2023-08-27 08:13:04 | INFO | train_inner | epoch 025:    129 / 1191 loss=1.83, trans_loss=4.636, nll_loss=1.765, w2v_ctc_loss=0.532, task_loss=2.493, contrastive_loss=0.161, total=6583.6, n_correct=4728.18, ppl=3.4, accuracy=71.818, wps=18201.9, ups=1.38, wpb=13167.2, bsz=436.5, num_updates=28700, lr=8.34784e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=13.4, wall=26262
2023-08-27 08:14:17 | INFO | train_inner | epoch 025:    229 / 1191 loss=1.821, trans_loss=4.642, nll_loss=1.775, w2v_ctc_loss=0.53, task_loss=2.241, contrastive_loss=0.071, total=6780.64, n_correct=4861.52, ppl=3.42, accuracy=71.697, wps=18655.9, ups=1.38, wpb=13561.3, bsz=471, num_updates=28800, lr=8.33333e-05, gnorm=0.383, clip=0, loss_scale=64, train_wall=72, gb_free=14.3, wall=26335
2023-08-27 08:15:29 | INFO | train_inner | epoch 025:    329 / 1191 loss=1.833, trans_loss=4.648, nll_loss=1.781, w2v_ctc_loss=0.544, task_loss=2.474, contrastive_loss=0.087, total=6618.73, n_correct=4732.7, ppl=3.44, accuracy=71.505, wps=18290.8, ups=1.38, wpb=13237.5, bsz=431.7, num_updates=28900, lr=8.3189e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=26407
2023-08-27 08:16:41 | INFO | train_inner | epoch 025:    429 / 1191 loss=1.834, trans_loss=4.654, nll_loss=1.788, w2v_ctc_loss=0.541, task_loss=2.627, contrastive_loss=0.076, total=6559, n_correct=4678.43, ppl=3.45, accuracy=71.328, wps=18266.5, ups=1.39, wpb=13118, bsz=418.7, num_updates=29000, lr=8.30455e-05, gnorm=0.399, clip=0, loss_scale=64, train_wall=71, gb_free=13.6, wall=26479
2023-08-27 08:17:53 | INFO | train_inner | epoch 025:    529 / 1191 loss=1.825, trans_loss=4.645, nll_loss=1.779, w2v_ctc_loss=0.533, task_loss=2.125, contrastive_loss=0.091, total=6859.95, n_correct=4912.85, ppl=3.43, accuracy=71.616, wps=19019.7, ups=1.39, wpb=13719.9, bsz=486.8, num_updates=29100, lr=8.29027e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=26551
2023-08-27 08:19:05 | INFO | train_inner | epoch 025:    629 / 1191 loss=1.826, trans_loss=4.646, nll_loss=1.78, w2v_ctc_loss=0.531, task_loss=2.316, contrastive_loss=0.094, total=6758.81, n_correct=4841.28, ppl=3.43, accuracy=71.629, wps=18824.2, ups=1.39, wpb=13517.6, bsz=450.4, num_updates=29200, lr=8.27606e-05, gnorm=0.385, clip=0, loss_scale=64, train_wall=71, gb_free=14.6, wall=26623
2023-08-27 08:20:17 | INFO | train_inner | epoch 025:    729 / 1191 loss=1.844, trans_loss=4.657, nll_loss=1.794, w2v_ctc_loss=0.542, task_loss=2.382, contrastive_loss=0.186, total=6686.07, n_correct=4768.56, ppl=3.47, accuracy=71.321, wps=18475.1, ups=1.38, wpb=13372.1, bsz=450.8, num_updates=29300, lr=8.26192e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=26696
2023-08-27 08:21:29 | INFO | train_inner | epoch 025:    829 / 1191 loss=1.834, trans_loss=4.655, nll_loss=1.791, w2v_ctc_loss=0.539, task_loss=2.308, contrastive_loss=0.107, total=6724.86, n_correct=4800.27, ppl=3.46, accuracy=71.381, wps=18618.3, ups=1.38, wpb=13449.7, bsz=454.4, num_updates=29400, lr=8.24786e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=12.5, wall=26768
2023-08-27 08:22:41 | INFO | train_inner | epoch 025:    929 / 1191 loss=1.83, trans_loss=4.651, nll_loss=1.787, w2v_ctc_loss=0.536, task_loss=2.203, contrastive_loss=0.097, total=6787.73, n_correct=4850.9, ppl=3.45, accuracy=71.466, wps=18863.7, ups=1.39, wpb=13575.5, bsz=474.6, num_updates=29500, lr=8.23387e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=71, gb_free=12.6, wall=26840
2023-08-27 08:23:52 | INFO | train_inner | epoch 025:   1029 / 1191 loss=1.837, trans_loss=4.663, nll_loss=1.803, w2v_ctc_loss=0.538, task_loss=2.328, contrastive_loss=0.114, total=6654.71, n_correct=4737.72, ppl=3.49, accuracy=71.193, wps=18708.2, ups=1.41, wpb=13309.4, bsz=451.1, num_updates=29600, lr=8.21995e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=70, gb_free=12.7, wall=26911
2023-08-27 08:25:05 | INFO | train_inner | epoch 025:   1129 / 1191 loss=1.836, trans_loss=4.656, nll_loss=1.793, w2v_ctc_loss=0.545, task_loss=2.434, contrastive_loss=0.103, total=6685.06, n_correct=4773.04, ppl=3.46, accuracy=71.399, wps=18510.3, ups=1.38, wpb=13370.1, bsz=444.3, num_updates=29700, lr=8.2061e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=12.1, wall=26983
2023-08-27 08:25:50 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:26:22 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 3.915 | trans_loss 5.184 | nll_loss 2.392 | w2v_ctc_loss 1.172 | task_loss 8.532 | contrastive_loss 0.25 | total 6138.43 | n_correct 4168 | ppl 5.25 | accuracy 67.9 | uer 16.396 | wer 18.181 | raw_wer 18.181 | bleu 27.08 | wps 1757.6 | wpb 6138.4 | bsz 201.1 | num_updates 29762 | best_bleu 27.5
2023-08-27 08:26:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 29762 updates
2023-08-27 08:26:22 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 08:26:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 08:26:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 25 @ 29762 updates, score 27.08) (writing took 6.4884956129972124 seconds)
2023-08-27 08:26:29 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2023-08-27 08:26:29 | INFO | train | epoch 025 | loss 1.833 | trans_loss 4.651 | nll_loss 1.786 | w2v_ctc_loss 0.538 | task_loss 2.348 | contrastive_loss 0.111 | total 6703.69 | n_correct 4791.38 | ppl 3.45 | accuracy 71.474 | wps 17634.6 | ups 1.32 | wpb 13407.4 | bsz 452.1 | num_updates 29762 | lr 8.19755e-05 | gnorm 0.39 | clip 0 | loss_scale 64 | train_wall 852 | gb_free 11.6 | wall 27067
2023-08-27 08:26:29 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 08:26:29 | INFO | fairseq.trainer | begin training epoch 26
2023-08-27 08:26:29 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 08:27:03 | INFO | train_inner | epoch 026:     38 / 1191 loss=1.837, trans_loss=4.655, nll_loss=1.792, w2v_ctc_loss=0.536, task_loss=2.232, contrastive_loss=0.142, total=6821.45, n_correct=4874.6, ppl=3.46, accuracy=71.46, wps=11510.9, ups=0.84, wpb=13642.9, bsz=465.1, num_updates=29800, lr=8.19232e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=71, gb_free=10.3, wall=27102
2023-08-27 08:28:16 | INFO | train_inner | epoch 026:    138 / 1191 loss=1.817, trans_loss=4.631, nll_loss=1.76, w2v_ctc_loss=0.525, task_loss=2.362, contrastive_loss=0.09, total=6715.27, n_correct=4832.38, ppl=3.39, accuracy=71.961, wps=18334.1, ups=1.37, wpb=13430.5, bsz=454.7, num_updates=29900, lr=8.17861e-05, gnorm=0.387, clip=0, loss_scale=64, train_wall=73, gb_free=13.2, wall=27175
2023-08-27 08:29:28 | INFO | train_inner | epoch 026:    238 / 1191 loss=1.822, trans_loss=4.63, nll_loss=1.759, w2v_ctc_loss=0.532, task_loss=2.341, contrastive_loss=0.118, total=6666.23, n_correct=4797.5, ppl=3.38, accuracy=71.967, wps=18758.7, ups=1.41, wpb=13332.5, bsz=450.1, num_updates=30000, lr=8.16497e-05, gnorm=0.389, clip=0, loss_scale=128, train_wall=71, gb_free=14.1, wall=27246
2023-08-27 08:29:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:30:01 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.93 | trans_loss 5.187 | nll_loss 2.393 | w2v_ctc_loss 1.214 | task_loss 8.528 | contrastive_loss 0.254 | total 6138.43 | n_correct 4164.71 | ppl 5.25 | accuracy 67.847 | uer 16.409 | wer 18.193 | raw_wer 18.193 | bleu 27.17 | wps 1698.5 | wpb 6138.4 | bsz 201.1 | num_updates 30000 | best_bleu 27.5
2023-08-27 08:30:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30000 updates
2023-08-27 08:30:01 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-27 08:30:03 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-27 08:30:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt (epoch 26 @ 30000 updates, score 27.17) (writing took 6.800820454998757 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 08:30:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-27 08:31:21 | INFO | train_inner | epoch 026:    339 / 1191 loss=1.822, trans_loss=4.635, nll_loss=1.766, w2v_ctc_loss=0.526, task_loss=2.049, contrastive_loss=0.154, total=6886.57, n_correct=4953.12, ppl=3.4, accuracy=71.924, wps=12180, ups=0.88, wpb=13773.1, bsz=496.6, num_updates=30100, lr=8.15139e-05, gnorm=0.382, clip=0, loss_scale=64, train_wall=72, gb_free=12.9, wall=27359
2023-08-27 08:32:33 | INFO | train_inner | epoch 026:    439 / 1191 loss=1.831, trans_loss=4.643, nll_loss=1.774, w2v_ctc_loss=0.537, task_loss=2.527, contrastive_loss=0.115, total=6569.92, n_correct=4704.78, ppl=3.42, accuracy=71.611, wps=18209.6, ups=1.39, wpb=13139.8, bsz=423, num_updates=30200, lr=8.13788e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=10.9, wall=27431
2023-08-27 08:33:46 | INFO | train_inner | epoch 026:    539 / 1191 loss=1.829, trans_loss=4.642, nll_loss=1.775, w2v_ctc_loss=0.532, task_loss=2.368, contrastive_loss=0.128, total=6684.51, n_correct=4788.48, ppl=3.42, accuracy=71.635, wps=18272.5, ups=1.37, wpb=13369, bsz=453.1, num_updates=30300, lr=8.12444e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=73, gb_free=14.8, wall=27504
2023-08-27 08:34:58 | INFO | train_inner | epoch 026:    639 / 1191 loss=1.831, trans_loss=4.646, nll_loss=1.779, w2v_ctc_loss=0.533, task_loss=2.53, contrastive_loss=0.12, total=6606.67, n_correct=4730.59, ppl=3.43, accuracy=71.603, wps=18272.4, ups=1.38, wpb=13213.3, bsz=426.7, num_updates=30400, lr=8.11107e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=72, gb_free=12.3, wall=27577
2023-08-27 08:36:10 | INFO | train_inner | epoch 026:    739 / 1191 loss=1.827, trans_loss=4.646, nll_loss=1.779, w2v_ctc_loss=0.535, task_loss=2.37, contrastive_loss=0.073, total=6778.79, n_correct=4852.22, ppl=3.43, accuracy=71.579, wps=18782.3, ups=1.39, wpb=13557.6, bsz=446.5, num_updates=30500, lr=8.09776e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=14.2, wall=27649
2023-08-27 08:37:22 | INFO | train_inner | epoch 026:    839 / 1191 loss=1.827, trans_loss=4.643, nll_loss=1.776, w2v_ctc_loss=0.528, task_loss=2.311, contrastive_loss=0.126, total=6679.03, n_correct=4788.02, ppl=3.43, accuracy=71.687, wps=18599.8, ups=1.39, wpb=13358.1, bsz=455.9, num_updates=30600, lr=8.08452e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=71, gb_free=13.3, wall=27721
2023-08-27 08:38:34 | INFO | train_inner | epoch 026:    939 / 1191 loss=1.839, trans_loss=4.654, nll_loss=1.791, w2v_ctc_loss=0.541, task_loss=2.391, contrastive_loss=0.14, total=6677.41, n_correct=4763.26, ppl=3.46, accuracy=71.334, wps=18580.3, ups=1.39, wpb=13354.8, bsz=447.2, num_updates=30700, lr=8.07134e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=71, gb_free=14, wall=27793
2023-08-27 08:39:47 | INFO | train_inner | epoch 026:   1039 / 1191 loss=1.834, trans_loss=4.655, nll_loss=1.792, w2v_ctc_loss=0.545, task_loss=2.372, contrastive_loss=0.073, total=6701.65, n_correct=4779.33, ppl=3.46, accuracy=71.316, wps=18495.2, ups=1.38, wpb=13403.3, bsz=447.7, num_updates=30800, lr=8.05823e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=13.5, wall=27865
2023-08-27 08:40:59 | INFO | train_inner | epoch 026:   1139 / 1191 loss=1.831, trans_loss=4.657, nll_loss=1.795, w2v_ctc_loss=0.536, task_loss=2.251, contrastive_loss=0.102, total=6787.9, n_correct=4845.49, ppl=3.47, accuracy=71.384, wps=18650.7, ups=1.37, wpb=13575.8, bsz=474.7, num_updates=30900, lr=8.04518e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=27938
2023-08-27 08:41:37 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
2023-08-27 08:42:09 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.938 | trans_loss 5.183 | nll_loss 2.388 | w2v_ctc_loss 1.253 | task_loss 8.567 | contrastive_loss 0.251 | total 6138.43 | n_correct 4168.57 | ppl 5.24 | accuracy 67.909 | uer 16.559 | wer 18.304 | raw_wer 18.304 | bleu 27.18 | wps 1764.1 | wpb 6138.4 | bsz 201.1 | num_updates 30952 | best_bleu 27.5
2023-08-27 08:42:09 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30952 updates
2023-08-27 08:42:09 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1809.pt
2023-08-27 08:42:15 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1809.pt
2023-08-27 08:42:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.1809.pt (epoch 26 @ 30952 updates, score 27.18) (writing took 10.230201654005214 seconds)
2023-08-27 08:42:19 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2023-08-27 08:42:19 | INFO | train | epoch 026 | loss 1.828 | trans_loss 4.644 | nll_loss 1.778 | w2v_ctc_loss 0.534 | task_loss 2.349 | contrastive_loss 0.11 | total 6702.57 | n_correct 4800.77 | ppl 3.43 | accuracy 71.626 | wps 16786.6 | ups 1.25 | wpb 13405.1 | bsz 451.9 | num_updates 30952 | lr 8.03842e-05 | gnorm 0.393 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 12.7 | wall 28018
2023-08-27 08:42:19 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 08:42:19 | INFO | fairseq.trainer | begin training epoch 27
2023-08-27 08:42:19 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 08:43:01 | INFO | train_inner | epoch 027:     48 / 1191 loss=1.825, trans_loss=4.641, nll_loss=1.774, w2v_ctc_loss=0.535, task_loss=2.408, contrastive_loss=0.067, total=6621.11, n_correct=4744.54, ppl=3.42, accuracy=71.658, wps=10855.5, ups=0.82, wpb=13242.2, bsz=439, num_updates=31000, lr=8.03219e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=71, gb_free=15.5, wall=28060
2023-08-27 08:44:14 | INFO | train_inner | epoch 027:    148 / 1191 loss=1.826, trans_loss=4.63, nll_loss=1.759, w2v_ctc_loss=0.53, task_loss=2.303, contrastive_loss=0.157, total=6726.66, n_correct=4836.23, ppl=3.38, accuracy=71.896, wps=18581, ups=1.38, wpb=13453.3, bsz=464.7, num_updates=31100, lr=8.01927e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=14.1, wall=28132
2023-08-27 08:45:26 | INFO | train_inner | epoch 027:    248 / 1191 loss=1.813, trans_loss=4.625, nll_loss=1.754, w2v_ctc_loss=0.518, task_loss=2.144, contrastive_loss=0.126, total=6820.93, n_correct=4914.91, ppl=3.37, accuracy=72.056, wps=18907, ups=1.39, wpb=13641.9, bsz=482.9, num_updates=31200, lr=8.00641e-05, gnorm=0.385, clip=0, loss_scale=64, train_wall=72, gb_free=14.6, wall=28204
2023-08-27 08:46:38 | INFO | train_inner | epoch 027:    348 / 1191 loss=1.812, trans_loss=4.623, nll_loss=1.751, w2v_ctc_loss=0.52, task_loss=2.238, contrastive_loss=0.096, total=6731.11, n_correct=4853.16, ppl=3.37, accuracy=72.1, wps=18607.5, ups=1.38, wpb=13462.2, bsz=466.9, num_updates=31300, lr=7.99361e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=12.8, wall=28277
2023-08-27 08:46:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 08:47:51 | INFO | train_inner | epoch 027:    449 / 1191 loss=1.827, trans_loss=4.647, nll_loss=1.781, w2v_ctc_loss=0.537, task_loss=2.498, contrastive_loss=0.069, total=6614.94, n_correct=4737.4, ppl=3.44, accuracy=71.617, wps=18090, ups=1.37, wpb=13229.9, bsz=435.5, num_updates=31400, lr=7.98087e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=73, gb_free=14.5, wall=28350
2023-08-27 08:49:04 | INFO | train_inner | epoch 027:    549 / 1191 loss=1.819, trans_loss=4.634, nll_loss=1.765, w2v_ctc_loss=0.53, task_loss=2.246, contrastive_loss=0.084, total=6772.35, n_correct=4866.73, ppl=3.4, accuracy=71.862, wps=18799.8, ups=1.39, wpb=13544.7, bsz=464.2, num_updates=31500, lr=7.96819e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=28422
2023-08-27 08:50:15 | INFO | train_inner | epoch 027:    649 / 1191 loss=1.83, trans_loss=4.64, nll_loss=1.772, w2v_ctc_loss=0.528, task_loss=2.392, contrastive_loss=0.159, total=6684.99, n_correct=4793.88, ppl=3.41, accuracy=71.711, wps=18686.2, ups=1.4, wpb=13370, bsz=444.5, num_updates=31600, lr=7.95557e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=71, gb_free=10.6, wall=28493
2023-08-27 08:51:27 | INFO | train_inner | epoch 027:    749 / 1191 loss=1.824, trans_loss=4.642, nll_loss=1.775, w2v_ctc_loss=0.531, task_loss=2.432, contrastive_loss=0.085, total=6680.05, n_correct=4789.46, ppl=3.42, accuracy=71.698, wps=18562.2, ups=1.39, wpb=13360.1, bsz=443.5, num_updates=31700, lr=7.94301e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=71, gb_free=13.7, wall=28565
2023-08-27 08:52:40 | INFO | train_inner | epoch 027:    849 / 1191 loss=1.826, trans_loss=4.642, nll_loss=1.776, w2v_ctc_loss=0.536, task_loss=2.454, contrastive_loss=0.078, total=6647.72, n_correct=4762.98, ppl=3.42, accuracy=71.648, wps=18321.5, ups=1.38, wpb=13295.4, bsz=440.9, num_updates=31800, lr=7.93052e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=28638
2023-08-27 08:53:52 | INFO | train_inner | epoch 027:    949 / 1191 loss=1.834, trans_loss=4.655, nll_loss=1.791, w2v_ctc_loss=0.538, task_loss=2.545, contrastive_loss=0.094, total=6634.42, n_correct=4734.18, ppl=3.46, accuracy=71.358, wps=18315.4, ups=1.38, wpb=13268.8, bsz=422.9, num_updates=31900, lr=7.91808e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=12.8, wall=28710
2023-08-27 08:55:04 | INFO | train_inner | epoch 027:   1049 / 1191 loss=1.83, trans_loss=4.647, nll_loss=1.782, w2v_ctc_loss=0.531, task_loss=2.352, contrastive_loss=0.148, total=6652.45, n_correct=4764.77, ppl=3.44, accuracy=71.624, wps=18457.3, ups=1.39, wpb=13304.9, bsz=450.6, num_updates=32000, lr=7.90569e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=28783
2023-08-27 08:55:04 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:55:37 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.907 | trans_loss 5.181 | nll_loss 2.387 | w2v_ctc_loss 1.155 | task_loss 8.526 | contrastive_loss 0.25 | total 6138.43 | n_correct 4170 | ppl 5.23 | accuracy 67.933 | uer 16.209 | wer 17.996 | raw_wer 17.996 | bleu 27.25 | wps 1668.7 | wpb 6138.4 | bsz 201.1 | num_updates 32000 | best_bleu 27.5
2023-08-27 08:55:37 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32000 updates
2023-08-27 08:55:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-27 08:55:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-27 08:55:44 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt (epoch 27 @ 32000 updates, score 27.25) (writing took 6.284275103986147 seconds)
2023-08-27 08:56:56 | INFO | train_inner | epoch 027:   1149 / 1191 loss=1.828, trans_loss=4.648, nll_loss=1.783, w2v_ctc_loss=0.53, task_loss=2.292, contrastive_loss=0.115, total=6753.53, n_correct=4833.54, ppl=3.44, accuracy=71.571, wps=12087.7, ups=0.89, wpb=13507.1, bsz=452.5, num_updates=32100, lr=7.89337e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=71, gb_free=10.8, wall=28894
2023-08-27 08:57:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 08:57:58 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.937 | trans_loss 5.182 | nll_loss 2.387 | w2v_ctc_loss 1.253 | task_loss 8.553 | contrastive_loss 0.248 | total 6138.43 | n_correct 4166.86 | ppl 5.23 | accuracy 67.881 | uer 16.217 | wer 17.947 | raw_wer 17.947 | bleu 27.22 | wps 1747.1 | wpb 6138.4 | bsz 201.1 | num_updates 32142 | best_bleu 27.5
2023-08-27 08:57:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32142 updates
2023-08-27 08:57:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.2202.pt
2023-08-27 08:58:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.2202.pt
2023-08-27 08:58:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.2202.pt (epoch 27 @ 32142 updates, score 27.22) (writing took 6.5440593649982475 seconds)
2023-08-27 08:58:05 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2023-08-27 08:58:05 | INFO | train | epoch 027 | loss 1.823 | trans_loss 4.638 | nll_loss 1.77 | w2v_ctc_loss 0.529 | task_loss 2.344 | contrastive_loss 0.106 | total 6702.86 | n_correct 4810.42 | ppl 3.41 | accuracy 71.767 | wps 16863.6 | ups 1.26 | wpb 13405.7 | bsz 451.8 | num_updates 32142 | lr 7.88821e-05 | gnorm 0.392 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 13.4 | wall 28964
2023-08-27 08:58:05 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 08:58:05 | INFO | fairseq.trainer | begin training epoch 28
2023-08-27 08:58:05 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 08:58:55 | INFO | train_inner | epoch 028:     58 / 1191 loss=1.811, trans_loss=4.621, nll_loss=1.749, w2v_ctc_loss=0.52, task_loss=2.289, contrastive_loss=0.102, total=6702.18, n_correct=4834.54, ppl=3.36, accuracy=72.134, wps=11276.4, ups=0.84, wpb=13404.4, bsz=456.4, num_updates=32200, lr=7.8811e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=71, gb_free=14.4, wall=29013
2023-08-27 09:00:07 | INFO | train_inner | epoch 028:    158 / 1191 loss=1.818, trans_loss=4.628, nll_loss=1.756, w2v_ctc_loss=0.536, task_loss=2.453, contrastive_loss=0.056, total=6676.02, n_correct=4806.7, ppl=3.38, accuracy=71.999, wps=18550.7, ups=1.39, wpb=13352, bsz=432.6, num_updates=32300, lr=7.86889e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=29085
2023-08-27 09:01:19 | INFO | train_inner | epoch 028:    258 / 1191 loss=1.816, trans_loss=4.629, nll_loss=1.758, w2v_ctc_loss=0.522, task_loss=2.371, contrastive_loss=0.1, total=6680.3, n_correct=4809.52, ppl=3.38, accuracy=71.996, wps=18535.7, ups=1.39, wpb=13360.6, bsz=450.4, num_updates=32400, lr=7.85674e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=10.4, wall=29157
2023-08-27 09:02:31 | INFO | train_inner | epoch 028:    358 / 1191 loss=1.813, trans_loss=4.628, nll_loss=1.757, w2v_ctc_loss=0.525, task_loss=2.307, contrastive_loss=0.07, total=6733.45, n_correct=4849.25, ppl=3.38, accuracy=72.017, wps=18637.1, ups=1.38, wpb=13466.9, bsz=460.2, num_updates=32500, lr=7.84465e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=29230
2023-08-27 09:03:44 | INFO | train_inner | epoch 028:    458 / 1191 loss=1.824, trans_loss=4.63, nll_loss=1.76, w2v_ctc_loss=0.523, task_loss=2.231, contrastive_loss=0.187, total=6786.13, n_correct=4888.02, ppl=3.39, accuracy=72.03, wps=18652.8, ups=1.37, wpb=13572.3, bsz=473.9, num_updates=32600, lr=7.8326e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=29302
2023-08-27 09:04:55 | INFO | train_inner | epoch 028:    558 / 1191 loss=1.809, trans_loss=4.628, nll_loss=1.757, w2v_ctc_loss=0.518, task_loss=2.309, contrastive_loss=0.058, total=6699.39, n_correct=4830.64, ppl=3.38, accuracy=72.106, wps=18747.3, ups=1.4, wpb=13398.8, bsz=453, num_updates=32700, lr=7.82062e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=71, gb_free=14, wall=29374
2023-08-27 09:06:07 | INFO | train_inner | epoch 028:    658 / 1191 loss=1.816, trans_loss=4.628, nll_loss=1.758, w2v_ctc_loss=0.521, task_loss=2.299, contrastive_loss=0.124, total=6757.2, n_correct=4870.16, ppl=3.38, accuracy=72.074, wps=18869.1, ups=1.4, wpb=13514.4, bsz=457.5, num_updates=32800, lr=7.80869e-05, gnorm=0.389, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=29445
2023-08-27 09:07:19 | INFO | train_inner | epoch 028:    758 / 1191 loss=1.817, trans_loss=4.633, nll_loss=1.764, w2v_ctc_loss=0.526, task_loss=2.351, contrastive_loss=0.085, total=6689.37, n_correct=4811.59, ppl=3.4, accuracy=71.929, wps=18519.2, ups=1.38, wpb=13378.7, bsz=453.8, num_updates=32900, lr=7.79681e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=29518
2023-08-27 09:08:31 | INFO | train_inner | epoch 028:    858 / 1191 loss=1.818, trans_loss=4.633, nll_loss=1.764, w2v_ctc_loss=0.527, task_loss=2.35, contrastive_loss=0.091, total=6644.99, n_correct=4781.07, ppl=3.4, accuracy=71.95, wps=18555.4, ups=1.4, wpb=13290, bsz=451.4, num_updates=33000, lr=7.78499e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=71, gb_free=12.6, wall=29589
2023-08-27 09:09:43 | INFO | train_inner | epoch 028:    958 / 1191 loss=1.828, trans_loss=4.642, nll_loss=1.775, w2v_ctc_loss=0.533, task_loss=2.459, contrastive_loss=0.122, total=6647.77, n_correct=4768.57, ppl=3.42, accuracy=71.732, wps=18506, ups=1.39, wpb=13295.5, bsz=438, num_updates=33100, lr=7.77322e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=14.7, wall=29661
2023-08-27 09:10:55 | INFO | train_inner | epoch 028:   1058 / 1191 loss=1.833, trans_loss=4.647, nll_loss=1.782, w2v_ctc_loss=0.524, task_loss=2.451, contrastive_loss=0.186, total=6683.12, n_correct=4783.69, ppl=3.44, accuracy=71.579, wps=18529.3, ups=1.39, wpb=13366.2, bsz=439.6, num_updates=33200, lr=7.76151e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=29733
2023-08-27 09:12:08 | INFO | train_inner | epoch 028:   1158 / 1191 loss=1.822, trans_loss=4.643, nll_loss=1.778, w2v_ctc_loss=0.525, task_loss=2.424, contrastive_loss=0.094, total=6679.78, n_correct=4792, ppl=3.43, accuracy=71.739, wps=18368.6, ups=1.37, wpb=13359.6, bsz=445.2, num_updates=33300, lr=7.74984e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=29806
2023-08-27 09:12:31 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 09:13:04 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 3.927 | trans_loss 5.186 | nll_loss 2.391 | w2v_ctc_loss 1.214 | task_loss 8.546 | contrastive_loss 0.244 | total 6138.43 | n_correct 4162.71 | ppl 5.25 | accuracy 67.814 | uer 16.356 | wer 18.051 | raw_wer 18.051 | bleu 27.33 | wps 1761.1 | wpb 6138.4 | bsz 201.1 | num_updates 33333 | best_bleu 27.5
2023-08-27 09:13:04 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 33333 updates
2023-08-27 09:13:04 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3301.pt
2023-08-27 09:13:07 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3301.pt
2023-08-27 09:13:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3301.pt (epoch 28 @ 33333 updates, score 27.33) (writing took 7.104997234011535 seconds)
2023-08-27 09:13:11 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2023-08-27 09:13:11 | INFO | train | epoch 028 | loss 1.819 | trans_loss 4.632 | nll_loss 1.763 | w2v_ctc_loss 0.525 | task_loss 2.347 | contrastive_loss 0.108 | total 6703.69 | n_correct 4823.24 | ppl 3.39 | accuracy 71.949 | wps 17622.1 | ups 1.31 | wpb 13407.4 | bsz 452.1 | num_updates 33333 | lr 7.74601e-05 | gnorm 0.394 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 13.4 | wall 29870
2023-08-27 09:13:12 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 09:13:12 | INFO | fairseq.trainer | begin training epoch 29
2023-08-27 09:13:12 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 09:14:08 | INFO | train_inner | epoch 029:     67 / 1191 loss=1.806, trans_loss=4.614, nll_loss=1.74, w2v_ctc_loss=0.514, task_loss=2.149, contrastive_loss=0.103, total=6806.79, n_correct=4929.86, ppl=3.34, accuracy=72.426, wps=11318.1, ups=0.83, wpb=13613.6, bsz=476.8, num_updates=33400, lr=7.73823e-05, gnorm=0.384, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=29926
2023-08-27 09:15:20 | INFO | train_inner | epoch 029:    167 / 1191 loss=1.803, trans_loss=4.613, nll_loss=1.737, w2v_ctc_loss=0.513, task_loss=2.395, contrastive_loss=0.059, total=6676.33, n_correct=4830.85, ppl=3.33, accuracy=72.358, wps=18575.7, ups=1.39, wpb=13352.7, bsz=438, num_updates=33500, lr=7.72667e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=12, wall=29998
2023-08-27 09:16:32 | INFO | train_inner | epoch 029:    267 / 1191 loss=1.82, trans_loss=4.624, nll_loss=1.751, w2v_ctc_loss=0.511, task_loss=2.349, contrastive_loss=0.195, total=6670.27, n_correct=4811.59, ppl=3.37, accuracy=72.135, wps=18440.2, ups=1.38, wpb=13340.5, bsz=453.4, num_updates=33600, lr=7.71517e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=14.2, wall=30071
2023-08-27 09:17:44 | INFO | train_inner | epoch 029:    367 / 1191 loss=1.808, trans_loss=4.623, nll_loss=1.75, w2v_ctc_loss=0.521, task_loss=2.357, contrastive_loss=0.061, total=6747.17, n_correct=4869.57, ppl=3.36, accuracy=72.172, wps=18664.7, ups=1.38, wpb=13494.3, bsz=452, num_updates=33700, lr=7.70371e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=72, gb_free=14.5, wall=30143
2023-08-27 09:18:57 | INFO | train_inner | epoch 029:    467 / 1191 loss=1.809, trans_loss=4.622, nll_loss=1.75, w2v_ctc_loss=0.513, task_loss=2.26, contrastive_loss=0.112, total=6772.8, n_correct=4891.7, ppl=3.36, accuracy=72.226, wps=18711.9, ups=1.38, wpb=13545.6, bsz=464.8, num_updates=33800, lr=7.69231e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=30215
2023-08-27 09:20:09 | INFO | train_inner | epoch 029:    567 / 1191 loss=1.821, trans_loss=4.632, nll_loss=1.762, w2v_ctc_loss=0.532, task_loss=2.59, contrastive_loss=0.097, total=6577.57, n_correct=4729.24, ppl=3.39, accuracy=71.9, wps=18193.5, ups=1.38, wpb=13155.1, bsz=421.4, num_updates=33900, lr=7.68095e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=14.5, wall=30288
2023-08-27 09:21:21 | INFO | train_inner | epoch 029:    667 / 1191 loss=1.809, trans_loss=4.619, nll_loss=1.746, w2v_ctc_loss=0.519, task_loss=2.209, contrastive_loss=0.09, total=6760.39, n_correct=4884.37, ppl=3.35, accuracy=72.25, wps=18854.2, ups=1.39, wpb=13520.8, bsz=469.3, num_updates=34000, lr=7.66965e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=12.1, wall=30359
2023-08-27 09:21:21 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 09:21:54 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.93 | trans_loss 5.191 | nll_loss 2.398 | w2v_ctc_loss 1.205 | task_loss 8.507 | contrastive_loss 0.253 | total 6138.43 | n_correct 4166.71 | ppl 5.27 | accuracy 67.879 | uer 16.511 | wer 18.286 | raw_wer 18.286 | bleu 27.32 | wps 1707.6 | wpb 6138.4 | bsz 201.1 | num_updates 34000 | best_bleu 27.5
2023-08-27 09:21:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34000 updates
2023-08-27 09:21:54 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-27 09:21:56 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-27 09:22:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt (epoch 29 @ 34000 updates, score 27.32) (writing took 7.042596237006364 seconds)
2023-08-27 09:23:13 | INFO | train_inner | epoch 029:    767 / 1191 loss=1.81, trans_loss=4.626, nll_loss=1.755, w2v_ctc_loss=0.519, task_loss=2.362, contrastive_loss=0.089, total=6664.13, n_correct=4808, ppl=3.38, accuracy=72.147, wps=11903.4, ups=0.89, wpb=13328.3, bsz=450.3, num_updates=34100, lr=7.6584e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=7.7, wall=30471
2023-08-27 09:24:25 | INFO | train_inner | epoch 029:    867 / 1191 loss=1.819, trans_loss=4.637, nll_loss=1.769, w2v_ctc_loss=0.529, task_loss=2.452, contrastive_loss=0.064, total=6659.43, n_correct=4782.35, ppl=3.41, accuracy=71.813, wps=18540.2, ups=1.39, wpb=13318.9, bsz=435.3, num_updates=34200, lr=7.64719e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=71, gb_free=11, wall=30543
2023-08-27 09:25:37 | INFO | train_inner | epoch 029:    967 / 1191 loss=1.827, trans_loss=4.635, nll_loss=1.767, w2v_ctc_loss=0.525, task_loss=2.325, contrastive_loss=0.182, total=6728.65, n_correct=4835.77, ppl=3.4, accuracy=71.868, wps=18554.5, ups=1.38, wpb=13457.3, bsz=461.6, num_updates=34300, lr=7.63604e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=12.3, wall=30616
2023-08-27 09:26:49 | INFO | train_inner | epoch 029:   1067 / 1191 loss=1.819, trans_loss=4.633, nll_loss=1.764, w2v_ctc_loss=0.52, task_loss=2.339, contrastive_loss=0.135, total=6711.89, n_correct=4831.31, ppl=3.4, accuracy=71.981, wps=18638.5, ups=1.39, wpb=13423.8, bsz=456.2, num_updates=34400, lr=7.62493e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=71, gb_free=14.5, wall=30688
2023-08-27 09:28:02 | INFO | train_inner | epoch 029:   1167 / 1191 loss=1.812, trans_loss=4.632, nll_loss=1.763, w2v_ctc_loss=0.514, task_loss=2.274, contrastive_loss=0.102, total=6748.65, n_correct=4864.55, ppl=3.4, accuracy=72.082, wps=18583.2, ups=1.38, wpb=13497.3, bsz=461.5, num_updates=34500, lr=7.61387e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=72, gb_free=15.5, wall=30760
2023-08-27 09:28:19 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 09:28:52 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.913 | trans_loss 5.178 | nll_loss 2.382 | w2v_ctc_loss 1.186 | task_loss 8.526 | contrastive_loss 0.243 | total 6138.43 | n_correct 4180.43 | ppl 5.21 | accuracy 68.103 | uer 16.193 | wer 17.906 | raw_wer 17.906 | bleu 27.14 | wps 1751 | wpb 6138.4 | bsz 201.1 | num_updates 34524 | best_bleu 27.5
2023-08-27 09:28:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34524 updates
2023-08-27 09:28:52 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 09:28:58 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 09:28:58 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 29 @ 34524 updates, score 27.14) (writing took 5.897806629989645 seconds)
2023-08-27 09:28:58 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2023-08-27 09:28:58 | INFO | train | epoch 029 | loss 1.813 | trans_loss 4.626 | nll_loss 1.755 | w2v_ctc_loss 0.519 | task_loss 2.347 | contrastive_loss 0.107 | total 6703.69 | n_correct 4834.09 | ppl 3.37 | accuracy 72.111 | wps 16870.8 | ups 1.26 | wpb 13407.4 | bsz 452.1 | num_updates 34524 | lr 7.61122e-05 | gnorm 0.391 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 13.7 | wall 30816
2023-08-27 09:28:58 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 09:28:58 | INFO | fairseq.trainer | begin training epoch 30
2023-08-27 09:28:58 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 09:30:00 | INFO | train_inner | epoch 030:     76 / 1191 loss=1.798, trans_loss=4.609, nll_loss=1.733, w2v_ctc_loss=0.505, task_loss=2.093, contrastive_loss=0.098, total=6849.81, n_correct=4970.58, ppl=3.32, accuracy=72.565, wps=11641.1, ups=0.85, wpb=13699.6, bsz=486.1, num_updates=34600, lr=7.60286e-05, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=14, wall=30878
2023-08-27 09:31:11 | INFO | train_inner | epoch 030:    176 / 1191 loss=1.804, trans_loss=4.611, nll_loss=1.734, w2v_ctc_loss=0.51, task_loss=2.373, contrastive_loss=0.098, total=6657.78, n_correct=4820.09, ppl=3.33, accuracy=72.398, wps=18659.6, ups=1.4, wpb=13315.6, bsz=441, num_updates=34700, lr=7.5919e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=71, gb_free=14.7, wall=30949
2023-08-27 09:32:23 | INFO | train_inner | epoch 030:    276 / 1191 loss=1.804, trans_loss=4.609, nll_loss=1.733, w2v_ctc_loss=0.512, task_loss=2.244, contrastive_loss=0.106, total=6769.26, n_correct=4908.5, ppl=3.32, accuracy=72.512, wps=18772.3, ups=1.39, wpb=13538.5, bsz=465.3, num_updates=34800, lr=7.58098e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=14.6, wall=31021
2023-08-27 09:33:36 | INFO | train_inner | epoch 030:    376 / 1191 loss=1.801, trans_loss=4.611, nll_loss=1.737, w2v_ctc_loss=0.507, task_loss=2.134, contrastive_loss=0.102, total=6850.27, n_correct=4962.17, ppl=3.33, accuracy=72.438, wps=18762.8, ups=1.37, wpb=13700.5, bsz=485.4, num_updates=34900, lr=7.57011e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=73, gb_free=13.9, wall=31094
2023-08-27 09:34:48 | INFO | train_inner | epoch 030:    476 / 1191 loss=1.808, trans_loss=4.618, nll_loss=1.744, w2v_ctc_loss=0.515, task_loss=2.449, contrastive_loss=0.095, total=6641.83, n_correct=4803.88, ppl=3.35, accuracy=72.328, wps=18445.5, ups=1.39, wpb=13283.7, bsz=444.7, num_updates=35000, lr=7.55929e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=71, gb_free=13.1, wall=31166
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 09:36:00 | INFO | train_inner | epoch 030:    576 / 1191 loss=1.812, trans_loss=4.622, nll_loss=1.75, w2v_ctc_loss=0.516, task_loss=2.388, contrastive_loss=0.113, total=6679.82, n_correct=4818.09, ppl=3.36, accuracy=72.129, wps=18506.5, ups=1.39, wpb=13359.6, bsz=445.4, num_updates=35100, lr=7.54851e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=72, gb_free=11.6, wall=31239
2023-08-27 09:37:12 | INFO | train_inner | epoch 030:    676 / 1191 loss=1.813, trans_loss=4.623, nll_loss=1.75, w2v_ctc_loss=0.524, task_loss=2.557, contrastive_loss=0.08, total=6572.86, n_correct=4739.48, ppl=3.36, accuracy=72.107, wps=18284.1, ups=1.39, wpb=13145.7, bsz=422.5, num_updates=35200, lr=7.53778e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=71, gb_free=14, wall=31311
2023-08-27 09:38:25 | INFO | train_inner | epoch 030:    776 / 1191 loss=1.824, trans_loss=4.627, nll_loss=1.756, w2v_ctc_loss=0.521, task_loss=2.461, contrastive_loss=0.175, total=6650.65, n_correct=4787.5, ppl=3.38, accuracy=71.985, wps=18259.6, ups=1.37, wpb=13301.3, bsz=438.1, num_updates=35300, lr=7.5271e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=72, gb_free=13.1, wall=31383
2023-08-27 09:39:37 | INFO | train_inner | epoch 030:    876 / 1191 loss=1.811, trans_loss=4.623, nll_loss=1.752, w2v_ctc_loss=0.516, task_loss=2.402, contrastive_loss=0.108, total=6686.47, n_correct=4826.42, ppl=3.37, accuracy=72.182, wps=18604.2, ups=1.39, wpb=13372.9, bsz=447.2, num_updates=35400, lr=7.51646e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=71, gb_free=15.7, wall=31455
2023-08-27 09:40:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-27 09:40:51 | INFO | train_inner | epoch 030:    977 / 1191 loss=1.817, trans_loss=4.63, nll_loss=1.761, w2v_ctc_loss=0.523, task_loss=2.463, contrastive_loss=0.111, total=6639.47, n_correct=4781.09, ppl=3.39, accuracy=72.01, wps=18005.8, ups=1.36, wpb=13278.9, bsz=444.3, num_updates=35500, lr=7.50587e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=73, gb_free=13.4, wall=31529
2023-08-27 09:42:03 | INFO | train_inner | epoch 030:   1077 / 1191 loss=1.81, trans_loss=4.627, nll_loss=1.757, w2v_ctc_loss=0.521, task_loss=2.304, contrastive_loss=0.064, total=6764.46, n_correct=4881.94, ppl=3.38, accuracy=72.17, wps=18677.8, ups=1.38, wpb=13528.9, bsz=456.1, num_updates=35600, lr=7.49532e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=14.7, wall=31601
2023-08-27 09:43:15 | INFO | train_inner | epoch 030:   1177 / 1191 loss=1.817, trans_loss=4.639, nll_loss=1.772, w2v_ctc_loss=0.518, task_loss=2.323, contrastive_loss=0.12, total=6687.11, n_correct=4804.79, ppl=3.42, accuracy=71.852, wps=18489.7, ups=1.38, wpb=13374.2, bsz=453.8, num_updates=35700, lr=7.48481e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=10.5, wall=31674
2023-08-27 09:43:25 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
2023-08-27 09:43:58 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 3.926 | trans_loss 5.182 | nll_loss 2.388 | w2v_ctc_loss 1.217 | task_loss 8.555 | contrastive_loss 0.25 | total 6138.43 | n_correct 4171.57 | ppl 5.23 | accuracy 67.958 | uer 16.503 | wer 18.341 | raw_wer 18.341 | bleu 27.32 | wps 1680.5 | wpb 6138.4 | bsz 201.1 | num_updates 35714 | best_bleu 27.5
2023-08-27 09:43:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 35714 updates
2023-08-27 09:43:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3203.pt
2023-08-27 09:44:01 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3203.pt
2023-08-27 09:44:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3203.pt (epoch 30 @ 35714 updates, score 27.32) (writing took 7.559053163000499 seconds)
2023-08-27 09:44:06 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2023-08-27 09:44:06 | INFO | train | epoch 030 | loss 1.81 | trans_loss 4.621 | nll_loss 1.748 | w2v_ctc_loss 0.516 | task_loss 2.345 | contrastive_loss 0.106 | total 6703.36 | n_correct 4841.23 | ppl 3.36 | accuracy 72.221 | wps 17561.8 | ups 1.31 | wpb 13406.7 | bsz 452.2 | num_updates 35714 | lr 7.48334e-05 | gnorm 0.394 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 14.5 | wall 31725
2023-08-27 09:44:06 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 09:44:06 | INFO | fairseq.trainer | begin training epoch 31
2023-08-27 09:44:06 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 09:45:16 | INFO | train_inner | epoch 031:     86 / 1191 loss=1.807, trans_loss=4.611, nll_loss=1.735, w2v_ctc_loss=0.518, task_loss=2.574, contrastive_loss=0.079, total=6599.42, n_correct=4781.24, ppl=3.33, accuracy=72.449, wps=10938.5, ups=0.83, wpb=13198.8, bsz=419.2, num_updates=35800, lr=7.47435e-05, gnorm=0.399, clip=0, loss_scale=64, train_wall=71, gb_free=11.4, wall=31794
2023-08-27 09:46:29 | INFO | train_inner | epoch 031:    186 / 1191 loss=1.796, trans_loss=4.605, nll_loss=1.727, w2v_ctc_loss=0.504, task_loss=2.303, contrastive_loss=0.078, total=6732.09, n_correct=4889.8, ppl=3.31, accuracy=72.634, wps=18539.9, ups=1.38, wpb=13464.2, bsz=458.4, num_updates=35900, lr=7.46393e-05, gnorm=0.393, clip=0, loss_scale=64, train_wall=72, gb_free=12.3, wall=31867
2023-08-27 09:47:41 | INFO | train_inner | epoch 031:    286 / 1191 loss=1.81, trans_loss=4.614, nll_loss=1.738, w2v_ctc_loss=0.517, task_loss=2.528, contrastive_loss=0.114, total=6560.21, n_correct=4743.57, ppl=3.34, accuracy=72.308, wps=18204, ups=1.39, wpb=13120.4, bsz=431.9, num_updates=36000, lr=7.45356e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=72, gb_free=13, wall=31939
2023-08-27 09:47:41 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 09:48:13 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.913 | trans_loss 5.184 | nll_loss 2.387 | w2v_ctc_loss 1.171 | task_loss 8.556 | contrastive_loss 0.249 | total 6138.43 | n_correct 4173.86 | ppl 5.23 | accuracy 67.996 | uer 16.22 | wer 17.962 | raw_wer 17.962 | bleu 27.34 | wps 1763.6 | wpb 6138.4 | bsz 201.1 | num_updates 36000 | best_bleu 27.5
2023-08-27 09:48:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36000 updates
2023-08-27 09:48:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-27 09:48:15 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-27 09:48:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt (epoch 31 @ 36000 updates, score 27.34) (writing took 7.174879221987794 seconds)
2023-08-27 09:49:33 | INFO | train_inner | epoch 031:    386 / 1191 loss=1.798, trans_loss=4.611, nll_loss=1.735, w2v_ctc_loss=0.51, task_loss=2.338, contrastive_loss=0.057, total=6740.71, n_correct=4884.62, ppl=3.33, accuracy=72.464, wps=12061.2, ups=0.89, wpb=13481.4, bsz=456.6, num_updates=36100, lr=7.44323e-05, gnorm=0.39, clip=0, loss_scale=64, train_wall=71, gb_free=15.3, wall=32051
2023-08-27 09:50:45 | INFO | train_inner | epoch 031:    486 / 1191 loss=1.809, trans_loss=4.623, nll_loss=1.75, w2v_ctc_loss=0.515, task_loss=2.553, contrastive_loss=0.079, total=6663.24, n_correct=4810.4, ppl=3.36, accuracy=72.193, wps=18414.2, ups=1.38, wpb=13326.5, bsz=427.4, num_updates=36200, lr=7.43294e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=32123
2023-08-27 09:51:57 | INFO | train_inner | epoch 031:    586 / 1191 loss=1.809, trans_loss=4.614, nll_loss=1.739, w2v_ctc_loss=0.511, task_loss=2.327, contrastive_loss=0.14, total=6690.15, n_correct=4839.8, ppl=3.34, accuracy=72.342, wps=18554.1, ups=1.39, wpb=13380.3, bsz=452.9, num_updates=36300, lr=7.4227e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=72, gb_free=12.7, wall=32195
2023-08-27 09:53:09 | INFO | train_inner | epoch 031:    686 / 1191 loss=1.805, trans_loss=4.613, nll_loss=1.738, w2v_ctc_loss=0.508, task_loss=2.168, contrastive_loss=0.129, total=6828.19, n_correct=4946.17, ppl=3.34, accuracy=72.437, wps=18940, ups=1.39, wpb=13656.4, bsz=475.7, num_updates=36400, lr=7.41249e-05, gnorm=0.388, clip=0, loss_scale=64, train_wall=72, gb_free=9, wall=32268
2023-08-27 09:54:22 | INFO | train_inner | epoch 031:    786 / 1191 loss=1.806, trans_loss=4.617, nll_loss=1.745, w2v_ctc_loss=0.513, task_loss=2.196, contrastive_loss=0.109, total=6799.81, n_correct=4915.31, ppl=3.35, accuracy=72.286, wps=18653.2, ups=1.37, wpb=13599.6, bsz=477.8, num_updates=36500, lr=7.40233e-05, gnorm=0.391, clip=0, loss_scale=64, train_wall=72, gb_free=13, wall=32340
2023-08-27 09:55:35 | INFO | train_inner | epoch 031:    886 / 1191 loss=1.813, trans_loss=4.623, nll_loss=1.752, w2v_ctc_loss=0.516, task_loss=2.407, contrastive_loss=0.134, total=6621.33, n_correct=4777.61, ppl=3.37, accuracy=72.155, wps=18219.8, ups=1.38, wpb=13242.7, bsz=446.7, num_updates=36600, lr=7.39221e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=72, gb_free=6.3, wall=32413
2023-08-27 09:55:47 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 09:56:47 | INFO | train_inner | epoch 031:    987 / 1191 loss=1.809, trans_loss=4.621, nll_loss=1.75, w2v_ctc_loss=0.516, task_loss=2.38, contrastive_loss=0.094, total=6680.18, n_correct=4825.14, ppl=3.36, accuracy=72.231, wps=18388.2, ups=1.38, wpb=13360.4, bsz=446.8, num_updates=36700, lr=7.38213e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=32486
2023-08-27 09:57:59 | INFO | train_inner | epoch 031:   1087 / 1191 loss=1.8, trans_loss=4.617, nll_loss=1.744, w2v_ctc_loss=0.505, task_loss=2.067, contrastive_loss=0.098, total=6884.21, n_correct=4981.17, ppl=3.35, accuracy=72.356, wps=19248.3, ups=1.4, wpb=13768.4, bsz=489.3, num_updates=36800, lr=7.3721e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=71, gb_free=12.3, wall=32557
2023-08-27 09:59:10 | INFO | train_inner | epoch 031:   1187 / 1191 loss=1.81, trans_loss=4.623, nll_loss=1.751, w2v_ctc_loss=0.513, task_loss=2.373, contrastive_loss=0.124, total=6656.88, n_correct=4799.53, ppl=3.37, accuracy=72.099, wps=18612.7, ups=1.4, wpb=13313.8, bsz=445.6, num_updates=36900, lr=7.3621e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=14.1, wall=32629
2023-08-27 09:59:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 09:59:47 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.921 | trans_loss 5.177 | nll_loss 2.382 | w2v_ctc_loss 1.204 | task_loss 8.551 | contrastive_loss 0.26 | total 6138.43 | n_correct 4169.57 | ppl 5.21 | accuracy 67.926 | uer 16.305 | wer 18.148 | raw_wer 18.148 | bleu 27.22 | wps 1683.8 | wpb 6138.4 | bsz 201.1 | num_updates 36904 | best_bleu 27.5
2023-08-27 09:59:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36904 updates
2023-08-27 09:59:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 09:59:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 09:59:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 31 @ 36904 updates, score 27.22) (writing took 6.032487341988599 seconds)
2023-08-27 09:59:53 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2023-08-27 09:59:53 | INFO | train | epoch 031 | loss 1.806 | trans_loss 4.616 | nll_loss 1.742 | w2v_ctc_loss 0.512 | task_loss 2.351 | contrastive_loss 0.103 | total 6701.65 | n_correct 4847.5 | ppl 3.34 | accuracy 72.333 | wps 16849.4 | ups 1.26 | wpb 13403.3 | bsz 451.6 | num_updates 36904 | lr 7.3617e-05 | gnorm 0.395 | clip 0 | loss_scale 32 | train_wall 854 | gb_free 10.3 | wall 32671
2023-08-27 09:59:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 09:59:53 | INFO | fairseq.trainer | begin training epoch 32
2023-08-27 09:59:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 10:01:09 | INFO | train_inner | epoch 032:     96 / 1191 loss=1.791, trans_loss=4.591, nll_loss=1.71, w2v_ctc_loss=0.505, task_loss=2.29, contrastive_loss=0.08, total=6689.32, n_correct=4876.56, ppl=3.27, accuracy=72.901, wps=11275, ups=0.84, wpb=13378.6, bsz=452.4, num_updates=37000, lr=7.35215e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=71, gb_free=12.3, wall=32748
2023-08-27 10:02:21 | INFO | train_inner | epoch 032:    196 / 1191 loss=1.808, trans_loss=4.606, nll_loss=1.73, w2v_ctc_loss=0.508, task_loss=2.252, contrastive_loss=0.184, total=6806.67, n_correct=4938.63, ppl=3.32, accuracy=72.556, wps=18826.6, ups=1.38, wpb=13613.3, bsz=466.5, num_updates=37100, lr=7.34223e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=10.8, wall=32820
2023-08-27 10:03:34 | INFO | train_inner | epoch 032:    296 / 1191 loss=1.797, trans_loss=4.605, nll_loss=1.728, w2v_ctc_loss=0.506, task_loss=2.412, contrastive_loss=0.072, total=6678.58, n_correct=4847.52, ppl=3.31, accuracy=72.583, wps=18466.2, ups=1.38, wpb=13357.2, bsz=446.2, num_updates=37200, lr=7.33236e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=32892
2023-08-27 10:04:46 | INFO | train_inner | epoch 032:    396 / 1191 loss=1.793, trans_loss=4.599, nll_loss=1.72, w2v_ctc_loss=0.502, task_loss=2.285, contrastive_loss=0.076, total=6758.65, n_correct=4918.19, ppl=3.29, accuracy=72.769, wps=18820.8, ups=1.39, wpb=13517.3, bsz=458.9, num_updates=37300, lr=7.32252e-05, gnorm=0.389, clip=0, loss_scale=32, train_wall=71, gb_free=7.9, wall=32964
2023-08-27 10:05:58 | INFO | train_inner | epoch 032:    496 / 1191 loss=1.797, trans_loss=4.609, nll_loss=1.733, w2v_ctc_loss=0.51, task_loss=2.304, contrastive_loss=0.063, total=6744.1, n_correct=4893.38, ppl=3.32, accuracy=72.558, wps=18663.2, ups=1.38, wpb=13488.2, bsz=454.9, num_updates=37400, lr=7.31272e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=33036
2023-08-27 10:07:11 | INFO | train_inner | epoch 032:    596 / 1191 loss=1.796, trans_loss=4.608, nll_loss=1.731, w2v_ctc_loss=0.507, task_loss=2.388, contrastive_loss=0.057, total=6688.42, n_correct=4856.41, ppl=3.32, accuracy=72.609, wps=18351.5, ups=1.37, wpb=13376.8, bsz=444.7, num_updates=37500, lr=7.30297e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=33109
2023-08-27 10:08:24 | INFO | train_inner | epoch 032:    696 / 1191 loss=1.802, trans_loss=4.61, nll_loss=1.734, w2v_ctc_loss=0.507, task_loss=2.507, contrastive_loss=0.103, total=6670, n_correct=4835.35, ppl=3.33, accuracy=72.494, wps=18339.5, ups=1.37, wpb=13340, bsz=436.6, num_updates=37600, lr=7.29325e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=33182
2023-08-27 10:09:36 | INFO | train_inner | epoch 032:    796 / 1191 loss=1.81, trans_loss=4.613, nll_loss=1.739, w2v_ctc_loss=0.51, task_loss=2.296, contrastive_loss=0.161, total=6761.99, n_correct=4893.85, ppl=3.34, accuracy=72.373, wps=18558.6, ups=1.37, wpb=13524, bsz=465.5, num_updates=37700, lr=7.28357e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=33255
2023-08-27 10:10:49 | INFO | train_inner | epoch 032:    896 / 1191 loss=1.81, trans_loss=4.62, nll_loss=1.748, w2v_ctc_loss=0.511, task_loss=2.421, contrastive_loss=0.12, total=6694.46, n_correct=4834.62, ppl=3.36, accuracy=72.218, wps=18553.3, ups=1.39, wpb=13388.9, bsz=444.9, num_updates=37800, lr=7.27393e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=33327
2023-08-27 10:12:00 | INFO | train_inner | epoch 032:    996 / 1191 loss=1.803, trans_loss=4.616, nll_loss=1.742, w2v_ctc_loss=0.511, task_loss=2.398, contrastive_loss=0.087, total=6610.12, n_correct=4785.06, ppl=3.35, accuracy=72.39, wps=18420.2, ups=1.39, wpb=13220.2, bsz=440.7, num_updates=37900, lr=7.26433e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=71, gb_free=13.2, wall=33399
2023-08-27 10:13:12 | INFO | train_inner | epoch 032:   1096 / 1191 loss=1.803, trans_loss=4.618, nll_loss=1.745, w2v_ctc_loss=0.513, task_loss=2.477, contrastive_loss=0.052, total=6609.06, n_correct=4778.12, ppl=3.35, accuracy=72.297, wps=18338.2, ups=1.39, wpb=13218.1, bsz=431, num_updates=38000, lr=7.25476e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=15.2, wall=33471
2023-08-27 10:13:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 10:13:47 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.941 | trans_loss 5.185 | nll_loss 2.391 | w2v_ctc_loss 1.258 | task_loss 8.548 | contrastive_loss 0.247 | total 6138.43 | n_correct 4171.14 | ppl 5.25 | accuracy 67.951 | uer 16.396 | wer 18.048 | raw_wer 18.048 | bleu 27.5 | wps 1587.3 | wpb 6138.4 | bsz 201.1 | num_updates 38000 | best_bleu 27.5
2023-08-27 10:13:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38000 updates
2023-08-27 10:13:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-27 10:13:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-27 10:13:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt (epoch 32 @ 38000 updates, score 27.5) (writing took 12.540757937997114 seconds)
2023-08-27 10:15:08 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 10:15:41 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.919 | trans_loss 5.182 | nll_loss 2.389 | w2v_ctc_loss 1.188 | task_loss 8.546 | contrastive_loss 0.255 | total 6138.43 | n_correct 4179.14 | ppl 5.24 | accuracy 68.082 | uer 16.174 | wer 17.951 | raw_wer 17.951 | bleu 27.53 | wps 1644.1 | wpb 6138.4 | bsz 201.1 | num_updates 38095 | best_bleu 27.53
2023-08-27 10:15:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38095 updates
2023-08-27 10:15:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 10:15:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 10:15:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 32 @ 38095 updates, score 27.53) (writing took 11.406431174007594 seconds)
2023-08-27 10:15:53 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2023-08-27 10:15:53 | INFO | train | epoch 032 | loss 1.801 | trans_loss 4.61 | nll_loss 1.734 | w2v_ctc_loss 0.508 | task_loss 2.346 | contrastive_loss 0.105 | total 6703.69 | n_correct 4861.06 | ppl 3.33 | accuracy 72.513 | wps 16627.3 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 38095 | lr 7.24571e-05 | gnorm 0.395 | clip 0 | loss_scale 32 | train_wall 854 | gb_free 11.5 | wall 33632
2023-08-27 10:15:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 10:15:53 | INFO | fairseq.trainer | begin training epoch 33
2023-08-27 10:15:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 10:16:04 | INFO | train_inner | epoch 033:      5 / 1191 loss=1.811, trans_loss=4.621, nll_loss=1.75, w2v_ctc_loss=0.504, task_loss=2.173, contrastive_loss=0.219, total=6703.57, n_correct=4851.19, ppl=3.36, accuracy=72.367, wps=7806.6, ups=0.58, wpb=13407.1, bsz=482.5, num_updates=38100, lr=7.24524e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=14.3, wall=33643
2023-08-27 10:17:17 | INFO | train_inner | epoch 033:    105 / 1191 loss=1.787, trans_loss=4.595, nll_loss=1.715, w2v_ctc_loss=0.496, task_loss=2.255, contrastive_loss=0.068, total=6806.82, n_correct=4960.86, ppl=3.28, accuracy=72.881, wps=18747.6, ups=1.38, wpb=13613.6, bsz=467.7, num_updates=38200, lr=7.23575e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=33715
2023-08-27 10:18:28 | INFO | train_inner | epoch 033:    205 / 1191 loss=1.788, trans_loss=4.591, nll_loss=1.71, w2v_ctc_loss=0.494, task_loss=2.271, contrastive_loss=0.09, total=6763.38, n_correct=4931.64, ppl=3.27, accuracy=72.917, wps=18872.4, ups=1.4, wpb=13526.8, bsz=455.5, num_updates=38300, lr=7.22629e-05, gnorm=0.383, clip=0, loss_scale=32, train_wall=71, gb_free=12.8, wall=33787
2023-08-27 10:19:41 | INFO | train_inner | epoch 033:    305 / 1191 loss=1.802, trans_loss=4.602, nll_loss=1.723, w2v_ctc_loss=0.509, task_loss=2.503, contrastive_loss=0.122, total=6595.67, n_correct=4793.38, ppl=3.3, accuracy=72.675, wps=18244.5, ups=1.38, wpb=13191.3, bsz=434, num_updates=38400, lr=7.21688e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=12.4, wall=33859
2023-08-27 10:20:53 | INFO | train_inner | epoch 033:    405 / 1191 loss=1.797, trans_loss=4.602, nll_loss=1.723, w2v_ctc_loss=0.505, task_loss=2.461, contrastive_loss=0.101, total=6592.1, n_correct=4792.18, ppl=3.3, accuracy=72.696, wps=18298.8, ups=1.39, wpb=13184.2, bsz=432.6, num_updates=38500, lr=7.2075e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=4.3, wall=33931
2023-08-27 10:22:04 | INFO | train_inner | epoch 033:    505 / 1191 loss=1.798, trans_loss=4.604, nll_loss=1.727, w2v_ctc_loss=0.505, task_loss=2.288, contrastive_loss=0.101, total=6691.29, n_correct=4862.05, ppl=3.31, accuracy=72.662, wps=18800.3, ups=1.4, wpb=13382.6, bsz=456.4, num_updates=38600, lr=7.19816e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=71, gb_free=15.1, wall=34002
2023-08-27 10:23:17 | INFO | train_inner | epoch 033:    605 / 1191 loss=1.799, trans_loss=4.602, nll_loss=1.725, w2v_ctc_loss=0.513, task_loss=2.41, contrastive_loss=0.079, total=6673.5, n_correct=4846.59, ppl=3.31, accuracy=72.624, wps=18309.5, ups=1.37, wpb=13347, bsz=446.7, num_updates=38700, lr=7.18885e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=11.6, wall=34075
2023-08-27 10:24:29 | INFO | train_inner | epoch 033:    705 / 1191 loss=1.799, trans_loss=4.608, nll_loss=1.733, w2v_ctc_loss=0.505, task_loss=2.399, contrastive_loss=0.088, total=6684.47, n_correct=4847.9, ppl=3.32, accuracy=72.525, wps=18445, ups=1.38, wpb=13368.9, bsz=443.1, num_updates=38800, lr=7.17958e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=4.5, wall=34148
2023-08-27 10:25:41 | INFO | train_inner | epoch 033:    805 / 1191 loss=1.796, trans_loss=4.603, nll_loss=1.726, w2v_ctc_loss=0.495, task_loss=2.211, contrastive_loss=0.141, total=6794.84, n_correct=4945.53, ppl=3.31, accuracy=72.784, wps=18912.2, ups=1.39, wpb=13589.7, bsz=467.9, num_updates=38900, lr=7.17035e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=71, gb_free=13.9, wall=34220
2023-08-27 10:26:54 | INFO | train_inner | epoch 033:    905 / 1191 loss=1.802, trans_loss=4.612, nll_loss=1.738, w2v_ctc_loss=0.512, task_loss=2.279, contrastive_loss=0.084, total=6754.04, n_correct=4893.07, ppl=3.34, accuracy=72.447, wps=18517.9, ups=1.37, wpb=13508.1, bsz=463.2, num_updates=39000, lr=7.16115e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=34293
2023-08-27 10:28:07 | INFO | train_inner | epoch 033:   1005 / 1191 loss=1.805, trans_loss=4.62, nll_loss=1.748, w2v_ctc_loss=0.509, task_loss=2.478, contrastive_loss=0.083, total=6679.84, n_correct=4831.44, ppl=3.36, accuracy=72.329, wps=18375.2, ups=1.38, wpb=13359.7, bsz=440.5, num_updates=39100, lr=7.15199e-05, gnorm=0.405, clip=0, loss_scale=64, train_wall=72, gb_free=4.6, wall=34365
2023-08-27 10:29:19 | INFO | train_inner | epoch 033:   1105 / 1191 loss=1.809, trans_loss=4.617, nll_loss=1.744, w2v_ctc_loss=0.515, task_loss=2.296, contrastive_loss=0.127, total=6749.49, n_correct=4880.23, ppl=3.35, accuracy=72.305, wps=18625.8, ups=1.38, wpb=13499, bsz=463.2, num_updates=39200, lr=7.14286e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=72, gb_free=12.9, wall=34438
2023-08-27 10:30:22 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 10:30:54 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 3.928 | trans_loss 5.177 | nll_loss 2.382 | w2v_ctc_loss 1.235 | task_loss 8.525 | contrastive_loss 0.248 | total 6138.43 | n_correct 4178.43 | ppl 5.21 | accuracy 68.07 | uer 16.099 | wer 17.888 | raw_wer 17.888 | bleu 27.58 | wps 1765.9 | wpb 6138.4 | bsz 201.1 | num_updates 39286 | best_bleu 27.58
2023-08-27 10:30:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 39286 updates
2023-08-27 10:30:54 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 10:31:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 10:31:06 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 33 @ 39286 updates, score 27.58) (writing took 12.24112767598126 seconds)
2023-08-27 10:31:06 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2023-08-27 10:31:06 | INFO | train | epoch 033 | loss 1.799 | trans_loss 4.606 | nll_loss 1.729 | w2v_ctc_loss 0.505 | task_loss 2.347 | contrastive_loss 0.103 | total 6703.69 | n_correct 4867.94 | ppl 3.32 | accuracy 72.616 | wps 17486.9 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 39286 | lr 7.13503e-05 | gnorm 0.397 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 10.6 | wall 34545
2023-08-27 10:31:07 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 10:31:07 | INFO | fairseq.trainer | begin training epoch 34
2023-08-27 10:31:07 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 10:31:24 | INFO | train_inner | epoch 034:     14 / 1191 loss=1.802, trans_loss=4.608, nll_loss=1.734, w2v_ctc_loss=0.505, task_loss=2.255, contrastive_loss=0.156, total=6714.43, n_correct=4875.95, ppl=3.33, accuracy=72.619, wps=10780.8, ups=0.8, wpb=13428.9, bsz=468.7, num_updates=39300, lr=7.13376e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=71, gb_free=13.8, wall=34562
2023-08-27 10:32:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 10:32:37 | INFO | train_inner | epoch 034:    115 / 1191 loss=1.792, trans_loss=4.589, nll_loss=1.707, w2v_ctc_loss=0.494, task_loss=2.174, contrastive_loss=0.153, total=6796.64, n_correct=4960.75, ppl=3.27, accuracy=72.988, wps=18723.8, ups=1.38, wpb=13593.3, bsz=474.2, num_updates=39400, lr=7.1247e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=34635
2023-08-27 10:33:49 | INFO | train_inner | epoch 034:    215 / 1191 loss=1.793, trans_loss=4.591, nll_loss=1.71, w2v_ctc_loss=0.501, task_loss=2.404, contrastive_loss=0.116, total=6678.61, n_correct=4870.79, ppl=3.27, accuracy=72.931, wps=18394.6, ups=1.38, wpb=13357.2, bsz=450.2, num_updates=39500, lr=7.11568e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=34708
2023-08-27 10:35:01 | INFO | train_inner | epoch 034:    315 / 1191 loss=1.792, trans_loss=4.598, nll_loss=1.719, w2v_ctc_loss=0.505, task_loss=2.497, contrastive_loss=0.053, total=6608.68, n_correct=4805.3, ppl=3.29, accuracy=72.712, wps=18342.5, ups=1.39, wpb=13217.4, bsz=433.2, num_updates=39600, lr=7.10669e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=71, gb_free=11.9, wall=34780
2023-08-27 10:36:14 | INFO | train_inner | epoch 034:    415 / 1191 loss=1.792, trans_loss=4.599, nll_loss=1.721, w2v_ctc_loss=0.502, task_loss=2.498, contrastive_loss=0.063, total=6649.36, n_correct=4836.86, ppl=3.3, accuracy=72.742, wps=18336, ups=1.38, wpb=13298.7, bsz=430.9, num_updates=39700, lr=7.09773e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=34852
2023-08-27 10:37:26 | INFO | train_inner | epoch 034:    515 / 1191 loss=1.791, trans_loss=4.6, nll_loss=1.722, w2v_ctc_loss=0.496, task_loss=2.421, contrastive_loss=0.09, total=6704.45, n_correct=4883.54, ppl=3.3, accuracy=72.84, wps=18493.1, ups=1.38, wpb=13408.9, bsz=443.4, num_updates=39800, lr=7.08881e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=34925
2023-08-27 10:38:39 | INFO | train_inner | epoch 034:    615 / 1191 loss=1.801, trans_loss=4.603, nll_loss=1.726, w2v_ctc_loss=0.506, task_loss=2.271, contrastive_loss=0.132, total=6737.48, n_correct=4892.76, ppl=3.31, accuracy=72.62, wps=18634.9, ups=1.38, wpb=13475, bsz=465.8, num_updates=39900, lr=7.07992e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=34997
2023-08-27 10:39:51 | INFO | train_inner | epoch 034:    715 / 1191 loss=1.795, trans_loss=4.602, nll_loss=1.724, w2v_ctc_loss=0.502, task_loss=2.441, contrastive_loss=0.084, total=6608.91, n_correct=4807.44, ppl=3.3, accuracy=72.742, wps=18374.5, ups=1.39, wpb=13217.8, bsz=435.2, num_updates=40000, lr=7.07107e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=71, gb_free=12.7, wall=35069
2023-08-27 10:39:51 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 10:40:23 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.923 | trans_loss 5.184 | nll_loss 2.387 | w2v_ctc_loss 1.204 | task_loss 8.578 | contrastive_loss 0.25 | total 6138.43 | n_correct 4176 | ppl 5.23 | accuracy 68.03 | uer 16.359 | wer 18.234 | raw_wer 18.234 | bleu 27.63 | wps 1762.6 | wpb 6138.4 | bsz 201.1 | num_updates 40000 | best_bleu 27.63
2023-08-27 10:40:23 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40000 updates
2023-08-27 10:40:23 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-27 10:40:25 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-27 10:40:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt (epoch 34 @ 40000 updates, score 27.63) (writing took 10.662314464017982 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 10:41:46 | INFO | train_inner | epoch 034:    815 / 1191 loss=1.793, trans_loss=4.601, nll_loss=1.723, w2v_ctc_loss=0.504, task_loss=2.373, contrastive_loss=0.081, total=6668.41, n_correct=4849.22, ppl=3.3, accuracy=72.719, wps=11515, ups=0.86, wpb=13336.8, bsz=455.6, num_updates=40100, lr=7.06225e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=35185
2023-08-27 10:42:59 | INFO | train_inner | epoch 034:    915 / 1191 loss=1.798, trans_loss=4.606, nll_loss=1.729, w2v_ctc_loss=0.508, task_loss=2.506, contrastive_loss=0.074, total=6650.22, n_correct=4834.27, ppl=3.31, accuracy=72.693, wps=18443.8, ups=1.39, wpb=13300.4, bsz=427.8, num_updates=40200, lr=7.05346e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=35257
2023-08-27 10:44:10 | INFO | train_inner | epoch 034:   1015 / 1191 loss=1.795, trans_loss=4.611, nll_loss=1.737, w2v_ctc_loss=0.504, task_loss=2.374, contrastive_loss=0.062, total=6680.01, n_correct=4852.8, ppl=3.33, accuracy=72.647, wps=18604.8, ups=1.39, wpb=13360, bsz=442.6, num_updates=40300, lr=7.0447e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=13.5, wall=35329
2023-08-27 10:45:22 | INFO | train_inner | epoch 034:   1115 / 1191 loss=1.788, trans_loss=4.604, nll_loss=1.728, w2v_ctc_loss=0.491, task_loss=2.168, contrastive_loss=0.095, total=6848.4, n_correct=4984.38, ppl=3.31, accuracy=72.782, wps=19100.2, ups=1.39, wpb=13696.8, bsz=477.6, num_updates=40400, lr=7.03598e-05, gnorm=0.388, clip=0, loss_scale=32, train_wall=71, gb_free=14.2, wall=35400
2023-08-27 10:46:17 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
2023-08-27 10:46:51 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.939 | trans_loss 5.181 | nll_loss 2.388 | w2v_ctc_loss 1.26 | task_loss 8.574 | contrastive_loss 0.25 | total 6138.43 | n_correct 4176.71 | ppl 5.23 | accuracy 68.042 | uer 16.228 | wer 17.903 | raw_wer 17.903 | bleu 27.42 | wps 1671.1 | wpb 6138.4 | bsz 201.1 | num_updates 40476 | best_bleu 27.63
2023-08-27 10:46:51 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40476 updates
2023-08-27 10:46:51 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4205.pt
2023-08-27 10:46:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4205.pt
2023-08-27 10:46:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4205.pt (epoch 34 @ 40476 updates, score 27.42) (writing took 6.181786394008668 seconds)
2023-08-27 10:46:57 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2023-08-27 10:46:57 | INFO | train | epoch 034 | loss 1.794 | trans_loss 4.6 | nll_loss 1.723 | w2v_ctc_loss 0.501 | task_loss 2.348 | contrastive_loss 0.1 | total 6703.47 | n_correct 4877.66 | ppl 3.3 | accuracy 72.763 | wps 16780.9 | ups 1.25 | wpb 13406.9 | bsz 451.9 | num_updates 40476 | lr 7.02937e-05 | gnorm 0.396 | clip 0 | loss_scale 32 | train_wall 852 | gb_free 14.1 | wall 35496
2023-08-27 10:46:57 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 10:46:57 | INFO | fairseq.trainer | begin training epoch 35
2023-08-27 10:46:57 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 10:47:23 | INFO | train_inner | epoch 035:     24 / 1191 loss=1.799, trans_loss=4.603, nll_loss=1.727, w2v_ctc_loss=0.499, task_loss=2.209, contrastive_loss=0.164, total=6771.92, n_correct=4922.27, ppl=3.31, accuracy=72.686, wps=11241.1, ups=0.83, wpb=13543.8, bsz=471.7, num_updates=40500, lr=7.02728e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=35521
2023-08-27 10:48:34 | INFO | train_inner | epoch 035:    124 / 1191 loss=1.782, trans_loss=4.584, nll_loss=1.701, w2v_ctc_loss=0.498, task_loss=2.344, contrastive_loss=0.061, total=6711.06, n_correct=4909.62, ppl=3.25, accuracy=73.157, wps=18655.8, ups=1.39, wpb=13422.1, bsz=452.8, num_updates=40600, lr=7.01862e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=35593
2023-08-27 10:49:46 | INFO | train_inner | epoch 035:    224 / 1191 loss=1.794, trans_loss=4.587, nll_loss=1.705, w2v_ctc_loss=0.495, task_loss=2.447, contrastive_loss=0.179, total=6627.11, n_correct=4839.36, ppl=3.26, accuracy=73.024, wps=18569.5, ups=1.4, wpb=13254.2, bsz=444, num_updates=40700, lr=7.01e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=15.1, wall=35664
2023-08-27 10:50:58 | INFO | train_inner | epoch 035:    324 / 1191 loss=1.786, trans_loss=4.585, nll_loss=1.702, w2v_ctc_loss=0.494, task_loss=2.245, contrastive_loss=0.115, total=6768.12, n_correct=4951.1, ppl=3.25, accuracy=73.153, wps=18813.6, ups=1.39, wpb=13536.2, bsz=463.6, num_updates=40800, lr=7.0014e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=35736
2023-08-27 10:52:10 | INFO | train_inner | epoch 035:    424 / 1191 loss=1.791, trans_loss=4.598, nll_loss=1.719, w2v_ctc_loss=0.503, task_loss=2.635, contrastive_loss=0.05, total=6573.32, n_correct=4789.49, ppl=3.29, accuracy=72.863, wps=18205.2, ups=1.38, wpb=13146.6, bsz=420.1, num_updates=40900, lr=6.99284e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=35808
2023-08-27 10:53:22 | INFO | train_inner | epoch 035:    524 / 1191 loss=1.788, trans_loss=4.59, nll_loss=1.71, w2v_ctc_loss=0.5, task_loss=2.349, contrastive_loss=0.08, total=6718.03, n_correct=4899.22, ppl=3.27, accuracy=72.926, wps=18710.4, ups=1.39, wpb=13436.1, bsz=456.1, num_updates=41000, lr=6.9843e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=12.5, wall=35880
2023-08-27 10:54:35 | INFO | train_inner | epoch 035:    624 / 1191 loss=1.789, trans_loss=4.595, nll_loss=1.716, w2v_ctc_loss=0.495, task_loss=2.384, contrastive_loss=0.087, total=6702.8, n_correct=4883.5, ppl=3.29, accuracy=72.858, wps=18419.3, ups=1.37, wpb=13405.6, bsz=446.4, num_updates=41100, lr=6.9758e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=9.6, wall=35953
2023-08-27 10:55:46 | INFO | train_inner | epoch 035:    724 / 1191 loss=1.797, trans_loss=4.601, nll_loss=1.723, w2v_ctc_loss=0.501, task_loss=2.346, contrastive_loss=0.124, total=6709.59, n_correct=4877.81, ppl=3.3, accuracy=72.699, wps=18692.2, ups=1.39, wpb=13419.2, bsz=453.6, num_updates=41200, lr=6.96733e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=13.2, wall=36025
2023-08-27 10:56:59 | INFO | train_inner | epoch 035:    824 / 1191 loss=1.795, trans_loss=4.604, nll_loss=1.727, w2v_ctc_loss=0.496, task_loss=2.25, contrastive_loss=0.115, total=6756.65, n_correct=4912.49, ppl=3.31, accuracy=72.706, wps=18723.7, ups=1.39, wpb=13513.3, bsz=459.7, num_updates=41300, lr=6.95889e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=36097
2023-08-27 10:58:10 | INFO | train_inner | epoch 035:    924 / 1191 loss=1.79, trans_loss=4.596, nll_loss=1.718, w2v_ctc_loss=0.489, task_loss=2.156, contrastive_loss=0.139, total=6770.43, n_correct=4934.44, ppl=3.29, accuracy=72.882, wps=18873.1, ups=1.39, wpb=13540.9, bsz=473.1, num_updates=41400, lr=6.95048e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=71, gb_free=14.8, wall=36169
2023-08-27 10:59:22 | INFO | train_inner | epoch 035:   1024 / 1191 loss=1.791, trans_loss=4.598, nll_loss=1.72, w2v_ctc_loss=0.502, task_loss=2.38, contrastive_loss=0.066, total=6727.5, n_correct=4896.24, ppl=3.29, accuracy=72.779, wps=18718.6, ups=1.39, wpb=13455, bsz=442.9, num_updates=41500, lr=6.9421e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=71, gb_free=14.2, wall=36241
2023-08-27 11:00:35 | INFO | train_inner | epoch 035:   1124 / 1191 loss=1.795, trans_loss=4.61, nll_loss=1.736, w2v_ctc_loss=0.505, task_loss=2.425, contrastive_loss=0.063, total=6632.13, n_correct=4815.49, ppl=3.33, accuracy=72.608, wps=18213.3, ups=1.37, wpb=13264.3, bsz=443.4, num_updates=41600, lr=6.93375e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=72, gb_free=13.7, wall=36313
2023-08-27 11:01:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:01:56 | INFO | dev_st | epoch 035 | valid on 'dev_st' subset | loss 3.931 | trans_loss 5.183 | nll_loss 2.388 | w2v_ctc_loss 1.23 | task_loss 8.572 | contrastive_loss 0.249 | total 6138.43 | n_correct 4175.29 | ppl 5.24 | accuracy 68.019 | uer 16.311 | wer 18.066 | raw_wer 18.066 | bleu 27.38 | wps 1764.9 | wpb 6138.4 | bsz 201.1 | num_updates 41667 | best_bleu 27.63
2023-08-27 11:01:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 35 @ 41667 updates
2023-08-27 11:01:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3806.pt
2023-08-27 11:01:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3806.pt
2023-08-27 11:02:03 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.3806.pt (epoch 35 @ 41667 updates, score 27.38) (writing took 6.858133437985089 seconds)
2023-08-27 11:02:03 | INFO | fairseq_cli.train | end of epoch 35 (average epoch stats below)
2023-08-27 11:02:03 | INFO | train | epoch 035 | loss 1.791 | trans_loss 4.596 | nll_loss 1.717 | w2v_ctc_loss 0.498 | task_loss 2.346 | contrastive_loss 0.102 | total 6703.69 | n_correct 4884.97 | ppl 3.29 | accuracy 72.87 | wps 17626.3 | ups 1.31 | wpb 13407.4 | bsz 452.1 | num_updates 41667 | lr 6.92818e-05 | gnorm 0.397 | clip 0 | loss_scale 64 | train_wall 852 | gb_free 14.3 | wall 36401
2023-08-27 11:02:03 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 11:02:03 | INFO | fairseq.trainer | begin training epoch 36
2023-08-27 11:02:03 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 11:02:34 | INFO | train_inner | epoch 036:     33 / 1191 loss=1.793, trans_loss=4.597, nll_loss=1.72, w2v_ctc_loss=0.494, task_loss=2.267, contrastive_loss=0.131, total=6723.84, n_correct=4899.9, ppl=3.29, accuracy=72.874, wps=11262.4, ups=0.84, wpb=13447.7, bsz=466.4, num_updates=41700, lr=6.92543e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=14.7, wall=36433
2023-08-27 11:03:46 | INFO | train_inner | epoch 036:    133 / 1191 loss=1.787, trans_loss=4.579, nll_loss=1.695, w2v_ctc_loss=0.493, task_loss=2.428, contrastive_loss=0.147, total=6619.6, n_correct=4847.2, ppl=3.24, accuracy=73.225, wps=18414.2, ups=1.39, wpb=13239.2, bsz=440.5, num_updates=41800, lr=6.91714e-05, gnorm=0.403, clip=0, loss_scale=64, train_wall=71, gb_free=12.4, wall=36505
2023-08-27 11:04:58 | INFO | train_inner | epoch 036:    233 / 1191 loss=1.769, trans_loss=4.569, nll_loss=1.683, w2v_ctc_loss=0.483, task_loss=2.193, contrastive_loss=0.059, total=6746.42, n_correct=4955.45, ppl=3.21, accuracy=73.453, wps=18855.6, ups=1.4, wpb=13492.8, bsz=471.8, num_updates=41900, lr=6.90889e-05, gnorm=0.389, clip=0, loss_scale=64, train_wall=71, gb_free=14.2, wall=36576
2023-08-27 11:06:10 | INFO | train_inner | epoch 036:    333 / 1191 loss=1.775, trans_loss=4.581, nll_loss=1.698, w2v_ctc_loss=0.485, task_loss=2.235, contrastive_loss=0.063, total=6782.22, n_correct=4972.75, ppl=3.24, accuracy=73.32, wps=18950.8, ups=1.4, wpb=13564.4, bsz=465.7, num_updates=42000, lr=6.90066e-05, gnorm=0.386, clip=0, loss_scale=64, train_wall=71, gb_free=14.3, wall=36648
2023-08-27 11:06:10 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:06:42 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.935 | trans_loss 5.185 | nll_loss 2.39 | w2v_ctc_loss 1.236 | task_loss 8.567 | contrastive_loss 0.253 | total 6138.43 | n_correct 4180.29 | ppl 5.24 | accuracy 68.1 | uer 16.206 | wer 17.932 | raw_wer 17.932 | bleu 27.5 | wps 1721.1 | wpb 6138.4 | bsz 201.1 | num_updates 42000 | best_bleu 27.63
2023-08-27 11:06:42 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42000 updates
2023-08-27 11:06:42 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-27 11:06:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-27 11:06:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt (epoch 36 @ 42000 updates, score 27.5) (writing took 7.1479480379784945 seconds)
2023-08-27 11:08:03 | INFO | train_inner | epoch 036:    433 / 1191 loss=1.785, trans_loss=4.589, nll_loss=1.708, w2v_ctc_loss=0.495, task_loss=2.219, contrastive_loss=0.1, total=6792.65, n_correct=4965.53, ppl=3.27, accuracy=73.102, wps=11983.4, ups=0.88, wpb=13585.3, bsz=471.5, num_updates=42100, lr=6.89246e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=36761
2023-08-27 11:09:15 | INFO | train_inner | epoch 036:    533 / 1191 loss=1.798, trans_loss=4.596, nll_loss=1.717, w2v_ctc_loss=0.495, task_loss=2.196, contrastive_loss=0.189, total=6799.2, n_correct=4955.76, ppl=3.29, accuracy=72.887, wps=18898.5, ups=1.39, wpb=13598.4, bsz=476.6, num_updates=42200, lr=6.88428e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=71, gb_free=13.9, wall=36833
2023-08-27 11:10:27 | INFO | train_inner | epoch 036:    633 / 1191 loss=1.785, trans_loss=4.591, nll_loss=1.71, w2v_ctc_loss=0.497, task_loss=2.41, contrastive_loss=0.054, total=6677.2, n_correct=4873.85, ppl=3.27, accuracy=72.992, wps=18441.9, ups=1.38, wpb=13354.4, bsz=440.8, num_updates=42300, lr=6.87614e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=13.3, wall=36906
2023-08-27 11:11:40 | INFO | train_inner | epoch 036:    733 / 1191 loss=1.793, trans_loss=4.596, nll_loss=1.717, w2v_ctc_loss=0.497, task_loss=2.35, contrastive_loss=0.122, total=6721.98, n_correct=4899.98, ppl=3.29, accuracy=72.895, wps=18548.8, ups=1.38, wpb=13444, bsz=451.5, num_updates=42400, lr=6.86803e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=13.9, wall=36978
2023-08-27 11:12:53 | INFO | train_inner | epoch 036:    833 / 1191 loss=1.791, trans_loss=4.603, nll_loss=1.726, w2v_ctc_loss=0.5, task_loss=2.445, contrastive_loss=0.059, total=6667.94, n_correct=4850.21, ppl=3.31, accuracy=72.739, wps=18236.6, ups=1.37, wpb=13335.9, bsz=443.4, num_updates=42500, lr=6.85994e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=73, gb_free=14.6, wall=37051
2023-08-27 11:14:06 | INFO | train_inner | epoch 036:    933 / 1191 loss=1.8, trans_loss=4.602, nll_loss=1.725, w2v_ctc_loss=0.5, task_loss=2.512, contrastive_loss=0.146, total=6687.67, n_correct=4859.1, ppl=3.31, accuracy=72.658, wps=18345.9, ups=1.37, wpb=13375.3, bsz=433.6, num_updates=42600, lr=6.85189e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=72, gb_free=14, wall=37124
2023-08-27 11:15:17 | INFO | train_inner | epoch 036:   1033 / 1191 loss=1.788, trans_loss=4.599, nll_loss=1.721, w2v_ctc_loss=0.495, task_loss=2.278, contrastive_loss=0.083, total=6704.37, n_correct=4885.55, ppl=3.3, accuracy=72.871, wps=18856, ups=1.41, wpb=13408.7, bsz=460.9, num_updates=42700, lr=6.84386e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=71, gb_free=14.2, wall=37195
2023-08-27 11:16:29 | INFO | train_inner | epoch 036:   1133 / 1191 loss=1.791, trans_loss=4.598, nll_loss=1.72, w2v_ctc_loss=0.505, task_loss=2.466, contrastive_loss=0.059, total=6606.86, n_correct=4808.69, ppl=3.29, accuracy=72.783, wps=18267.4, ups=1.38, wpb=13213.7, bsz=434.3, num_updates=42800, lr=6.83586e-05, gnorm=0.399, clip=0, loss_scale=64, train_wall=72, gb_free=15.1, wall=37268
2023-08-27 11:17:11 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:17:43 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.938 | trans_loss 5.182 | nll_loss 2.387 | w2v_ctc_loss 1.256 | task_loss 8.556 | contrastive_loss 0.249 | total 6138.43 | n_correct 4183.29 | ppl 5.23 | accuracy 68.149 | uer 16.46 | wer 18.159 | raw_wer 18.159 | bleu 27.43 | wps 1755.1 | wpb 6138.4 | bsz 201.1 | num_updates 42858 | best_bleu 27.63
2023-08-27 11:17:43 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42858 updates
2023-08-27 11:17:43 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4306.pt
2023-08-27 11:17:46 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4306.pt
2023-08-27 11:17:50 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.4306.pt (epoch 36 @ 42858 updates, score 27.43) (writing took 7.085056632000487 seconds)
2023-08-27 11:17:51 | INFO | fairseq_cli.train | end of epoch 36 (average epoch stats below)
2023-08-27 11:17:51 | INFO | train | epoch 036 | loss 1.788 | trans_loss 4.592 | nll_loss 1.712 | w2v_ctc_loss 0.496 | task_loss 2.346 | contrastive_loss 0.101 | total 6703.69 | n_correct 4891.43 | ppl 3.28 | accuracy 72.966 | wps 16850.9 | ups 1.26 | wpb 13407.4 | bsz 452.1 | num_updates 42858 | lr 6.83123e-05 | gnorm 0.397 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 12.9 | wall 37349
2023-08-27 11:17:51 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 11:17:51 | INFO | fairseq.trainer | begin training epoch 37
2023-08-27 11:17:51 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 11:18:29 | INFO | train_inner | epoch 037:     42 / 1191 loss=1.792, trans_loss=4.596, nll_loss=1.718, w2v_ctc_loss=0.497, task_loss=2.436, contrastive_loss=0.108, total=6674.02, n_correct=4861.89, ppl=3.29, accuracy=72.848, wps=11137.6, ups=0.83, wpb=13348, bsz=440.6, num_updates=42900, lr=6.82789e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=71, gb_free=14.8, wall=37388
2023-08-27 11:18:34 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 11:19:43 | INFO | train_inner | epoch 037:    143 / 1191 loss=1.785, trans_loss=4.578, nll_loss=1.693, w2v_ctc_loss=0.489, task_loss=2.268, contrastive_loss=0.16, total=6739.59, n_correct=4938.43, ppl=3.23, accuracy=73.275, wps=18321.2, ups=1.36, wpb=13479.2, bsz=457.3, num_updates=43000, lr=6.81994e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=73, gb_free=12.9, wall=37461
2023-08-27 11:20:54 | INFO | train_inner | epoch 037:    243 / 1191 loss=1.781, trans_loss=4.579, nll_loss=1.695, w2v_ctc_loss=0.492, task_loss=2.376, contrastive_loss=0.088, total=6696.92, n_correct=4903, ppl=3.24, accuracy=73.213, wps=18706.3, ups=1.4, wpb=13393.8, bsz=449.2, num_updates=43100, lr=6.81203e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=37533
2023-08-27 11:22:06 | INFO | train_inner | epoch 037:    343 / 1191 loss=1.783, trans_loss=4.582, nll_loss=1.698, w2v_ctc_loss=0.493, task_loss=2.406, contrastive_loss=0.08, total=6637.72, n_correct=4857.22, ppl=3.24, accuracy=73.176, wps=18543, ups=1.4, wpb=13275.4, bsz=440.5, num_updates=43200, lr=6.80414e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=71, gb_free=13.7, wall=37604
2023-08-27 11:23:18 | INFO | train_inner | epoch 037:    443 / 1191 loss=1.775, trans_loss=4.576, nll_loss=1.691, w2v_ctc_loss=0.482, task_loss=2.353, contrastive_loss=0.078, total=6703.75, n_correct=4917.02, ppl=3.23, accuracy=73.347, wps=18689.3, ups=1.39, wpb=13407.5, bsz=446.8, num_updates=43300, lr=6.79628e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=14.7, wall=37676
2023-08-27 11:24:30 | INFO | train_inner | epoch 037:    543 / 1191 loss=1.785, trans_loss=4.586, nll_loss=1.704, w2v_ctc_loss=0.496, task_loss=2.41, contrastive_loss=0.094, total=6639.95, n_correct=4847.72, ppl=3.26, accuracy=73.008, wps=18408.5, ups=1.39, wpb=13279.9, bsz=449.3, num_updates=43400, lr=6.78844e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=37748
2023-08-27 11:25:42 | INFO | train_inner | epoch 037:    643 / 1191 loss=1.79, trans_loss=4.596, nll_loss=1.717, w2v_ctc_loss=0.494, task_loss=2.511, contrastive_loss=0.086, total=6631.82, n_correct=4834.18, ppl=3.29, accuracy=72.894, wps=18490.1, ups=1.39, wpb=13263.6, bsz=428.1, num_updates=43500, lr=6.78064e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=71, gb_free=12.4, wall=37820
2023-08-27 11:26:54 | INFO | train_inner | epoch 037:    743 / 1191 loss=1.785, trans_loss=4.588, nll_loss=1.707, w2v_ctc_loss=0.489, task_loss=2.334, contrastive_loss=0.105, total=6719.07, n_correct=4913.83, ppl=3.26, accuracy=73.133, wps=18412.8, ups=1.37, wpb=13438.1, bsz=451.8, num_updates=43600, lr=6.77285e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=37893
2023-08-27 11:28:07 | INFO | train_inner | epoch 037:    843 / 1191 loss=1.783, trans_loss=4.592, nll_loss=1.713, w2v_ctc_loss=0.488, task_loss=2.248, contrastive_loss=0.102, total=6808.88, n_correct=4971.77, ppl=3.28, accuracy=73.019, wps=18773.8, ups=1.38, wpb=13617.8, bsz=466.8, num_updates=43700, lr=6.7651e-05, gnorm=0.39, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=37965
2023-08-27 11:29:19 | INFO | train_inner | epoch 037:    943 / 1191 loss=1.78, trans_loss=4.584, nll_loss=1.703, w2v_ctc_loss=0.483, task_loss=2.055, contrastive_loss=0.136, total=6855.49, n_correct=5015.6, ppl=3.26, accuracy=73.162, wps=18976.6, ups=1.38, wpb=13711, bsz=499.9, num_updates=43800, lr=6.75737e-05, gnorm=0.391, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=38038
2023-08-27 11:30:32 | INFO | train_inner | epoch 037:   1043 / 1191 loss=1.783, trans_loss=4.593, nll_loss=1.712, w2v_ctc_loss=0.492, task_loss=2.447, contrastive_loss=0.052, total=6689.96, n_correct=4882.43, ppl=3.28, accuracy=72.981, wps=18439.5, ups=1.38, wpb=13379.9, bsz=441.4, num_updates=43900, lr=6.74967e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=38110
2023-08-27 11:31:43 | INFO | train_inner | epoch 037:   1143 / 1191 loss=1.799, trans_loss=4.604, nll_loss=1.729, w2v_ctc_loss=0.503, task_loss=2.43, contrastive_loss=0.126, total=6631.9, n_correct=4821.86, ppl=3.31, accuracy=72.707, wps=18552.9, ups=1.4, wpb=13263.8, bsz=443.6, num_updates=44000, lr=6.742e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=71, gb_free=14.7, wall=38182
2023-08-27 11:31:43 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:32:17 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.926 | trans_loss 5.176 | nll_loss 2.38 | w2v_ctc_loss 1.226 | task_loss 8.533 | contrastive_loss 0.255 | total 6138.43 | n_correct 4182 | ppl 5.21 | accuracy 68.128 | uer 16.051 | wer 17.713 | raw_wer 17.713 | bleu 27.65 | wps 1689.2 | wpb 6138.4 | bsz 201.1 | num_updates 44000 | best_bleu 27.65
2023-08-27 11:32:17 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44000 updates
2023-08-27 11:32:17 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-27 11:32:18 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-27 11:32:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt (epoch 37 @ 44000 updates, score 27.65) (writing took 11.44525272300234 seconds)
2023-08-27 11:33:03 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:33:36 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.928 | trans_loss 5.177 | nll_loss 2.381 | w2v_ctc_loss 1.233 | task_loss 8.551 | contrastive_loss 0.255 | total 6138.43 | n_correct 4186.57 | ppl 5.21 | accuracy 68.203 | uer 16.067 | wer 17.702 | raw_wer 17.702 | bleu 27.7 | wps 1715.8 | wpb 6138.4 | bsz 201.1 | num_updates 44048 | best_bleu 27.7
2023-08-27 11:33:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44048 updates
2023-08-27 11:33:36 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 11:33:42 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 11:33:46 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 37 @ 44048 updates, score 27.7) (writing took 10.409497090993682 seconds)
2023-08-27 11:33:47 | INFO | fairseq_cli.train | end of epoch 37 (average epoch stats below)
2023-08-27 11:33:47 | INFO | train | epoch 037 | loss 1.784 | trans_loss 4.587 | nll_loss 1.705 | w2v_ctc_loss 0.491 | task_loss 2.35 | contrastive_loss 0.098 | total 6701.4 | n_correct 4897.84 | ppl 3.26 | accuracy 73.087 | wps 16675.7 | ups 1.24 | wpb 13402.8 | bsz 451.5 | num_updates 44048 | lr 6.73832e-05 | gnorm 0.398 | clip 0 | loss_scale 32 | train_wall 852 | gb_free 13.7 | wall 38306
2023-08-27 11:33:47 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 11:33:47 | INFO | fairseq.trainer | begin training epoch 38
2023-08-27 11:33:47 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 11:34:32 | INFO | train_inner | epoch 038:     52 / 1191 loss=1.78, trans_loss=4.588, nll_loss=1.706, w2v_ctc_loss=0.488, task_loss=2.472, contrastive_loss=0.057, total=6590.11, n_correct=4818.68, ppl=3.26, accuracy=73.12, wps=7795.5, ups=0.59, wpb=13180.2, bsz=432.1, num_updates=44100, lr=6.73435e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=71, gb_free=12, wall=38351
2023-08-27 11:35:44 | INFO | train_inner | epoch 038:    152 / 1191 loss=1.774, trans_loss=4.57, nll_loss=1.683, w2v_ctc_loss=0.485, task_loss=2.321, contrastive_loss=0.077, total=6707.39, n_correct=4931.4, ppl=3.21, accuracy=73.522, wps=18730.7, ups=1.4, wpb=13414.8, bsz=449.4, num_updates=44200, lr=6.72673e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=71, gb_free=8.2, wall=38422
2023-08-27 11:36:57 | INFO | train_inner | epoch 038:    252 / 1191 loss=1.789, trans_loss=4.58, nll_loss=1.696, w2v_ctc_loss=0.487, task_loss=2.337, contrastive_loss=0.194, total=6683.44, n_correct=4895.61, ppl=3.24, accuracy=73.25, wps=18429.5, ups=1.38, wpb=13366.9, bsz=456.5, num_updates=44300, lr=6.71913e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=38495
2023-08-27 11:38:09 | INFO | train_inner | epoch 038:    352 / 1191 loss=1.775, trans_loss=4.573, nll_loss=1.687, w2v_ctc_loss=0.49, task_loss=2.407, contrastive_loss=0.059, total=6695.6, n_correct=4917.59, ppl=3.22, accuracy=73.445, wps=18528.8, ups=1.38, wpb=13391.2, bsz=443, num_updates=44400, lr=6.71156e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=38567
2023-08-27 11:39:21 | INFO | train_inner | epoch 038:    452 / 1191 loss=1.778, trans_loss=4.578, nll_loss=1.695, w2v_ctc_loss=0.485, task_loss=2.214, contrastive_loss=0.12, total=6755.69, n_correct=4953.27, ppl=3.24, accuracy=73.32, wps=18678.8, ups=1.38, wpb=13511.4, bsz=476.3, num_updates=44500, lr=6.70402e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=38640
2023-08-27 11:40:34 | INFO | train_inner | epoch 038:    552 / 1191 loss=1.78, trans_loss=4.58, nll_loss=1.698, w2v_ctc_loss=0.484, task_loss=2.27, contrastive_loss=0.114, total=6799.96, n_correct=4988.9, ppl=3.24, accuracy=73.367, wps=18780.1, ups=1.38, wpb=13599.9, bsz=463.7, num_updates=44600, lr=6.6965e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=38712
2023-08-27 11:41:46 | INFO | train_inner | epoch 038:    652 / 1191 loss=1.783, trans_loss=4.588, nll_loss=1.708, w2v_ctc_loss=0.485, task_loss=2.159, contrastive_loss=0.124, total=6826.7, n_correct=4992.68, ppl=3.27, accuracy=73.135, wps=18874.3, ups=1.38, wpb=13653.4, bsz=474.6, num_updates=44700, lr=6.689e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=38784
2023-08-27 11:42:58 | INFO | train_inner | epoch 038:    752 / 1191 loss=1.782, trans_loss=4.586, nll_loss=1.704, w2v_ctc_loss=0.488, task_loss=2.291, contrastive_loss=0.116, total=6730.12, n_correct=4926.84, ppl=3.26, accuracy=73.206, wps=18762.3, ups=1.39, wpb=13460.2, bsz=464.2, num_updates=44800, lr=6.68153e-05, gnorm=0.397, clip=0, loss_scale=32, train_wall=71, gb_free=13.4, wall=38856
2023-08-27 11:44:10 | INFO | train_inner | epoch 038:    852 / 1191 loss=1.782, trans_loss=4.587, nll_loss=1.706, w2v_ctc_loss=0.493, task_loss=2.449, contrastive_loss=0.053, total=6687.39, n_correct=4883.41, ppl=3.26, accuracy=73.024, wps=18472.9, ups=1.38, wpb=13374.8, bsz=435.4, num_updates=44900, lr=6.67409e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=38929
2023-08-27 11:45:22 | INFO | train_inner | epoch 038:    952 / 1191 loss=1.782, trans_loss=4.588, nll_loss=1.707, w2v_ctc_loss=0.488, task_loss=2.368, contrastive_loss=0.077, total=6685.88, n_correct=4889.82, ppl=3.26, accuracy=73.137, wps=18519.6, ups=1.38, wpb=13371.8, bsz=446, num_updates=45000, lr=6.66667e-05, gnorm=0.4, clip=0, loss_scale=64, train_wall=72, gb_free=10.8, wall=39001
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:0')
2023-08-27 11:46:34 | INFO | train_inner | epoch 038:   1052 / 1191 loss=1.788, trans_loss=4.589, nll_loss=1.708, w2v_ctc_loss=0.494, task_loss=2.46, contrastive_loss=0.108, total=6622.97, n_correct=4837.61, ppl=3.27, accuracy=73.043, wps=18434.9, ups=1.39, wpb=13245.9, bsz=440.1, num_updates=45100, lr=6.65927e-05, gnorm=0.404, clip=0, loss_scale=64, train_wall=71, gb_free=12.4, wall=39073
2023-08-27 11:47:47 | INFO | train_inner | epoch 038:   1152 / 1191 loss=1.782, trans_loss=4.59, nll_loss=1.709, w2v_ctc_loss=0.489, task_loss=2.359, contrastive_loss=0.084, total=6688.64, n_correct=4885.56, ppl=3.27, accuracy=73.043, wps=18485.7, ups=1.38, wpb=13377.3, bsz=448.4, num_updates=45200, lr=6.6519e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=13.2, wall=39145
2023-08-27 11:48:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2468, device='cuda:3')
2023-08-27 11:48:47 | INFO | dev_st | epoch 038 | valid on 'dev_st' subset | loss 3.931 | trans_loss 5.179 | nll_loss 2.382 | w2v_ctc_loss 1.24 | task_loss 8.564 | contrastive_loss 0.254 | total 6138.43 | n_correct 4186.57 | ppl 5.21 | accuracy 68.203 | uer 16.059 | wer 17.806 | raw_wer 17.806 | bleu 27.61 | wps 1754 | wpb 6138.4 | bsz 201.1 | num_updates 45239 | best_bleu 27.7
2023-08-27 11:48:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 38 @ 45239 updates
2023-08-27 11:48:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6107.pt
2023-08-27 11:48:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6107.pt
2023-08-27 11:48:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6107.pt (epoch 38 @ 45239 updates, score 27.61) (writing took 6.630996964988299 seconds)
2023-08-27 11:48:54 | INFO | fairseq_cli.train | end of epoch 38 (average epoch stats below)
2023-08-27 11:48:54 | INFO | train | epoch 038 | loss 1.781 | trans_loss 4.583 | nll_loss 1.7 | w2v_ctc_loss 0.488 | task_loss 2.345 | contrastive_loss 0.1 | total 6703.69 | n_correct 4909.14 | ppl 3.25 | accuracy 73.23 | wps 17607.8 | ups 1.31 | wpb 13407.4 | bsz 452.1 | num_updates 45239 | lr 6.64903e-05 | gnorm 0.398 | clip 0 | loss_scale 64 | train_wall 853 | gb_free 14.1 | wall 39212
2023-08-27 11:48:54 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 11:48:54 | INFO | fairseq.trainer | begin training epoch 39
2023-08-27 11:48:54 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 11:49:46 | INFO | train_inner | epoch 039:     61 / 1191 loss=1.78, trans_loss=4.585, nll_loss=1.702, w2v_ctc_loss=0.489, task_loss=2.655, contrastive_loss=0.059, total=6527.07, n_correct=4779.77, ppl=3.25, accuracy=73.23, wps=10932.8, ups=0.84, wpb=13054.1, bsz=420.4, num_updates=45300, lr=6.64455e-05, gnorm=0.403, clip=0, loss_scale=64, train_wall=71, gb_free=10.3, wall=39264
2023-08-27 11:50:59 | INFO | train_inner | epoch 039:    161 / 1191 loss=1.769, trans_loss=4.564, nll_loss=1.675, w2v_ctc_loss=0.482, task_loss=2.387, contrastive_loss=0.057, total=6683.06, n_correct=4918.47, ppl=3.19, accuracy=73.596, wps=18372.3, ups=1.37, wpb=13366.1, bsz=440.5, num_updates=45400, lr=6.63723e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=13, wall=39337
2023-08-27 11:52:11 | INFO | train_inner | epoch 039:    261 / 1191 loss=1.781, trans_loss=4.58, nll_loss=1.696, w2v_ctc_loss=0.487, task_loss=2.415, contrastive_loss=0.129, total=6673.47, n_correct=4891.56, ppl=3.24, accuracy=73.299, wps=18441.2, ups=1.38, wpb=13346.9, bsz=445, num_updates=45500, lr=6.62994e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=39409
2023-08-27 11:53:24 | INFO | train_inner | epoch 039:    361 / 1191 loss=1.778, trans_loss=4.577, nll_loss=1.692, w2v_ctc_loss=0.489, task_loss=2.548, contrastive_loss=0.079, total=6602.39, n_correct=4839.19, ppl=3.23, accuracy=73.295, wps=18054.6, ups=1.37, wpb=13204.8, bsz=427.5, num_updates=45600, lr=6.62266e-05, gnorm=0.401, clip=0, loss_scale=64, train_wall=73, gb_free=12.7, wall=39483
2023-08-27 11:54:37 | INFO | train_inner | epoch 039:    461 / 1191 loss=1.778, trans_loss=4.576, nll_loss=1.691, w2v_ctc_loss=0.478, task_loss=2.261, contrastive_loss=0.135, total=6752.25, n_correct=4952.15, ppl=3.23, accuracy=73.341, wps=18684.9, ups=1.38, wpb=13504.5, bsz=462.8, num_updates=45700, lr=6.61541e-05, gnorm=0.397, clip=0, loss_scale=64, train_wall=72, gb_free=14.4, wall=39555
2023-08-27 11:54:57 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 11:55:49 | INFO | train_inner | epoch 039:    562 / 1191 loss=1.774, trans_loss=4.574, nll_loss=1.689, w2v_ctc_loss=0.481, task_loss=2.375, contrastive_loss=0.083, total=6680.3, n_correct=4904.91, ppl=3.22, accuracy=73.423, wps=18357.9, ups=1.37, wpb=13360.6, bsz=446.3, num_updates=45800, lr=6.60819e-05, gnorm=0.402, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=39628
2023-08-27 11:57:02 | INFO | train_inner | epoch 039:    662 / 1191 loss=1.783, trans_loss=4.585, nll_loss=1.703, w2v_ctc_loss=0.487, task_loss=2.315, contrastive_loss=0.12, total=6717.92, n_correct=4913.51, ppl=3.26, accuracy=73.14, wps=18578.1, ups=1.38, wpb=13435.8, bsz=463.2, num_updates=45900, lr=6.60098e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=6.4, wall=39700
2023-08-27 11:58:14 | INFO | train_inner | epoch 039:    762 / 1191 loss=1.779, trans_loss=4.583, nll_loss=1.7, w2v_ctc_loss=0.485, task_loss=2.328, contrastive_loss=0.102, total=6736.15, n_correct=4934.67, ppl=3.25, accuracy=73.257, wps=18691.2, ups=1.39, wpb=13472.3, bsz=455.3, num_updates=46000, lr=6.5938e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=39772
2023-08-27 11:58:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 11:58:46 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.93 | trans_loss 5.179 | nll_loss 2.382 | w2v_ctc_loss 1.237 | task_loss 8.53 | contrastive_loss 0.255 | total 6138.43 | n_correct 4183.57 | ppl 5.21 | accuracy 68.154 | uer 16.145 | wer 17.832 | raw_wer 17.832 | bleu 27.47 | wps 1760.4 | wpb 6138.4 | bsz 201.1 | num_updates 46000 | best_bleu 27.7
2023-08-27 11:58:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46000 updates
2023-08-27 11:58:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-27 11:58:48 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-27 11:58:52 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt (epoch 39 @ 46000 updates, score 27.47) (writing took 5.7669700270053 seconds)
2023-08-27 12:00:05 | INFO | train_inner | epoch 039:    862 / 1191 loss=1.778, trans_loss=4.584, nll_loss=1.703, w2v_ctc_loss=0.484, task_loss=2.224, contrastive_loss=0.094, total=6798.2, n_correct=4978.67, ppl=3.25, accuracy=73.235, wps=12227.1, ups=0.9, wpb=13596.4, bsz=472.1, num_updates=46100, lr=6.58665e-05, gnorm=0.4, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=39883
2023-08-27 12:01:18 | INFO | train_inner | epoch 039:    962 / 1191 loss=1.775, trans_loss=4.574, nll_loss=1.69, w2v_ctc_loss=0.48, task_loss=2.154, contrastive_loss=0.121, total=6835.31, n_correct=5018.71, ppl=3.23, accuracy=73.423, wps=18826.4, ups=1.38, wpb=13670.6, bsz=480.9, num_updates=46200, lr=6.57952e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=39956
2023-08-27 12:02:29 | INFO | train_inner | epoch 039:   1062 / 1191 loss=1.777, trans_loss=4.579, nll_loss=1.696, w2v_ctc_loss=0.479, task_loss=2.268, contrastive_loss=0.105, total=6757.98, n_correct=4951.75, ppl=3.24, accuracy=73.273, wps=18887.9, ups=1.4, wpb=13516, bsz=459.7, num_updates=46300, lr=6.57241e-05, gnorm=0.396, clip=0, loss_scale=32, train_wall=71, gb_free=14.5, wall=40027
2023-08-27 12:03:41 | INFO | train_inner | epoch 039:   1162 / 1191 loss=1.787, trans_loss=4.591, nll_loss=1.711, w2v_ctc_loss=0.496, task_loss=2.461, contrastive_loss=0.082, total=6582.59, n_correct=4807.08, ppl=3.27, accuracy=73.027, wps=18331.1, ups=1.39, wpb=13165.2, bsz=428.8, num_updates=46400, lr=6.56532e-05, gnorm=0.406, clip=0, loss_scale=32, train_wall=71, gb_free=14.3, wall=40099
2023-08-27 12:04:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 12:04:35 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.918 | trans_loss 5.176 | nll_loss 2.378 | w2v_ctc_loss 1.208 | task_loss 8.512 | contrastive_loss 0.239 | total 6138.43 | n_correct 4193 | ppl 5.2 | accuracy 68.307 | uer 15.917 | wer 17.828 | raw_wer 17.828 | bleu 27.65 | wps 1666.9 | wpb 6138.4 | bsz 201.1 | num_updates 46429 | best_bleu 27.7
2023-08-27 12:04:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46429 updates
2023-08-27 12:04:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6503.pt
2023-08-27 12:04:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6503.pt
2023-08-27 12:04:41 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.6503.pt (epoch 39 @ 46429 updates, score 27.65) (writing took 6.196728921990143 seconds)
2023-08-27 12:04:42 | INFO | fairseq_cli.train | end of epoch 39 (average epoch stats below)
2023-08-27 12:04:42 | INFO | train | epoch 039 | loss 1.778 | trans_loss 4.579 | nll_loss 1.695 | w2v_ctc_loss 0.484 | task_loss 2.346 | contrastive_loss 0.098 | total 6702.46 | n_correct 4913.45 | ppl 3.24 | accuracy 73.308 | wps 16833.1 | ups 1.26 | wpb 13404.9 | bsz 451.8 | num_updates 46429 | lr 6.56327e-05 | gnorm 0.399 | clip 0 | loss_scale 32 | train_wall 854 | gb_free 13.3 | wall 40160
2023-08-27 12:04:42 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 12:04:42 | INFO | fairseq.trainer | begin training epoch 40
2023-08-27 12:04:42 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 12:05:40 | INFO | train_inner | epoch 040:     71 / 1191 loss=1.766, trans_loss=4.563, nll_loss=1.675, w2v_ctc_loss=0.475, task_loss=2.229, contrastive_loss=0.083, total=6767.38, n_correct=4986.47, ppl=3.19, accuracy=73.684, wps=11318.3, ups=0.84, wpb=13534.8, bsz=468.9, num_updates=46500, lr=6.55826e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=71, gb_free=13.4, wall=40219
2023-08-27 12:06:52 | INFO | train_inner | epoch 040:    171 / 1191 loss=1.765, trans_loss=4.561, nll_loss=1.672, w2v_ctc_loss=0.481, task_loss=2.331, contrastive_loss=0.05, total=6723.92, n_correct=4961.32, ppl=3.19, accuracy=73.786, wps=18774.9, ups=1.4, wpb=13447.8, bsz=450.2, num_updates=46600, lr=6.55122e-05, gnorm=0.395, clip=0, loss_scale=32, train_wall=71, gb_free=14.1, wall=40291
2023-08-27 12:08:04 | INFO | train_inner | epoch 040:    271 / 1191 loss=1.765, trans_loss=4.563, nll_loss=1.676, w2v_ctc_loss=0.475, task_loss=2.227, contrastive_loss=0.083, total=6753.31, n_correct=4975.37, ppl=3.19, accuracy=73.673, wps=18706.9, ups=1.39, wpb=13506.6, bsz=465.8, num_updates=46700, lr=6.5442e-05, gnorm=0.392, clip=0, loss_scale=32, train_wall=72, gb_free=15, wall=40363
2023-08-27 12:09:17 | INFO | train_inner | epoch 040:    371 / 1191 loss=1.776, trans_loss=4.572, nll_loss=1.686, w2v_ctc_loss=0.48, task_loss=2.487, contrastive_loss=0.109, total=6618.47, n_correct=4862.16, ppl=3.22, accuracy=73.464, wps=18290, ups=1.38, wpb=13236.9, bsz=438.2, num_updates=46800, lr=6.5372e-05, gnorm=0.399, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=40435
2023-08-27 12:10:28 | INFO | train_inner | epoch 040:    471 / 1191 loss=1.767, trans_loss=4.572, nll_loss=1.686, w2v_ctc_loss=0.476, task_loss=2.315, contrastive_loss=0.05, total=6719.05, n_correct=4942.02, ppl=3.22, accuracy=73.552, wps=18785.5, ups=1.4, wpb=13438.1, bsz=454.8, num_updates=46900, lr=6.53023e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=71, gb_free=14.1, wall=40507
2023-08-27 12:11:40 | INFO | train_inner | epoch 040:    571 / 1191 loss=1.772, trans_loss=4.571, nll_loss=1.686, w2v_ctc_loss=0.47, task_loss=2.295, contrastive_loss=0.158, total=6684.61, n_correct=4917.41, ppl=3.22, accuracy=73.563, wps=18625.9, ups=1.39, wpb=13369.2, bsz=455.8, num_updates=47000, lr=6.52328e-05, gnorm=0.394, clip=0, loss_scale=32, train_wall=71, gb_free=12.2, wall=40578
2023-08-27 12:12:53 | INFO | train_inner | epoch 040:    671 / 1191 loss=1.784, trans_loss=4.578, nll_loss=1.693, w2v_ctc_loss=0.484, task_loss=2.368, contrastive_loss=0.162, total=6699.46, n_correct=4911.53, ppl=3.23, accuracy=73.312, wps=18421.8, ups=1.37, wpb=13398.9, bsz=447.6, num_updates=47100, lr=6.51635e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=7.9, wall=40651
2023-08-27 12:14:05 | INFO | train_inner | epoch 040:    771 / 1191 loss=1.777, trans_loss=4.58, nll_loss=1.696, w2v_ctc_loss=0.489, task_loss=2.41, contrastive_loss=0.063, total=6659.73, n_correct=4881.49, ppl=3.24, accuracy=73.299, wps=18497.3, ups=1.39, wpb=13319.5, bsz=443.6, num_updates=47200, lr=6.50945e-05, gnorm=0.405, clip=0, loss_scale=32, train_wall=72, gb_free=12.5, wall=40723
2023-08-27 12:15:18 | INFO | train_inner | epoch 040:    871 / 1191 loss=1.782, trans_loss=4.584, nll_loss=1.702, w2v_ctc_loss=0.491, task_loss=2.437, contrastive_loss=0.092, total=6696.57, n_correct=4901.37, ppl=3.25, accuracy=73.192, wps=18299.8, ups=1.37, wpb=13393.1, bsz=441.7, num_updates=47300, lr=6.50256e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=73, gb_free=14.4, wall=40796
2023-08-27 12:16:30 | INFO | train_inner | epoch 040:    971 / 1191 loss=1.782, trans_loss=4.585, nll_loss=1.704, w2v_ctc_loss=0.483, task_loss=2.303, contrastive_loss=0.129, total=6694.1, n_correct=4901.86, ppl=3.26, accuracy=73.227, wps=18543.8, ups=1.39, wpb=13388.2, bsz=455.1, num_updates=47400, lr=6.4957e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=72, gb_free=10.4, wall=40869
2023-08-27 12:17:43 | INFO | train_inner | epoch 040:   1071 / 1191 loss=1.777, trans_loss=4.58, nll_loss=1.698, w2v_ctc_loss=0.487, task_loss=2.344, contrastive_loss=0.082, total=6744.49, n_correct=4945.05, ppl=3.25, accuracy=73.32, wps=18538, ups=1.37, wpb=13489, bsz=455.8, num_updates=47500, lr=6.48886e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=40941
2023-08-27 12:18:55 | INFO | train_inner | epoch 040:   1171 / 1191 loss=1.775, trans_loss=4.579, nll_loss=1.697, w2v_ctc_loss=0.477, task_loss=2.283, contrastive_loss=0.114, total=6706.26, n_correct=4916.14, ppl=3.24, accuracy=73.307, wps=18721.7, ups=1.4, wpb=13412.5, bsz=463.1, num_updates=47600, lr=6.48204e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=71, gb_free=14.6, wall=41013
2023-08-27 12:19:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 12:19:41 | INFO | dev_st | epoch 040 | valid on 'dev_st' subset | loss 3.922 | trans_loss 5.181 | nll_loss 2.384 | w2v_ctc_loss 1.208 | task_loss 8.562 | contrastive_loss 0.247 | total 6138.43 | n_correct 4184.43 | ppl 5.22 | accuracy 68.168 | uer 15.95 | wer 17.624 | raw_wer 17.624 | bleu 27.78 | wps 1767 | wpb 6138.4 | bsz 201.1 | num_updates 47620 | best_bleu 27.78
2023-08-27 12:19:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 40 @ 47620 updates
2023-08-27 12:19:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 12:19:47 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-27 12:19:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 40 @ 47620 updates, score 27.78) (writing took 11.510678652994102 seconds)
2023-08-27 12:19:53 | INFO | fairseq_cli.train | end of epoch 40 (average epoch stats below)
2023-08-27 12:19:53 | INFO | train | epoch 040 | loss 1.774 | trans_loss 4.574 | nll_loss 1.689 | w2v_ctc_loss 0.481 | task_loss 2.344 | contrastive_loss 0.098 | total 6703.69 | n_correct 4923.23 | ppl 3.23 | accuracy 73.441 | wps 17524.1 | ups 1.31 | wpb 13407.4 | bsz 452.1 | num_updates 47620 | lr 6.48068e-05 | gnorm 0.398 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 12.1 | wall 41071
2023-08-27 12:19:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 12:19:53 | INFO | fairseq.trainer | begin training epoch 41
2023-08-27 12:19:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 12:20:58 | INFO | train_inner | epoch 041:     80 / 1191 loss=1.771, trans_loss=4.567, nll_loss=1.68, w2v_ctc_loss=0.478, task_loss=2.337, contrastive_loss=0.117, total=6708.43, n_correct=4932.48, ppl=3.2, accuracy=73.527, wps=10844.8, ups=0.81, wpb=13416.9, bsz=461.1, num_updates=47700, lr=6.47524e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=41137
2023-08-27 12:22:10 | INFO | train_inner | epoch 041:    180 / 1191 loss=1.778, trans_loss=4.567, nll_loss=1.68, w2v_ctc_loss=0.479, task_loss=2.389, contrastive_loss=0.147, total=6679.28, n_correct=4908.19, ppl=3.2, accuracy=73.484, wps=18562.6, ups=1.39, wpb=13358.6, bsz=446.1, num_updates=47800, lr=6.46846e-05, gnorm=0.403, clip=0, loss_scale=64, train_wall=71, gb_free=13, wall=41209
2023-08-27 12:23:23 | INFO | train_inner | epoch 041:    280 / 1191 loss=1.763, trans_loss=4.563, nll_loss=1.675, w2v_ctc_loss=0.466, task_loss=2.207, contrastive_loss=0.105, total=6799.31, n_correct=5015.72, ppl=3.19, accuracy=73.768, wps=18803.1, ups=1.38, wpb=13598.6, bsz=478, num_updates=47900, lr=6.46171e-05, gnorm=0.398, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=41281
2023-08-27 12:24:35 | INFO | train_inner | epoch 041:    380 / 1191 loss=1.765, trans_loss=4.566, nll_loss=1.678, w2v_ctc_loss=0.478, task_loss=2.256, contrastive_loss=0.053, total=6787.95, n_correct=4997.28, ppl=3.2, accuracy=73.62, wps=18752.9, ups=1.38, wpb=13575.9, bsz=460.8, num_updates=48000, lr=6.45497e-05, gnorm=0.395, clip=0, loss_scale=64, train_wall=72, gb_free=14.1, wall=41353
2023-08-27 12:24:35 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 12:25:07 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.925 | trans_loss 5.185 | nll_loss 2.389 | w2v_ctc_loss 1.209 | task_loss 8.521 | contrastive_loss 0.25 | total 6138.43 | n_correct 4181.57 | ppl 5.24 | accuracy 68.121 | uer 15.968 | wer 17.646 | raw_wer 17.646 | bleu 27.38 | wps 1756.1 | wpb 6138.4 | bsz 201.1 | num_updates 48000 | best_bleu 27.78
2023-08-27 12:25:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48000 updates
2023-08-27 12:25:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-27 12:25:10 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-27 12:25:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt (epoch 41 @ 48000 updates, score 27.38) (writing took 6.722123823012225 seconds)
2023-08-27 12:26:27 | INFO | train_inner | epoch 041:    480 / 1191 loss=1.765, trans_loss=4.568, nll_loss=1.681, w2v_ctc_loss=0.479, task_loss=2.286, contrastive_loss=0.049, total=6778.68, n_correct=4992.77, ppl=3.21, accuracy=73.654, wps=12063.2, ups=0.89, wpb=13557.4, bsz=458.9, num_updates=48100, lr=6.44826e-05, gnorm=0.394, clip=0, loss_scale=64, train_wall=72, gb_free=14.6, wall=41466
2023-08-27 12:27:39 | INFO | train_inner | epoch 041:    580 / 1191 loss=1.763, trans_loss=4.564, nll_loss=1.676, w2v_ctc_loss=0.469, task_loss=2.217, contrastive_loss=0.07, total=6784.72, n_correct=5000.06, ppl=3.19, accuracy=73.696, wps=18937.7, ups=1.4, wpb=13569.4, bsz=462, num_updates=48200, lr=6.44157e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=71, gb_free=13.9, wall=41537
2023-08-27 12:28:51 | INFO | train_inner | epoch 041:    680 / 1191 loss=1.772, trans_loss=4.57, nll_loss=1.684, w2v_ctc_loss=0.483, task_loss=2.357, contrastive_loss=0.094, total=6684.16, n_correct=4913.5, ppl=3.21, accuracy=73.51, wps=18547.4, ups=1.39, wpb=13368.3, bsz=449.7, num_updates=48300, lr=6.43489e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=71, gb_free=8.1, wall=41610
2023-08-27 12:30:03 | INFO | train_inner | epoch 041:    780 / 1191 loss=1.777, trans_loss=4.576, nll_loss=1.692, w2v_ctc_loss=0.485, task_loss=2.582, contrastive_loss=0.084, total=6538.9, n_correct=4796.38, ppl=3.23, accuracy=73.351, wps=18066.9, ups=1.38, wpb=13077.8, bsz=421.6, num_updates=48400, lr=6.42824e-05, gnorm=0.406, clip=0, loss_scale=64, train_wall=72, gb_free=14.4, wall=41682
2023-08-27 12:31:16 | INFO | train_inner | epoch 041:    880 / 1191 loss=1.776, trans_loss=4.574, nll_loss=1.689, w2v_ctc_loss=0.484, task_loss=2.527, contrastive_loss=0.089, total=6585.34, n_correct=4835.85, ppl=3.22, accuracy=73.434, wps=18127.3, ups=1.38, wpb=13170.7, bsz=427.6, num_updates=48500, lr=6.42161e-05, gnorm=0.405, clip=0, loss_scale=64, train_wall=72, gb_free=8.2, wall=41755
2023-08-27 12:32:29 | INFO | train_inner | epoch 041:    980 / 1191 loss=1.779, trans_loss=4.58, nll_loss=1.698, w2v_ctc_loss=0.485, task_loss=2.475, contrastive_loss=0.096, total=6665.41, n_correct=4880.55, ppl=3.24, accuracy=73.222, wps=18270, ups=1.37, wpb=13330.8, bsz=440.6, num_updates=48600, lr=6.415e-05, gnorm=0.403, clip=0, loss_scale=64, train_wall=72, gb_free=14.6, wall=41828
2023-08-27 12:33:42 | INFO | train_inner | epoch 041:   1080 / 1191 loss=1.772, trans_loss=4.576, nll_loss=1.692, w2v_ctc_loss=0.473, task_loss=2.179, contrastive_loss=0.129, total=6840.57, n_correct=5026, ppl=3.23, accuracy=73.473, wps=18842.1, ups=1.38, wpb=13681.1, bsz=479.5, num_updates=48700, lr=6.40841e-05, gnorm=0.392, clip=0, loss_scale=64, train_wall=72, gb_free=14.9, wall=41900
2023-08-27 12:34:53 | INFO | train_inner | epoch 041:   1180 / 1191 loss=1.782, trans_loss=4.583, nll_loss=1.701, w2v_ctc_loss=0.484, task_loss=2.479, contrastive_loss=0.133, total=6594.78, n_correct=4829.94, ppl=3.25, accuracy=73.239, wps=18399, ups=1.39, wpb=13189.6, bsz=431.4, num_updates=48800, lr=6.40184e-05, gnorm=0.401, clip=0, loss_scale=64, train_wall=71, gb_free=12, wall=41972
2023-08-27 12:35:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 12:35:35 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.932 | trans_loss 5.184 | nll_loss 2.387 | w2v_ctc_loss 1.235 | task_loss 8.549 | contrastive_loss 0.246 | total 6138.43 | n_correct 4174.29 | ppl 5.23 | accuracy 68.003 | uer 15.907 | wer 17.635 | raw_wer 17.635 | bleu 27.39 | wps 1667 | wpb 6138.4 | bsz 201.1 | num_updates 48811 | best_bleu 27.78
2023-08-27 12:35:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48811 updates
2023-08-27 12:35:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 12:35:40 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-27 12:35:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 41 @ 48811 updates, score 27.39) (writing took 5.702781368017895 seconds)
2023-08-27 12:35:40 | INFO | fairseq_cli.train | end of epoch 41 (average epoch stats below)
2023-08-27 12:35:40 | INFO | train | epoch 041 | loss 1.772 | trans_loss 4.571 | nll_loss 1.685 | w2v_ctc_loss 0.478 | task_loss 2.348 | contrastive_loss 0.098 | total 6703.69 | n_correct 4927.78 | ppl 3.22 | accuracy 73.508 | wps 16852.8 | ups 1.26 | wpb 13407.4 | bsz 452.1 | num_updates 48811 | lr 6.40112e-05 | gnorm 0.4 | clip 0 | loss_scale 64 | train_wall 854 | gb_free 11.5 | wall 42019
2023-08-27 12:35:41 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-27 12:35:41 | INFO | fairseq.trainer | begin training epoch 42
2023-08-27 12:35:41 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-27 12:36:52 | INFO | train_inner | epoch 042:     89 / 1191 loss=1.76, trans_loss=4.552, nll_loss=1.662, w2v_ctc_loss=0.464, task_loss=2.09, contrastive_loss=0.12, total=6830.39, n_correct=5049.82, ppl=3.16, accuracy=73.932, wps=11556.9, ups=0.85, wpb=13660.8, bsz=486.2, num_updates=48900, lr=6.39529e-05, gnorm=0.396, clip=0, loss_scale=64, train_wall=71, gb_free=13.1, wall=42090
2023-08-27 12:38:04 | INFO | train_inner | epoch 042:    189 / 1191 loss=1.778, trans_loss=4.566, nll_loss=1.679, w2v_ctc_loss=0.477, task_loss=2.428, contrastive_loss=0.172, total=6676.16, n_correct=4909.86, ppl=3.2, accuracy=73.543, wps=18425.6, ups=1.38, wpb=13352.3, bsz=441.6, num_updates=49000, lr=6.38877e-05, gnorm=0.409, clip=0, loss_scale=64, train_wall=72, gb_free=8.3, wall=42163
2023-08-27 12:39:17 | INFO | train_inner | epoch 042:    289 / 1191 loss=1.772, trans_loss=4.562, nll_loss=1.673, w2v_ctc_loss=0.483, task_loss=2.407, contrastive_loss=0.101, total=6646.38, n_correct=4892.56, ppl=3.19, accuracy=73.612, wps=18354.1, ups=1.38, wpb=13292.8, bsz=444.2, num_updates=49100, lr=6.38226e-05, gnorm=0.407, clip=0, loss_scale=64, train_wall=72, gb_free=15.1, wall=42235
2023-08-27 12:40:29 | INFO | train_inner | epoch 042:    389 / 1191 loss=1.764, trans_loss=4.561, nll_loss=1.672, w2v_ctc_loss=0.473, task_loss=2.413, contrastive_loss=0.088, total=6624.92, n_correct=4888.81, ppl=3.19, accuracy=73.794, wps=18370.1, ups=1.39, wpb=13249.8, bsz=445.7, num_updates=49200, lr=6.37577e-05, gnorm=0.399, clip=0, loss_scale=64, train_wall=72, gb_free=13.5, wall=42307
2023-08-27 12:41:42 | INFO | train_inner | epoch 042:    489 / 1191 loss=1.771, trans_loss=4.572, nll_loss=1.686, w2v_ctc_loss=0.481, task_loss=2.614, contrastive_loss=0.047, total=6627.21, n_correct=4871.63, ppl=3.22, accuracy=73.51, wps=18073, ups=1.36, wpb=13254.4, bsz=421.1, num_updates=49300, lr=6.3693e-05, gnorm=0.402, clip=0, loss_scale=64, train_wall=73, gb_free=7.8, wall=42380
2023-08-27 12:42:54 | INFO | train_inner | epoch 042:    589 / 1191 loss=1.78, trans_loss=4.576, nll_loss=1.691, w2v_ctc_loss=0.486, task_loss=2.492, contrastive_loss=0.127, total=6612.24, n_correct=4850.88, ppl=3.23, accuracy=73.362, wps=18426.4, ups=1.39, wpb=13224.5, bsz=433.3, num_updates=49400, lr=6.36285e-05, gnorm=0.405, clip=0, loss_scale=64, train_wall=71, gb_free=11.1, wall=42452
2023-08-27 12:43:53 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-27 12:44:07 | INFO | train_inner | epoch 042:    690 / 1191 loss=1.762, trans_loss=4.565, nll_loss=1.678, w2v_ctc_loss=0.471, task_loss=2.169, contrastive_loss=0.066, total=6807.89, n_correct=5018.07, ppl=3.2, accuracy=73.71, wps=18647.4, ups=1.37, wpb=13615.8, bsz=474.7, num_updates=49500, lr=6.35642e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=73, gb_free=8.7, wall=42525
2023-08-27 12:45:19 | INFO | train_inner | epoch 042:    790 / 1191 loss=1.772, trans_loss=4.575, nll_loss=1.692, w2v_ctc_loss=0.478, task_loss=2.25, contrastive_loss=0.094, total=6715.54, n_correct=4938.25, ppl=3.23, accuracy=73.535, wps=18634.6, ups=1.39, wpb=13431.1, bsz=463.9, num_updates=49600, lr=6.35001e-05, gnorm=0.403, clip=0, loss_scale=32, train_wall=71, gb_free=13.4, wall=42597
2023-08-27 12:46:30 | INFO | train_inner | epoch 042:    890 / 1191 loss=1.763, trans_loss=4.563, nll_loss=1.675, w2v_ctc_loss=0.474, task_loss=2.413, contrastive_loss=0.055, total=6567.62, n_correct=4841.16, ppl=3.19, accuracy=73.713, wps=18408.4, ups=1.4, wpb=13135.2, bsz=440.7, num_updates=49700, lr=6.34361e-05, gnorm=0.404, clip=0, loss_scale=32, train_wall=71, gb_free=13.3, wall=42669
2023-08-27 12:47:43 | INFO | train_inner | epoch 042:    990 / 1191 loss=1.77, trans_loss=4.57, nll_loss=1.685, w2v_ctc_loss=0.473, task_loss=2.128, contrastive_loss=0.128, total=6827.16, n_correct=5022.96, ppl=3.22, accuracy=73.573, wps=18871.5, ups=1.38, wpb=13654.3, bsz=484, num_updates=49800, lr=6.33724e-05, gnorm=0.398, clip=0, loss_scale=32, train_wall=72, gb_free=14.7, wall=42741
2023-08-27 12:48:55 | INFO | train_inner | epoch 042:   1090 / 1191 loss=1.771, trans_loss=4.574, nll_loss=1.688, w2v_ctc_loss=0.48, task_loss=2.546, contrastive_loss=0.043, total=6664.62, n_correct=4891.58, ppl=3.22, accuracy=73.396, wps=18552.2, ups=1.39, wpb=13329.2, bsz=421.6, num_updates=49900, lr=6.33089e-05, gnorm=0.401, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=42813
2023-08-27 12:50:07 | INFO | train_inner | epoch 042:   1190 / 1191 loss=1.767, trans_loss=4.572, nll_loss=1.687, w2v_ctc_loss=0.474, task_loss=2.263, contrastive_loss=0.074, total=6824.38, n_correct=5019.02, ppl=3.22, accuracy=73.545, wps=18845.6, ups=1.38, wpb=13648.8, bsz=463.9, num_updates=50000, lr=6.32456e-05, gnorm=0.393, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=42886
2023-08-27 12:50:07 | INFO | fairseq_cli.train | Stopping training due to num_updates: 50000 >= max_update: 50000
2023-08-27 12:50:07 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-27 12:50:40 | INFO | dev_st | epoch 042 | valid on 'dev_st' subset | loss 3.93 | trans_loss 5.183 | nll_loss 2.389 | w2v_ctc_loss 1.228 | task_loss 8.54 | contrastive_loss 0.245 | total 6138.43 | n_correct 4182.14 | ppl 5.24 | accuracy 68.131 | uer 16.22 | wer 17.977 | raw_wer 17.977 | bleu 27.65 | wps 1767 | wpb 6138.4 | bsz 201.1 | num_updates 50000 | best_bleu 27.78
2023-08-27 12:50:40 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 42 @ 50000 updates
2023-08-27 12:50:40 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_42_50000.pt
2023-08-27 12:50:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_42_50000.pt
2023-08-27 12:50:47 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_mustc_0827_both_topCL_AT_sentence_mixup0109_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_42_50000.pt (epoch 42 @ 50000 updates, score 27.65) (writing took 7.049711283994839 seconds)
2023-08-27 12:50:47 | INFO | fairseq_cli.train | end of epoch 42 (average epoch stats below)
2023-08-27 12:50:47 | INFO | train | epoch 042 | loss 1.769 | trans_loss 4.567 | nll_loss 1.681 | w2v_ctc_loss 0.476 | task_loss 2.343 | contrastive_loss 0.094 | total 6705.34 | n_correct 4935.25 | ppl 3.21 | accuracy 73.602 | wps 17587.5 | ups 1.31 | wpb 13410.7 | bsz 452 | num_updates 50000 | lr 6.32456e-05 | gnorm 0.401 | clip 0 | loss_scale 32 | train_wall 853 | gb_free 14.4 | wall 42925
2023-08-27 12:50:47 | INFO | fairseq_cli.train | done training in 42871.8 seconds
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    raise EOFError
EOFError
    raise EOFError
EOFError
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1728 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
