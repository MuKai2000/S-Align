2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 3): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 1): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 6): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 2): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 0): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 4): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 5): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | fairseq.distributed.utils | distributed init (rank 7): tcp://localhost:10035
2023-08-29 11:00:09 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 7
2023-08-29 11:00:09 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 4
2023-08-29 11:00:09 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 5
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 3
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 1
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 6
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 2
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:1 to store for rank: 0
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 0
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 5
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 1
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 6
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 2
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 3
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 4
2023-08-29 11:00:10 | INFO | torch.distributed.distributed_c10d | Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2023-08-29 11:00:10 | INFO | fairseq.distributed.utils | initialized host localhost.localdomain as rank 7
2023-08-29 11:00:14 | INFO | fairseq_cli.train | {'_name': None, 'common': {'_name': None, 'no_progress_bar': True, 'log_interval': 100, 'log_format': None, 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': 'sentencepiece', 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:10035', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': 'no_c10d', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 11000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train_st,train_asr', 'valid_subset': 'dev_st', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 11000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 50000, 'stop_time_hours': 0.0, 'clip_norm': 10.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.0002], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False}, 'checkpoint': {'_name': None, 'save_dir': './checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 2000, 'keep_interval_updates': 5, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': 2, 'keep_best_checkpoints': 10, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='s2t_joint', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'task': Namespace(_name='joint_triple_pretraining_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'criterion': Namespace(_name='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adapter_dim=4096, adapter_dropout=0.0, adapter_layers=0, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_position_embed=True, add_position_embed_after_ctc=True, add_proj_norm=False, adversarial_training=True, aim_repo=None, aim_run_hash=None, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, apply_mask=True, arch='s2t_joint', at_adapte_win=False, at_level='sentence', at_low_pos=False, at_nomute=False, at_nopad=True, at_scale=2.5, attention_dropout=0.1, avg_shrink=False, azureml_logging=False, ban_cl_step=-1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='bleu', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=10.0, cluster_embed_path='', cnn_module_kernel=31, combine_valid_subsets=None, config_yaml='config_st.yaml', continue_once=None, contrastive_alpha=1.5, contrastive_beta=1.0, contrastive_temperature=0.1, conv_channels=512, conv_kernel_sizes='5,5', cpu=False, cpu_offload=False, criterion='label_smoothed_cross_entropy_with_w2v_ctc_shrink_joint_AT_merge', ctc_weight=0.3, curriculum=0, data='data_all_enfr_lcrm', data_buffer_size=10, dataset_impl=None, ddp_backend='no_c10d', ddp_comm_hook='none', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline', decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layerdrop=0.0, decoder_layers=6, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=512, decrease_step=0, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, dropout=0.1, dropout_input=0.0, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, embed_path='', embedding_l2norm=False, empty_cache_freq=0, encoder_attention_heads=8, encoder_embed_dim=512, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_normalize_before=True, eos=2, eval_bleu=True, eval_bleu_args='{}', eval_bleu_detok='space', eval_bleu_detok_args='{}', eval_bleu_remove_bpe='sentencepiece', eval_tokenized_bleu=True, fast_stat_sync=False, feature_grad_mult=0.0, final_dropout=0.1, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, fp32_reduce_scatter=False, freeze_finetune_updates=3000, gen_subset='test', get_similarity=False, gradient_as_bucket_view=False, grouped_shuffling=False, heartbeat_timeout=-1, ignore_prefix_size=0, ignore_unused_valid_subsets=False, is_shrink='uniq', keep_best_checkpoints=10, keep_interval_updates=5, keep_interval_updates_pattern=-1, keep_last_epochs=2, keep_mt_task=True, label_smoothing=0.2, latent_temp=(1, 0.1, 0.999995), layerdrop=0.0, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format=None, log_interval=100, lookback=False, lr=[0.0002], lr_scheduler='inverse_sqrt', macaron_style=False, mask_channel_length=6, mask_channel_other=0, mask_channel_prob=0.25, mask_channel_selection='static', mask_length=10, mask_other=0, mask_prob=0.5, mask_selection='static', max_epoch=100, max_position_ctc=0, max_source_positions=6000, max_target_positions=1024, max_tokens=11000, max_tokens_valid=11000, max_update=50000, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, merge_mt_st=True, min_loss_scale=0.0001, mixup_for_whole_model=False, mixup_rate=-0.1, model_parallel_size=1, mt_model_args=None, mt_model_filter_size=0, mt_model_path='/mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt', no_epoch_checkpoints=True, no_last_checkpoints=False, no_mask_channel_overlap=False, no_mask_overlap=False, no_progress_bar=True, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, normalize=False, not_fsdp_flatten_parameters=False, nprocs_per_node=8, num_shards=1, num_workers=2, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', position_unit_size=0, post_process='sentencepiece', profile=False, quant_noise_pq=0, quantization_config_path=None, rel_pos_type='legacy', relative_attn=False, report_accuracy=True, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', save_interval=1, save_interval_updates=2000, scoring='bleu', sead_layers=6, seed=1, sentence_avg=False, shard_id=0, share_ctc_embed=True, share_decoder_input_output_embed=True, share_two_encoders=True, skip_invalid_size_inputs_valid_test=True, skip_remainder_batch=False, slowmo_base_algorithm='localsgd', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, task='joint_triple_pretraining_merge', tensorboard_logdir='./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd', text_conv_kernel=0, threshold_loss_scale=None, tokenizer=None, tpu=False, train_config='/mnt/zhangyh/fairseq-AT/egs/pretrain-all/conf/train_shrink_AT_zyh.yaml', train_st_without_ctc=False, train_subset='train_st,train_asr', transfer_proj=False, unk=3, update_epoch_batch_itr=False, update_freq=[1], update_ordered_indices_seed=False, use_bmuf=False, use_cnn_module=True, use_ctc_cluster=False, use_ctc_loss=True, use_ctc_shrink=True, use_double_ctc=False, use_old_adam=False, use_plasma_view=False, use_sharded_state=False, use_token_contrastive=False, use_two_contrastive=False, use_w2v_ctc=True, user_dir=None, valid_subset='dev_st', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, w2v_args=None, w2v_path='/mnt/zhangyh/pretrain/hubert_base_ls960.pt', wandb_project=None, warmup_init_lr=1e-07, warmup_updates=5000, weight_decay=0.0, weight_steps=5000, word_align=False, write_checkpoints_asynchronously=False, zero_infinity=True, zero_sharding='none', zero_triu=False), 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0002]}, 'lr_scheduler': {'_name': 'inverse_sqrt', 'warmup_updates': 5000, 'warmup_init_lr': 1e-07, 'lr': [0.0002]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}}
2023-08-29 11:00:14 | INFO | fairseq.tasks.joint_triple_pretraining_merge | dictionary size (dict.wrd.txt): 9,999
2023-08-29 11:00:14 | INFO | fairseq.tasks.joint_triple_pretraining_merge | asr dictionary size (dict.wrd.txt): 9,999
2023-08-29 11:00:14 | INFO | fairseq.tasks.joint_triple_pretraining_merge | cluster dictionary size (kmeans100.convert.txt): 5,224
2023-08-29 11:00:14 | INFO | fairseq.tasks.joint_triple_pretraining_merge | Initial task weight: asr 1.0: mt 0.5
2023-08-29 11:00:14 | INFO | root | load pretrained embeddings: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-29 11:00:18 | INFO | fairseq.tasks.hubert_pretraining | current directory is /mnt/zhangyh/fairseq-AT/egs/pretrain-all
2023-08-29 11:00:18 | INFO | fairseq.tasks.hubert_pretraining | HubertPretrainingTask Config {'_name': 'hubert_pretraining', 'data': 'data_all_enfr_lcrm', 'fine_tuning': False, 'labels': ['layer6.km500'], 'label_dir': None, 'label_rate': 50.0, 'sample_rate': 16000, 'normalize': False, 'enable_padding': False, 'max_keep_size': None, 'max_sample_size': 250000, 'min_sample_size': 32000, 'single_target': False, 'random_crop': True, 'pad_audio': False}
2023-08-29 11:00:18 | INFO | fairseq.models.hubert.hubert | HubertModel Config: {'_name': 'hubert', 'label_rate': 50.0, 'extractor_mode': default, 'encoder_layers': 12, 'encoder_embed_dim': 768, 'encoder_ffn_embed_dim': 3072, 'encoder_attention_heads': 12, 'activation_fn': gelu, 'layer_type': transformer, 'dropout': 0.1, 'attention_dropout': 0.1, 'activation_dropout': 0.1, 'encoder_layerdrop': 0.0, 'dropout_input': 0.0, 'dropout_features': 0.1, 'final_dim': 256, 'untie_final_proj': False, 'layer_norm_first': False, 'conv_feature_layers': '[(512,10,5)] + [(512,3,2)] * 4 + [(512,2,2)] * 2', 'conv_bias': False, 'logit_temp': 0.1, 'target_glu': False, 'feature_grad_mult': 0.0, 'mask_length': 10, 'mask_prob': 0.5, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'mask_channel_length': 6, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'mask_channel_min_space': 1, 'conv_pos': 128, 'conv_pos_groups': 16, 'latent_temp': [2.0, 0.5, 0.999995], 'skip_masked': False, 'skip_nomask': False, 'checkpoint_activations': False, 'required_seq_len_multiple': 2, 'depthwise_conv_kernel_size': 31, 'attn_type': '', 'pos_enc_type': 'abs', 'fp16': True}
2023-08-29 11:00:20 | INFO | root | load pretrained hubert
2023-08-29 11:00:27 | INFO | root | load pretrained embedding as ctc proj: /mnt/zhangyh/fairseq-AT/egs/machine_translation/pretrain_embeddings_wmt_enfr_baseline
2023-08-29 11:00:33 | INFO | root | load pretrained encoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-29 11:00:39 | INFO | root | load pretrained decoder: /mnt/zhangyh/fairseq-AT/egs/machine_translation/checkpoints/wmt-en2fr/enfr-baseline/last5.ensemble.pt
2023-08-29 11:00:39 | INFO | root | share the sematic adapter and textual encoder
2023-08-29 11:00:39 | INFO | fairseq_cli.train | S2TJoint(
  (acoustic_encoder): AcousticEncoder(
    (compress_ffn): Linear(in_features=768, out_features=512, bias=True)
    (proj): Linear(in_features=512, out_features=9999, bias=False)
    (w2v_model): HubertModel(
      (feature_extractor): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Fp32GroupNorm(512, 512, eps=1e-05, affine=True)
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): GELU(approximate='none')
          )
        )
      )
      (post_extract_proj): Linear(in_features=512, out_features=768, bias=True)
      (dropout_input): Dropout(p=0.0, inplace=False)
      (dropout_features): Dropout(p=0.1, inplace=False)
      (encoder): TransformerEncoder(
        (pos_conv): Sequential(
          (0): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
          (1): SamePad()
          (2): GELU(approximate='none')
        )
        (layers): ModuleList(
          (0-11): 12 x TransformerSentenceEncoderLayer(
            (self_attn): MultiheadAttention(
              (dropout_module): FairseqDropout()
              (k_proj): Linear(in_features=768, out_features=768, bias=True)
              (v_proj): Linear(in_features=768, out_features=768, bias=True)
              (q_proj): Linear(in_features=768, out_features=768, bias=True)
              (out_proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (dropout1): Dropout(p=0.1, inplace=False)
            (dropout2): Dropout(p=0.1, inplace=False)
            (dropout3): Dropout(p=0.1, inplace=False)
            (self_attn_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (final_layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
          )
        )
        (layer_norm): FusedLayerNorm(torch.Size([768]), eps=1e-05, elementwise_affine=True)
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      (final_proj): None
    )
    (noad): NormalAdapter(
      (subsample): Conv1dSubsampler(
        (conv_layers): ModuleList(
          (0): Conv1d(512, 512, kernel_size=(5,), stride=(2,), padding=(2,))
          (1): Conv1d(256, 1024, kernel_size=(5,), stride=(2,), padding=(2,))
        )
      )
      (layers): ModuleList()
    )
    (sead): SemanticAdapter(
      (embed_positions): SinusoidalPositionalEmbedding()
      (layers): ModuleList(
        (0-5): 6 x TransformerEncoderLayerBase(
          (self_attn): MultiheadAttention(
            (dropout_module): FairseqDropout()
            (k_proj): Linear(in_features=512, out_features=512, bias=True)
            (v_proj): Linear(in_features=512, out_features=512, bias=True)
            (q_proj): Linear(in_features=512, out_features=512, bias=True)
            (out_proj): Linear(in_features=512, out_features=512, bias=True)
          )
          (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
          (dropout_module): FairseqDropout()
          (activation_dropout_module): FairseqDropout()
          (fc1): Linear(in_features=512, out_features=2048, bias=True)
          (fc2): Linear(in_features=2048, out_features=512, bias=True)
          (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        )
      )
      (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    )
    (final_dropout): Dropout(p=0.1, inplace=False)
    (shrink_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (textual_encoder): MTModelEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerEncoderLayerBase(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
  )
  (decoder): TransformerDecoderScriptable(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(9999, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0-5): 6 x TransformerDecoderLayerBase(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
      )
    )
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (output_projection): Linear(in_features=512, out_features=9999, bias=False)
  )
  (task_net): TaskNetwork(
    (layer_norm): FusedLayerNorm(torch.Size([512]), eps=1e-05, elementwise_affine=True)
    (down_proj): Linear(in_features=512, out_features=256, bias=True)
    (up_proj): Linear(in_features=256, out_features=512, bias=True)
    (dropout_module): FairseqDropout()
    (task_proj): Linear(in_features=512, out_features=1, bias=False)
  )
)
2023-08-29 11:00:39 | INFO | fairseq_cli.train | task: JointTriplePretrainingMergeTask
2023-08-29 11:00:39 | INFO | fairseq_cli.train | model: S2TJoint
2023-08-29 11:00:39 | INFO | fairseq_cli.train | criterion: LabelSmoothedCrossEntropywithW2vCtcShrinkJointATMerge
2023-08-29 11:00:39 | INFO | fairseq_cli.train | num. shared model params: 147,043,968 (num. trained: 147,043,968)
2023-08-29 11:00:39 | INFO | fairseq_cli.train | num. expert model params: 0 (num. trained: 0)
2023-08-29 11:00:39 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-29 11:00:39 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 11:00:39 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 11:00:39 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="dev_st", n_samples=1408, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 11:00:55 | INFO | torch.distributed.distributed_c10d | Added key: store_based_barrier_key:2 to store for rank: 0
2023-08-29 11:00:55 | INFO | torch.distributed.distributed_c10d | Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- textual_encoder.embed_tokens.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.embed_tokens.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.weight <- decoder.output_projection.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.0.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.1.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.2.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.3.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.4.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.5.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- acoustic_encoder.w2v_model.feature_extractor.conv_layers.6.0.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- decoder.output_projection.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.proj.bias <- task_net.task_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.weight <- textual_encoder.layers.0.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.k_proj.bias <- textual_encoder.layers.0.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.weight <- textual_encoder.layers.0.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.v_proj.bias <- textual_encoder.layers.0.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.weight <- textual_encoder.layers.0.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.q_proj.bias <- textual_encoder.layers.0.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.weight <- textual_encoder.layers.0.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn.out_proj.bias <- textual_encoder.layers.0.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.weight <- textual_encoder.layers.0.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.self_attn_layer_norm.bias <- textual_encoder.layers.0.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.weight <- textual_encoder.layers.0.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc1.bias <- textual_encoder.layers.0.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.weight <- textual_encoder.layers.0.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.fc2.bias <- textual_encoder.layers.0.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.weight <- textual_encoder.layers.0.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.0.final_layer_norm.bias <- textual_encoder.layers.0.final_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.weight <- textual_encoder.layers.1.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.k_proj.bias <- textual_encoder.layers.1.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.weight <- textual_encoder.layers.1.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.v_proj.bias <- textual_encoder.layers.1.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.weight <- textual_encoder.layers.1.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.q_proj.bias <- textual_encoder.layers.1.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.weight <- textual_encoder.layers.1.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn.out_proj.bias <- textual_encoder.layers.1.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.weight <- textual_encoder.layers.1.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.self_attn_layer_norm.bias <- textual_encoder.layers.1.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.weight <- textual_encoder.layers.1.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc1.bias <- textual_encoder.layers.1.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.weight <- textual_encoder.layers.1.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.fc2.bias <- textual_encoder.layers.1.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.weight <- textual_encoder.layers.1.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.1.final_layer_norm.bias <- textual_encoder.layers.1.final_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.weight <- textual_encoder.layers.2.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.k_proj.bias <- textual_encoder.layers.2.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.weight <- textual_encoder.layers.2.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.v_proj.bias <- textual_encoder.layers.2.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.weight <- textual_encoder.layers.2.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.q_proj.bias <- textual_encoder.layers.2.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.weight <- textual_encoder.layers.2.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn.out_proj.bias <- textual_encoder.layers.2.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.weight <- textual_encoder.layers.2.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.self_attn_layer_norm.bias <- textual_encoder.layers.2.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.weight <- textual_encoder.layers.2.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc1.bias <- textual_encoder.layers.2.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.weight <- textual_encoder.layers.2.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.fc2.bias <- textual_encoder.layers.2.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.weight <- textual_encoder.layers.2.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.2.final_layer_norm.bias <- textual_encoder.layers.2.final_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.weight <- textual_encoder.layers.3.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.k_proj.bias <- textual_encoder.layers.3.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.weight <- textual_encoder.layers.3.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.v_proj.bias <- textual_encoder.layers.3.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.weight <- textual_encoder.layers.3.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.q_proj.bias <- textual_encoder.layers.3.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.weight <- textual_encoder.layers.3.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn.out_proj.bias <- textual_encoder.layers.3.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.weight <- textual_encoder.layers.3.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.self_attn_layer_norm.bias <- textual_encoder.layers.3.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.weight <- textual_encoder.layers.3.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc1.bias <- textual_encoder.layers.3.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.weight <- textual_encoder.layers.3.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.fc2.bias <- textual_encoder.layers.3.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.weight <- textual_encoder.layers.3.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.3.final_layer_norm.bias <- textual_encoder.layers.3.final_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.weight <- textual_encoder.layers.4.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.k_proj.bias <- textual_encoder.layers.4.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.weight <- textual_encoder.layers.4.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.v_proj.bias <- textual_encoder.layers.4.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.weight <- textual_encoder.layers.4.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.q_proj.bias <- textual_encoder.layers.4.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.weight <- textual_encoder.layers.4.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn.out_proj.bias <- textual_encoder.layers.4.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.weight <- textual_encoder.layers.4.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.self_attn_layer_norm.bias <- textual_encoder.layers.4.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.weight <- textual_encoder.layers.4.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc1.bias <- textual_encoder.layers.4.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.weight <- textual_encoder.layers.4.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.fc2.bias <- textual_encoder.layers.4.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.weight <- textual_encoder.layers.4.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.4.final_layer_norm.bias <- textual_encoder.layers.4.final_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.weight <- textual_encoder.layers.5.self_attn.k_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.k_proj.bias <- textual_encoder.layers.5.self_attn.k_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.weight <- textual_encoder.layers.5.self_attn.v_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.v_proj.bias <- textual_encoder.layers.5.self_attn.v_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.weight <- textual_encoder.layers.5.self_attn.q_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.q_proj.bias <- textual_encoder.layers.5.self_attn.q_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.weight <- textual_encoder.layers.5.self_attn.out_proj.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn.out_proj.bias <- textual_encoder.layers.5.self_attn.out_proj.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.weight <- textual_encoder.layers.5.self_attn_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.self_attn_layer_norm.bias <- textual_encoder.layers.5.self_attn_layer_norm.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.weight <- textual_encoder.layers.5.fc1.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc1.bias <- textual_encoder.layers.5.fc1.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.weight <- textual_encoder.layers.5.fc2.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.fc2.bias <- textual_encoder.layers.5.fc2.bias
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.weight <- textual_encoder.layers.5.final_layer_norm.weight
2023-08-29 11:00:55 | INFO | fairseq.trainer | detected shared parameter: acoustic_encoder.sead.layers.5.final_layer_norm.bias <- textual_encoder.layers.5.final_layer_norm.bias
2023-08-29 11:00:56 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   0: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   1: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   2: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   3: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   4: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   5: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   6: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | rank   7: capabilities =  8.6  ; total memory = 23.700 GB ; name = NVIDIA GeForce RTX 3090                 
2023-08-29 11:00:56 | INFO | fairseq.utils | ***********************CUDA enviroments for all 8 workers***********************
2023-08-29 11:00:56 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)
2023-08-29 11:00:56 | INFO | fairseq_cli.train | max tokens per device = 11000 and max sentences per device = None
2023-08-29 11:00:56 | INFO | fairseq.trainer | Preparing to load checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 11:00:56 | INFO | fairseq.trainer | No existing checkpoint found ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 11:00:56 | INFO | fairseq.trainer | loading train data for epoch 1
2023-08-29 11:00:56 | INFO | fairseq.tasks.speech_to_text | pre-tokenizer: {'tokenizer': None}
2023-08-29 11:00:56 | INFO | fairseq.tasks.speech_to_text | tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 11:00:56 | INFO | fairseq.tasks.joint_triple_pretraining_merge | src tokenizer: {'bpe': 'sentencepiece', 'sentencepiece_model': '/mnt/zhangyh/fairseq-AT/egs/pretrain-all/data_all_enfr_lcrm/sentencepiece.bpe.model'}
2023-08-29 11:00:58 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_asr", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 11:01:00 | INFO | fairseq.data.audio.triple_dataset | TripleDataset(split="train_st", n_samples=269255, prepend_tgt_lang_tag=False, shuffle=False, transforms=None)
2023-08-29 11:01:52 | INFO | fairseq.optim.adam | using FusedAdam
2023-08-29 11:01:52 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 11:01:52 | INFO | fairseq.trainer | begin training epoch 1
2023-08-29 11:01:52 | INFO | fairseq_cli.train | Start iterating over samples
True False
None None None
2023-08-29 11:02:03 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
2023-08-29 11:02:05 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 11:02:14 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
True False
None None None
True False
None None None
True False
None None None
True False
None None None
2023-08-29 11:03:11 | INFO | train_inner | epoch 001:    103 / 1191 loss=19.962, trans_loss=6.388, nll_loss=5.161, w2v_ctc_loss=21.402, task_loss=2.983, contrastive_loss=3.61, total=6730.09, n_correct=202.08, ppl=35.78, accuracy=3.003, wps=27876, ups=1.43, wpb=19489.4, bsz=681.6, num_updates=100, lr=4.098e-06, gnorm=1.656, clip=0, loss_scale=16, train_wall=71, gb_free=17.9, wall=135
2023-08-29 11:04:18 | INFO | train_inner | epoch 001:    203 / 1191 loss=16.232, trans_loss=6.189, nll_loss=4.982, w2v_ctc_loss=15.888, task_loss=2.851, contrastive_loss=3.626, total=6694.99, n_correct=167.31, ppl=31.6, accuracy=2.499, wps=28806.5, ups=1.48, wpb=19404.5, bsz=683.1, num_updates=200, lr=8.096e-06, gnorm=6.151, clip=4, loss_scale=16, train_wall=67, gb_free=17.6, wall=202
2023-08-29 11:05:27 | INFO | train_inner | epoch 001:    303 / 1191 loss=11.213, trans_loss=6.174, nll_loss=5.041, w2v_ctc_loss=8.133, task_loss=2.39, contrastive_loss=3.656, total=6849.79, n_correct=124.81, ppl=32.92, accuracy=1.822, wps=28828.8, ups=1.45, wpb=19850.1, bsz=713.5, num_updates=300, lr=1.2094e-05, gnorm=1.632, clip=0, loss_scale=16, train_wall=68, gb_free=18, wall=271
2023-08-29 11:06:35 | INFO | train_inner | epoch 001:    403 / 1191 loss=10.743, trans_loss=6.293, nll_loss=5.222, w2v_ctc_loss=7.389, task_loss=2.529, contrastive_loss=3.537, total=6661.33, n_correct=59.94, ppl=37.32, accuracy=0.9, wps=28515.8, ups=1.48, wpb=19315.8, bsz=657.1, num_updates=400, lr=1.6092e-05, gnorm=0.861, clip=0, loss_scale=16, train_wall=67, gb_free=18.1, wall=339
2023-08-29 11:07:42 | INFO | train_inner | epoch 001:    503 / 1191 loss=10.621, trans_loss=6.408, nll_loss=5.373, w2v_ctc_loss=7.037, task_loss=2.233, contrastive_loss=3.589, total=6737.22, n_correct=36.88, ppl=41.43, accuracy=0.547, wps=29005.8, ups=1.49, wpb=19517.9, bsz=686.6, num_updates=500, lr=2.009e-05, gnorm=0.738, clip=0, loss_scale=16, train_wall=67, gb_free=18.4, wall=406
2023-08-29 11:08:49 | INFO | train_inner | epoch 001:    603 / 1191 loss=10.578, trans_loss=6.468, nll_loss=5.454, w2v_ctc_loss=6.902, task_loss=2.17, contrastive_loss=3.558, total=6775.38, n_correct=28.61, ppl=43.83, accuracy=0.422, wps=29238.2, ups=1.49, wpb=19631.7, bsz=689.3, num_updates=600, lr=2.4088e-05, gnorm=0.864, clip=0, loss_scale=16, train_wall=66, gb_free=18, wall=473
2023-08-29 11:09:56 | INFO | train_inner | epoch 001:    703 / 1191 loss=10.507, trans_loss=6.51, nll_loss=5.506, w2v_ctc_loss=6.791, task_loss=2.226, contrastive_loss=3.571, total=6625.64, n_correct=20.51, ppl=45.44, accuracy=0.31, wps=28734.2, ups=1.5, wpb=19188.7, bsz=672.7, num_updates=700, lr=2.8086e-05, gnorm=0.907, clip=0, loss_scale=16, train_wall=66, gb_free=18.1, wall=540
2023-08-29 11:11:03 | INFO | train_inner | epoch 001:    803 / 1191 loss=10.405, trans_loss=6.43, nll_loss=5.399, w2v_ctc_loss=6.756, task_loss=2.102, contrastive_loss=3.512, total=6750.05, n_correct=17.17, ppl=42.2, accuracy=0.254, wps=29297.5, ups=1.5, wpb=19548.7, bsz=688.8, num_updates=800, lr=3.2084e-05, gnorm=1.058, clip=0, loss_scale=16, train_wall=66, gb_free=18.3, wall=607
2023-08-29 11:11:44 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-29 11:12:11 | INFO | train_inner | epoch 001:    904 / 1191 loss=10.239, trans_loss=6.328, nll_loss=5.272, w2v_ctc_loss=6.721, task_loss=2.229, contrastive_loss=3.459, total=6702.64, n_correct=21.24, ppl=38.64, accuracy=0.317, wps=28447.5, ups=1.46, wpb=19424.7, bsz=673.6, num_updates=900, lr=3.6082e-05, gnorm=1.495, clip=0, loss_scale=8, train_wall=68, gb_free=18.8, wall=675
2023-08-29 11:13:18 | INFO | train_inner | epoch 001:   1004 / 1191 loss=10.171, trans_loss=6.297, nll_loss=5.23, w2v_ctc_loss=6.73, task_loss=2.286, contrastive_loss=3.405, total=6668.77, n_correct=27.15, ppl=37.52, accuracy=0.407, wps=28705.1, ups=1.49, wpb=19319.9, bsz=664.8, num_updates=1000, lr=4.008e-05, gnorm=1.719, clip=0, loss_scale=8, train_wall=67, gb_free=18.4, wall=742
2023-08-29 11:14:25 | INFO | train_inner | epoch 001:   1104 / 1191 loss=10.062, trans_loss=6.285, nll_loss=5.206, w2v_ctc_loss=6.652, task_loss=2.305, contrastive_loss=3.306, total=6572.24, n_correct=30.37, ppl=36.92, accuracy=0.462, wps=28673.9, ups=1.51, wpb=19034.3, bsz=644, num_updates=1100, lr=4.4078e-05, gnorm=1.646, clip=0, loss_scale=8, train_wall=66, gb_free=19.1, wall=809
2023-08-29 11:15:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
True False
None None None
True False
None None None
True False
None None None
True False
None None None
True False
None None None
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/torch/nn/functional.py:4999: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
2023-08-29 11:16:06 | INFO | dev_st | epoch 001 | valid on 'dev_st' subset | loss 13.79 | trans_loss 13.805 | nll_loss 13.533 | w2v_ctc_loss 9.327 | task_loss 14.015 | contrastive_loss 4.875 | total 6138.43 | n_correct 22.2857 | ppl 11851.3 | accuracy 0.363 | uer 91.664 | wer 98.914 | raw_wer 98.914 | bleu 0 | wps 1213.6 | wpb 6138.4 | bsz 201.1 | num_updates 1187
2023-08-29 11:16:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 1 @ 1187 updates
2023-08-29 11:16:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:16:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:16:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 1 @ 1187 updates, score 0.0) (writing took 3.9178944070008583 seconds)
2023-08-29 11:16:10 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2023-08-29 11:16:10 | INFO | train | epoch 001 | loss 11.753 | trans_loss 6.337 | nll_loss 5.253 | w2v_ctc_loss 8.951 | task_loss 2.376 | contrastive_loss 3.52 | total 6701.88 | n_correct 64.3791 | ppl 38.14 | accuracy 0.961 | wps 27134.7 | ups 1.4 | wpb 19417.4 | bsz 677.7 | num_updates 1187 | lr 4.75563e-05 | gnorm 1.706 | clip 0.3 | loss_scale 8 | train_wall 796 | gb_free 18.5 | wall 914
2023-08-29 11:16:10 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 11:16:10 | INFO | fairseq.trainer | begin training epoch 2
2023-08-29 11:16:10 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 11:16:29 | INFO | train_inner | epoch 002:     13 / 1191 loss=10.013, trans_loss=6.267, nll_loss=5.185, w2v_ctc_loss=6.61, task_loss=2.163, contrastive_loss=3.373, total=6638.17, n_correct=32.31, ppl=36.39, accuracy=0.487, wps=15521.9, ups=0.81, wpb=19236.9, bsz=681, num_updates=1200, lr=4.8076e-05, gnorm=1.81, clip=0, loss_scale=8, train_wall=66, gb_free=17.6, wall=933
2023-08-29 11:17:35 | INFO | train_inner | epoch 002:    113 / 1191 loss=9.914, trans_loss=6.255, nll_loss=5.172, w2v_ctc_loss=6.607, task_loss=2.265, contrastive_loss=3.25, total=6607.17, n_correct=32.67, ppl=36.06, accuracy=0.494, wps=28744.5, ups=1.5, wpb=19135.7, bsz=660.8, num_updates=1300, lr=5.2074e-05, gnorm=2.101, clip=0, loss_scale=8, train_wall=66, gb_free=19, wall=999
2023-08-29 11:18:43 | INFO | train_inner | epoch 002:    213 / 1191 loss=9.877, trans_loss=6.226, nll_loss=5.138, w2v_ctc_loss=6.61, task_loss=2.23, contrastive_loss=3.2, total=6717.78, n_correct=36.16, ppl=35.21, accuracy=0.538, wps=28762.9, ups=1.48, wpb=19457.9, bsz=673, num_updates=1400, lr=5.6072e-05, gnorm=2.17, clip=0, loss_scale=8, train_wall=67, gb_free=17.8, wall=1067
2023-08-29 11:19:50 | INFO | train_inner | epoch 002:    313 / 1191 loss=9.824, trans_loss=6.202, nll_loss=5.108, w2v_ctc_loss=6.552, task_loss=2.101, contrastive_loss=3.179, total=6783.61, n_correct=39.42, ppl=34.49, accuracy=0.581, wps=29238.6, ups=1.49, wpb=19657, bsz=692, num_updates=1500, lr=6.007e-05, gnorm=2.188, clip=0, loss_scale=8, train_wall=67, gb_free=17.6, wall=1134
2023-08-29 11:20:57 | INFO | train_inner | epoch 002:    413 / 1191 loss=9.454, trans_loss=6.178, nll_loss=5.075, w2v_ctc_loss=6.035, task_loss=2.154, contrastive_loss=3.2, total=6717.93, n_correct=44.76, ppl=33.71, accuracy=0.666, wps=29052.2, ups=1.49, wpb=19471.9, bsz=690.3, num_updates=1600, lr=6.4068e-05, gnorm=2.065, clip=0, loss_scale=8, train_wall=66, gb_free=18.2, wall=1201
2023-08-29 11:22:04 | INFO | train_inner | epoch 002:    513 / 1191 loss=8.679, trans_loss=6.156, nll_loss=5.048, w2v_ctc_loss=4.917, task_loss=2.22, contrastive_loss=3.181, total=6702.22, n_correct=47.46, ppl=33.09, accuracy=0.708, wps=29059, ups=1.5, wpb=19424.7, bsz=680.4, num_updates=1700, lr=6.8066e-05, gnorm=1.824, clip=0, loss_scale=8, train_wall=66, gb_free=18.4, wall=1268
2023-08-29 11:23:11 | INFO | train_inner | epoch 002:    613 / 1191 loss=8.384, trans_loss=6.154, nll_loss=5.043, w2v_ctc_loss=4.542, task_loss=2.275, contrastive_loss=3.107, total=6642.86, n_correct=50.47, ppl=32.97, accuracy=0.76, wps=28768.6, ups=1.5, wpb=19232.5, bsz=660, num_updates=1800, lr=7.2064e-05, gnorm=1.865, clip=0, loss_scale=8, train_wall=66, gb_free=17.7, wall=1335
2023-08-29 11:24:17 | INFO | train_inner | epoch 002:    713 / 1191 loss=8.191, trans_loss=6.158, nll_loss=5.048, w2v_ctc_loss=4.206, task_loss=2.092, contrastive_loss=3.121, total=6796.78, n_correct=50.7, ppl=33.09, accuracy=0.746, wps=29615.2, ups=1.51, wpb=19677.2, bsz=701.9, num_updates=1900, lr=7.6062e-05, gnorm=1.561, clip=0, loss_scale=8, train_wall=66, gb_free=19.1, wall=1401
2023-08-29 11:25:24 | INFO | train_inner | epoch 002:    813 / 1191 loss=7.967, trans_loss=6.149, nll_loss=5.033, w2v_ctc_loss=3.927, task_loss=2.133, contrastive_loss=3.02, total=6729.61, n_correct=53.12, ppl=32.74, accuracy=0.789, wps=29043, ups=1.49, wpb=19499, bsz=680.8, num_updates=2000, lr=8.006e-05, gnorm=1.67, clip=0, loss_scale=8, train_wall=66, gb_free=17.6, wall=1469
2023-08-29 11:25:24 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 11:26:08 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 12.318 | trans_loss 13.723 | nll_loss 13.303 | w2v_ctc_loss 5.097 | task_loss 14.015 | contrastive_loss 4.455 | total 6138.43 | n_correct 48.1429 | ppl 10109.8 | accuracy 0.784 | uer 70.42 | wer 67.828 | raw_wer 67.828 | bleu 0 | wps 1225.5 | wpb 6138.4 | bsz 201.1 | num_updates 2000 | best_bleu 0
2023-08-29 11:26:08 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2000 updates
2023-08-29 11:26:08 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-29 11:26:10 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt
2023-08-29 11:26:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.0) (writing took 14.392651996000495 seconds)
2023-08-29 11:27:30 | INFO | train_inner | epoch 002:    913 / 1191 loss=7.781, trans_loss=6.145, nll_loss=5.031, w2v_ctc_loss=3.69, task_loss=2.11, contrastive_loss=3.06, total=6752.13, n_correct=56.29, ppl=32.69, accuracy=0.834, wps=15648.5, ups=0.8, wpb=19570.7, bsz=703.1, num_updates=2100, lr=8.4058e-05, gnorm=1.489, clip=0, loss_scale=8, train_wall=66, gb_free=17.9, wall=1594
2023-08-29 11:28:37 | INFO | train_inner | epoch 002:   1013 / 1191 loss=7.605, trans_loss=6.165, nll_loss=5.05, w2v_ctc_loss=3.514, task_loss=2.181, contrastive_loss=2.915, total=6765.53, n_correct=59.66, ppl=33.12, accuracy=0.882, wps=29273.1, ups=1.49, wpb=19614, bsz=684.2, num_updates=2200, lr=8.8056e-05, gnorm=1.715, clip=0, loss_scale=8, train_wall=66, gb_free=18.5, wall=1661
2023-08-29 11:29:43 | INFO | train_inner | epoch 002:   1113 / 1191 loss=7.443, trans_loss=6.163, nll_loss=5.047, w2v_ctc_loss=3.367, task_loss=2.297, contrastive_loss=2.825, total=6648.26, n_correct=60.83, ppl=33.06, accuracy=0.915, wps=28994.6, ups=1.51, wpb=19255.9, bsz=655, num_updates=2300, lr=9.2054e-05, gnorm=2, clip=0, loss_scale=8, train_wall=66, gb_free=18.5, wall=1727
2023-08-29 11:30:35 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 11:31:18 | INFO | dev_st | epoch 002 | valid on 'dev_st' subset | loss 12.378 | trans_loss 14.35 | nll_loss 13.935 | w2v_ctc_loss 4.167 | task_loss 14.015 | contrastive_loss 4.195 | total 6138.43 | n_correct 63.4286 | ppl 15663.5 | accuracy 1.033 | uer 60.888 | wer 58.36 | raw_wer 58.36 | bleu 0 | wps 1221.9 | wpb 6138.4 | bsz 201.1 | num_updates 2378 | best_bleu 0
2023-08-29 11:31:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 2 @ 2378 updates
2023-08-29 11:31:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:31:26 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:31:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 2 @ 2378 updates, score 0.0) (writing took 12.86040494700137 seconds)
2023-08-29 11:31:32 | INFO | fairseq_cli.train | end of epoch 2 (average epoch stats below)
2023-08-29 11:31:32 | INFO | train | epoch 002 | loss 8.576 | trans_loss 6.176 | nll_loss 5.071 | w2v_ctc_loss 4.818 | task_loss 2.194 | contrastive_loss 3.083 | total 6703.69 | n_correct 49.0697 | ppl 33.61 | accuracy 0.732 | wps 25109.2 | ups 1.29 | wpb 19422.7 | bsz 678.2 | num_updates 2378 | lr 9.51724e-05 | gnorm 1.882 | clip 0 | loss_scale 8 | train_wall 789 | gb_free 17.7 | wall 1836
2023-08-29 11:31:32 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 11:31:32 | INFO | fairseq.trainer | begin training epoch 3
2023-08-29 11:31:32 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 11:31:53 | INFO | train_inner | epoch 003:     22 / 1191 loss=7.318, trans_loss=6.151, nll_loss=5.037, w2v_ctc_loss=3.257, task_loss=2.34, contrastive_loss=2.832, total=6597.75, n_correct=62.76, ppl=32.84, accuracy=0.951, wps=14651.2, ups=0.77, wpb=19123.8, bsz=654.9, num_updates=2400, lr=9.6052e-05, gnorm=1.847, clip=0, loss_scale=8, train_wall=66, gb_free=18.5, wall=1858
2023-08-29 11:33:01 | INFO | train_inner | epoch 003:    122 / 1191 loss=7.238, trans_loss=6.144, nll_loss=5.03, w2v_ctc_loss=3.142, task_loss=2.153, contrastive_loss=2.813, total=6689.99, n_correct=64.86, ppl=32.68, accuracy=0.97, wps=28940.1, ups=1.49, wpb=19400.5, bsz=686.9, num_updates=2500, lr=0.00010005, gnorm=2.004, clip=0, loss_scale=8, train_wall=66, gb_free=18.7, wall=1925
2023-08-29 11:34:08 | INFO | train_inner | epoch 003:    222 / 1191 loss=7.103, trans_loss=6.147, nll_loss=5.034, w2v_ctc_loss=3.029, task_loss=2.135, contrastive_loss=2.734, total=6716.3, n_correct=67.96, ppl=32.77, accuracy=1.012, wps=28921.9, ups=1.49, wpb=19462.8, bsz=684.5, num_updates=2600, lr=0.000104048, gnorm=1.894, clip=0, loss_scale=8, train_wall=67, gb_free=17.7, wall=1992
2023-08-29 11:35:14 | INFO | train_inner | epoch 003:    322 / 1191 loss=6.966, trans_loss=6.147, nll_loss=5.034, w2v_ctc_loss=2.983, task_loss=2.506, contrastive_loss=2.557, total=6578.84, n_correct=66.45, ppl=32.75, accuracy=1.01, wps=28587.4, ups=1.5, wpb=19052.5, bsz=625.2, num_updates=2700, lr=0.000108046, gnorm=2.02, clip=0, loss_scale=8, train_wall=66, gb_free=18.5, wall=2059
2023-08-29 11:36:21 | INFO | train_inner | epoch 003:    422 / 1191 loss=6.925, trans_loss=6.152, nll_loss=5.042, w2v_ctc_loss=2.874, task_loss=2.146, contrastive_loss=2.675, total=6697.81, n_correct=66.74, ppl=32.94, accuracy=0.996, wps=29282.5, ups=1.51, wpb=19404.2, bsz=690.4, num_updates=2800, lr=0.000112044, gnorm=1.77, clip=0, loss_scale=8, train_wall=66, gb_free=18.9, wall=2125
2023-08-29 11:37:28 | INFO | train_inner | epoch 003:    522 / 1191 loss=6.861, trans_loss=6.157, nll_loss=5.05, w2v_ctc_loss=2.84, task_loss=2.186, contrastive_loss=2.51, total=6747.27, n_correct=69.53, ppl=33.12, accuracy=1.03, wps=29240.6, ups=1.5, wpb=19551.8, bsz=674.2, num_updates=2900, lr=0.000116042, gnorm=2.109, clip=0, loss_scale=8, train_wall=66, gb_free=18.2, wall=2192
2023-08-29 11:38:35 | INFO | train_inner | epoch 003:    622 / 1191 loss=6.77, trans_loss=6.141, nll_loss=5.029, w2v_ctc_loss=2.781, task_loss=2.222, contrastive_loss=2.462, total=6746.29, n_correct=72.86, ppl=32.65, accuracy=1.08, wps=29187.1, ups=1.49, wpb=19552.3, bsz=665.2, num_updates=3000, lr=0.00012004, gnorm=1.842, clip=0, loss_scale=16, train_wall=66, gb_free=18.6, wall=2259
2023-08-29 11:38:36 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-29 11:38:37 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
2023-08-29 11:38:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
2023-08-29 11:38:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 1.0
2023-08-29 11:40:24 | INFO | train_inner | epoch 003:    726 / 1191 loss=6.103, trans_loss=5.351, nll_loss=4.065, w2v_ctc_loss=2.534, task_loss=1.526, contrastive_loss=2.576, total=6742.35, n_correct=349.55, ppl=16.73, accuracy=5.184, wps=17844.9, ups=0.91, wpb=19541.9, bsz=701.5, num_updates=3100, lr=0.000124038, gnorm=3.586, clip=5, loss_scale=1, train_wall=109, gb_free=13, wall=2368
2023-08-29 11:42:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.5
2023-08-29 11:42:09 | INFO | train_inner | epoch 003:    827 / 1191 loss=5.244, trans_loss=4.735, nll_loss=3.248, w2v_ctc_loss=2.23, task_loss=1.451, contrastive_loss=2.252, total=6766.15, n_correct=1212.85, ppl=9.5, accuracy=17.925, wps=18754.2, ups=0.96, wpb=19613.1, bsz=706.4, num_updates=3200, lr=0.000128036, gnorm=2.601, clip=0, loss_scale=0.5, train_wall=104, gb_free=12.9, wall=2473
2023-08-29 11:43:52 | INFO | train_inner | epoch 003:    927 / 1191 loss=4.666, trans_loss=4.173, nll_loss=2.505, w2v_ctc_loss=2.099, task_loss=1.4, contrastive_loss=2.101, total=6806.95, n_correct=2218.77, ppl=5.68, accuracy=32.596, wps=19125.3, ups=0.97, wpb=19716, bsz=716.9, num_updates=3300, lr=0.000132034, gnorm=2.381, clip=0, loss_scale=0.5, train_wall=102, gb_free=13.9, wall=2576
2023-08-29 11:45:37 | INFO | train_inner | epoch 003:   1027 / 1191 loss=4.367, trans_loss=4.081, nll_loss=2.39, w2v_ctc_loss=2.018, task_loss=1.818, contrastive_loss=1.849, total=6529.36, n_correct=2320.36, ppl=5.24, accuracy=35.537, wps=18052.7, ups=0.95, wpb=18923.2, bsz=611.4, num_updates=3400, lr=0.000136032, gnorm=2.099, clip=0, loss_scale=0.5, train_wall=104, gb_free=6.7, wall=2681
2023-08-29 11:47:22 | INFO | train_inner | epoch 003:   1127 / 1191 loss=4.248, trans_loss=4.043, nll_loss=2.339, w2v_ctc_loss=1.889, task_loss=1.472, contrastive_loss=1.876, total=6784.07, n_correct=2513.55, ppl=5.06, accuracy=37.051, wps=18664.5, ups=0.95, wpb=19637.9, bsz=711.9, num_updates=3500, lr=0.00014003, gnorm=1.918, clip=0, loss_scale=0.5, train_wall=105, gb_free=12.6, wall=2786
2023-08-29 11:48:28 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 11:49:05 | INFO | dev_st | epoch 003 | valid on 'dev_st' subset | loss 6.15 | trans_loss 6.908 | nll_loss 4.706 | w2v_ctc_loss 2.208 | task_loss 7.754 | contrastive_loss 2.485 | total 6138.43 | n_correct 2391.71 | ppl 26.11 | accuracy 38.963 | uer 34.972 | wer 34.805 | raw_wer 34.805 | bleu 0.52 | wps 1411.5 | wpb 6138.4 | bsz 201.1 | num_updates 3564 | best_bleu 0.52
2023-08-29 11:49:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 3 @ 3564 updates
2023-08-29 11:49:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:49:12 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 11:49:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 3 @ 3564 updates, score 0.52) (writing took 12.54102492799575 seconds)
2023-08-29 11:49:18 | INFO | fairseq_cli.train | end of epoch 3 (average epoch stats below)
2023-08-29 11:49:18 | INFO | train | epoch 003 | loss 5.964 | trans_loss 5.33 | nll_loss 3.994 | w2v_ctc_loss 2.554 | task_loss 1.89 | contrastive_loss 2.375 | total 6703.52 | n_correct 894.882 | ppl 15.94 | accuracy 13.349 | wps 21606.5 | ups 1.11 | wpb 19422.4 | bsz 678.3 | num_updates 3564 | lr 0.000142589 | gnorm 2.176 | clip 0.4 | loss_scale 0.5 | train_wall 1002 | gb_free 15.1 | wall 2902
2023-08-29 11:49:18 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 11:49:18 | INFO | fairseq.trainer | begin training epoch 4
2023-08-29 11:49:18 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 11:50:04 | INFO | train_inner | epoch 004:     36 / 1191 loss=4.068, trans_loss=4.026, nll_loss=2.318, w2v_ctc_loss=1.821, task_loss=1.637, contrastive_loss=1.672, total=6564.97, n_correct=2458.12, ppl=4.99, accuracy=37.443, wps=11747.6, ups=0.62, wpb=19003.4, bsz=642.3, num_updates=3600, lr=0.000144028, gnorm=1.869, clip=0, loss_scale=0.5, train_wall=104, gb_free=13.5, wall=2948
2023-08-29 11:51:49 | INFO | train_inner | epoch 004:    136 / 1191 loss=3.948, trans_loss=4.004, nll_loss=2.291, w2v_ctc_loss=1.744, task_loss=1.609, contrastive_loss=1.564, total=6717.55, n_correct=2559.44, ppl=4.89, accuracy=38.101, wps=18498.3, ups=0.95, wpb=19456.2, bsz=654.6, num_updates=3700, lr=0.000148026, gnorm=1.782, clip=0, loss_scale=0.5, train_wall=105, gb_free=11.6, wall=3053
2023-08-29 11:53:33 | INFO | train_inner | epoch 004:    236 / 1191 loss=3.89, trans_loss=3.991, nll_loss=2.276, w2v_ctc_loss=1.69, task_loss=1.498, contrastive_loss=1.658, total=6754.2, n_correct=2607.84, ppl=4.84, accuracy=38.611, wps=18785.8, ups=0.96, wpb=19575.6, bsz=702.5, num_updates=3800, lr=0.000152024, gnorm=1.722, clip=0, loss_scale=0.5, train_wall=104, gb_free=11.9, wall=3157
2023-08-29 11:55:16 | INFO | train_inner | epoch 004:    336 / 1191 loss=3.775, trans_loss=3.987, nll_loss=2.271, w2v_ctc_loss=1.665, task_loss=1.553, contrastive_loss=1.422, total=6663.4, n_correct=2595.33, ppl=4.83, accuracy=38.949, wps=18770.8, ups=0.97, wpb=19310.2, bsz=662.9, num_updates=3900, lr=0.000156022, gnorm=1.592, clip=0, loss_scale=0.5, train_wall=102, gb_free=10.4, wall=3260
2023-08-29 11:57:00 | INFO | train_inner | epoch 004:    436 / 1191 loss=3.732, trans_loss=3.975, nll_loss=2.255, w2v_ctc_loss=1.626, task_loss=1.547, contrastive_loss=1.507, total=6723.42, n_correct=2637.22, ppl=4.77, accuracy=39.224, wps=18639.5, ups=0.96, wpb=19479.8, bsz=685.4, num_updates=4000, lr=0.00016002, gnorm=1.59, clip=0, loss_scale=0.5, train_wall=104, gb_free=14, wall=3365
2023-08-29 11:57:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 11:57:35 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 5.802 | trans_loss 6.796 | nll_loss 4.564 | w2v_ctc_loss 1.942 | task_loss 7.772 | contrastive_loss 1.914 | total 6138.43 | n_correct 2496.57 | ppl 23.65 | accuracy 40.671 | uer 31.18 | wer 31.354 | raw_wer 31.354 | bleu 1.02 | wps 1567.2 | wpb 6138.4 | bsz 201.1 | num_updates 4000 | best_bleu 1.02
2023-08-29 11:57:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4000 updates
2023-08-29 11:57:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-29 11:57:37 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt
2023-08-29 11:57:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_4_4000.pt (epoch 4 @ 4000 updates, score 1.02) (writing took 13.164177267011837 seconds)
2023-08-29 11:59:33 | INFO | train_inner | epoch 004:    536 / 1191 loss=3.634, trans_loss=3.96, nll_loss=2.236, w2v_ctc_loss=1.599, task_loss=1.578, contrastive_loss=1.313, total=6675.14, n_correct=2645.29, ppl=4.71, accuracy=39.629, wps=12712, ups=0.66, wpb=19342.3, bsz=669.8, num_updates=4100, lr=0.000164018, gnorm=1.478, clip=0, loss_scale=0.5, train_wall=103, gb_free=13.9, wall=3517
2023-08-29 12:01:18 | INFO | train_inner | epoch 004:    636 / 1191 loss=3.592, trans_loss=3.954, nll_loss=2.229, w2v_ctc_loss=1.566, task_loss=1.498, contrastive_loss=1.355, total=6814.85, n_correct=2729.66, ppl=4.69, accuracy=40.055, wps=18720.9, ups=0.95, wpb=19752.2, bsz=705.4, num_updates=4200, lr=0.000168016, gnorm=1.416, clip=0, loss_scale=0.5, train_wall=105, gb_free=5, wall=3622
2023-08-29 12:03:01 | INFO | train_inner | epoch 004:    736 / 1191 loss=3.511, trans_loss=3.946, nll_loss=2.216, w2v_ctc_loss=1.526, task_loss=1.521, contrastive_loss=1.3, total=6699.76, n_correct=2723.32, ppl=4.65, accuracy=40.648, wps=18850.7, ups=0.97, wpb=19404.7, bsz=685.5, num_updates=4300, lr=0.000172014, gnorm=1.39, clip=0, loss_scale=0.5, train_wall=102, gb_free=4.6, wall=3725
2023-08-29 12:04:46 | INFO | train_inner | epoch 004:    836 / 1191 loss=3.473, trans_loss=3.94, nll_loss=2.209, w2v_ctc_loss=1.514, task_loss=1.437, contrastive_loss=1.263, total=6858.76, n_correct=2818.8, ppl=4.62, accuracy=41.098, wps=18841.3, ups=0.95, wpb=19866.4, bsz=725.5, num_updates=4400, lr=0.000176012, gnorm=1.36, clip=0, loss_scale=0.5, train_wall=105, gb_free=14.1, wall=3831
2023-08-29 12:06:31 | INFO | train_inner | epoch 004:    936 / 1191 loss=3.406, trans_loss=3.92, nll_loss=2.183, w2v_ctc_loss=1.497, task_loss=1.472, contrastive_loss=1.191, total=6732.9, n_correct=2830.23, ppl=4.54, accuracy=42.036, wps=18691.8, ups=0.96, wpb=19494.6, bsz=702.9, num_updates=4500, lr=0.00018001, gnorm=1.395, clip=0, loss_scale=0.5, train_wall=104, gb_free=10.6, wall=3935
2023-08-29 12:08:16 | INFO | train_inner | epoch 004:   1036 / 1191 loss=3.37, trans_loss=3.912, nll_loss=2.172, w2v_ctc_loss=1.508, task_loss=1.646, contrastive_loss=1.122, total=6643.82, n_correct=2816.36, ppl=4.51, accuracy=42.391, wps=18272.3, ups=0.95, wpb=19242.6, bsz=660.8, num_updates=4600, lr=0.000184008, gnorm=1.442, clip=0, loss_scale=0.5, train_wall=105, gb_free=13.7, wall=4040
2023-08-29 12:10:00 | INFO | train_inner | epoch 004:   1136 / 1191 loss=3.292, trans_loss=3.889, nll_loss=2.145, w2v_ctc_loss=1.496, task_loss=1.672, contrastive_loss=0.978, total=6570.21, n_correct=2844.63, ppl=4.42, accuracy=43.296, wps=18264.8, ups=0.96, wpb=19047.6, bsz=630.5, num_updates=4700, lr=0.000188006, gnorm=1.467, clip=0, loss_scale=0.5, train_wall=104, gb_free=7.3, wall=4144
2023-08-29 12:10:57 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 12:11:33 | INFO | dev_st | epoch 004 | valid on 'dev_st' subset | loss 5.269 | trans_loss 6.385 | nll_loss 4.014 | w2v_ctc_loss 1.684 | task_loss 7.864 | contrastive_loss 1.37 | total 6138.43 | n_correct 2945.86 | ppl 16.16 | accuracy 47.99 | uer 28.313 | wer 28.825 | raw_wer 28.825 | bleu 5.44 | wps 1496.9 | wpb 6138.4 | bsz 201.1 | num_updates 4755 | best_bleu 5.44
2023-08-29 12:11:33 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 4 @ 4755 updates
2023-08-29 12:11:33 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:11:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:11:48 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 4 @ 4755 updates, score 5.44) (writing took 15.205914752994431 seconds)
2023-08-29 12:11:48 | INFO | fairseq_cli.train | end of epoch 4 (average epoch stats below)
2023-08-29 12:11:48 | INFO | train | epoch 004 | loss 3.598 | trans_loss 3.95 | nll_loss 2.223 | w2v_ctc_loss 1.586 | task_loss 1.553 | contrastive_loss 1.327 | total 6703.69 | n_correct 2713.07 | ppl 4.67 | accuracy 40.471 | wps 17129.1 | ups 0.88 | wpb 19422.7 | bsz 678.2 | num_updates 4755 | lr 0.000190205 | gnorm 1.509 | clip 0 | loss_scale 0.5 | train_wall 1236 | gb_free 13.3 | wall 4252
2023-08-29 12:11:48 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 12:11:48 | INFO | fairseq.trainer | begin training epoch 5
2023-08-29 12:11:48 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 12:12:41 | INFO | train_inner | epoch 005:     45 / 1191 loss=3.234, trans_loss=3.846, nll_loss=2.089, w2v_ctc_loss=1.446, task_loss=1.428, contrastive_loss=1.054, total=6770.61, n_correct=3054.89, ppl=4.26, accuracy=45.12, wps=12186.5, ups=0.62, wpb=19623.2, bsz=716.6, num_updates=4800, lr=0.000192004, gnorm=1.284, clip=0, loss_scale=0.5, train_wall=102, gb_free=12.3, wall=4305
2023-08-29 12:14:26 | INFO | train_inner | epoch 005:    145 / 1191 loss=3.169, trans_loss=3.835, nll_loss=2.072, w2v_ctc_loss=1.429, task_loss=1.581, contrastive_loss=1.005, total=6699.77, n_correct=3073.81, ppl=4.2, accuracy=45.879, wps=18504.3, ups=0.95, wpb=19409.6, bsz=671.7, num_updates=4900, lr=0.000196002, gnorm=1.404, clip=0, loss_scale=0.5, train_wall=104, gb_free=5.9, wall=4410
2023-08-29 12:16:10 | INFO | train_inner | epoch 005:    245 / 1191 loss=3.143, trans_loss=3.806, nll_loss=2.035, w2v_ctc_loss=1.421, task_loss=1.411, contrastive_loss=0.984, total=6859.5, n_correct=3245.49, ppl=4.1, accuracy=47.314, wps=19107.8, ups=0.96, wpb=19870.2, bsz=728.4, num_updates=5000, lr=0.0002, gnorm=1.418, clip=1, loss_scale=0.5, train_wall=103, gb_free=12.7, wall=4514
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:0')
2023-08-29 12:17:54 | INFO | train_inner | epoch 005:    345 / 1191 loss=3.101, trans_loss=3.793, nll_loss=2.018, w2v_ctc_loss=1.429, task_loss=1.599, contrastive_loss=0.94, total=6631.13, n_correct=3174.84, ppl=4.05, accuracy=47.878, wps=18481.5, ups=0.96, wpb=19212.5, bsz=667.2, num_updates=5100, lr=0.00019803, gnorm=1.024, clip=0, loss_scale=0.5, train_wall=103, gb_free=13.8, wall=4618
2023-08-29 12:19:39 | INFO | train_inner | epoch 005:    445 / 1191 loss=3.074, trans_loss=3.767, nll_loss=1.986, w2v_ctc_loss=1.426, task_loss=1.55, contrastive_loss=0.956, total=6691.68, n_correct=3274.85, ppl=3.96, accuracy=48.939, wps=18535.4, ups=0.96, wpb=19399.7, bsz=680, num_updates=5200, lr=0.000196116, gnorm=0.972, clip=0, loss_scale=0.5, train_wall=104, gb_free=14, wall=4723
2023-08-29 12:21:24 | INFO | train_inner | epoch 005:    545 / 1191 loss=3.039, trans_loss=3.749, nll_loss=1.961, w2v_ctc_loss=1.413, task_loss=1.595, contrastive_loss=0.965, total=6658.28, n_correct=3321.01, ppl=3.89, accuracy=49.878, wps=18391.4, ups=0.95, wpb=19286.8, bsz=671.1, num_updates=5300, lr=0.000194257, gnorm=0.961, clip=0, loss_scale=1, train_wall=104, gb_free=13.1, wall=4828
2023-08-29 12:23:07 | INFO | train_inner | epoch 005:    645 / 1191 loss=2.995, trans_loss=3.732, nll_loss=1.937, w2v_ctc_loss=1.414, task_loss=1.579, contrastive_loss=0.822, total=6704.06, n_correct=3412.46, ppl=3.83, accuracy=50.901, wps=18810.8, ups=0.97, wpb=19409.9, bsz=666.1, num_updates=5400, lr=0.00019245, gnorm=0.979, clip=0, loss_scale=1, train_wall=103, gb_free=12.6, wall=4931
2023-08-29 12:24:52 | INFO | train_inner | epoch 005:    745 / 1191 loss=2.967, trans_loss=3.697, nll_loss=1.895, w2v_ctc_loss=1.395, task_loss=1.533, contrastive_loss=0.907, total=6729.67, n_correct=3506.58, ppl=3.72, accuracy=52.106, wps=18505.5, ups=0.95, wpb=19505.8, bsz=691, num_updates=5500, lr=0.000190693, gnorm=0.87, clip=0, loss_scale=1, train_wall=105, gb_free=14.1, wall=5036
2023-08-29 12:26:37 | INFO | train_inner | epoch 005:    845 / 1191 loss=2.907, trans_loss=3.676, nll_loss=1.866, w2v_ctc_loss=1.373, task_loss=1.515, contrastive_loss=0.848, total=6762.66, n_correct=3589.51, ppl=3.64, accuracy=53.078, wps=18754.4, ups=0.96, wpb=19587.2, bsz=685.2, num_updates=5600, lr=0.000188982, gnorm=0.832, clip=0, loss_scale=1, train_wall=104, gb_free=13.7, wall=5141
2023-08-29 12:28:22 | INFO | train_inner | epoch 005:    945 / 1191 loss=2.883, trans_loss=3.666, nll_loss=1.854, w2v_ctc_loss=1.375, task_loss=1.629, contrastive_loss=0.823, total=6594.78, n_correct=3535.27, ppl=3.62, accuracy=53.607, wps=18241.9, ups=0.95, wpb=19112.3, bsz=655, num_updates=5700, lr=0.000187317, gnorm=0.818, clip=0, loss_scale=1, train_wall=104, gb_free=14.9, wall=5246
2023-08-29 12:30:07 | INFO | train_inner | epoch 005:   1045 / 1191 loss=2.829, trans_loss=3.646, nll_loss=1.827, w2v_ctc_loss=1.357, task_loss=1.653, contrastive_loss=0.76, total=6644.2, n_correct=3618.24, ppl=3.55, accuracy=54.457, wps=18340.6, ups=0.95, wpb=19249, bsz=647.4, num_updates=5800, lr=0.000185695, gnorm=0.748, clip=0, loss_scale=1, train_wall=104, gb_free=14.1, wall=5351
2023-08-29 12:31:50 | INFO | train_inner | epoch 005:   1145 / 1191 loss=2.821, trans_loss=3.628, nll_loss=1.805, w2v_ctc_loss=1.353, task_loss=1.583, contrastive_loss=0.789, total=6704.07, n_correct=3704.15, ppl=3.5, accuracy=55.252, wps=18711.8, ups=0.96, wpb=19424.7, bsz=670.9, num_updates=5900, lr=0.000184115, gnorm=0.734, clip=0, loss_scale=1, train_wall=103, gb_free=14.4, wall=5454
2023-08-29 12:32:39 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.5021, device='cuda:3')
2023-08-29 12:33:14 | INFO | dev_st | epoch 005 | valid on 'dev_st' subset | loss 4.543 | trans_loss 5.594 | nll_loss 2.982 | w2v_ctc_loss 1.498 | task_loss 8.086 | contrastive_loss 0.977 | total 6138.43 | n_correct 3700.71 | ppl 7.9 | accuracy 60.288 | uer 24.307 | wer 25.203 | raw_wer 25.203 | bleu 18.05 | wps 1480.1 | wpb 6138.4 | bsz 201.1 | num_updates 5946 | best_bleu 18.05
2023-08-29 12:33:14 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 5 @ 5946 updates
2023-08-29 12:33:14 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:33:21 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:33:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 5 @ 5946 updates, score 18.05) (writing took 12.215431795993936 seconds)
2023-08-29 12:33:27 | INFO | fairseq_cli.train | end of epoch 5 (average epoch stats below)
2023-08-29 12:33:27 | INFO | train | epoch 005 | loss 2.995 | trans_loss 3.727 | nll_loss 1.932 | w2v_ctc_loss 1.397 | task_loss 1.555 | contrastive_loss 0.897 | total 6703.69 | n_correct 3407.18 | ppl 3.82 | accuracy 50.825 | wps 17815.1 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 5946 | lr 0.000183401 | gnorm 0.981 | clip 0.1 | loss_scale 1 | train_wall 1236 | gb_free 11.1 | wall 5551
2023-08-29 12:33:27 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 12:33:27 | INFO | fairseq.trainer | begin training epoch 6
2023-08-29 12:33:27 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 12:34:30 | INFO | train_inner | epoch 006:     54 / 1191 loss=2.758, trans_loss=3.6, nll_loss=1.768, w2v_ctc_loss=1.304, task_loss=1.574, contrastive_loss=0.795, total=6666, n_correct=3753.71, ppl=3.41, accuracy=56.311, wps=12130.8, ups=0.63, wpb=19315.1, bsz=666.5, num_updates=6000, lr=0.000182574, gnorm=0.698, clip=0, loss_scale=1, train_wall=103, gb_free=13.7, wall=5614
2023-08-29 12:34:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 12:35:06 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.533 | trans_loss 5.568 | nll_loss 2.95 | w2v_ctc_loss 1.54 | task_loss 8.01 | contrastive_loss 0.961 | total 6138.43 | n_correct 3720.86 | ppl 7.73 | accuracy 60.616 | uer 25.168 | wer 26.043 | raw_wer 26.043 | bleu 18.72 | wps 1486.1 | wpb 6138.4 | bsz 201.1 | num_updates 6000 | best_bleu 18.72
2023-08-29 12:35:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 6000 updates
2023-08-29 12:35:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-29 12:35:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt
2023-08-29 12:35:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_6_6000.pt (epoch 6 @ 6000 updates, score 18.72) (writing took 14.178571843003738 seconds)
2023-08-29 12:37:05 | INFO | train_inner | epoch 006:    154 / 1191 loss=2.708, trans_loss=3.587, nll_loss=1.75, w2v_ctc_loss=1.284, task_loss=1.582, contrastive_loss=0.725, total=6706.73, n_correct=3817.25, ppl=3.36, accuracy=56.917, wps=12521.2, ups=0.64, wpb=19420.3, bsz=672.5, num_updates=6100, lr=0.000181071, gnorm=0.676, clip=0, loss_scale=1, train_wall=104, gb_free=14.1, wall=5769
2023-08-29 12:38:49 | INFO | train_inner | epoch 006:    254 / 1191 loss=2.708, trans_loss=3.569, nll_loss=1.729, w2v_ctc_loss=1.275, task_loss=1.438, contrastive_loss=0.787, total=6843.77, n_correct=3942.42, ppl=3.31, accuracy=57.606, wps=18963.3, ups=0.96, wpb=19827, bsz=719.2, num_updates=6200, lr=0.000179605, gnorm=0.671, clip=0, loss_scale=1, train_wall=104, gb_free=10.7, wall=5873
2023-08-29 12:40:35 | INFO | train_inner | epoch 006:    354 / 1191 loss=2.664, trans_loss=3.565, nll_loss=1.722, w2v_ctc_loss=1.276, task_loss=1.572, contrastive_loss=0.668, total=6718.25, n_correct=3887.33, ppl=3.3, accuracy=57.862, wps=18428.6, ups=0.95, wpb=19456, bsz=675.4, num_updates=6300, lr=0.000178174, gnorm=0.639, clip=0, loss_scale=1, train_wall=105, gb_free=13.5, wall=5979
2023-08-29 12:42:18 | INFO | train_inner | epoch 006:    454 / 1191 loss=2.669, trans_loss=3.56, nll_loss=1.718, w2v_ctc_loss=1.287, task_loss=1.61, contrastive_loss=0.715, total=6581.72, n_correct=3815.55, ppl=3.29, accuracy=57.972, wps=18418, ups=0.97, wpb=19072.9, bsz=654.2, num_updates=6400, lr=0.000176777, gnorm=0.69, clip=0, loss_scale=1, train_wall=103, gb_free=12.4, wall=6083
2023-08-29 12:44:03 | INFO | train_inner | epoch 006:    554 / 1191 loss=2.622, trans_loss=3.542, nll_loss=1.696, w2v_ctc_loss=1.26, task_loss=1.605, contrastive_loss=0.638, total=6692.57, n_correct=3923.47, ppl=3.24, accuracy=58.624, wps=18511, ups=0.95, wpb=19403.6, bsz=661.9, num_updates=6500, lr=0.000175412, gnorm=0.635, clip=0, loss_scale=1, train_wall=104, gb_free=13.6, wall=6187
2023-08-29 12:45:48 | INFO | train_inner | epoch 006:    654 / 1191 loss=2.607, trans_loss=3.541, nll_loss=1.692, w2v_ctc_loss=1.244, task_loss=1.638, contrastive_loss=0.679, total=6683.66, n_correct=3936.91, ppl=3.23, accuracy=58.904, wps=18472.3, ups=0.95, wpb=19354.9, bsz=656, num_updates=6600, lr=0.000174078, gnorm=0.603, clip=0, loss_scale=1, train_wall=104, gb_free=13.6, wall=6292
2023-08-29 12:47:32 | INFO | train_inner | epoch 006:    754 / 1191 loss=2.626, trans_loss=3.525, nll_loss=1.672, w2v_ctc_loss=1.244, task_loss=1.455, contrastive_loss=0.771, total=6835.69, n_correct=4060.72, ppl=3.19, accuracy=59.405, wps=18989.8, ups=0.96, wpb=19805.9, bsz=721.1, num_updates=6700, lr=0.000172774, gnorm=0.647, clip=0, loss_scale=1, train_wall=104, gb_free=13.6, wall=6396
2023-08-29 12:49:17 | INFO | train_inner | epoch 006:    854 / 1191 loss=2.599, trans_loss=3.517, nll_loss=1.665, w2v_ctc_loss=1.243, task_loss=1.58, contrastive_loss=0.724, total=6631.85, n_correct=3957.51, ppl=3.17, accuracy=59.674, wps=18332.9, ups=0.95, wpb=19230.7, bsz=683.2, num_updates=6800, lr=0.000171499, gnorm=0.6, clip=0, loss_scale=1, train_wall=104, gb_free=13, wall=6501
2023-08-29 12:51:03 | INFO | train_inner | epoch 006:    954 / 1191 loss=2.589, trans_loss=3.522, nll_loss=1.669, w2v_ctc_loss=1.248, task_loss=1.716, contrastive_loss=0.704, total=6625.27, n_correct=3951.85, ppl=3.18, accuracy=59.648, wps=18170, ups=0.95, wpb=19193.5, bsz=639.2, num_updates=6900, lr=0.000170251, gnorm=0.62, clip=0, loss_scale=1, train_wall=105, gb_free=14.8, wall=6607
2023-08-29 12:52:47 | INFO | train_inner | epoch 006:   1054 / 1191 loss=2.536, trans_loss=3.504, nll_loss=1.647, w2v_ctc_loss=1.213, task_loss=1.584, contrastive_loss=0.635, total=6671.05, n_correct=4024.61, ppl=3.13, accuracy=60.329, wps=18528.7, ups=0.96, wpb=19330.5, bsz=662.2, num_updates=7000, lr=0.000169031, gnorm=0.595, clip=0, loss_scale=1, train_wall=104, gb_free=13.8, wall=6711
2023-08-29 12:54:30 | INFO | train_inner | epoch 006:   1154 / 1191 loss=2.512, trans_loss=3.493, nll_loss=1.634, w2v_ctc_loss=1.2, task_loss=1.422, contrastive_loss=0.581, total=6767.86, n_correct=4119.24, ppl=3.1, accuracy=60.865, wps=19057.7, ups=0.97, wpb=19618.5, bsz=715.8, num_updates=7100, lr=0.000167836, gnorm=0.576, clip=0, loss_scale=1, train_wall=102, gb_free=13.4, wall=6814
2023-08-29 12:55:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 12:55:41 | INFO | dev_st | epoch 006 | valid on 'dev_st' subset | loss 4.254 | trans_loss 5.31 | nll_loss 2.631 | w2v_ctc_loss 1.382 | task_loss 8.274 | contrastive_loss 0.791 | total 6138.43 | n_correct 3953.86 | ppl 6.19 | accuracy 64.412 | uer 22.753 | wer 24.403 | raw_wer 24.403 | bleu 22.57 | wps 1770.8 | wpb 6138.4 | bsz 201.1 | num_updates 7137 | best_bleu 22.57
2023-08-29 12:55:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 6 @ 7137 updates
2023-08-29 12:55:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:55:47 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 12:55:53 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 6 @ 7137 updates, score 22.57) (writing took 11.705968138005119 seconds)
2023-08-29 12:55:53 | INFO | fairseq_cli.train | end of epoch 6 (average epoch stats below)
2023-08-29 12:55:53 | INFO | train | epoch 006 | loss 2.623 | trans_loss 3.54 | nll_loss 1.692 | w2v_ctc_loss 1.252 | task_loss 1.558 | contrastive_loss 0.696 | total 6703.69 | n_correct 3945.02 | ppl 3.23 | accuracy 58.849 | wps 17182 | ups 0.88 | wpb 19422.7 | bsz 678.2 | num_updates 7137 | lr 0.000167401 | gnorm 0.633 | clip 0 | loss_scale 1 | train_wall 1237 | gb_free 13.5 | wall 6897
2023-08-29 12:55:53 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 12:55:53 | INFO | fairseq.trainer | begin training epoch 7
2023-08-29 12:55:53 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 12:57:07 | INFO | train_inner | epoch 007:     63 / 1191 loss=2.507, trans_loss=3.49, nll_loss=1.626, w2v_ctc_loss=1.186, task_loss=1.535, contrastive_loss=0.675, total=6709.85, n_correct=4087.35, ppl=3.09, accuracy=60.916, wps=12377.9, ups=0.64, wpb=19423.2, bsz=686.3, num_updates=7200, lr=0.000166667, gnorm=0.576, clip=0, loss_scale=1, train_wall=104, gb_free=13.5, wall=6971
2023-08-29 12:58:52 | INFO | train_inner | epoch 007:    163 / 1191 loss=2.479, trans_loss=3.472, nll_loss=1.608, w2v_ctc_loss=1.173, task_loss=1.591, contrastive_loss=0.65, total=6669.78, n_correct=4093.39, ppl=3.05, accuracy=61.372, wps=18448.8, ups=0.95, wpb=19344.6, bsz=674.7, num_updates=7300, lr=0.000165521, gnorm=0.573, clip=0, loss_scale=2, train_wall=104, gb_free=13.6, wall=7076
2023-08-29 13:00:36 | INFO | train_inner | epoch 007:    263 / 1191 loss=2.456, trans_loss=3.467, nll_loss=1.599, w2v_ctc_loss=1.171, task_loss=1.548, contrastive_loss=0.561, total=6700.41, n_correct=4129.03, ppl=3.03, accuracy=61.624, wps=18737.3, ups=0.97, wpb=19416.3, bsz=677, num_updates=7400, lr=0.000164399, gnorm=0.557, clip=0, loss_scale=2, train_wall=103, gb_free=13.7, wall=7180
2023-08-29 13:02:18 | INFO | train_inner | epoch 007:    363 / 1191 loss=2.423, trans_loss=3.454, nll_loss=1.584, w2v_ctc_loss=1.146, task_loss=1.51, contrastive_loss=0.533, total=6720.08, n_correct=4180.31, ppl=3, accuracy=62.206, wps=18989.5, ups=0.97, wpb=19478.4, bsz=685.8, num_updates=7500, lr=0.000163299, gnorm=0.576, clip=0, loss_scale=2, train_wall=102, gb_free=13.8, wall=7282
2023-08-29 13:04:02 | INFO | train_inner | epoch 007:    463 / 1191 loss=2.443, trans_loss=3.46, nll_loss=1.591, w2v_ctc_loss=1.15, task_loss=1.458, contrastive_loss=0.625, total=6789.62, n_correct=4214.75, ppl=3.01, accuracy=62.076, wps=18964.4, ups=0.96, wpb=19672.2, bsz=710.5, num_updates=7600, lr=0.000162221, gnorm=0.556, clip=0, loss_scale=2, train_wall=103, gb_free=14, wall=7386
2023-08-29 13:05:47 | INFO | train_inner | epoch 007:    563 / 1191 loss=2.425, trans_loss=3.458, nll_loss=1.588, w2v_ctc_loss=1.16, task_loss=1.601, contrastive_loss=0.545, total=6702.67, n_correct=4168.15, ppl=3.01, accuracy=62.186, wps=18527.8, ups=0.95, wpb=19415.7, bsz=670.5, num_updates=7700, lr=0.000161165, gnorm=0.557, clip=0, loss_scale=2, train_wall=104, gb_free=13.7, wall=7491
2023-08-29 13:07:32 | INFO | train_inner | epoch 007:    663 / 1191 loss=2.423, trans_loss=3.456, nll_loss=1.585, w2v_ctc_loss=1.141, task_loss=1.524, contrastive_loss=0.621, total=6760.71, n_correct=4206.94, ppl=3, accuracy=62.226, wps=18514.6, ups=0.95, wpb=19588.2, bsz=694.7, num_updates=7800, lr=0.000160128, gnorm=0.538, clip=0, loss_scale=2, train_wall=105, gb_free=13.4, wall=7597
2023-08-29 13:09:17 | INFO | train_inner | epoch 007:    763 / 1191 loss=2.39, trans_loss=3.447, nll_loss=1.573, w2v_ctc_loss=1.139, task_loss=1.597, contrastive_loss=0.518, total=6674.41, n_correct=4176.95, ppl=2.98, accuracy=62.582, wps=18570.9, ups=0.96, wpb=19327.8, bsz=668.7, num_updates=7900, lr=0.000159111, gnorm=0.534, clip=0, loss_scale=2, train_wall=103, gb_free=14.2, wall=7701
2023-08-29 13:11:01 | INFO | train_inner | epoch 007:    863 / 1191 loss=2.398, trans_loss=3.447, nll_loss=1.574, w2v_ctc_loss=1.132, task_loss=1.64, contrastive_loss=0.615, total=6649.63, n_correct=4159.32, ppl=2.98, accuracy=62.55, wps=18358, ups=0.95, wpb=19262.6, bsz=655.3, num_updates=8000, lr=0.000158114, gnorm=0.536, clip=0, loss_scale=2, train_wall=104, gb_free=10.9, wall=7806
2023-08-29 13:11:01 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 13:11:34 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.161 | trans_loss 5.219 | nll_loss 2.522 | w2v_ctc_loss 1.353 | task_loss 8.297 | contrastive_loss 0.732 | total 6138.43 | n_correct 4030.57 | ppl 5.74 | accuracy 65.661 | uer 21.972 | wer 23.276 | raw_wer 23.276 | bleu 23.32 | wps 1774.6 | wpb 6138.4 | bsz 201.1 | num_updates 8000 | best_bleu 23.32
2023-08-29 13:11:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8000 updates
2023-08-29 13:11:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-29 13:11:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt
2023-08-29 13:11:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_7_8000.pt (epoch 7 @ 8000 updates, score 23.32) (writing took 15.513959353993414 seconds)
2023-08-29 13:13:34 | INFO | train_inner | epoch 007:    963 / 1191 loss=2.368, trans_loss=3.436, nll_loss=1.56, w2v_ctc_loss=1.131, task_loss=1.637, contrastive_loss=0.512, total=6654.2, n_correct=4190.8, ppl=2.95, accuracy=62.98, wps=12654.6, ups=0.66, wpb=19276, bsz=650.4, num_updates=8100, lr=0.000157135, gnorm=0.524, clip=0, loss_scale=2, train_wall=104, gb_free=12.7, wall=7958
2023-08-29 13:15:18 | INFO | train_inner | epoch 007:   1063 / 1191 loss=2.392, trans_loss=3.435, nll_loss=1.558, w2v_ctc_loss=1.129, task_loss=1.536, contrastive_loss=0.624, total=6667.94, n_correct=4206.58, ppl=2.94, accuracy=63.087, wps=18472.5, ups=0.96, wpb=19306.9, bsz=689.1, num_updates=8200, lr=0.000156174, gnorm=0.532, clip=0, loss_scale=2, train_wall=104, gb_free=14.2, wall=8062
2023-08-29 13:17:03 | INFO | train_inner | epoch 007:   1163 / 1191 loss=2.38, trans_loss=3.435, nll_loss=1.561, w2v_ctc_loss=1.127, task_loss=1.582, contrastive_loss=0.591, total=6723.25, n_correct=4240.12, ppl=2.95, accuracy=63.067, wps=18628.2, ups=0.96, wpb=19488, bsz=679.5, num_updates=8300, lr=0.00015523, gnorm=0.527, clip=0, loss_scale=2, train_wall=104, gb_free=13.7, wall=8167
2023-08-29 13:17:32 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 13:18:05 | INFO | dev_st | epoch 007 | valid on 'dev_st' subset | loss 4.112 | trans_loss 5.168 | nll_loss 2.459 | w2v_ctc_loss 1.34 | task_loss 8.336 | contrastive_loss 0.693 | total 6138.43 | n_correct 4077.57 | ppl 5.5 | accuracy 66.427 | uer 21.83 | wer 23.094 | raw_wer 23.094 | bleu 24.11 | wps 1750.3 | wpb 6138.4 | bsz 201.1 | num_updates 8328 | best_bleu 24.11
2023-08-29 13:18:05 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 7 @ 8328 updates
2023-08-29 13:18:05 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 13:18:11 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 13:18:17 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 7 @ 8328 updates, score 24.11) (writing took 12.6713119160122 seconds)
2023-08-29 13:18:18 | INFO | fairseq_cli.train | end of epoch 7 (average epoch stats below)
2023-08-29 13:18:18 | INFO | train | epoch 007 | loss 2.419 | trans_loss 3.453 | nll_loss 1.581 | w2v_ctc_loss 1.146 | task_loss 1.563 | contrastive_loss 0.587 | total 6703.69 | n_correct 4177.13 | ppl 2.99 | accuracy 62.311 | wps 17199.9 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 8328 | lr 0.000154969 | gnorm 0.547 | clip 0 | loss_scale 2 | train_wall 1236 | gb_free 12.9 | wall 8242
2023-08-29 13:18:18 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 13:18:18 | INFO | fairseq.trainer | begin training epoch 8
2023-08-29 13:18:18 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 13:19:40 | INFO | train_inner | epoch 008:     72 / 1191 loss=2.315, trans_loss=3.414, nll_loss=1.531, w2v_ctc_loss=1.089, task_loss=1.55, contrastive_loss=0.471, total=6745.48, n_correct=4301.42, ppl=2.89, accuracy=63.767, wps=12423.2, ups=0.64, wpb=19533.8, bsz=674.5, num_updates=8400, lr=0.000154303, gnorm=0.512, clip=0, loss_scale=2, train_wall=103, gb_free=13.4, wall=8324
2023-08-29 13:21:25 | INFO | train_inner | epoch 008:    172 / 1191 loss=2.334, trans_loss=3.404, nll_loss=1.523, w2v_ctc_loss=1.083, task_loss=1.513, contrastive_loss=0.617, total=6729.03, n_correct=4302.79, ppl=2.87, accuracy=63.944, wps=18703.9, ups=0.96, wpb=19515.5, bsz=709.4, num_updates=8500, lr=0.000153393, gnorm=0.514, clip=0, loss_scale=2, train_wall=104, gb_free=12.1, wall=8429
2023-08-29 13:23:10 | INFO | train_inner | epoch 008:    272 / 1191 loss=2.311, trans_loss=3.409, nll_loss=1.525, w2v_ctc_loss=1.08, task_loss=1.554, contrastive_loss=0.535, total=6744.69, n_correct=4314.74, ppl=2.88, accuracy=63.972, wps=18444.8, ups=0.94, wpb=19537.1, bsz=690.8, num_updates=8600, lr=0.000152499, gnorm=0.507, clip=0, loss_scale=2, train_wall=105, gb_free=13.2, wall=8535
2023-08-29 13:24:56 | INFO | train_inner | epoch 008:    372 / 1191 loss=2.305, trans_loss=3.412, nll_loss=1.532, w2v_ctc_loss=1.093, task_loss=1.668, contrastive_loss=0.493, total=6658.8, n_correct=4245.74, ppl=2.89, accuracy=63.761, wps=18226.4, ups=0.94, wpb=19304.8, bsz=648.9, num_updates=8700, lr=0.00015162, gnorm=0.508, clip=0, loss_scale=2, train_wall=105, gb_free=15, wall=8640
2023-08-29 13:26:41 | INFO | train_inner | epoch 008:    472 / 1191 loss=2.287, trans_loss=3.4, nll_loss=1.516, w2v_ctc_loss=1.081, task_loss=1.621, contrastive_loss=0.475, total=6647.69, n_correct=4270.6, ppl=2.86, accuracy=64.242, wps=18482.1, ups=0.96, wpb=19267.9, bsz=656.8, num_updates=8800, lr=0.000150756, gnorm=0.506, clip=0, loss_scale=2, train_wall=103, gb_free=9.4, wall=8745
2023-08-29 13:28:25 | INFO | train_inner | epoch 008:    572 / 1191 loss=2.276, trans_loss=3.4, nll_loss=1.516, w2v_ctc_loss=1.065, task_loss=1.613, contrastive_loss=0.514, total=6679.62, n_correct=4296.02, ppl=2.86, accuracy=64.315, wps=18570.8, ups=0.96, wpb=19354, bsz=670.5, num_updates=8900, lr=0.000149906, gnorm=0.496, clip=0, loss_scale=2, train_wall=104, gb_free=12, wall=8849
2023-08-29 13:30:08 | INFO | train_inner | epoch 008:    672 / 1191 loss=2.266, trans_loss=3.4, nll_loss=1.516, w2v_ctc_loss=1.067, task_loss=1.525, contrastive_loss=0.445, total=6738.94, n_correct=4342.11, ppl=2.86, accuracy=64.433, wps=18951.6, ups=0.97, wpb=19521.7, bsz=681.5, num_updates=9000, lr=0.000149071, gnorm=0.495, clip=0, loss_scale=2, train_wall=102, gb_free=13.3, wall=8952
2023-08-29 13:31:52 | INFO | train_inner | epoch 008:    772 / 1191 loss=2.277, trans_loss=3.397, nll_loss=1.513, w2v_ctc_loss=1.073, task_loss=1.605, contrastive_loss=0.519, total=6677.55, n_correct=4299.66, ppl=2.85, accuracy=64.39, wps=18640.9, ups=0.96, wpb=19351.7, bsz=668.2, num_updates=9100, lr=0.00014825, gnorm=0.499, clip=0, loss_scale=2, train_wall=103, gb_free=13.9, wall=9056
2023-08-29 13:33:35 | INFO | train_inner | epoch 008:    872 / 1191 loss=2.266, trans_loss=3.388, nll_loss=1.501, w2v_ctc_loss=1.07, task_loss=1.465, contrastive_loss=0.469, total=6788.78, n_correct=4401.31, ppl=2.83, accuracy=64.832, wps=18997.9, ups=0.97, wpb=19674.1, bsz=702.5, num_updates=9200, lr=0.000147442, gnorm=0.494, clip=0, loss_scale=2, train_wall=103, gb_free=13.8, wall=9159
2023-08-29 13:35:19 | INFO | train_inner | epoch 008:    972 / 1191 loss=2.277, trans_loss=3.398, nll_loss=1.512, w2v_ctc_loss=1.067, task_loss=1.605, contrastive_loss=0.553, total=6663.7, n_correct=4297.35, ppl=2.85, accuracy=64.489, wps=18544.9, ups=0.96, wpb=19293.7, bsz=664.8, num_updates=9300, lr=0.000146647, gnorm=0.498, clip=0, loss_scale=2, train_wall=103, gb_free=13.3, wall=9263
2023-08-29 13:37:03 | INFO | train_inner | epoch 008:   1072 / 1191 loss=2.238, trans_loss=3.389, nll_loss=1.498, w2v_ctc_loss=1.06, task_loss=1.585, contrastive_loss=0.417, total=6705.45, n_correct=4349.12, ppl=2.82, accuracy=64.859, wps=18612.4, ups=0.96, wpb=19401.4, bsz=666.9, num_updates=9400, lr=0.000145865, gnorm=0.487, clip=0, loss_scale=4, train_wall=104, gb_free=13.9, wall=9368
2023-08-29 13:38:47 | INFO | train_inner | epoch 008:   1172 / 1191 loss=2.269, trans_loss=3.379, nll_loss=1.491, w2v_ctc_loss=1.047, task_loss=1.45, contrastive_loss=0.606, total=6718.14, n_correct=4369.83, ppl=2.81, accuracy=65.045, wps=18875.2, ups=0.97, wpb=19472.2, bsz=716.5, num_updates=9500, lr=0.000145095, gnorm=0.503, clip=0, loss_scale=4, train_wall=103, gb_free=14.5, wall=9471
2023-08-29 13:39:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 13:39:39 | INFO | dev_st | epoch 008 | valid on 'dev_st' subset | loss 4.012 | trans_loss 5.089 | nll_loss 2.365 | w2v_ctc_loss 1.27 | task_loss 8.416 | contrastive_loss 0.618 | total 6138.43 | n_correct 4154.86 | ppl 5.15 | accuracy 67.686 | uer 19.726 | wer 21.019 | raw_wer 21.019 | bleu 25.66 | wps 1762.9 | wpb 6138.4 | bsz 201.1 | num_updates 9519 | best_bleu 25.66
2023-08-29 13:39:39 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 8 @ 9519 updates
2023-08-29 13:39:39 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 13:39:45 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 13:39:51 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 8 @ 9519 updates, score 25.66) (writing took 12.152931043994613 seconds)
2023-08-29 13:39:51 | INFO | fairseq_cli.train | end of epoch 8 (average epoch stats below)
2023-08-29 13:39:51 | INFO | train | epoch 008 | loss 2.283 | trans_loss 3.398 | nll_loss 1.513 | w2v_ctc_loss 1.071 | task_loss 1.564 | contrastive_loss 0.513 | total 6703.69 | n_correct 4315.42 | ppl 2.85 | accuracy 64.374 | wps 17887.1 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 9519 | lr 0.00014495 | gnorm 0.501 | clip 0 | loss_scale 4 | train_wall 1233 | gb_free 13.9 | wall 9535
2023-08-29 13:39:51 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 13:39:51 | INFO | fairseq.trainer | begin training epoch 9
2023-08-29 13:39:51 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 13:41:22 | INFO | train_inner | epoch 009:     81 / 1191 loss=2.21, trans_loss=3.366, nll_loss=1.472, w2v_ctc_loss=1.019, task_loss=1.562, contrastive_loss=0.504, total=6684.33, n_correct=4376.85, ppl=2.77, accuracy=65.479, wps=12432.7, ups=0.64, wpb=19364.4, bsz=678.1, num_updates=9600, lr=0.000144338, gnorm=0.484, clip=0, loss_scale=4, train_wall=103, gb_free=14.3, wall=9627
2023-08-29 13:43:07 | INFO | train_inner | epoch 009:    181 / 1191 loss=2.195, trans_loss=3.356, nll_loss=1.462, w2v_ctc_loss=1.013, task_loss=1.548, contrastive_loss=0.478, total=6740.44, n_correct=4431.01, ppl=2.75, accuracy=65.738, wps=18638.7, ups=0.95, wpb=19538.6, bsz=685.8, num_updates=9700, lr=0.000143592, gnorm=0.481, clip=0, loss_scale=4, train_wall=104, gb_free=12.1, wall=9731
2023-08-29 13:44:51 | INFO | train_inner | epoch 009:    281 / 1191 loss=2.202, trans_loss=3.369, nll_loss=1.474, w2v_ctc_loss=1.03, task_loss=1.482, contrastive_loss=0.427, total=6810.44, n_correct=4468.53, ppl=2.78, accuracy=65.613, wps=18973.8, ups=0.96, wpb=19713.5, bsz=704.5, num_updates=9800, lr=0.000142857, gnorm=0.477, clip=0, loss_scale=4, train_wall=103, gb_free=4.8, wall=9835
2023-08-29 13:46:38 | INFO | train_inner | epoch 009:    381 / 1191 loss=2.195, trans_loss=3.362, nll_loss=1.468, w2v_ctc_loss=1.015, task_loss=1.546, contrastive_loss=0.478, total=6764.19, n_correct=4441.67, ppl=2.77, accuracy=65.664, wps=18406.2, ups=0.94, wpb=19599, bsz=692.8, num_updates=9900, lr=0.000142134, gnorm=0.474, clip=0, loss_scale=4, train_wall=106, gb_free=11.1, wall=9942
2023-08-29 13:48:23 | INFO | train_inner | epoch 009:    481 / 1191 loss=2.21, trans_loss=3.362, nll_loss=1.47, w2v_ctc_loss=1.028, task_loss=1.534, contrastive_loss=0.498, total=6721.58, n_correct=4419.51, ppl=2.77, accuracy=65.751, wps=18505.2, ups=0.95, wpb=19482.7, bsz=693.3, num_updates=10000, lr=0.000141421, gnorm=0.48, clip=0, loss_scale=4, train_wall=105, gb_free=12.6, wall=10047
2023-08-29 13:48:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 13:48:55 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.982 | trans_loss 5.064 | nll_loss 2.334 | w2v_ctc_loss 1.251 | task_loss 8.478 | contrastive_loss 0.602 | total 6138.43 | n_correct 4187.29 | ppl 5.04 | accuracy 68.214 | uer 19.397 | wer 20.762 | raw_wer 20.762 | bleu 25.98 | wps 1742.4 | wpb 6138.4 | bsz 201.1 | num_updates 10000 | best_bleu 25.98
2023-08-29 13:48:55 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10000 updates
2023-08-29 13:48:55 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-29 13:48:57 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt
2023-08-29 13:49:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_9_10000.pt (epoch 9 @ 10000 updates, score 25.98) (writing took 12.39443858199229 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 13:50:51 | INFO | train_inner | epoch 009:    581 / 1191 loss=2.168, trans_loss=3.356, nll_loss=1.46, w2v_ctc_loss=1.012, task_loss=1.612, contrastive_loss=0.407, total=6622.12, n_correct=4367.41, ppl=2.75, accuracy=65.952, wps=12929.5, ups=0.67, wpb=19183.5, bsz=661.2, num_updates=10100, lr=0.00014072, gnorm=0.388, clip=0, loss_scale=4, train_wall=102, gb_free=14.5, wall=10195
2023-08-29 13:52:35 | INFO | train_inner | epoch 009:    681 / 1191 loss=2.187, trans_loss=3.366, nll_loss=1.472, w2v_ctc_loss=1.019, task_loss=1.725, contrastive_loss=0.483, total=6572.09, n_correct=4318.98, ppl=2.77, accuracy=65.717, wps=18285.7, ups=0.96, wpb=19033.3, bsz=628.4, num_updates=10200, lr=0.000140028, gnorm=0.388, clip=0, loss_scale=4, train_wall=104, gb_free=13.4, wall=10300
2023-08-29 13:54:20 | INFO | train_inner | epoch 009:    781 / 1191 loss=2.197, trans_loss=3.359, nll_loss=1.466, w2v_ctc_loss=1.017, task_loss=1.56, contrastive_loss=0.506, total=6687.01, n_correct=4403.29, ppl=2.76, accuracy=65.848, wps=18604.8, ups=0.96, wpb=19382.2, bsz=684, num_updates=10300, lr=0.000139347, gnorm=0.38, clip=0, loss_scale=4, train_wall=104, gb_free=14.3, wall=10404
2023-08-29 13:56:04 | INFO | train_inner | epoch 009:    881 / 1191 loss=2.165, trans_loss=3.358, nll_loss=1.463, w2v_ctc_loss=1.016, task_loss=1.595, contrastive_loss=0.397, total=6712.16, n_correct=4425.42, ppl=2.76, accuracy=65.931, wps=18646.2, ups=0.96, wpb=19450, bsz=662.2, num_updates=10400, lr=0.000138675, gnorm=0.382, clip=0, loss_scale=4, train_wall=104, gb_free=11.2, wall=10508
2023-08-29 13:57:49 | INFO | train_inner | epoch 009:    981 / 1191 loss=2.173, trans_loss=3.353, nll_loss=1.456, w2v_ctc_loss=1.009, task_loss=1.553, contrastive_loss=0.464, total=6714.94, n_correct=4442.56, ppl=2.74, accuracy=66.159, wps=18528.7, ups=0.95, wpb=19450.9, bsz=685.3, num_updates=10500, lr=0.000138013, gnorm=0.378, clip=0, loss_scale=4, train_wall=104, gb_free=13.9, wall=10613
2023-08-29 13:59:33 | INFO | train_inner | epoch 009:   1081 / 1191 loss=2.182, trans_loss=3.352, nll_loss=1.457, w2v_ctc_loss=1.009, task_loss=1.543, contrastive_loss=0.516, total=6671.51, n_correct=4412.85, ppl=2.75, accuracy=66.145, wps=18610.9, ups=0.96, wpb=19335.8, bsz=678.8, num_updates=10600, lr=0.000137361, gnorm=0.379, clip=0, loss_scale=4, train_wall=103, gb_free=14.2, wall=10717
2023-08-29 14:01:17 | INFO | train_inner | epoch 009:   1181 / 1191 loss=2.167, trans_loss=3.352, nll_loss=1.456, w2v_ctc_loss=1.026, task_loss=1.643, contrastive_loss=0.389, total=6674.07, n_correct=4411.52, ppl=2.74, accuracy=66.099, wps=18585.4, ups=0.96, wpb=19339.3, bsz=655, num_updates=10700, lr=0.000136717, gnorm=0.379, clip=0, loss_scale=4, train_wall=103, gb_free=14.4, wall=10821
2023-08-29 14:01:27 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
2023-08-29 14:02:00 | INFO | dev_st | epoch 009 | valid on 'dev_st' subset | loss 3.954 | trans_loss 5.04 | nll_loss 2.3 | w2v_ctc_loss 1.241 | task_loss 8.427 | contrastive_loss 0.574 | total 6138.43 | n_correct 4208.57 | ppl 4.93 | accuracy 68.561 | uer 19.691 | wer 21.09 | raw_wer 21.09 | bleu 26.47 | wps 1755.7 | wpb 6138.4 | bsz 201.1 | num_updates 10710 | best_bleu 26.47
2023-08-29 14:02:00 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 9 @ 10710 updates
2023-08-29 14:02:00 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:02:06 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:02:12 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 9 @ 10710 updates, score 26.47) (writing took 12.388373358000536 seconds)
2023-08-29 14:02:13 | INFO | fairseq_cli.train | end of epoch 9 (average epoch stats below)
2023-08-29 14:02:13 | INFO | train | epoch 009 | loss 2.186 | trans_loss 3.359 | nll_loss 1.464 | w2v_ctc_loss 1.017 | task_loss 1.567 | contrastive_loss 0.46 | total 6703.69 | n_correct 4415.34 | ppl 2.76 | accuracy 65.864 | wps 17242.6 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 10710 | lr 0.000136653 | gnorm 0.421 | clip 0 | loss_scale 4 | train_wall 1236 | gb_free 14.3 | wall 10877
2023-08-29 14:02:13 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 14:02:13 | INFO | fairseq.trainer | begin training epoch 10
2023-08-29 14:02:13 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 14:03:54 | INFO | train_inner | epoch 010:     90 / 1191 loss=2.115, trans_loss=3.327, nll_loss=1.424, w2v_ctc_loss=0.973, task_loss=1.567, contrastive_loss=0.39, total=6665.56, n_correct=4463.36, ppl=2.68, accuracy=66.962, wps=12317.9, ups=0.64, wpb=19313.2, bsz=674, num_updates=10800, lr=0.000136083, gnorm=0.373, clip=0, loss_scale=4, train_wall=103, gb_free=14.1, wall=10978
2023-08-29 14:05:37 | INFO | train_inner | epoch 010:    190 / 1191 loss=2.132, trans_loss=3.338, nll_loss=1.439, w2v_ctc_loss=0.986, task_loss=1.578, contrastive_loss=0.424, total=6676.4, n_correct=4450.45, ppl=2.71, accuracy=66.659, wps=18753.9, ups=0.97, wpb=19344, bsz=679, num_updates=10900, lr=0.000135457, gnorm=0.373, clip=0, loss_scale=4, train_wall=103, gb_free=10.5, wall=11081
2023-08-29 14:07:21 | INFO | train_inner | epoch 010:    290 / 1191 loss=2.134, trans_loss=3.329, nll_loss=1.426, w2v_ctc_loss=0.977, task_loss=1.541, contrastive_loss=0.48, total=6758.29, n_correct=4520.26, ppl=2.69, accuracy=66.885, wps=18715, ups=0.96, wpb=19575, bsz=688, num_updates=11000, lr=0.00013484, gnorm=0.375, clip=0, loss_scale=4, train_wall=104, gb_free=13.8, wall=11185
2023-08-29 14:09:06 | INFO | train_inner | epoch 010:    390 / 1191 loss=2.159, trans_loss=3.332, nll_loss=1.431, w2v_ctc_loss=0.985, task_loss=1.443, contrastive_loss=0.55, total=6837.98, n_correct=4567.2, ppl=2.7, accuracy=66.792, wps=18860.8, ups=0.95, wpb=19812.8, bsz=733.7, num_updates=11100, lr=0.000134231, gnorm=0.371, clip=0, loss_scale=4, train_wall=104, gb_free=12.8, wall=11291
2023-08-29 14:10:51 | INFO | train_inner | epoch 010:    490 / 1191 loss=2.116, trans_loss=3.327, nll_loss=1.423, w2v_ctc_loss=0.994, task_loss=1.58, contrastive_loss=0.352, total=6733.09, n_correct=4509.94, ppl=2.68, accuracy=66.982, wps=18728.8, ups=0.96, wpb=19496.6, bsz=671.5, num_updates=11200, lr=0.000133631, gnorm=0.365, clip=0, loss_scale=4, train_wall=104, gb_free=13.4, wall=11395
2023-08-29 14:12:34 | INFO | train_inner | epoch 010:    590 / 1191 loss=2.12, trans_loss=3.333, nll_loss=1.431, w2v_ctc_loss=0.979, task_loss=1.584, contrastive_loss=0.428, total=6703.25, n_correct=4483.32, ppl=2.7, accuracy=66.883, wps=18762.4, ups=0.97, wpb=19415.2, bsz=668.5, num_updates=11300, lr=0.000133038, gnorm=0.37, clip=0, loss_scale=4, train_wall=103, gb_free=11.2, wall=11498
2023-08-29 14:14:19 | INFO | train_inner | epoch 010:    690 / 1191 loss=2.126, trans_loss=3.329, nll_loss=1.428, w2v_ctc_loss=0.984, task_loss=1.54, contrastive_loss=0.426, total=6753.28, n_correct=4523.29, ppl=2.69, accuracy=66.979, wps=18630.2, ups=0.95, wpb=19568.5, bsz=694.1, num_updates=11400, lr=0.000132453, gnorm=0.369, clip=0, loss_scale=8, train_wall=104, gb_free=12.4, wall=11603
2023-08-29 14:16:04 | INFO | train_inner | epoch 010:    790 / 1191 loss=2.09, trans_loss=3.325, nll_loss=1.423, w2v_ctc_loss=0.977, task_loss=1.661, contrastive_loss=0.335, total=6644.44, n_correct=4456.16, ppl=2.68, accuracy=67.066, wps=18341, ups=0.95, wpb=19257.5, bsz=653.5, num_updates=11500, lr=0.000131876, gnorm=0.365, clip=0, loss_scale=8, train_wall=104, gb_free=12.5, wall=11708
2023-08-29 14:17:49 | INFO | train_inner | epoch 010:    890 / 1191 loss=2.116, trans_loss=3.325, nll_loss=1.422, w2v_ctc_loss=0.986, task_loss=1.681, contrastive_loss=0.423, total=6555.79, n_correct=4390.44, ppl=2.68, accuracy=66.97, wps=18105.3, ups=0.95, wpb=18998.8, bsz=643.2, num_updates=11600, lr=0.000131306, gnorm=0.37, clip=0, loss_scale=8, train_wall=104, gb_free=14.3, wall=11813
2023-08-29 14:19:33 | INFO | train_inner | epoch 010:    990 / 1191 loss=2.099, trans_loss=3.32, nll_loss=1.416, w2v_ctc_loss=0.977, task_loss=1.512, contrastive_loss=0.368, total=6744.7, n_correct=4536.38, ppl=2.67, accuracy=67.258, wps=18808.2, ups=0.96, wpb=19542, bsz=685, num_updates=11700, lr=0.000130744, gnorm=0.362, clip=0, loss_scale=8, train_wall=103, gb_free=12.6, wall=11917
2023-08-29 14:21:18 | INFO | train_inner | epoch 010:   1090 / 1191 loss=2.102, trans_loss=3.317, nll_loss=1.414, w2v_ctc_loss=0.986, task_loss=1.575, contrastive_loss=0.364, total=6678.1, n_correct=4490.01, ppl=2.67, accuracy=67.235, wps=18469.9, ups=0.95, wpb=19361.2, bsz=671.9, num_updates=11800, lr=0.000130189, gnorm=0.363, clip=0, loss_scale=8, train_wall=104, gb_free=14.7, wall=12022
2023-08-29 14:23:01 | INFO | train_inner | epoch 010:   1190 / 1191 loss=2.129, trans_loss=3.324, nll_loss=1.42, w2v_ctc_loss=0.974, task_loss=1.539, contrastive_loss=0.54, total=6723, n_correct=4510.05, ppl=2.68, accuracy=67.084, wps=18769.7, ups=0.96, wpb=19474.7, bsz=687.8, num_updates=11900, lr=0.000129641, gnorm=0.368, clip=0, loss_scale=8, train_wall=103, gb_free=10.3, wall=12126
2023-08-29 14:23:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 14:23:35 | INFO | dev_st | epoch 010 | valid on 'dev_st' subset | loss 3.897 | trans_loss 4.985 | nll_loss 2.236 | w2v_ctc_loss 1.22 | task_loss 8.482 | contrastive_loss 0.533 | total 6138.43 | n_correct 4253.57 | ppl 4.71 | accuracy 69.294 | uer 19.308 | wer 20.863 | raw_wer 20.863 | bleu 26.94 | wps 1692.4 | wpb 6138.4 | bsz 201.1 | num_updates 11901 | best_bleu 26.94
2023-08-29 14:23:35 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 10 @ 11901 updates
2023-08-29 14:23:35 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:23:42 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:23:49 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 10 @ 11901 updates, score 26.94) (writing took 13.621058092001476 seconds)
2023-08-29 14:23:50 | INFO | fairseq_cli.train | end of epoch 10 (average epoch stats below)
2023-08-29 14:23:50 | INFO | train | epoch 010 | loss 2.119 | trans_loss 3.327 | nll_loss 1.425 | w2v_ctc_loss 0.981 | task_loss 1.568 | contrastive_loss 0.425 | total 6703.69 | n_correct 4490.16 | ppl 2.68 | accuracy 66.98 | wps 17837 | ups 0.92 | wpb 19422.7 | bsz 678.2 | num_updates 11901 | lr 0.000129635 | gnorm 0.369 | clip 0 | loss_scale 8 | train_wall 1235 | gb_free 12.1 | wall 12174
2023-08-29 14:23:50 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 14:23:50 | INFO | fairseq.trainer | begin training epoch 11
2023-08-29 14:23:50 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 14:25:40 | INFO | train_inner | epoch 011:     99 / 1191 loss=2.075, trans_loss=3.305, nll_loss=1.398, w2v_ctc_loss=0.961, task_loss=1.671, contrastive_loss=0.38, total=6625.08, n_correct=4477.4, ppl=2.63, accuracy=67.583, wps=12079.9, ups=0.63, wpb=19200.5, bsz=646.3, num_updates=12000, lr=0.000129099, gnorm=0.365, clip=0, loss_scale=8, train_wall=104, gb_free=12.1, wall=12285
2023-08-29 14:25:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 14:26:13 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.912 | trans_loss 4.987 | nll_loss 2.233 | w2v_ctc_loss 1.266 | task_loss 8.537 | contrastive_loss 0.535 | total 6138.43 | n_correct 4256.57 | ppl 4.7 | accuracy 69.343 | uer 19.397 | wer 20.919 | raw_wer 20.919 | bleu 26.97 | wps 1748.3 | wpb 6138.4 | bsz 201.1 | num_updates 12000 | best_bleu 26.97
2023-08-29 14:26:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 12000 updates
2023-08-29 14:26:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-29 14:26:15 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt
2023-08-29 14:26:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_11_12000.pt (epoch 11 @ 12000 updates, score 26.97) (writing took 14.139406543996301 seconds)
2023-08-29 14:28:11 | INFO | train_inner | epoch 011:    199 / 1191 loss=2.069, trans_loss=3.306, nll_loss=1.397, w2v_ctc_loss=0.939, task_loss=1.53, contrastive_loss=0.441, total=6714.24, n_correct=4549.23, ppl=2.63, accuracy=67.755, wps=12919.1, ups=0.66, wpb=19444, bsz=690.5, num_updates=12100, lr=0.000128565, gnorm=0.36, clip=0, loss_scale=8, train_wall=103, gb_free=4.7, wall=12435
2023-08-29 14:29:55 | INFO | train_inner | epoch 011:    299 / 1191 loss=2.068, trans_loss=3.303, nll_loss=1.394, w2v_ctc_loss=0.946, task_loss=1.577, contrastive_loss=0.423, total=6621.56, n_correct=4484.21, ppl=2.63, accuracy=67.721, wps=18409.7, ups=0.96, wpb=19185.3, bsz=672.4, num_updates=12200, lr=0.000128037, gnorm=0.365, clip=0, loss_scale=8, train_wall=104, gb_free=10, wall=12539
2023-08-29 14:31:39 | INFO | train_inner | epoch 011:    399 / 1191 loss=2.067, trans_loss=3.301, nll_loss=1.393, w2v_ctc_loss=0.947, task_loss=1.634, contrastive_loss=0.429, total=6581.25, n_correct=4465.57, ppl=2.63, accuracy=67.853, wps=18418.3, ups=0.97, wpb=19076.8, bsz=656.9, num_updates=12300, lr=0.000127515, gnorm=0.358, clip=0, loss_scale=8, train_wall=103, gb_free=12, wall=12643
2023-08-29 14:33:23 | INFO | train_inner | epoch 011:    499 / 1191 loss=2.061, trans_loss=3.307, nll_loss=1.4, w2v_ctc_loss=0.959, task_loss=1.654, contrastive_loss=0.327, total=6670.13, n_correct=4512.54, ppl=2.64, accuracy=67.653, wps=18524.2, ups=0.96, wpb=19333.3, bsz=653.5, num_updates=12400, lr=0.000127, gnorm=0.359, clip=0, loss_scale=8, train_wall=104, gb_free=14.8, wall=12747
2023-08-29 14:35:06 | INFO | train_inner | epoch 011:    599 / 1191 loss=2.056, trans_loss=3.302, nll_loss=1.396, w2v_ctc_loss=0.957, task_loss=1.586, contrastive_loss=0.322, total=6647.53, n_correct=4497.83, ppl=2.63, accuracy=67.662, wps=18687.5, ups=0.97, wpb=19280.2, bsz=669, num_updates=12500, lr=0.000126491, gnorm=0.361, clip=0, loss_scale=8, train_wall=103, gb_free=12.2, wall=12850
2023-08-29 14:36:51 | INFO | train_inner | epoch 011:    699 / 1191 loss=2.052, trans_loss=3.298, nll_loss=1.39, w2v_ctc_loss=0.946, task_loss=1.655, contrastive_loss=0.363, total=6670.92, n_correct=4526.47, ppl=2.62, accuracy=67.854, wps=18405.6, ups=0.95, wpb=19341.9, bsz=658.6, num_updates=12600, lr=0.000125988, gnorm=0.356, clip=0, loss_scale=8, train_wall=104, gb_free=13.8, wall=12955
2023-08-29 14:38:36 | INFO | train_inner | epoch 011:    799 / 1191 loss=2.079, trans_loss=3.307, nll_loss=1.4, w2v_ctc_loss=0.961, task_loss=1.516, contrastive_loss=0.399, total=6805.86, n_correct=4604.08, ppl=2.64, accuracy=67.649, wps=18884.2, ups=0.96, wpb=19717.6, bsz=708.8, num_updates=12700, lr=0.000125491, gnorm=0.354, clip=0, loss_scale=8, train_wall=104, gb_free=14.2, wall=13060
2023-08-29 14:40:21 | INFO | train_inner | epoch 011:    899 / 1191 loss=2.051, trans_loss=3.307, nll_loss=1.398, w2v_ctc_loss=0.938, task_loss=1.549, contrastive_loss=0.371, total=6772.2, n_correct=4593.66, ppl=2.64, accuracy=67.831, wps=18718.2, ups=0.95, wpb=19604.9, bsz=678.5, num_updates=12800, lr=0.000125, gnorm=0.35, clip=0, loss_scale=8, train_wall=104, gb_free=12.5, wall=13165
2023-08-29 14:42:06 | INFO | train_inner | epoch 011:    999 / 1191 loss=2.059, trans_loss=3.3, nll_loss=1.389, w2v_ctc_loss=0.927, task_loss=1.468, contrastive_loss=0.456, total=6790.09, n_correct=4621.21, ppl=2.62, accuracy=68.058, wps=18722.3, ups=0.95, wpb=19658.4, bsz=709.9, num_updates=12900, lr=0.000124515, gnorm=0.353, clip=0, loss_scale=8, train_wall=104, gb_free=10.8, wall=13270
2023-08-29 14:43:49 | INFO | train_inner | epoch 011:   1099 / 1191 loss=2.07, trans_loss=3.298, nll_loss=1.389, w2v_ctc_loss=0.943, task_loss=1.49, contrastive_loss=0.469, total=6750.83, n_correct=4589.83, ppl=2.62, accuracy=67.989, wps=18820, ups=0.96, wpb=19560.1, bsz=699.2, num_updates=13000, lr=0.000124035, gnorm=0.353, clip=0, loss_scale=8, train_wall=103, gb_free=15.2, wall=13374
2023-08-29 14:45:26 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 14:45:58 | INFO | dev_st | epoch 011 | valid on 'dev_st' subset | loss 3.869 | trans_loss 4.955 | nll_loss 2.195 | w2v_ctc_loss 1.23 | task_loss 8.525 | contrastive_loss 0.505 | total 6138.43 | n_correct 4288.29 | ppl 4.58 | accuracy 69.86 | uer 18.538 | wer 20.033 | raw_wer 20.033 | bleu 27.44 | wps 1756.1 | wpb 6138.4 | bsz 201.1 | num_updates 13092 | best_bleu 27.44
2023-08-29 14:45:58 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 11 @ 13092 updates
2023-08-29 14:45:58 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:46:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 14:46:13 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 11 @ 13092 updates, score 27.44) (writing took 14.563839726994047 seconds)
2023-08-29 14:46:13 | INFO | fairseq_cli.train | end of epoch 11 (average epoch stats below)
2023-08-29 14:46:13 | INFO | train | epoch 011 | loss 2.063 | trans_loss 3.303 | nll_loss 1.395 | w2v_ctc_loss 0.947 | task_loss 1.568 | contrastive_loss 0.396 | total 6703.69 | n_correct 4544.81 | ppl 2.63 | accuracy 67.796 | wps 17214.4 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 13092 | lr 0.000123598 | gnorm 0.357 | clip 0 | loss_scale 8 | train_wall 1234 | gb_free 13.2 | wall 13518
2023-08-29 14:46:14 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 14:46:14 | INFO | fairseq.trainer | begin training epoch 12
2023-08-29 14:46:14 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 14:46:29 | INFO | train_inner | epoch 012:      8 / 1191 loss=2.05, trans_loss=3.301, nll_loss=1.391, w2v_ctc_loss=0.939, task_loss=1.449, contrastive_loss=0.369, total=6828.68, n_correct=4646.18, ppl=2.62, accuracy=68.039, wps=12358.9, ups=0.63, wpb=19765.9, bsz=719.4, num_updates=13100, lr=0.00012356, gnorm=0.35, clip=0, loss_scale=8, train_wall=104, gb_free=13.2, wall=13534
2023-08-29 14:48:13 | INFO | train_inner | epoch 012:    108 / 1191 loss=2.002, trans_loss=3.279, nll_loss=1.365, w2v_ctc_loss=0.915, task_loss=1.604, contrastive_loss=0.306, total=6717.99, n_correct=4608.28, ppl=2.58, accuracy=68.596, wps=18727.8, ups=0.96, wpb=19465, bsz=662.1, num_updates=13200, lr=0.000123091, gnorm=0.346, clip=0, loss_scale=8, train_wall=103, gb_free=15, wall=13637
2023-08-29 14:49:57 | INFO | train_inner | epoch 012:    208 / 1191 loss=2.023, trans_loss=3.288, nll_loss=1.375, w2v_ctc_loss=0.921, task_loss=1.574, contrastive_loss=0.376, total=6735.23, n_correct=4601.76, ppl=2.59, accuracy=68.324, wps=18772.4, ups=0.96, wpb=19511.3, bsz=672.6, num_updates=13300, lr=0.000122628, gnorm=0.349, clip=0, loss_scale=8, train_wall=103, gb_free=10, wall=13741
2023-08-29 14:51:42 | INFO | train_inner | epoch 012:    308 / 1191 loss=2.037, trans_loss=3.286, nll_loss=1.374, w2v_ctc_loss=0.92, task_loss=1.531, contrastive_loss=0.439, total=6698.76, n_correct=4581.17, ppl=2.59, accuracy=68.388, wps=18530.3, ups=0.95, wpb=19416.8, bsz=689.3, num_updates=13400, lr=0.000122169, gnorm=0.351, clip=0, loss_scale=8, train_wall=104, gb_free=11.8, wall=13846
2023-08-29 14:53:26 | INFO | train_inner | epoch 012:    408 / 1191 loss=2.019, trans_loss=3.283, nll_loss=1.37, w2v_ctc_loss=0.905, task_loss=1.45, contrastive_loss=0.412, total=6779.09, n_correct=4642.79, ppl=2.58, accuracy=68.487, wps=18923.5, ups=0.96, wpb=19640, bsz=710.1, num_updates=13500, lr=0.000121716, gnorm=0.346, clip=0, loss_scale=16, train_wall=103, gb_free=14.8, wall=13950
2023-08-29 14:55:10 | INFO | train_inner | epoch 012:    508 / 1191 loss=2.001, trans_loss=3.283, nll_loss=1.368, w2v_ctc_loss=0.91, task_loss=1.525, contrastive_loss=0.312, total=6728.99, n_correct=4616.41, ppl=2.58, accuracy=68.605, wps=18736.2, ups=0.96, wpb=19492.1, bsz=684.5, num_updates=13600, lr=0.000121268, gnorm=0.35, clip=0, loss_scale=16, train_wall=103, gb_free=13.3, wall=14054
2023-08-29 14:56:55 | INFO | train_inner | epoch 012:    608 / 1191 loss=2.029, trans_loss=3.284, nll_loss=1.37, w2v_ctc_loss=0.925, task_loss=1.603, contrastive_loss=0.397, total=6729.55, n_correct=4604.97, ppl=2.58, accuracy=68.429, wps=18599.5, ups=0.95, wpb=19495.9, bsz=680.6, num_updates=13700, lr=0.000120824, gnorm=0.351, clip=0, loss_scale=16, train_wall=104, gb_free=13.6, wall=14159
2023-08-29 14:58:40 | INFO | train_inner | epoch 012:    708 / 1191 loss=2.03, trans_loss=3.274, nll_loss=1.361, w2v_ctc_loss=0.916, task_loss=1.507, contrastive_loss=0.456, total=6756.6, n_correct=4634.77, ppl=2.57, accuracy=68.596, wps=18700.9, ups=0.95, wpb=19597, bsz=693.5, num_updates=13800, lr=0.000120386, gnorm=0.348, clip=0, loss_scale=16, train_wall=104, gb_free=13, wall=14264
2023-08-29 15:00:24 | INFO | train_inner | epoch 012:    808 / 1191 loss=2.019, trans_loss=3.29, nll_loss=1.376, w2v_ctc_loss=0.924, task_loss=1.624, contrastive_loss=0.353, total=6649.22, n_correct=4545.23, ppl=2.6, accuracy=68.357, wps=18462.4, ups=0.96, wpb=19253.7, bsz=662.1, num_updates=13900, lr=0.000119952, gnorm=0.352, clip=0, loss_scale=16, train_wall=104, gb_free=14.2, wall=14368
2023-08-29 15:02:09 | INFO | train_inner | epoch 012:    908 / 1191 loss=2.024, trans_loss=3.289, nll_loss=1.377, w2v_ctc_loss=0.923, task_loss=1.648, contrastive_loss=0.382, total=6675.33, n_correct=4563.08, ppl=2.6, accuracy=68.357, wps=18364.8, ups=0.95, wpb=19336.2, bsz=663.1, num_updates=14000, lr=0.000119523, gnorm=0.35, clip=0, loss_scale=16, train_wall=105, gb_free=13.5, wall=14473
2023-08-29 15:02:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 15:02:42 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.866 | trans_loss 4.948 | nll_loss 2.187 | w2v_ctc_loss 1.243 | task_loss 8.5 | contrastive_loss 0.5 | total 6138.43 | n_correct 4292.86 | ppl 4.55 | accuracy 69.934 | uer 18.894 | wer 20.271 | raw_wer 20.271 | bleu 27.92 | wps 1738.2 | wpb 6138.4 | bsz 201.1 | num_updates 14000 | best_bleu 27.92
2023-08-29 15:02:42 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14000 updates
2023-08-29 15:02:42 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-29 15:02:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt
2023-08-29 15:02:58 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_12_14000.pt (epoch 12 @ 14000 updates, score 27.92) (writing took 16.211410671006888 seconds)
2023-08-29 15:04:42 | INFO | train_inner | epoch 012:   1008 / 1191 loss=2.015, trans_loss=3.283, nll_loss=1.372, w2v_ctc_loss=0.93, task_loss=1.624, contrastive_loss=0.338, total=6596.55, n_correct=4516.17, ppl=2.59, accuracy=68.463, wps=12536.9, ups=0.66, wpb=19127.6, bsz=661, num_updates=14100, lr=0.000119098, gnorm=0.35, clip=0, loss_scale=16, train_wall=103, gb_free=12.2, wall=14626
2023-08-29 15:06:26 | INFO | train_inner | epoch 012:   1108 / 1191 loss=2.015, trans_loss=3.284, nll_loss=1.37, w2v_ctc_loss=0.915, task_loss=1.613, contrastive_loss=0.396, total=6647.62, n_correct=4559.98, ppl=2.58, accuracy=68.596, wps=18391.5, ups=0.96, wpb=19253.5, bsz=671, num_updates=14200, lr=0.000118678, gnorm=0.346, clip=0, loss_scale=16, train_wall=104, gb_free=12.5, wall=14730
2023-08-29 15:07:53 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 15:08:26 | INFO | dev_st | epoch 012 | valid on 'dev_st' subset | loss 3.853 | trans_loss 4.937 | nll_loss 2.177 | w2v_ctc_loss 1.235 | task_loss 8.53 | contrastive_loss 0.489 | total 6138.43 | n_correct 4299.71 | ppl 4.52 | accuracy 70.046 | uer 18.525 | wer 20.097 | raw_wer 20.097 | bleu 27.85 | wps 1774.2 | wpb 6138.4 | bsz 201.1 | num_updates 14283 | best_bleu 27.92
2023-08-29 15:08:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 12 @ 14283 updates
2023-08-29 15:08:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.8509.pt
2023-08-29 15:08:28 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.8509.pt
2023-08-29 15:08:33 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_27.8509.pt (epoch 12 @ 14283 updates, score 27.85) (writing took 7.451480308998725 seconds)
2023-08-29 15:08:34 | INFO | fairseq_cli.train | end of epoch 12 (average epoch stats below)
2023-08-29 15:08:34 | INFO | train | epoch 012 | loss 2.019 | trans_loss 3.284 | nll_loss 1.371 | w2v_ctc_loss 0.919 | task_loss 1.569 | contrastive_loss 0.374 | total 6703.69 | n_correct 4590.83 | ppl 2.59 | accuracy 68.482 | wps 17261.2 | ups 0.89 | wpb 19422.7 | bsz 678.2 | num_updates 14283 | lr 0.000118333 | gnorm 0.349 | clip 0 | loss_scale 16 | train_wall 1236 | gb_free 14.1 | wall 14858
2023-08-29 15:08:34 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 15:08:34 | INFO | fairseq.trainer | begin training epoch 13
2023-08-29 15:08:34 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 15:09:00 | INFO | train_inner | epoch 013:     17 / 1191 loss=2.002, trans_loss=3.28, nll_loss=1.365, w2v_ctc_loss=0.918, task_loss=1.589, contrastive_loss=0.313, total=6706.4, n_correct=4605.53, ppl=2.58, accuracy=68.674, wps=12657, ups=0.65, wpb=19421, bsz=670.1, num_updates=14300, lr=0.000118262, gnorm=0.346, clip=0, loss_scale=16, train_wall=105, gb_free=10.6, wall=14884
2023-08-29 15:10:45 | INFO | train_inner | epoch 013:    117 / 1191 loss=1.982, trans_loss=3.261, nll_loss=1.342, w2v_ctc_loss=0.892, task_loss=1.634, contrastive_loss=0.371, total=6705.38, n_correct=4635.67, ppl=2.54, accuracy=69.134, wps=18562.5, ups=0.96, wpb=19432.1, bsz=665.1, num_updates=14400, lr=0.000117851, gnorm=0.341, clip=0, loss_scale=16, train_wall=104, gb_free=14.1, wall=14989
2023-08-29 15:12:29 | INFO | train_inner | epoch 013:    217 / 1191 loss=1.989, trans_loss=3.271, nll_loss=1.354, w2v_ctc_loss=0.888, task_loss=1.559, contrastive_loss=0.407, total=6644.14, n_correct=4577.44, ppl=2.56, accuracy=68.894, wps=18455.4, ups=0.96, wpb=19247.1, bsz=686.9, num_updates=14500, lr=0.000117444, gnorm=0.347, clip=0, loss_scale=16, train_wall=104, gb_free=14.3, wall=15093
2023-08-29 15:14:13 | INFO | train_inner | epoch 013:    317 / 1191 loss=2.001, trans_loss=3.265, nll_loss=1.347, w2v_ctc_loss=0.874, task_loss=1.454, contrastive_loss=0.502, total=6736.08, n_correct=4660.2, ppl=2.54, accuracy=69.183, wps=18702.2, ups=0.96, wpb=19515.7, bsz=719, num_updates=14600, lr=0.000117041, gnorm=0.347, clip=0, loss_scale=16, train_wall=104, gb_free=12.7, wall=15197
2023-08-29 15:15:57 | INFO | train_inner | epoch 013:    417 / 1191 loss=1.974, trans_loss=3.269, nll_loss=1.353, w2v_ctc_loss=0.899, task_loss=1.567, contrastive_loss=0.282, total=6736.32, n_correct=4644.62, ppl=2.55, accuracy=68.949, wps=18757.2, ups=0.96, wpb=19522.2, bsz=673.9, num_updates=14700, lr=0.000116642, gnorm=0.34, clip=0, loss_scale=16, train_wall=104, gb_free=14.1, wall=15301
2023-08-29 15:17:42 | INFO | train_inner | epoch 013:    517 / 1191 loss=1.992, trans_loss=3.273, nll_loss=1.357, w2v_ctc_loss=0.898, task_loss=1.67, contrastive_loss=0.379, total=6643.47, n_correct=4569.27, ppl=2.56, accuracy=68.778, wps=18341.5, ups=0.95, wpb=19249.1, bsz=654.5, num_updates=14800, lr=0.000116248, gnorm=0.347, clip=0, loss_scale=16, train_wall=104, gb_free=10.4, wall=15406
2023-08-29 15:19:27 | INFO | train_inner | epoch 013:    617 / 1191 loss=1.986, trans_loss=3.271, nll_loss=1.354, w2v_ctc_loss=0.904, task_loss=1.624, contrastive_loss=0.333, total=6696.7, n_correct=4612.44, ppl=2.56, accuracy=68.876, wps=18589.7, ups=0.96, wpb=19399.3, bsz=654.4, num_updates=14900, lr=0.000115857, gnorm=0.351, clip=0, loss_scale=16, train_wall=104, gb_free=12.7, wall=15511
2023-08-29 15:21:12 | INFO | train_inner | epoch 013:    717 / 1191 loss=1.971, trans_loss=3.268, nll_loss=1.35, w2v_ctc_loss=0.897, task_loss=1.64, contrastive_loss=0.289, total=6651.23, n_correct=4590.25, ppl=2.55, accuracy=69.014, wps=18291.5, ups=0.95, wpb=19267.8, bsz=658.4, num_updates=15000, lr=0.00011547, gnorm=0.348, clip=0, loss_scale=16, train_wall=105, gb_free=13.5, wall=15616
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 15:22:25 | INFO | train_inner | epoch 013:    817 / 1191 loss=1.963, trans_loss=4.716, nll_loss=1.951, w2v_ctc_loss=0.643, task_loss=2.252, contrastive_loss=0.29, total=6762.49, n_correct=4664.5, ppl=3.87, accuracy=68.976, wps=18585.1, ups=1.37, wpb=13584, bsz=465.1, num_updates=15100, lr=0.000115087, gnorm=0.44, clip=0, loss_scale=16, train_wall=73, gb_free=13.5, wall=15689
2023-08-29 15:23:37 | INFO | train_inner | epoch 013:    917 / 1191 loss=1.96, trans_loss=4.734, nll_loss=1.957, w2v_ctc_loss=0.658, task_loss=2.591, contrastive_loss=0.24, total=6568.58, n_correct=4524.44, ppl=3.88, accuracy=68.88, wps=18132.7, ups=1.38, wpb=13137.2, bsz=422.7, num_updates=15200, lr=0.000114708, gnorm=0.444, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=15762
2023-08-29 15:24:50 | INFO | train_inner | epoch 013:   1017 / 1191 loss=1.949, trans_loss=4.73, nll_loss=1.952, w2v_ctc_loss=0.642, task_loss=2.255, contrastive_loss=0.222, total=6789.67, n_correct=4694.41, ppl=3.87, accuracy=69.14, wps=18618.2, ups=1.37, wpb=13579.3, bsz=466.8, num_updates=15300, lr=0.000114332, gnorm=0.434, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=15835
2023-08-29 15:26:03 | INFO | train_inner | epoch 013:   1117 / 1191 loss=1.959, trans_loss=4.734, nll_loss=1.957, w2v_ctc_loss=0.652, task_loss=2.293, contrastive_loss=0.283, total=6736.17, n_correct=4645.81, ppl=3.88, accuracy=68.968, wps=18468.3, ups=1.37, wpb=13472.3, bsz=461.7, num_updates=15400, lr=0.000113961, gnorm=0.439, clip=0, loss_scale=16, train_wall=72, gb_free=11.1, wall=15907
2023-08-29 15:26:57 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
2023-08-29 15:27:29 | INFO | dev_st | epoch 013 | valid on 'dev_st' subset | loss 3.836 | trans_loss 4.921 | nll_loss 2.154 | w2v_ctc_loss 1.222 | task_loss 8.551 | contrastive_loss 0.483 | total 6138.43 | n_correct 4317.86 | ppl 4.45 | accuracy 70.341 | uer 18.089 | wer 19.535 | raw_wer 19.535 | bleu 28.42 | wps 1753.5 | wpb 6138.4 | bsz 201.1 | num_updates 15474 | best_bleu 28.42
2023-08-29 15:27:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 13 @ 15474 updates
2023-08-29 15:27:29 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 15:27:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 15:27:43 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 13 @ 15474 updates, score 28.42) (writing took 13.055765443001292 seconds)
2023-08-29 15:27:43 | INFO | fairseq_cli.train | end of epoch 13 (average epoch stats below)
2023-08-29 15:27:43 | INFO | train | epoch 013 | loss 1.977 | trans_loss 3.728 | nll_loss 1.541 | w2v_ctc_loss 0.816 | task_loss 1.811 | contrastive_loss 0.337 | total 6703.69 | n_correct 4624.37 | ppl 2.91 | accuracy 68.982 | wps 17647.5 | ups 1.04 | wpb 17027.8 | bsz 587.8 | num_updates 15474 | lr 0.000113688 | gnorm 0.383 | clip 0 | loss_scale 16 | train_wall 1088 | gb_free 9.6 | wall 16007
2023-08-29 15:27:43 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 15:27:43 | INFO | fairseq.trainer | begin training epoch 14
2023-08-29 15:27:43 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 15:28:09 | INFO | train_inner | epoch 014:     26 / 1191 loss=1.956, trans_loss=4.73, nll_loss=1.952, w2v_ctc_loss=0.648, task_loss=2.185, contrastive_loss=0.277, total=6751.58, n_correct=4666.67, ppl=3.87, accuracy=69.12, wps=10736.9, ups=0.8, wpb=13503.2, bsz=466.1, num_updates=15500, lr=0.000113592, gnorm=0.435, clip=0, loss_scale=32, train_wall=72, gb_free=11.2, wall=16033
2023-08-29 15:29:21 | INFO | train_inner | epoch 014:    126 / 1191 loss=1.948, trans_loss=4.714, nll_loss=1.931, w2v_ctc_loss=0.639, task_loss=2.296, contrastive_loss=0.293, total=6662.66, n_correct=4626.32, ppl=3.81, accuracy=69.437, wps=18508.1, ups=1.39, wpb=13325.3, bsz=452.1, num_updates=15600, lr=0.000113228, gnorm=0.436, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=16105
2023-08-29 15:30:34 | INFO | train_inner | epoch 014:    226 / 1191 loss=1.94, trans_loss=4.719, nll_loss=1.936, w2v_ctc_loss=0.632, task_loss=2.423, contrastive_loss=0.227, total=6628.52, n_correct=4592.06, ppl=3.83, accuracy=69.277, wps=18240.7, ups=1.38, wpb=13257, bsz=443.4, num_updates=15700, lr=0.000112867, gnorm=0.436, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=16178
2023-08-29 15:31:47 | INFO | train_inner | epoch 014:    326 / 1191 loss=1.951, trans_loss=4.718, nll_loss=1.936, w2v_ctc_loss=0.642, task_loss=2.394, contrastive_loss=0.293, total=6730.49, n_correct=4662.64, ppl=3.83, accuracy=69.276, wps=18274.8, ups=1.36, wpb=13461, bsz=450, num_updates=15800, lr=0.000112509, gnorm=0.439, clip=0, loss_scale=32, train_wall=73, gb_free=14.7, wall=16252
2023-08-29 15:33:01 | INFO | train_inner | epoch 014:    426 / 1191 loss=1.939, trans_loss=4.714, nll_loss=1.931, w2v_ctc_loss=0.635, task_loss=2.254, contrastive_loss=0.229, total=6813.49, n_correct=4729.05, ppl=3.81, accuracy=69.407, wps=18580.2, ups=1.36, wpb=13627, bsz=467.5, num_updates=15900, lr=0.000112154, gnorm=0.433, clip=0, loss_scale=32, train_wall=73, gb_free=13.1, wall=16325
2023-08-29 15:34:14 | INFO | train_inner | epoch 014:    526 / 1191 loss=1.951, trans_loss=4.712, nll_loss=1.929, w2v_ctc_loss=0.64, task_loss=2.324, contrastive_loss=0.319, total=6709.13, n_correct=4652.19, ppl=3.81, accuracy=69.341, wps=18371.9, ups=1.37, wpb=13418.3, bsz=456.4, num_updates=16000, lr=0.000111803, gnorm=0.436, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=16398
2023-08-29 15:34:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 15:34:47 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.845 | trans_loss 4.921 | nll_loss 2.156 | w2v_ctc_loss 1.253 | task_loss 8.53 | contrastive_loss 0.48 | total 6138.43 | n_correct 4317.43 | ppl 4.46 | accuracy 70.334 | uer 18.704 | wer 20.149 | raw_wer 20.149 | bleu 28.13 | wps 1725.1 | wpb 6138.4 | bsz 201.1 | num_updates 16000 | best_bleu 28.42
2023-08-29 15:34:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16000 updates
2023-08-29 15:34:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-29 15:34:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt
2023-08-29 15:34:54 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_14_16000.pt (epoch 14 @ 16000 updates, score 28.13) (writing took 7.666769098010263 seconds)
2023-08-29 15:36:08 | INFO | train_inner | epoch 014:    626 / 1191 loss=1.94, trans_loss=4.714, nll_loss=1.931, w2v_ctc_loss=0.636, task_loss=2.283, contrastive_loss=0.247, total=6815.41, n_correct=4734.42, ppl=3.81, accuracy=69.466, wps=11974.9, ups=0.88, wpb=13630.8, bsz=465.9, num_updates=16100, lr=0.000111456, gnorm=0.428, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=16512
2023-08-29 15:37:21 | INFO | train_inner | epoch 014:    726 / 1191 loss=1.956, trans_loss=4.718, nll_loss=1.937, w2v_ctc_loss=0.651, task_loss=2.38, contrastive_loss=0.305, total=6688.33, n_correct=4627.75, ppl=3.83, accuracy=69.191, wps=18316.5, ups=1.37, wpb=13376.7, bsz=448, num_updates=16200, lr=0.000111111, gnorm=0.44, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=16585
2023-08-29 15:38:35 | INFO | train_inner | epoch 014:    826 / 1191 loss=1.952, trans_loss=4.721, nll_loss=1.941, w2v_ctc_loss=0.641, task_loss=2.364, contrastive_loss=0.339, total=6699.73, n_correct=4642.83, ppl=3.84, accuracy=69.299, wps=18097.7, ups=1.35, wpb=13399.5, bsz=459.5, num_updates=16300, lr=0.00011077, gnorm=0.433, clip=0, loss_scale=32, train_wall=73, gb_free=13.9, wall=16659
2023-08-29 15:39:47 | INFO | train_inner | epoch 014:    926 / 1191 loss=1.948, trans_loss=4.722, nll_loss=1.941, w2v_ctc_loss=0.651, task_loss=2.395, contrastive_loss=0.222, total=6651.62, n_correct=4608.25, ppl=3.84, accuracy=69.28, wps=18286.6, ups=1.37, wpb=13303.2, bsz=446, num_updates=16400, lr=0.000110432, gnorm=0.437, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=16732
2023-08-29 15:41:01 | INFO | train_inner | epoch 014:   1026 / 1191 loss=1.948, trans_loss=4.722, nll_loss=1.942, w2v_ctc_loss=0.652, task_loss=2.628, contrastive_loss=0.207, total=6566.51, n_correct=4547.13, ppl=3.84, accuracy=69.247, wps=17979.2, ups=1.37, wpb=13133, bsz=420.2, num_updates=16500, lr=0.000110096, gnorm=0.439, clip=0, loss_scale=32, train_wall=72, gb_free=10.3, wall=16805
2023-08-29 15:42:13 | INFO | train_inner | epoch 014:   1126 / 1191 loss=1.941, trans_loss=4.714, nll_loss=1.932, w2v_ctc_loss=0.638, task_loss=2.173, contrastive_loss=0.257, total=6798.37, n_correct=4727.5, ppl=3.82, accuracy=69.539, wps=18841.1, ups=1.39, wpb=13596.7, bsz=475.2, num_updates=16600, lr=0.000109764, gnorm=0.429, clip=0, loss_scale=32, train_wall=72, gb_free=14.7, wall=16877
2023-08-29 15:43:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 15:43:32 | INFO | dev_st | epoch 014 | valid on 'dev_st' subset | loss 3.827 | trans_loss 4.91 | nll_loss 2.142 | w2v_ctc_loss 1.223 | task_loss 8.569 | contrastive_loss 0.475 | total 6138.43 | n_correct 4325.14 | ppl 4.41 | accuracy 70.46 | uer 18.399 | wer 19.84 | raw_wer 19.84 | bleu 28.12 | wps 1763.7 | wpb 6138.4 | bsz 201.1 | num_updates 16665 | best_bleu 28.42
2023-08-29 15:43:32 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 14 @ 16665 updates
2023-08-29 15:43:32 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.1207.pt
2023-08-29 15:43:34 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.1207.pt
2023-08-29 15:43:40 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.1207.pt (epoch 14 @ 16665 updates, score 28.12) (writing took 7.326953183001024 seconds)
2023-08-29 15:43:40 | INFO | fairseq_cli.train | end of epoch 14 (average epoch stats below)
2023-08-29 15:43:40 | INFO | train | epoch 014 | loss 1.947 | trans_loss 4.717 | nll_loss 1.935 | w2v_ctc_loss 0.642 | task_loss 2.354 | contrastive_loss 0.266 | total 6703.69 | n_correct 4648.71 | ppl 3.82 | accuracy 69.345 | wps 16676.8 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 16665 | lr 0.00010955 | gnorm 0.435 | clip 0 | loss_scale 32 | train_wall 862 | gb_free 14.3 | wall 16964
2023-08-29 15:43:40 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 15:43:40 | INFO | fairseq.trainer | begin training epoch 15
2023-08-29 15:43:40 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 15:44:13 | INFO | train_inner | epoch 015:     35 / 1191 loss=1.945, trans_loss=4.71, nll_loss=1.926, w2v_ctc_loss=0.64, task_loss=2.356, contrastive_loss=0.268, total=6693.11, n_correct=4648.51, ppl=3.8, accuracy=69.452, wps=11111.1, ups=0.83, wpb=13386.2, bsz=448.1, num_updates=16700, lr=0.000109435, gnorm=0.438, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=16997
2023-08-29 15:45:26 | INFO | train_inner | epoch 015:    135 / 1191 loss=1.934, trans_loss=4.701, nll_loss=1.914, w2v_ctc_loss=0.631, task_loss=2.29, contrastive_loss=0.264, total=6736.22, n_correct=4698.98, ppl=3.77, accuracy=69.757, wps=18571.7, ups=1.38, wpb=13472.4, bsz=458.3, num_updates=16800, lr=0.000109109, gnorm=0.431, clip=0, loss_scale=32, train_wall=72, gb_free=12, wall=17070
2023-08-29 15:46:38 | INFO | train_inner | epoch 015:    235 / 1191 loss=1.93, trans_loss=4.696, nll_loss=1.908, w2v_ctc_loss=0.632, task_loss=2.343, contrastive_loss=0.231, total=6691.08, n_correct=4670.13, ppl=3.75, accuracy=69.796, wps=18518.9, ups=1.38, wpb=13382.2, bsz=447.5, num_updates=16900, lr=0.000108786, gnorm=0.434, clip=0, loss_scale=32, train_wall=72, gb_free=14.2, wall=17142
2023-08-29 15:47:50 | INFO | train_inner | epoch 015:    335 / 1191 loss=1.926, trans_loss=4.692, nll_loss=1.903, w2v_ctc_loss=0.627, task_loss=2.37, contrastive_loss=0.223, total=6665.88, n_correct=4660.12, ppl=3.74, accuracy=69.91, wps=18477.4, ups=1.39, wpb=13331.8, bsz=446.9, num_updates=17000, lr=0.000108465, gnorm=0.435, clip=0, loss_scale=32, train_wall=71, gb_free=13.1, wall=17214
2023-08-29 15:49:03 | INFO | train_inner | epoch 015:    435 / 1191 loss=1.937, trans_loss=4.706, nll_loss=1.922, w2v_ctc_loss=0.635, task_loss=2.374, contrastive_loss=0.252, total=6733.73, n_correct=4685.16, ppl=3.79, accuracy=69.577, wps=18441.5, ups=1.37, wpb=13467.5, bsz=456.4, num_updates=17100, lr=0.000108148, gnorm=0.434, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=17287
2023-08-29 15:50:16 | INFO | train_inner | epoch 015:    535 / 1191 loss=1.935, trans_loss=4.698, nll_loss=1.911, w2v_ctc_loss=0.636, task_loss=2.33, contrastive_loss=0.265, total=6700.53, n_correct=4674.2, ppl=3.76, accuracy=69.759, wps=18373.3, ups=1.37, wpb=13401.1, bsz=460.4, num_updates=17200, lr=0.000107833, gnorm=0.431, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=17360
2023-08-29 15:51:29 | INFO | train_inner | epoch 015:    635 / 1191 loss=1.94, trans_loss=4.701, nll_loss=1.915, w2v_ctc_loss=0.644, task_loss=2.67, contrastive_loss=0.243, total=6598.77, n_correct=4594.81, ppl=3.77, accuracy=69.631, wps=18126.7, ups=1.37, wpb=13197.5, bsz=410.4, num_updates=17300, lr=0.000107521, gnorm=0.435, clip=0, loss_scale=32, train_wall=72, gb_free=11.6, wall=17433
2023-08-29 15:52:41 | INFO | train_inner | epoch 015:    735 / 1191 loss=1.94, trans_loss=4.698, nll_loss=1.912, w2v_ctc_loss=0.633, task_loss=2.376, contrastive_loss=0.337, total=6644.1, n_correct=4629.37, ppl=3.76, accuracy=69.676, wps=18337.8, ups=1.38, wpb=13288.2, bsz=454.2, num_updates=17400, lr=0.000107211, gnorm=0.434, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=17506
2023-08-29 15:53:55 | INFO | train_inner | epoch 015:    835 / 1191 loss=1.928, trans_loss=4.696, nll_loss=1.909, w2v_ctc_loss=0.634, task_loss=2.342, contrastive_loss=0.208, total=6725.66, n_correct=4696.2, ppl=3.76, accuracy=69.825, wps=18373.5, ups=1.37, wpb=13451.3, bsz=448.3, num_updates=17500, lr=0.000106904, gnorm=0.431, clip=0, loss_scale=32, train_wall=73, gb_free=13.2, wall=17579
2023-08-29 15:55:08 | INFO | train_inner | epoch 015:    935 / 1191 loss=1.93, trans_loss=4.695, nll_loss=1.908, w2v_ctc_loss=0.625, task_loss=2.241, contrastive_loss=0.309, total=6750.02, n_correct=4717.83, ppl=3.75, accuracy=69.894, wps=18403.6, ups=1.36, wpb=13500, bsz=473.6, num_updates=17600, lr=0.0001066, gnorm=0.424, clip=0, loss_scale=64, train_wall=73, gb_free=13.6, wall=17652
2023-08-29 15:56:21 | INFO | train_inner | epoch 015:   1035 / 1191 loss=1.931, trans_loss=4.701, nll_loss=1.915, w2v_ctc_loss=0.635, task_loss=2.34, contrastive_loss=0.232, total=6700.78, n_correct=4673.04, ppl=3.77, accuracy=69.739, wps=18406.5, ups=1.37, wpb=13401.6, bsz=454.3, num_updates=17700, lr=0.000106299, gnorm=0.43, clip=0, loss_scale=64, train_wall=72, gb_free=11.9, wall=17725
2023-08-29 15:57:22 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 15:57:35 | INFO | train_inner | epoch 015:   1136 / 1191 loss=1.93, trans_loss=4.701, nll_loss=1.915, w2v_ctc_loss=0.636, task_loss=2.435, contrastive_loss=0.198, total=6732.53, n_correct=4694.6, ppl=3.77, accuracy=69.73, wps=18049.1, ups=1.34, wpb=13465.1, bsz=438.8, num_updates=17800, lr=0.000106, gnorm=0.429, clip=0, loss_scale=32, train_wall=74, gb_free=13.3, wall=17800
2023-08-29 15:58:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 15:58:48 | INFO | dev_st | epoch 015 | valid on 'dev_st' subset | loss 3.824 | trans_loss 4.9 | nll_loss 2.128 | w2v_ctc_loss 1.251 | task_loss 8.576 | contrastive_loss 0.459 | total 6138.43 | n_correct 4337.29 | ppl 4.37 | accuracy 70.658 | uer 18.29 | wer 19.81 | raw_wer 19.81 | bleu 28.5 | wps 1762.5 | wpb 6138.4 | bsz 201.1 | num_updates 17855 | best_bleu 28.5
2023-08-29 15:58:48 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 15 @ 17855 updates
2023-08-29 15:58:48 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 15:58:55 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 15:59:01 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 15 @ 17855 updates, score 28.5) (writing took 13.090545889004716 seconds)
2023-08-29 15:59:01 | INFO | fairseq_cli.train | end of epoch 15 (average epoch stats below)
2023-08-29 15:59:01 | INFO | train | epoch 015 | loss 1.933 | trans_loss 4.699 | nll_loss 1.912 | w2v_ctc_loss 0.633 | task_loss 2.357 | contrastive_loss 0.255 | total 6702.01 | n_correct 4674.86 | ppl 3.76 | accuracy 69.753 | wps 17321.7 | ups 1.29 | wpb 13404 | bsz 451.6 | num_updates 17855 | lr 0.000105836 | gnorm 0.432 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 11.6 | wall 17885
2023-08-29 15:59:01 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 15:59:01 | INFO | fairseq.trainer | begin training epoch 16
2023-08-29 15:59:01 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 15:59:41 | INFO | train_inner | epoch 016:     45 / 1191 loss=1.93, trans_loss=4.692, nll_loss=1.904, w2v_ctc_loss=0.621, task_loss=2.292, contrastive_loss=0.317, total=6677.12, n_correct=4665.92, ppl=3.74, accuracy=69.879, wps=10645.6, ups=0.8, wpb=13354.2, bsz=455.1, num_updates=17900, lr=0.000105703, gnorm=0.432, clip=0, loss_scale=32, train_wall=71, gb_free=13.9, wall=17925
2023-08-29 16:00:54 | INFO | train_inner | epoch 016:    145 / 1191 loss=1.921, trans_loss=4.683, nll_loss=1.892, w2v_ctc_loss=0.623, task_loss=2.413, contrastive_loss=0.238, total=6726.17, n_correct=4715.2, ppl=3.71, accuracy=70.102, wps=18367.2, ups=1.37, wpb=13452.3, bsz=445.6, num_updates=18000, lr=0.000105409, gnorm=0.428, clip=0, loss_scale=32, train_wall=73, gb_free=14.1, wall=17998
2023-08-29 16:00:54 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 16:01:27 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.817 | trans_loss 4.907 | nll_loss 2.134 | w2v_ctc_loss 1.206 | task_loss 8.565 | contrastive_loss 0.463 | total 6138.43 | n_correct 4329.86 | ppl 4.39 | accuracy 70.537 | uer 18.1 | wer 19.624 | raw_wer 19.624 | bleu 28.44 | wps 1751.6 | wpb 6138.4 | bsz 201.1 | num_updates 18000 | best_bleu 28.5
2023-08-29 16:01:27 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 18000 updates
2023-08-29 16:01:27 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-29 16:01:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt
2023-08-29 16:01:35 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_16_18000.pt (epoch 16 @ 18000 updates, score 28.44) (writing took 8.061033314006636 seconds)
2023-08-29 16:02:48 | INFO | train_inner | epoch 016:    245 / 1191 loss=1.923, trans_loss=4.683, nll_loss=1.892, w2v_ctc_loss=0.625, task_loss=2.436, contrastive_loss=0.255, total=6696.53, n_correct=4692.93, ppl=3.71, accuracy=70.08, wps=11801.7, ups=0.88, wpb=13393.1, bsz=441.3, num_updates=18100, lr=0.000105118, gnorm=0.43, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=18112
2023-08-29 16:03:59 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 16:04:01 | INFO | train_inner | epoch 016:    346 / 1191 loss=1.922, trans_loss=4.686, nll_loss=1.897, w2v_ctc_loss=0.622, task_loss=2.231, contrastive_loss=0.255, total=6774.97, n_correct=4752.01, ppl=3.72, accuracy=70.141, wps=18370.2, ups=1.36, wpb=13549.9, bsz=465.4, num_updates=18200, lr=0.000104828, gnorm=0.425, clip=0, loss_scale=16, train_wall=73, gb_free=11.2, wall=18185
2023-08-29 16:05:14 | INFO | train_inner | epoch 016:    446 / 1191 loss=1.919, trans_loss=4.686, nll_loss=1.896, w2v_ctc_loss=0.625, task_loss=2.351, contrastive_loss=0.205, total=6679.62, n_correct=4681.3, ppl=3.72, accuracy=70.083, wps=18510.5, ups=1.39, wpb=13359.2, bsz=448.1, num_updates=18300, lr=0.000104542, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=18258
2023-08-29 16:06:26 | INFO | train_inner | epoch 016:    546 / 1191 loss=1.921, trans_loss=4.679, nll_loss=1.888, w2v_ctc_loss=0.622, task_loss=2.367, contrastive_loss=0.258, total=6693.31, n_correct=4694.54, ppl=3.7, accuracy=70.138, wps=18467.6, ups=1.38, wpb=13386.6, bsz=448.2, num_updates=18400, lr=0.000104257, gnorm=0.432, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=18330
2023-08-29 16:07:40 | INFO | train_inner | epoch 016:    646 / 1191 loss=1.924, trans_loss=4.683, nll_loss=1.893, w2v_ctc_loss=0.623, task_loss=2.346, contrastive_loss=0.276, total=6708.08, n_correct=4702.46, ppl=3.71, accuracy=70.101, wps=18189.5, ups=1.36, wpb=13416.2, bsz=457.7, num_updates=18500, lr=0.000103975, gnorm=0.429, clip=0, loss_scale=16, train_wall=73, gb_free=13.9, wall=18404
2023-08-29 16:08:52 | INFO | train_inner | epoch 016:    746 / 1191 loss=1.922, trans_loss=4.68, nll_loss=1.888, w2v_ctc_loss=0.63, task_loss=2.432, contrastive_loss=0.235, total=6642.59, n_correct=4659.68, ppl=3.7, accuracy=70.149, wps=18389.9, ups=1.38, wpb=13285.2, bsz=441.6, num_updates=18600, lr=0.000103695, gnorm=0.434, clip=0, loss_scale=16, train_wall=72, gb_free=13.1, wall=18476
2023-08-29 16:10:05 | INFO | train_inner | epoch 016:    846 / 1191 loss=1.928, trans_loss=4.691, nll_loss=1.903, w2v_ctc_loss=0.634, task_loss=2.434, contrastive_loss=0.244, total=6704.89, n_correct=4687.96, ppl=3.74, accuracy=69.919, wps=18266.7, ups=1.36, wpb=13409.8, bsz=444.3, num_updates=18700, lr=0.000103418, gnorm=0.434, clip=0, loss_scale=16, train_wall=73, gb_free=12.6, wall=18550
2023-08-29 16:11:18 | INFO | train_inner | epoch 016:    946 / 1191 loss=1.918, trans_loss=4.684, nll_loss=1.895, w2v_ctc_loss=0.619, task_loss=2.29, contrastive_loss=0.24, total=6714.17, n_correct=4706.33, ppl=3.72, accuracy=70.095, wps=18455.6, ups=1.37, wpb=13428.3, bsz=462.4, num_updates=18800, lr=0.000103142, gnorm=0.431, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=18622
2023-08-29 16:12:31 | INFO | train_inner | epoch 016:   1046 / 1191 loss=1.924, trans_loss=4.682, nll_loss=1.892, w2v_ctc_loss=0.628, task_loss=2.345, contrastive_loss=0.269, total=6686.6, n_correct=4686.92, ppl=3.71, accuracy=70.094, wps=18331.9, ups=1.37, wpb=13373.2, bsz=457.2, num_updates=18900, lr=0.000102869, gnorm=0.429, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=18695
2023-08-29 16:13:45 | INFO | train_inner | epoch 016:   1146 / 1191 loss=1.925, trans_loss=4.689, nll_loss=1.901, w2v_ctc_loss=0.627, task_loss=2.198, contrastive_loss=0.269, total=6800.1, n_correct=4762.86, ppl=3.73, accuracy=70.041, wps=18518.1, ups=1.36, wpb=13600.2, bsz=478.8, num_updates=19000, lr=0.000102598, gnorm=0.431, clip=0, loss_scale=16, train_wall=73, gb_free=13.9, wall=18769
2023-08-29 16:14:17 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 16:14:50 | INFO | dev_st | epoch 016 | valid on 'dev_st' subset | loss 3.805 | trans_loss 4.898 | nll_loss 2.126 | w2v_ctc_loss 1.189 | task_loss 8.564 | contrastive_loss 0.464 | total 6138.43 | n_correct 4346 | ppl 4.37 | accuracy 70.8 | uer 18.359 | wer 19.848 | raw_wer 19.848 | bleu 28.49 | wps 1739.3 | wpb 6138.4 | bsz 201.1 | num_updates 19045 | best_bleu 28.5
2023-08-29 16:14:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 16 @ 19045 updates
2023-08-29 16:14:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.4900.pt
2023-08-29 16:14:52 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.4900.pt
2023-08-29 16:14:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.4900.pt (epoch 16 @ 19045 updates, score 28.49) (writing took 9.307221903000027 seconds)
2023-08-29 16:15:00 | INFO | fairseq_cli.train | end of epoch 16 (average epoch stats below)
2023-08-29 16:15:00 | INFO | train | epoch 016 | loss 1.922 | trans_loss 4.684 | nll_loss 1.893 | w2v_ctc_loss 0.625 | task_loss 2.352 | contrastive_loss 0.255 | total 6703.91 | n_correct 4698.62 | ppl 3.72 | accuracy 70.088 | wps 16647.5 | ups 1.24 | wpb 13407.8 | bsz 452.2 | num_updates 19045 | lr 0.000102477 | gnorm 0.43 | clip 0 | loss_scale 16 | train_wall 861 | gb_free 13.4 | wall 18844
2023-08-29 16:15:00 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 16:15:00 | INFO | fairseq.trainer | begin training epoch 17
2023-08-29 16:15:00 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 16:15:48 | INFO | train_inner | epoch 017:     55 / 1191 loss=1.918, trans_loss=4.677, nll_loss=1.885, w2v_ctc_loss=0.616, task_loss=2.443, contrastive_loss=0.278, total=6603.02, n_correct=4634.64, ppl=3.69, accuracy=70.19, wps=10735.4, ups=0.81, wpb=13206, bsz=437.5, num_updates=19100, lr=0.000102329, gnorm=0.431, clip=0, loss_scale=16, train_wall=72, gb_free=10.1, wall=18892
2023-08-29 16:17:00 | INFO | train_inner | epoch 017:    155 / 1191 loss=1.909, trans_loss=4.666, nll_loss=1.871, w2v_ctc_loss=0.61, task_loss=2.37, contrastive_loss=0.257, total=6700.4, n_correct=4717.91, ppl=3.66, accuracy=70.412, wps=18445.6, ups=1.38, wpb=13400.8, bsz=452.7, num_updates=19200, lr=0.000102062, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=14.2, wall=18964
2023-08-29 16:18:13 | INFO | train_inner | epoch 017:    255 / 1191 loss=1.902, trans_loss=4.66, nll_loss=1.864, w2v_ctc_loss=0.611, task_loss=2.229, contrastive_loss=0.21, total=6816.25, n_correct=4818.27, ppl=3.64, accuracy=70.688, wps=18638.9, ups=1.37, wpb=13632.5, bsz=472.6, num_updates=19300, lr=0.000101797, gnorm=0.421, clip=0, loss_scale=16, train_wall=73, gb_free=10.4, wall=19038
2023-08-29 16:19:26 | INFO | train_inner | epoch 017:    355 / 1191 loss=1.913, trans_loss=4.674, nll_loss=1.881, w2v_ctc_loss=0.622, task_loss=2.399, contrastive_loss=0.213, total=6649.09, n_correct=4670.83, ppl=3.68, accuracy=70.248, wps=18380.7, ups=1.38, wpb=13298.2, bsz=444.3, num_updates=19400, lr=0.000101535, gnorm=0.429, clip=0, loss_scale=16, train_wall=72, gb_free=10.9, wall=19110
2023-08-29 16:20:38 | INFO | train_inner | epoch 017:    455 / 1191 loss=1.917, trans_loss=4.673, nll_loss=1.88, w2v_ctc_loss=0.619, task_loss=2.419, contrastive_loss=0.258, total=6687.8, n_correct=4699.64, ppl=3.68, accuracy=70.272, wps=18434.3, ups=1.38, wpb=13375.6, bsz=441.3, num_updates=19500, lr=0.000101274, gnorm=0.431, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=19182
2023-08-29 16:21:51 | INFO | train_inner | epoch 017:    555 / 1191 loss=1.921, trans_loss=4.679, nll_loss=1.888, w2v_ctc_loss=0.618, task_loss=2.377, contrastive_loss=0.288, total=6693.58, n_correct=4701.89, ppl=3.7, accuracy=70.245, wps=18341, ups=1.37, wpb=13387.2, bsz=444.4, num_updates=19600, lr=0.000101015, gnorm=0.429, clip=0, loss_scale=16, train_wall=72, gb_free=12.9, wall=19255
2023-08-29 16:23:04 | INFO | train_inner | epoch 017:    655 / 1191 loss=1.91, trans_loss=4.669, nll_loss=1.875, w2v_ctc_loss=0.617, task_loss=2.31, contrastive_loss=0.231, total=6685.1, n_correct=4706.62, ppl=3.67, accuracy=70.405, wps=18435.9, ups=1.38, wpb=13370.2, bsz=457.9, num_updates=19700, lr=0.000100759, gnorm=0.428, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=19328
2023-08-29 16:24:17 | INFO | train_inner | epoch 017:    755 / 1191 loss=1.916, trans_loss=4.678, nll_loss=1.887, w2v_ctc_loss=0.626, task_loss=2.476, contrastive_loss=0.195, total=6657.34, n_correct=4668.64, ppl=3.7, accuracy=70.128, wps=18229.2, ups=1.37, wpb=13314.7, bsz=430.7, num_updates=19800, lr=0.000100504, gnorm=0.429, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=19401
2023-08-29 16:25:30 | INFO | train_inner | epoch 017:    855 / 1191 loss=1.917, trans_loss=4.669, nll_loss=1.876, w2v_ctc_loss=0.62, task_loss=2.508, contrastive_loss=0.287, total=6624.99, n_correct=4664.49, ppl=3.67, accuracy=70.408, wps=18120.5, ups=1.37, wpb=13250, bsz=439.4, num_updates=19900, lr=0.000100251, gnorm=0.429, clip=0, loss_scale=16, train_wall=73, gb_free=10.7, wall=19474
2023-08-29 16:26:42 | INFO | train_inner | epoch 017:    955 / 1191 loss=1.911, trans_loss=4.665, nll_loss=1.871, w2v_ctc_loss=0.599, task_loss=2.083, contrastive_loss=0.35, total=6791.83, n_correct=4791.14, ppl=3.66, accuracy=70.543, wps=18787.8, ups=1.38, wpb=13583.7, bsz=493.5, num_updates=20000, lr=0.0001, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=19546
2023-08-29 16:26:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 16:27:15 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.814 | trans_loss 4.888 | nll_loss 2.111 | w2v_ctc_loss 1.246 | task_loss 8.571 | contrastive_loss 0.458 | total 6138.43 | n_correct 4354.86 | ppl 4.32 | accuracy 70.944 | uer 17.765 | wer 19.241 | raw_wer 19.241 | bleu 28.78 | wps 1743 | wpb 6138.4 | bsz 201.1 | num_updates 20000 | best_bleu 28.78
2023-08-29 16:27:15 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20000 updates
2023-08-29 16:27:15 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-29 16:27:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt
2023-08-29 16:27:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_17_20000.pt (epoch 17 @ 20000 updates, score 28.78) (writing took 14.082397519989172 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 16:28:42 | INFO | train_inner | epoch 017:   1055 / 1191 loss=1.907, trans_loss=4.664, nll_loss=1.869, w2v_ctc_loss=0.614, task_loss=2.399, contrastive_loss=0.24, total=6662.74, n_correct=4701.84, ppl=3.65, accuracy=70.569, wps=11140.9, ups=0.84, wpb=13325.5, bsz=442.7, num_updates=20100, lr=9.97509e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=12.3, wall=19666
2023-08-29 16:29:55 | INFO | train_inner | epoch 017:   1155 / 1191 loss=1.906, trans_loss=4.664, nll_loss=1.869, w2v_ctc_loss=0.614, task_loss=2.32, contrastive_loss=0.228, total=6776.47, n_correct=4782.83, ppl=3.65, accuracy=70.58, wps=18568.9, ups=1.37, wpb=13552.9, bsz=456, num_updates=20200, lr=9.95037e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=11.7, wall=19739
2023-08-29 16:30:21 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
2023-08-29 16:30:54 | INFO | dev_st | epoch 017 | valid on 'dev_st' subset | loss 3.802 | trans_loss 4.89 | nll_loss 2.117 | w2v_ctc_loss 1.2 | task_loss 8.574 | contrastive_loss 0.46 | total 6138.43 | n_correct 4347.29 | ppl 4.34 | accuracy 70.821 | uer 17.923 | wer 19.505 | raw_wer 19.505 | bleu 28.97 | wps 1750.3 | wpb 6138.4 | bsz 201.1 | num_updates 20236 | best_bleu 28.97
2023-08-29 16:30:54 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 17 @ 20236 updates
2023-08-29 16:30:54 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 16:31:00 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 16:31:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 17 @ 20236 updates, score 28.97) (writing took 11.416226921995985 seconds)
2023-08-29 16:31:06 | INFO | fairseq_cli.train | end of epoch 17 (average epoch stats below)
2023-08-29 16:31:06 | INFO | train | epoch 017 | loss 1.912 | trans_loss 4.67 | nll_loss 1.876 | w2v_ctc_loss 0.615 | task_loss 2.352 | contrastive_loss 0.25 | total 6703.69 | n_correct 4719.63 | ppl 3.67 | accuracy 70.403 | wps 16527.7 | ups 1.23 | wpb 13407.4 | bsz 452.1 | num_updates 20236 | lr 9.94152e-05 | gnorm 0.427 | clip 0 | loss_scale 16 | train_wall 860 | gb_free 14.2 | wall 19810
2023-08-29 16:31:06 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 16:31:06 | INFO | fairseq.trainer | begin training epoch 18
2023-08-29 16:31:06 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 16:32:00 | INFO | train_inner | epoch 018:     64 / 1191 loss=1.897, trans_loss=4.652, nll_loss=1.853, w2v_ctc_loss=0.599, task_loss=2.243, contrastive_loss=0.238, total=6805.63, n_correct=4815.36, ppl=3.61, accuracy=70.756, wps=10919.1, ups=0.8, wpb=13611.3, bsz=465.5, num_updates=20300, lr=9.92583e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=19864
2023-08-29 16:33:13 | INFO | train_inner | epoch 018:    164 / 1191 loss=1.906, trans_loss=4.663, nll_loss=1.866, w2v_ctc_loss=0.617, task_loss=2.653, contrastive_loss=0.204, total=6620.89, n_correct=4666.77, ppl=3.65, accuracy=70.486, wps=18139.8, ups=1.37, wpb=13241.8, bsz=419, num_updates=20400, lr=9.90148e-05, gnorm=0.429, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=19937
2023-08-29 16:34:25 | INFO | train_inner | epoch 018:    264 / 1191 loss=1.908, trans_loss=4.659, nll_loss=1.863, w2v_ctc_loss=0.607, task_loss=2.391, contrastive_loss=0.309, total=6622.15, n_correct=4678.84, ppl=3.64, accuracy=70.654, wps=18229.7, ups=1.38, wpb=13244.3, bsz=447.2, num_updates=20500, lr=9.8773e-05, gnorm=0.429, clip=0, loss_scale=32, train_wall=72, gb_free=14.8, wall=20009
2023-08-29 16:35:38 | INFO | train_inner | epoch 018:    364 / 1191 loss=1.9, trans_loss=4.654, nll_loss=1.855, w2v_ctc_loss=0.603, task_loss=2.314, contrastive_loss=0.274, total=6736.36, n_correct=4769.59, ppl=3.62, accuracy=70.804, wps=18445.6, ups=1.37, wpb=13472.7, bsz=459.4, num_updates=20600, lr=9.85329e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=20082
2023-08-29 16:36:51 | INFO | train_inner | epoch 018:    464 / 1191 loss=1.896, trans_loss=4.656, nll_loss=1.858, w2v_ctc_loss=0.599, task_loss=2.334, contrastive_loss=0.222, total=6698.43, n_correct=4738.95, ppl=3.63, accuracy=70.747, wps=18449.2, ups=1.38, wpb=13396.9, bsz=454.4, num_updates=20700, lr=9.82946e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=20155
2023-08-29 16:38:04 | INFO | train_inner | epoch 018:    564 / 1191 loss=1.899, trans_loss=4.655, nll_loss=1.857, w2v_ctc_loss=0.606, task_loss=2.151, contrastive_loss=0.24, total=6847.61, n_correct=4846.78, ppl=3.62, accuracy=70.781, wps=18778.9, ups=1.37, wpb=13695.2, bsz=483.1, num_updates=20800, lr=9.80581e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=11.7, wall=20228
2023-08-29 16:39:16 | INFO | train_inner | epoch 018:    664 / 1191 loss=1.902, trans_loss=4.655, nll_loss=1.857, w2v_ctc_loss=0.611, task_loss=2.533, contrastive_loss=0.219, total=6562.52, n_correct=4633.64, ppl=3.62, accuracy=70.608, wps=18261.1, ups=1.39, wpb=13125, bsz=426.3, num_updates=20900, lr=9.78232e-05, gnorm=0.432, clip=0, loss_scale=32, train_wall=71, gb_free=13.2, wall=20300
2023-08-29 16:40:29 | INFO | train_inner | epoch 018:    764 / 1191 loss=1.9, trans_loss=4.66, nll_loss=1.864, w2v_ctc_loss=0.609, task_loss=2.246, contrastive_loss=0.214, total=6829.65, n_correct=4824.68, ppl=3.64, accuracy=70.643, wps=18689.1, ups=1.37, wpb=13659.3, bsz=472.1, num_updates=21000, lr=9.759e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=73, gb_free=13.4, wall=20373
2023-08-29 16:41:42 | INFO | train_inner | epoch 018:    864 / 1191 loss=1.906, trans_loss=4.661, nll_loss=1.865, w2v_ctc_loss=0.61, task_loss=2.385, contrastive_loss=0.259, total=6699.72, n_correct=4725.92, ppl=3.64, accuracy=70.539, wps=18201.8, ups=1.36, wpb=13399.4, bsz=449, num_updates=21100, lr=9.73585e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=73, gb_free=13.5, wall=20447
2023-08-29 16:42:55 | INFO | train_inner | epoch 018:    964 / 1191 loss=1.896, trans_loss=4.653, nll_loss=1.855, w2v_ctc_loss=0.608, task_loss=2.256, contrastive_loss=0.205, total=6735.73, n_correct=4767.17, ppl=3.62, accuracy=70.774, wps=18623.9, ups=1.38, wpb=13471.5, bsz=459.4, num_updates=21200, lr=9.71286e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=20519
2023-08-29 16:44:07 | INFO | train_inner | epoch 018:   1064 / 1191 loss=1.908, trans_loss=4.661, nll_loss=1.865, w2v_ctc_loss=0.618, task_loss=2.497, contrastive_loss=0.253, total=6578.5, n_correct=4635.89, ppl=3.64, accuracy=70.47, wps=18220.3, ups=1.38, wpb=13157, bsz=432.2, num_updates=21300, lr=9.69003e-05, gnorm=0.429, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=20591
2023-08-29 16:45:21 | INFO | train_inner | epoch 018:   1164 / 1191 loss=1.906, trans_loss=4.658, nll_loss=1.861, w2v_ctc_loss=0.609, task_loss=2.321, contrastive_loss=0.275, total=6752.19, n_correct=4766.01, ppl=3.63, accuracy=70.585, wps=18337, ups=1.36, wpb=13504.4, bsz=463.4, num_updates=21400, lr=9.66736e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=73, gb_free=13.7, wall=20665
2023-08-29 16:45:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 16:46:12 | INFO | dev_st | epoch 018 | valid on 'dev_st' subset | loss 3.794 | trans_loss 4.881 | nll_loss 2.106 | w2v_ctc_loss 1.198 | task_loss 8.585 | contrastive_loss 0.455 | total 6138.43 | n_correct 4357.86 | ppl 4.3 | accuracy 70.993 | uer 17.436 | wer 19.055 | raw_wer 19.055 | bleu 28.73 | wps 1769.2 | wpb 6138.4 | bsz 201.1 | num_updates 21427 | best_bleu 28.97
2023-08-29 16:46:12 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 18 @ 21427 updates
2023-08-29 16:46:12 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7305.pt
2023-08-29 16:46:14 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7305.pt
2023-08-29 16:46:19 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7305.pt (epoch 18 @ 21427 updates, score 28.73) (writing took 6.8987619309918955 seconds)
2023-08-29 16:46:19 | INFO | fairseq_cli.train | end of epoch 18 (average epoch stats below)
2023-08-29 16:46:19 | INFO | train | epoch 018 | loss 1.902 | trans_loss 4.657 | nll_loss 1.859 | w2v_ctc_loss 0.607 | task_loss 2.354 | contrastive_loss 0.246 | total 6703.69 | n_correct 4737.59 | ppl 3.63 | accuracy 70.671 | wps 17475.3 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 21427 | lr 9.66127e-05 | gnorm 0.425 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.8 | wall 20724
2023-08-29 16:46:20 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 16:46:20 | INFO | fairseq.trainer | begin training epoch 19
2023-08-29 16:46:20 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 16:47:20 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 16:47:21 | INFO | train_inner | epoch 019:     74 / 1191 loss=1.893, trans_loss=4.643, nll_loss=1.841, w2v_ctc_loss=0.598, task_loss=2.497, contrastive_loss=0.243, total=6593.51, n_correct=4679.05, ppl=3.58, accuracy=70.964, wps=10954.2, ups=0.83, wpb=13187, bsz=426.8, num_updates=21500, lr=9.64486e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=12.8, wall=20785
2023-08-29 16:48:33 | INFO | train_inner | epoch 019:    174 / 1191 loss=1.884, trans_loss=4.639, nll_loss=1.836, w2v_ctc_loss=0.594, task_loss=2.373, contrastive_loss=0.195, total=6676.01, n_correct=4744.06, ppl=3.57, accuracy=71.061, wps=18480.3, ups=1.38, wpb=13352, bsz=445, num_updates=21600, lr=9.6225e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=12.7, wall=20857
2023-08-29 16:49:46 | INFO | train_inner | epoch 019:    274 / 1191 loss=1.888, trans_loss=4.636, nll_loss=1.832, w2v_ctc_loss=0.595, task_loss=2.254, contrastive_loss=0.249, total=6764.07, n_correct=4809.26, ppl=3.56, accuracy=71.1, wps=18517.1, ups=1.37, wpb=13528.1, bsz=463.5, num_updates=21700, lr=9.60031e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=11.9, wall=20930
2023-08-29 16:50:59 | INFO | train_inner | epoch 019:    374 / 1191 loss=1.886, trans_loss=4.644, nll_loss=1.843, w2v_ctc_loss=0.595, task_loss=2.343, contrastive_loss=0.187, total=6690, n_correct=4746.11, ppl=3.59, accuracy=70.943, wps=18523.1, ups=1.38, wpb=13380, bsz=443.1, num_updates=21800, lr=9.57826e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=72, gb_free=13.4, wall=21003
2023-08-29 16:52:12 | INFO | train_inner | epoch 019:    474 / 1191 loss=1.896, trans_loss=4.646, nll_loss=1.846, w2v_ctc_loss=0.594, task_loss=2.202, contrastive_loss=0.294, total=6787.56, n_correct=4817.62, ppl=3.6, accuracy=70.977, wps=18615.6, ups=1.37, wpb=13575.1, bsz=478.4, num_updates=21900, lr=9.55637e-05, gnorm=0.43, clip=0, loss_scale=16, train_wall=72, gb_free=11.4, wall=21076
2023-08-29 16:53:25 | INFO | train_inner | epoch 019:    574 / 1191 loss=1.895, trans_loss=4.653, nll_loss=1.855, w2v_ctc_loss=0.605, task_loss=2.323, contrastive_loss=0.217, total=6760.33, n_correct=4790.06, ppl=3.62, accuracy=70.855, wps=18438.6, ups=1.36, wpb=13520.7, bsz=463.2, num_updates=22000, lr=9.53463e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=73, gb_free=13.2, wall=21149
2023-08-29 16:53:25 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 16:53:57 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.785 | trans_loss 4.88 | nll_loss 2.103 | w2v_ctc_loss 1.182 | task_loss 8.516 | contrastive_loss 0.445 | total 6138.43 | n_correct 4368.86 | ppl 4.3 | accuracy 71.172 | uer 17.399 | wer 19.096 | raw_wer 19.096 | bleu 28.83 | wps 1771.5 | wpb 6138.4 | bsz 201.1 | num_updates 22000 | best_bleu 28.97
2023-08-29 16:53:57 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22000 updates
2023-08-29 16:53:57 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-29 16:53:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt
2023-08-29 16:54:05 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_19_22000.pt (epoch 19 @ 22000 updates, score 28.83) (writing took 7.430101716003264 seconds)
2023-08-29 16:55:18 | INFO | train_inner | epoch 019:    674 / 1191 loss=1.895, trans_loss=4.641, nll_loss=1.84, w2v_ctc_loss=0.593, task_loss=2.365, contrastive_loss=0.309, total=6640.74, n_correct=4718.39, ppl=3.58, accuracy=71.052, wps=11789.6, ups=0.89, wpb=13281.5, bsz=450.9, num_updates=22100, lr=9.51303e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=21262
2023-08-29 16:56:30 | INFO | train_inner | epoch 019:    774 / 1191 loss=1.894, trans_loss=4.644, nll_loss=1.844, w2v_ctc_loss=0.602, task_loss=2.299, contrastive_loss=0.226, total=6767.75, n_correct=4800.16, ppl=3.59, accuracy=70.927, wps=18606.8, ups=1.37, wpb=13535.5, bsz=463, num_updates=22200, lr=9.49158e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=11.8, wall=21334
2023-08-29 16:57:43 | INFO | train_inner | epoch 019:    874 / 1191 loss=1.903, trans_loss=4.647, nll_loss=1.848, w2v_ctc_loss=0.608, task_loss=2.427, contrastive_loss=0.287, total=6628.46, n_correct=4698.12, ppl=3.6, accuracy=70.878, wps=18107.7, ups=1.37, wpb=13256.9, bsz=442.5, num_updates=22300, lr=9.47027e-05, gnorm=0.429, clip=0, loss_scale=16, train_wall=73, gb_free=11.8, wall=21408
2023-08-29 16:58:56 | INFO | train_inner | epoch 019:    974 / 1191 loss=1.893, trans_loss=4.64, nll_loss=1.839, w2v_ctc_loss=0.607, task_loss=2.522, contrastive_loss=0.218, total=6611.45, n_correct=4691.94, ppl=3.58, accuracy=70.967, wps=18328.5, ups=1.39, wpb=13222.9, bsz=434.1, num_updates=22400, lr=9.44911e-05, gnorm=0.432, clip=0, loss_scale=16, train_wall=71, gb_free=13.8, wall=21480
2023-08-29 17:00:08 | INFO | train_inner | epoch 019:   1074 / 1191 loss=1.897, trans_loss=4.647, nll_loss=1.847, w2v_ctc_loss=0.603, task_loss=2.312, contrastive_loss=0.243, total=6721.73, n_correct=4765.77, ppl=3.6, accuracy=70.901, wps=18608, ups=1.38, wpb=13443.5, bsz=451.2, num_updates=22500, lr=9.42809e-05, gnorm=0.428, clip=0, loss_scale=16, train_wall=72, gb_free=14.7, wall=21552
2023-08-29 17:01:22 | INFO | train_inner | epoch 019:   1174 / 1191 loss=1.9, trans_loss=4.657, nll_loss=1.86, w2v_ctc_loss=0.601, task_loss=2.314, contrastive_loss=0.268, total=6808.52, n_correct=4816.02, ppl=3.63, accuracy=70.735, wps=18463.2, ups=1.36, wpb=13617, bsz=462.3, num_updates=22600, lr=9.40721e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=73, gb_free=5.9, wall=21626
2023-08-29 17:01:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 17:02:06 | INFO | dev_st | epoch 019 | valid on 'dev_st' subset | loss 3.798 | trans_loss 4.88 | nll_loss 2.104 | w2v_ctc_loss 1.223 | task_loss 8.555 | contrastive_loss 0.448 | total 6138.43 | n_correct 4356.29 | ppl 4.3 | accuracy 70.967 | uer 17.554 | wer 19.059 | raw_wer 19.059 | bleu 28.91 | wps 1757.7 | wpb 6138.4 | bsz 201.1 | num_updates 22617 | best_bleu 28.97
2023-08-29 17:02:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 19 @ 22617 updates
2023-08-29 17:02:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9101.pt
2023-08-29 17:02:09 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9101.pt
2023-08-29 17:02:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9101.pt (epoch 19 @ 22617 updates, score 28.91) (writing took 7.757503750006435 seconds)
2023-08-29 17:02:15 | INFO | fairseq_cli.train | end of epoch 19 (average epoch stats below)
2023-08-29 17:02:15 | INFO | train | epoch 019 | loss 1.893 | trans_loss 4.645 | nll_loss 1.844 | w2v_ctc_loss 0.6 | task_loss 2.354 | contrastive_loss 0.243 | total 6702.72 | n_correct 4755.15 | ppl 3.59 | accuracy 70.944 | wps 16700.5 | ups 1.25 | wpb 13405.4 | bsz 452 | num_updates 22617 | lr 9.40367e-05 | gnorm 0.425 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 14.2 | wall 21679
2023-08-29 17:02:15 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 17:02:15 | INFO | fairseq.trainer | begin training epoch 20
2023-08-29 17:02:15 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 17:03:23 | INFO | train_inner | epoch 020:     83 / 1191 loss=1.884, trans_loss=4.629, nll_loss=1.824, w2v_ctc_loss=0.597, task_loss=2.406, contrastive_loss=0.225, total=6680.08, n_correct=4759.11, ppl=3.54, accuracy=71.243, wps=11008.7, ups=0.82, wpb=13360.2, bsz=448.2, num_updates=22700, lr=9.38647e-05, gnorm=0.428, clip=0, loss_scale=16, train_wall=72, gb_free=12.8, wall=21747
2023-08-29 17:04:36 | INFO | train_inner | epoch 020:    183 / 1191 loss=1.886, trans_loss=4.63, nll_loss=1.825, w2v_ctc_loss=0.595, task_loss=2.442, contrastive_loss=0.242, total=6602.91, n_correct=4702.36, ppl=3.54, accuracy=71.216, wps=18225.9, ups=1.38, wpb=13205.8, bsz=438.1, num_updates=22800, lr=9.36586e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=21820
2023-08-29 17:05:48 | INFO | train_inner | epoch 020:    283 / 1191 loss=1.888, trans_loss=4.638, nll_loss=1.835, w2v_ctc_loss=0.591, task_loss=2.342, contrastive_loss=0.247, total=6762.57, n_correct=4810.74, ppl=3.57, accuracy=71.138, wps=18625, ups=1.38, wpb=13525.1, bsz=456.8, num_updates=22900, lr=9.34539e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=72, gb_free=4.1, wall=21892
2023-08-29 17:07:01 | INFO | train_inner | epoch 020:    383 / 1191 loss=1.882, trans_loss=4.637, nll_loss=1.834, w2v_ctc_loss=0.594, task_loss=2.219, contrastive_loss=0.199, total=6798.59, n_correct=4841.63, ppl=3.57, accuracy=71.215, wps=18780.9, ups=1.38, wpb=13597.2, bsz=469.2, num_updates=23000, lr=9.32505e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=11.5, wall=21965
2023-08-29 17:08:13 | INFO | train_inner | epoch 020:    483 / 1191 loss=1.878, trans_loss=4.626, nll_loss=1.821, w2v_ctc_loss=0.587, task_loss=2.337, contrastive_loss=0.229, total=6686.96, n_correct=4765.7, ppl=3.53, accuracy=71.269, wps=18436.8, ups=1.38, wpb=13373.9, bsz=446.1, num_updates=23100, lr=9.30484e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=72, gb_free=13.8, wall=22037
2023-08-29 17:09:26 | INFO | train_inner | epoch 020:    583 / 1191 loss=1.899, trans_loss=4.637, nll_loss=1.834, w2v_ctc_loss=0.598, task_loss=2.446, contrastive_loss=0.341, total=6619.39, n_correct=4703.65, ppl=3.57, accuracy=71.059, wps=18210.9, ups=1.38, wpb=13238.8, bsz=442.1, num_updates=23200, lr=9.28477e-05, gnorm=0.433, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=22110
2023-08-29 17:10:38 | INFO | train_inner | epoch 020:    683 / 1191 loss=1.879, trans_loss=4.63, nll_loss=1.826, w2v_ctc_loss=0.578, task_loss=2.208, contrastive_loss=0.275, total=6720.88, n_correct=4793.93, ppl=3.55, accuracy=71.329, wps=18670.2, ups=1.39, wpb=13441.8, bsz=471.1, num_updates=23300, lr=9.26482e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=71, gb_free=15, wall=22182
2023-08-29 17:11:50 | INFO | train_inner | epoch 020:    783 / 1191 loss=1.886, trans_loss=4.636, nll_loss=1.833, w2v_ctc_loss=0.593, task_loss=2.244, contrastive_loss=0.24, total=6756.09, n_correct=4810.5, ppl=3.56, accuracy=71.202, wps=18682.1, ups=1.38, wpb=13512.2, bsz=459.8, num_updates=23400, lr=9.245e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=12.7, wall=22254
2023-08-29 17:13:03 | INFO | train_inner | epoch 020:    883 / 1191 loss=1.882, trans_loss=4.633, nll_loss=1.829, w2v_ctc_loss=0.593, task_loss=2.423, contrastive_loss=0.203, total=6721.21, n_correct=4792.28, ppl=3.55, accuracy=71.301, wps=18470.5, ups=1.37, wpb=13442.4, bsz=447.2, num_updates=23500, lr=9.22531e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=11.4, wall=22327
2023-08-29 17:14:16 | INFO | train_inner | epoch 020:    983 / 1191 loss=1.881, trans_loss=4.634, nll_loss=1.831, w2v_ctc_loss=0.59, task_loss=2.549, contrastive_loss=0.193, total=6663.99, n_correct=4741.11, ppl=3.56, accuracy=71.145, wps=18159.9, ups=1.36, wpb=13328, bsz=432.3, num_updates=23600, lr=9.20575e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=73, gb_free=12.6, wall=22400
2023-08-29 17:15:29 | INFO | train_inner | epoch 020:   1083 / 1191 loss=1.883, trans_loss=4.634, nll_loss=1.832, w2v_ctc_loss=0.598, task_loss=2.318, contrastive_loss=0.19, total=6745.83, n_correct=4798.74, ppl=3.56, accuracy=71.136, wps=18473.3, ups=1.37, wpb=13491.7, bsz=458.4, num_updates=23700, lr=9.1863e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=22473
2023-08-29 17:16:42 | INFO | train_inner | epoch 020:   1183 / 1191 loss=1.891, trans_loss=4.643, nll_loss=1.843, w2v_ctc_loss=0.599, task_loss=2.373, contrastive_loss=0.237, total=6686.81, n_correct=4745.71, ppl=3.59, accuracy=70.971, wps=18410.7, ups=1.38, wpb=13373.6, bsz=452.7, num_updates=23800, lr=9.16698e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=22546
2023-08-29 17:16:48 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 17:17:20 | INFO | dev_st | epoch 020 | valid on 'dev_st' subset | loss 3.779 | trans_loss 4.879 | nll_loss 2.101 | w2v_ctc_loss 1.163 | task_loss 8.581 | contrastive_loss 0.446 | total 6138.43 | n_correct 4364.71 | ppl 4.29 | accuracy 71.105 | uer 17.313 | wer 18.873 | raw_wer 18.873 | bleu 28.59 | wps 1755.9 | wpb 6138.4 | bsz 201.1 | num_updates 23808 | best_bleu 28.97
2023-08-29 17:17:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 20 @ 23808 updates
2023-08-29 17:17:20 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5900.pt
2023-08-29 17:17:23 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5900.pt
2023-08-29 17:17:27 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5900.pt (epoch 20 @ 23808 updates, score 28.59) (writing took 7.1468079930054955 seconds)
2023-08-29 17:17:28 | INFO | fairseq_cli.train | end of epoch 20 (average epoch stats below)
2023-08-29 17:17:28 | INFO | train | epoch 020 | loss 1.885 | trans_loss 4.634 | nll_loss 1.831 | w2v_ctc_loss 0.593 | task_loss 2.355 | contrastive_loss 0.239 | total 6703.69 | n_correct 4771.97 | ppl 3.56 | accuracy 71.184 | wps 17488.8 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 23808 | lr 9.16544e-05 | gnorm 0.425 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 15.2 | wall 22592
2023-08-29 17:17:28 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 17:17:28 | INFO | fairseq.trainer | begin training epoch 21
2023-08-29 17:17:28 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 17:18:43 | INFO | train_inner | epoch 021:     92 / 1191 loss=1.883, trans_loss=4.621, nll_loss=1.814, w2v_ctc_loss=0.577, task_loss=2.222, contrastive_loss=0.35, total=6751.51, n_correct=4827.16, ppl=3.52, accuracy=71.497, wps=11179.1, ups=0.83, wpb=13503, bsz=472.6, num_updates=23900, lr=9.14779e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=22667
2023-08-29 17:19:55 | INFO | train_inner | epoch 021:    192 / 1191 loss=1.87, trans_loss=4.616, nll_loss=1.808, w2v_ctc_loss=0.581, task_loss=2.206, contrastive_loss=0.217, total=6783.56, n_correct=4861.98, ppl=3.5, accuracy=71.673, wps=18750.6, ups=1.38, wpb=13567.1, bsz=472.1, num_updates=24000, lr=9.12871e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=22739
2023-08-29 17:19:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 17:20:28 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.786 | trans_loss 4.876 | nll_loss 2.098 | w2v_ctc_loss 1.195 | task_loss 8.601 | contrastive_loss 0.445 | total 6138.43 | n_correct 4367.14 | ppl 4.28 | accuracy 71.144 | uer 17.177 | wer 18.799 | raw_wer 18.799 | bleu 28.72 | wps 1758.6 | wpb 6138.4 | bsz 201.1 | num_updates 24000 | best_bleu 28.97
2023-08-29 17:20:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24000 updates
2023-08-29 17:20:28 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-29 17:20:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt
2023-08-29 17:20:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_21_24000.pt (epoch 21 @ 24000 updates, score 28.72) (writing took 9.96282461899682 seconds)
2023-08-29 17:21:50 | INFO | train_inner | epoch 021:    292 / 1191 loss=1.872, trans_loss=4.621, nll_loss=1.813, w2v_ctc_loss=0.588, task_loss=2.429, contrastive_loss=0.18, total=6648.85, n_correct=4751.71, ppl=3.51, accuracy=71.467, wps=11580, ups=0.87, wpb=13297.7, bsz=437.3, num_updates=24100, lr=9.10975e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=22854
2023-08-29 17:23:03 | INFO | train_inner | epoch 021:    392 / 1191 loss=1.875, trans_loss=4.628, nll_loss=1.823, w2v_ctc_loss=0.583, task_loss=2.384, contrastive_loss=0.202, total=6668.27, n_correct=4759.17, ppl=3.54, accuracy=71.37, wps=18311, ups=1.37, wpb=13336.5, bsz=449.4, num_updates=24200, lr=9.09091e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=22927
2023-08-29 17:24:15 | INFO | train_inner | epoch 021:    492 / 1191 loss=1.877, trans_loss=4.62, nll_loss=1.812, w2v_ctc_loss=0.589, task_loss=2.455, contrastive_loss=0.217, total=6689.7, n_correct=4778.56, ppl=3.51, accuracy=71.432, wps=18495.9, ups=1.38, wpb=13379.4, bsz=438.4, num_updates=24300, lr=9.07218e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=22999
2023-08-29 17:25:28 | INFO | train_inner | epoch 021:    592 / 1191 loss=1.878, trans_loss=4.626, nll_loss=1.82, w2v_ctc_loss=0.594, task_loss=2.535, contrastive_loss=0.18, total=6614.82, n_correct=4719.12, ppl=3.53, accuracy=71.342, wps=18223.2, ups=1.38, wpb=13229.6, bsz=423.7, num_updates=24400, lr=9.05357e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=15, wall=23072
2023-08-29 17:26:41 | INFO | train_inner | epoch 021:    692 / 1191 loss=1.882, trans_loss=4.628, nll_loss=1.823, w2v_ctc_loss=0.588, task_loss=2.307, contrastive_loss=0.257, total=6722.88, n_correct=4796.18, ppl=3.54, accuracy=71.341, wps=18292.9, ups=1.36, wpb=13445.8, bsz=466.8, num_updates=24500, lr=9.03508e-05, gnorm=0.431, clip=0, loss_scale=32, train_wall=73, gb_free=12.4, wall=23145
2023-08-29 17:27:54 | INFO | train_inner | epoch 021:    792 / 1191 loss=1.886, trans_loss=4.628, nll_loss=1.823, w2v_ctc_loss=0.586, task_loss=2.445, contrastive_loss=0.301, total=6639.93, n_correct=4732.15, ppl=3.54, accuracy=71.268, wps=18271.8, ups=1.38, wpb=13279.9, bsz=443.4, num_updates=24600, lr=9.0167e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=11.4, wall=23218
2023-08-29 17:29:07 | INFO | train_inner | epoch 021:    892 / 1191 loss=1.882, trans_loss=4.626, nll_loss=1.82, w2v_ctc_loss=0.59, task_loss=2.334, contrastive_loss=0.247, total=6729.37, n_correct=4798.49, ppl=3.53, accuracy=71.307, wps=18423.3, ups=1.37, wpb=13458.7, bsz=452, num_updates=24700, lr=8.99843e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=23291
2023-08-29 17:30:20 | INFO | train_inner | epoch 021:    992 / 1191 loss=1.879, trans_loss=4.631, nll_loss=1.826, w2v_ctc_loss=0.584, task_loss=2.247, contrastive_loss=0.248, total=6803.81, n_correct=4852.44, ppl=3.55, accuracy=71.319, wps=18581.1, ups=1.37, wpb=13607.6, bsz=465.2, num_updates=24800, lr=8.98027e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=12.7, wall=23364
2023-08-29 17:31:34 | INFO | train_inner | epoch 021:   1092 / 1191 loss=1.88, trans_loss=4.629, nll_loss=1.825, w2v_ctc_loss=0.59, task_loss=2.288, contrastive_loss=0.226, total=6727.98, n_correct=4795.8, ppl=3.54, accuracy=71.281, wps=18373.8, ups=1.37, wpb=13456, bsz=457.5, num_updates=24900, lr=8.96221e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=73, gb_free=12.6, wall=23438
2023-08-29 17:32:46 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 17:33:18 | INFO | dev_st | epoch 021 | valid on 'dev_st' subset | loss 3.778 | trans_loss 4.873 | nll_loss 2.092 | w2v_ctc_loss 1.177 | task_loss 8.572 | contrastive_loss 0.444 | total 6138.43 | n_correct 4367.71 | ppl 4.26 | accuracy 71.154 | uer 17.105 | wer 18.669 | raw_wer 18.669 | bleu 28.57 | wps 1743.5 | wpb 6138.4 | bsz 201.1 | num_updates 24999 | best_bleu 28.97
2023-08-29 17:33:18 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 21 @ 24999 updates
2023-08-29 17:33:18 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5702.pt
2023-08-29 17:33:21 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5702.pt
2023-08-29 17:33:26 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.5702.pt (epoch 21 @ 24999 updates, score 28.57) (writing took 7.652134032003232 seconds)
2023-08-29 17:33:26 | INFO | fairseq_cli.train | end of epoch 21 (average epoch stats below)
2023-08-29 17:33:26 | INFO | train | epoch 021 | loss 1.878 | trans_loss 4.625 | nll_loss 1.819 | w2v_ctc_loss 0.586 | task_loss 2.353 | contrastive_loss 0.237 | total 6703.69 | n_correct 4786.18 | ppl 3.53 | accuracy 71.396 | wps 16660.8 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 24999 | lr 8.94445e-05 | gnorm 0.424 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 13.4 | wall 23550
2023-08-29 17:33:26 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 17:33:26 | INFO | fairseq.trainer | begin training epoch 22
2023-08-29 17:33:26 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 17:33:34 | INFO | train_inner | epoch 022:      1 / 1191 loss=1.881, trans_loss=4.626, nll_loss=1.821, w2v_ctc_loss=0.587, task_loss=2.389, contrastive_loss=0.254, total=6667.93, n_correct=4760.68, ppl=3.53, accuracy=71.397, wps=11029.1, ups=0.83, wpb=13335.9, bsz=453.9, num_updates=25000, lr=8.94427e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=10.5, wall=23559
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 17:34:47 | INFO | train_inner | epoch 022:    101 / 1191 loss=1.858, trans_loss=4.606, nll_loss=1.796, w2v_ctc_loss=0.565, task_loss=2.314, contrastive_loss=0.198, total=6752.63, n_correct=4850.1, ppl=3.47, accuracy=71.825, wps=18701.6, ups=1.38, wpb=13505.3, bsz=456.3, num_updates=25100, lr=8.92644e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=23631
2023-08-29 17:36:00 | INFO | train_inner | epoch 022:    201 / 1191 loss=1.87, trans_loss=4.613, nll_loss=1.804, w2v_ctc_loss=0.58, task_loss=2.424, contrastive_loss=0.223, total=6655.06, n_correct=4764.14, ppl=3.49, accuracy=71.587, wps=18213.5, ups=1.37, wpb=13310.1, bsz=443.4, num_updates=25200, lr=8.90871e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=12, wall=23704
2023-08-29 17:37:12 | INFO | train_inner | epoch 022:    301 / 1191 loss=1.87, trans_loss=4.611, nll_loss=1.802, w2v_ctc_loss=0.575, task_loss=2.266, contrastive_loss=0.263, total=6760.33, n_correct=4846.45, ppl=3.49, accuracy=71.69, wps=18665.8, ups=1.38, wpb=13520.7, bsz=469.7, num_updates=25300, lr=8.89108e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=23776
2023-08-29 17:38:26 | INFO | train_inner | epoch 022:    401 / 1191 loss=1.866, trans_loss=4.612, nll_loss=1.803, w2v_ctc_loss=0.58, task_loss=2.347, contrastive_loss=0.195, total=6660.25, n_correct=4775.15, ppl=3.49, accuracy=71.696, wps=18064.2, ups=1.36, wpb=13320.5, bsz=455.7, num_updates=25400, lr=8.87357e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=73, gb_free=15.1, wall=23850
2023-08-29 17:39:39 | INFO | train_inner | epoch 022:    501 / 1191 loss=1.877, trans_loss=4.619, nll_loss=1.811, w2v_ctc_loss=0.587, task_loss=2.344, contrastive_loss=0.252, total=6720.12, n_correct=4809.3, ppl=3.51, accuracy=71.566, wps=18452.7, ups=1.37, wpb=13440.2, bsz=457.6, num_updates=25500, lr=8.85615e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=13.8, wall=23923
2023-08-29 17:40:52 | INFO | train_inner | epoch 022:    601 / 1191 loss=1.869, trans_loss=4.616, nll_loss=1.807, w2v_ctc_loss=0.582, task_loss=2.39, contrastive_loss=0.193, total=6704.25, n_correct=4802.45, ppl=3.5, accuracy=71.633, wps=18398.6, ups=1.37, wpb=13408.5, bsz=447.4, num_updates=25600, lr=8.83883e-05, gnorm=0.421, clip=0, loss_scale=64, train_wall=72, gb_free=10.3, wall=23996
2023-08-29 17:42:04 | INFO | train_inner | epoch 022:    701 / 1191 loss=1.868, trans_loss=4.613, nll_loss=1.804, w2v_ctc_loss=0.57, task_loss=2.291, contrastive_loss=0.258, total=6710.51, n_correct=4808.44, ppl=3.49, accuracy=71.655, wps=18481.3, ups=1.38, wpb=13421, bsz=454.9, num_updates=25700, lr=8.82162e-05, gnorm=0.418, clip=0, loss_scale=64, train_wall=72, gb_free=15, wall=24068
2023-08-29 17:43:16 | INFO | train_inner | epoch 022:    801 / 1191 loss=1.87, trans_loss=4.612, nll_loss=1.803, w2v_ctc_loss=0.579, task_loss=2.459, contrastive_loss=0.243, total=6572.69, n_correct=4707.34, ppl=3.49, accuracy=71.62, wps=18280.3, ups=1.39, wpb=13145.4, bsz=434.8, num_updates=25800, lr=8.80451e-05, gnorm=0.423, clip=0, loss_scale=64, train_wall=71, gb_free=11.6, wall=24140
2023-08-29 17:44:30 | INFO | train_inner | epoch 022:    901 / 1191 loss=1.887, trans_loss=4.624, nll_loss=1.818, w2v_ctc_loss=0.587, task_loss=2.387, contrastive_loss=0.314, total=6701.42, n_correct=4775.44, ppl=3.53, accuracy=71.26, wps=18144.5, ups=1.35, wpb=13402.8, bsz=452.1, num_updates=25900, lr=8.7875e-05, gnorm=0.425, clip=0, loss_scale=64, train_wall=73, gb_free=12.5, wall=24214
2023-08-29 17:44:58 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 17:45:44 | INFO | train_inner | epoch 022:   1002 / 1191 loss=1.871, trans_loss=4.615, nll_loss=1.806, w2v_ctc_loss=0.581, task_loss=2.252, contrastive_loss=0.22, total=6844.73, n_correct=4900.44, ppl=3.5, accuracy=71.594, wps=18530.4, ups=1.35, wpb=13689.5, bsz=466.9, num_updates=26000, lr=8.77058e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=73, gb_free=13, wall=24288
2023-08-29 17:45:44 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
2023-08-29 17:46:17 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.787 | trans_loss 4.873 | nll_loss 2.095 | w2v_ctc_loss 1.199 | task_loss 8.528 | contrastive_loss 0.452 | total 6138.43 | n_correct 4368 | ppl 4.27 | accuracy 71.158 | uer 17.581 | wer 19.152 | raw_wer 19.152 | bleu 28.55 | wps 1759.7 | wpb 6138.4 | bsz 201.1 | num_updates 26000 | best_bleu 28.97
2023-08-29 17:46:17 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26000 updates
2023-08-29 17:46:17 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-29 17:46:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt
2023-08-29 17:46:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_22_26000.pt (epoch 22 @ 26000 updates, score 28.55) (writing took 7.969103390001692 seconds)
2023-08-29 17:47:37 | INFO | train_inner | epoch 022:   1102 / 1191 loss=1.868, trans_loss=4.613, nll_loss=1.804, w2v_ctc_loss=0.577, task_loss=2.35, contrastive_loss=0.222, total=6701.53, n_correct=4800.45, ppl=3.49, accuracy=71.632, wps=11880.3, ups=0.89, wpb=13403.1, bsz=447.4, num_updates=26100, lr=8.75376e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=71, gb_free=11.6, wall=24401
2023-08-29 17:48:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 17:49:14 | INFO | dev_st | epoch 022 | valid on 'dev_st' subset | loss 3.79 | trans_loss 4.871 | nll_loss 2.092 | w2v_ctc_loss 1.216 | task_loss 8.604 | contrastive_loss 0.45 | total 6138.43 | n_correct 4370.71 | ppl 4.26 | accuracy 71.202 | uer 17.329 | wer 18.892 | raw_wer 18.892 | bleu 28.88 | wps 1763.1 | wpb 6138.4 | bsz 201.1 | num_updates 26189 | best_bleu 28.97
2023-08-29 17:49:14 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 22 @ 26189 updates
2023-08-29 17:49:14 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8806.pt
2023-08-29 17:49:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8806.pt
2023-08-29 17:49:22 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8806.pt (epoch 22 @ 26189 updates, score 28.88) (writing took 7.560404994990677 seconds)
2023-08-29 17:49:22 | INFO | fairseq_cli.train | end of epoch 22 (average epoch stats below)
2023-08-29 17:49:22 | INFO | train | epoch 022 | loss 1.871 | trans_loss 4.615 | nll_loss 1.806 | w2v_ctc_loss 0.579 | task_loss 2.356 | contrastive_loss 0.234 | total 6703.74 | n_correct 4799.88 | ppl 3.5 | accuracy 71.6 | wps 16691.5 | ups 1.24 | wpb 13407.5 | bsz 452.1 | num_updates 26189 | lr 8.73888e-05 | gnorm 0.422 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 13.5 | wall 24506
2023-08-29 17:49:22 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 17:49:22 | INFO | fairseq.trainer | begin training epoch 23
2023-08-29 17:49:22 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 17:49:38 | INFO | train_inner | epoch 023:     11 / 1191 loss=1.876, trans_loss=4.62, nll_loss=1.813, w2v_ctc_loss=0.586, task_loss=2.509, contrastive_loss=0.221, total=6652.47, n_correct=4754.8, ppl=3.51, accuracy=71.474, wps=10991.4, ups=0.83, wpb=13304.9, bsz=433.4, num_updates=26200, lr=8.73704e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=12.8, wall=24522
2023-08-29 17:50:50 | INFO | train_inner | epoch 023:    111 / 1191 loss=1.861, trans_loss=4.6, nll_loss=1.787, w2v_ctc_loss=0.573, task_loss=2.457, contrastive_loss=0.212, total=6652.39, n_correct=4783.51, ppl=3.45, accuracy=71.907, wps=18364.2, ups=1.38, wpb=13304.8, bsz=438.7, num_updates=26300, lr=8.72041e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=24594
2023-08-29 17:52:03 | INFO | train_inner | epoch 023:    211 / 1191 loss=1.858, trans_loss=4.604, nll_loss=1.793, w2v_ctc_loss=0.568, task_loss=2.218, contrastive_loss=0.207, total=6813.04, n_correct=4894.84, ppl=3.46, accuracy=71.845, wps=18679.3, ups=1.37, wpb=13626.1, bsz=474, num_updates=26400, lr=8.70388e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=24667
2023-08-29 17:53:16 | INFO | train_inner | epoch 023:    311 / 1191 loss=1.853, trans_loss=4.598, nll_loss=1.784, w2v_ctc_loss=0.561, task_loss=2.239, contrastive_loss=0.209, total=6827.7, n_correct=4916.39, ppl=3.44, accuracy=72.007, wps=18826.2, ups=1.38, wpb=13655.4, bsz=466.9, num_updates=26500, lr=8.68744e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=9.8, wall=24740
2023-08-29 17:54:29 | INFO | train_inner | epoch 023:    411 / 1191 loss=1.87, trans_loss=4.61, nll_loss=1.8, w2v_ctc_loss=0.577, task_loss=2.45, contrastive_loss=0.251, total=6708.92, n_correct=4808.01, ppl=3.48, accuracy=71.666, wps=18429.3, ups=1.37, wpb=13417.8, bsz=437.8, num_updates=26600, lr=8.6711e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=11.3, wall=24813
2023-08-29 17:55:41 | INFO | train_inner | epoch 023:    511 / 1191 loss=1.864, trans_loss=4.605, nll_loss=1.793, w2v_ctc_loss=0.569, task_loss=2.33, contrastive_loss=0.246, total=6708.89, n_correct=4823.92, ppl=3.47, accuracy=71.903, wps=18463.5, ups=1.38, wpb=13417.8, bsz=453.5, num_updates=26700, lr=8.65485e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=11.6, wall=24885
2023-08-29 17:56:21 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 17:56:54 | INFO | train_inner | epoch 023:    612 / 1191 loss=1.87, trans_loss=4.612, nll_loss=1.803, w2v_ctc_loss=0.578, task_loss=2.322, contrastive_loss=0.24, total=6673.12, n_correct=4782.42, ppl=3.49, accuracy=71.667, wps=18315.4, ups=1.37, wpb=13346.2, bsz=453, num_updates=26800, lr=8.63868e-05, gnorm=0.434, clip=0, loss_scale=16, train_wall=72, gb_free=12.4, wall=24958
2023-08-29 17:58:07 | INFO | train_inner | epoch 023:    712 / 1191 loss=1.866, trans_loss=4.605, nll_loss=1.794, w2v_ctc_loss=0.566, task_loss=2.412, contrastive_loss=0.288, total=6660.29, n_correct=4782.31, ppl=3.47, accuracy=71.803, wps=18267.8, ups=1.37, wpb=13320.6, bsz=443.9, num_updates=26900, lr=8.62261e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=25031
2023-08-29 17:59:21 | INFO | train_inner | epoch 023:    812 / 1191 loss=1.863, trans_loss=4.609, nll_loss=1.799, w2v_ctc_loss=0.574, task_loss=2.404, contrastive_loss=0.196, total=6719.39, n_correct=4816.97, ppl=3.48, accuracy=71.688, wps=18274.1, ups=1.36, wpb=13438.8, bsz=446.1, num_updates=27000, lr=8.60663e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=73, gb_free=14.5, wall=25105
2023-08-29 18:00:33 | INFO | train_inner | epoch 023:    912 / 1191 loss=1.858, trans_loss=4.598, nll_loss=1.786, w2v_ctc_loss=0.576, task_loss=2.25, contrastive_loss=0.189, total=6716.94, n_correct=4835.68, ppl=3.45, accuracy=71.992, wps=18619.3, ups=1.39, wpb=13433.9, bsz=465.5, num_updates=27100, lr=8.59074e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=72, gb_free=12, wall=25177
2023-08-29 18:01:45 | INFO | train_inner | epoch 023:   1012 / 1191 loss=1.865, trans_loss=4.605, nll_loss=1.795, w2v_ctc_loss=0.578, task_loss=2.254, contrastive_loss=0.241, total=6674.89, n_correct=4794.73, ppl=3.47, accuracy=71.832, wps=18371.7, ups=1.38, wpb=13349.8, bsz=465.5, num_updates=27200, lr=8.57493e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=25250
2023-08-29 18:02:58 | INFO | train_inner | epoch 023:   1112 / 1191 loss=1.868, trans_loss=4.613, nll_loss=1.805, w2v_ctc_loss=0.575, task_loss=2.462, contrastive_loss=0.23, total=6640.69, n_correct=4753.86, ppl=3.49, accuracy=71.587, wps=18264.5, ups=1.38, wpb=13281.4, bsz=441.7, num_updates=27300, lr=8.55921e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=14.9, wall=25322
2023-08-29 18:03:55 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 18:04:28 | INFO | dev_st | epoch 023 | valid on 'dev_st' subset | loss 3.766 | trans_loss 4.86 | nll_loss 2.079 | w2v_ctc_loss 1.17 | task_loss 8.601 | contrastive_loss 0.438 | total 6138.43 | n_correct 4378.86 | ppl 4.22 | accuracy 71.335 | uer 17.014 | wer 18.583 | raw_wer 18.583 | bleu 28.74 | wps 1759.7 | wpb 6138.4 | bsz 201.1 | num_updates 27379 | best_bleu 28.97
2023-08-29 18:04:28 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 23 @ 27379 updates
2023-08-29 18:04:28 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7406.pt
2023-08-29 18:04:30 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7406.pt
2023-08-29 18:04:35 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7406.pt (epoch 23 @ 27379 updates, score 28.74) (writing took 7.352152161009144 seconds)
2023-08-29 18:04:35 | INFO | fairseq_cli.train | end of epoch 23 (average epoch stats below)
2023-08-29 18:04:35 | INFO | train | epoch 023 | loss 1.864 | trans_loss 4.606 | nll_loss 1.795 | w2v_ctc_loss 0.573 | task_loss 2.352 | contrastive_loss 0.232 | total 6703.69 | n_correct 4813.11 | ppl 3.47 | accuracy 71.798 | wps 17467.6 | ups 1.3 | wpb 13407.4 | bsz 452.2 | num_updates 27379 | lr 8.54685e-05 | gnorm 0.423 | clip 0 | loss_scale 16 | train_wall 857 | gb_free 14.6 | wall 25420
2023-08-29 18:04:36 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 18:04:36 | INFO | fairseq.trainer | begin training epoch 24
2023-08-29 18:04:36 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 18:04:58 | INFO | train_inner | epoch 024:     21 / 1191 loss=1.872, trans_loss=4.608, nll_loss=1.797, w2v_ctc_loss=0.578, task_loss=2.46, contrastive_loss=0.27, total=6654.23, n_correct=4768.33, ppl=3.48, accuracy=71.659, wps=11086.7, ups=0.83, wpb=13308.5, bsz=438.6, num_updates=27400, lr=8.54358e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=25442
2023-08-29 18:06:11 | INFO | train_inner | epoch 024:    121 / 1191 loss=1.855, trans_loss=4.598, nll_loss=1.785, w2v_ctc_loss=0.561, task_loss=2.239, contrastive_loss=0.232, total=6760.22, n_correct=4864.43, ppl=3.45, accuracy=71.957, wps=18677.2, ups=1.38, wpb=13520.4, bsz=474.5, num_updates=27500, lr=8.52803e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=9.9, wall=25515
2023-08-29 18:07:23 | INFO | train_inner | epoch 024:    221 / 1191 loss=1.855, trans_loss=4.593, nll_loss=1.779, w2v_ctc_loss=0.553, task_loss=2.123, contrastive_loss=0.298, total=6827.56, n_correct=4924.37, ppl=3.43, accuracy=72.125, wps=18918.9, ups=1.39, wpb=13655.1, bsz=483, num_updates=27600, lr=8.51257e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=71, gb_free=14.7, wall=25587
2023-08-29 18:08:36 | INFO | train_inner | epoch 024:    321 / 1191 loss=1.86, trans_loss=4.598, nll_loss=1.784, w2v_ctc_loss=0.57, task_loss=2.361, contrastive_loss=0.24, total=6731.61, n_correct=4842.1, ppl=3.44, accuracy=71.931, wps=18498.1, ups=1.37, wpb=13463.2, bsz=449.9, num_updates=27700, lr=8.49719e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=11.9, wall=25660
2023-08-29 18:09:48 | INFO | train_inner | epoch 024:    421 / 1191 loss=1.857, trans_loss=4.598, nll_loss=1.785, w2v_ctc_loss=0.569, task_loss=2.473, contrastive_loss=0.201, total=6661.95, n_correct=4797.67, ppl=3.45, accuracy=72.016, wps=18289.9, ups=1.37, wpb=13323.9, bsz=436.1, num_updates=27800, lr=8.48189e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=14.5, wall=25733
2023-08-29 18:11:02 | INFO | train_inner | epoch 024:    521 / 1191 loss=1.867, trans_loss=4.6, nll_loss=1.788, w2v_ctc_loss=0.572, task_loss=2.426, contrastive_loss=0.298, total=6652.29, n_correct=4778.96, ppl=3.45, accuracy=71.839, wps=18159.8, ups=1.36, wpb=13304.6, bsz=454, num_updates=27900, lr=8.46668e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=73, gb_free=12.1, wall=25806
2023-08-29 18:12:13 | INFO | train_inner | epoch 024:    621 / 1191 loss=1.856, trans_loss=4.599, nll_loss=1.785, w2v_ctc_loss=0.572, task_loss=2.556, contrastive_loss=0.166, total=6541.99, n_correct=4705.71, ppl=3.45, accuracy=71.931, wps=18284.6, ups=1.4, wpb=13084, bsz=418.2, num_updates=28000, lr=8.45154e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=71, gb_free=13.2, wall=25877
2023-08-29 18:12:13 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 18:12:46 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.793 | trans_loss 4.87 | nll_loss 2.089 | w2v_ctc_loss 1.231 | task_loss 8.599 | contrastive_loss 0.445 | total 6138.43 | n_correct 4369.71 | ppl 4.26 | accuracy 71.186 | uer 17.102 | wer 18.739 | raw_wer 18.739 | bleu 28.63 | wps 1738.6 | wpb 6138.4 | bsz 201.1 | num_updates 28000 | best_bleu 28.97
2023-08-29 18:12:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28000 updates
2023-08-29 18:12:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-29 18:12:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt
2023-08-29 18:12:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_24_28000.pt (epoch 24 @ 28000 updates, score 28.63) (writing took 8.979600988997845 seconds)
2023-08-29 18:14:07 | INFO | train_inner | epoch 024:    721 / 1191 loss=1.857, trans_loss=4.595, nll_loss=1.782, w2v_ctc_loss=0.569, task_loss=2.222, contrastive_loss=0.227, total=6743.6, n_correct=4862.67, ppl=3.44, accuracy=72.108, wps=11830.3, ups=0.88, wpb=13487.2, bsz=470.3, num_updates=28100, lr=8.43649e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=71, gb_free=14.7, wall=25991
2023-08-29 18:15:19 | INFO | train_inner | epoch 024:    821 / 1191 loss=1.852, trans_loss=4.592, nll_loss=1.778, w2v_ctc_loss=0.568, task_loss=2.347, contrastive_loss=0.188, total=6731.47, n_correct=4851.89, ppl=3.43, accuracy=72.078, wps=18649, ups=1.39, wpb=13462.9, bsz=448.3, num_updates=28200, lr=8.42152e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=71, gb_free=13.5, wall=26064
2023-08-29 18:16:33 | INFO | train_inner | epoch 024:    921 / 1191 loss=1.854, trans_loss=4.599, nll_loss=1.786, w2v_ctc_loss=0.565, task_loss=2.307, contrastive_loss=0.19, total=6730.81, n_correct=4848.75, ppl=3.45, accuracy=72.038, wps=18257, ups=1.36, wpb=13461.6, bsz=457.7, num_updates=28300, lr=8.40663e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=73, gb_free=13.7, wall=26137
2023-08-29 18:17:47 | INFO | train_inner | epoch 024:   1021 / 1191 loss=1.866, trans_loss=4.601, nll_loss=1.788, w2v_ctc_loss=0.566, task_loss=2.474, contrastive_loss=0.293, total=6590.6, n_correct=4738.25, ppl=3.45, accuracy=71.894, wps=17908.2, ups=1.36, wpb=13181.2, bsz=440.9, num_updates=28400, lr=8.39181e-05, gnorm=0.429, clip=0, loss_scale=16, train_wall=73, gb_free=14.1, wall=26211
2023-08-29 18:19:01 | INFO | train_inner | epoch 024:   1121 / 1191 loss=1.852, trans_loss=4.595, nll_loss=1.781, w2v_ctc_loss=0.565, task_loss=2.458, contrastive_loss=0.177, total=6706.32, n_correct=4831.12, ppl=3.44, accuracy=72.038, wps=18158.9, ups=1.35, wpb=13412.6, bsz=434.9, num_updates=28500, lr=8.37708e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=73, gb_free=12.2, wall=26285
2023-08-29 18:19:51 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 18:20:24 | INFO | dev_st | epoch 024 | valid on 'dev_st' subset | loss 3.773 | trans_loss 4.862 | nll_loss 2.08 | w2v_ctc_loss 1.191 | task_loss 8.544 | contrastive_loss 0.437 | total 6138.43 | n_correct 4380.86 | ppl 4.23 | accuracy 71.368 | uer 16.784 | wer 18.457 | raw_wer 18.457 | bleu 28.84 | wps 1744.6 | wpb 6138.4 | bsz 201.1 | num_updates 28570 | best_bleu 28.97
2023-08-29 18:20:24 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 24 @ 28570 updates
2023-08-29 18:20:24 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8405.pt
2023-08-29 18:20:26 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8405.pt
2023-08-29 18:20:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8405.pt (epoch 24 @ 28570 updates, score 28.84) (writing took 7.030712229010533 seconds)
2023-08-29 18:20:31 | INFO | fairseq_cli.train | end of epoch 24 (average epoch stats below)
2023-08-29 18:20:31 | INFO | train | epoch 024 | loss 1.857 | trans_loss 4.597 | nll_loss 1.784 | w2v_ctc_loss 0.567 | task_loss 2.354 | contrastive_loss 0.229 | total 6703.69 | n_correct 4826.16 | ppl 3.44 | accuracy 71.993 | wps 16706.8 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 28570 | lr 8.36681e-05 | gnorm 0.421 | clip 0 | loss_scale 16 | train_wall 858 | gb_free 14.9 | wall 26375
2023-08-29 18:20:31 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 18:20:31 | INFO | fairseq.trainer | begin training epoch 25
2023-08-29 18:20:31 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 18:21:01 | INFO | train_inner | epoch 025:     30 / 1191 loss=1.857, trans_loss=4.594, nll_loss=1.779, w2v_ctc_loss=0.567, task_loss=2.377, contrastive_loss=0.228, total=6700.77, n_correct=4826.7, ppl=3.43, accuracy=72.032, wps=11151.4, ups=0.83, wpb=13401.5, bsz=448.4, num_updates=28600, lr=8.36242e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=14.4, wall=26405
2023-08-29 18:22:14 | INFO | train_inner | epoch 025:    130 / 1191 loss=1.852, trans_loss=4.58, nll_loss=1.761, w2v_ctc_loss=0.557, task_loss=2.486, contrastive_loss=0.275, total=6590.97, n_correct=4764.86, ppl=3.39, accuracy=72.294, wps=18133.9, ups=1.38, wpb=13181.9, bsz=437.3, num_updates=28700, lr=8.34784e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=26478
2023-08-29 18:23:26 | INFO | train_inner | epoch 025:    230 / 1191 loss=1.84, trans_loss=4.587, nll_loss=1.771, w2v_ctc_loss=0.549, task_loss=2.227, contrastive_loss=0.187, total=6796.21, n_correct=4913.23, ppl=3.41, accuracy=72.294, wps=18634.3, ups=1.37, wpb=13592.4, bsz=475, num_updates=28800, lr=8.33333e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=26551
2023-08-29 18:24:40 | INFO | train_inner | epoch 025:    330 / 1191 loss=1.854, trans_loss=4.587, nll_loss=1.771, w2v_ctc_loss=0.572, task_loss=2.478, contrastive_loss=0.204, total=6610.56, n_correct=4769.29, ppl=3.41, accuracy=72.147, wps=18089.8, ups=1.37, wpb=13221.1, bsz=431.2, num_updates=28900, lr=8.3189e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=26624
2023-08-29 18:25:52 | INFO | train_inner | epoch 025:    430 / 1191 loss=1.852, trans_loss=4.59, nll_loss=1.774, w2v_ctc_loss=0.565, task_loss=2.642, contrastive_loss=0.189, total=6559.76, n_correct=4729.25, ppl=3.42, accuracy=72.095, wps=18043.2, ups=1.38, wpb=13119.5, bsz=417.2, num_updates=29000, lr=8.30455e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=26696
2023-08-29 18:27:05 | INFO | train_inner | epoch 025:    530 / 1191 loss=1.848, trans_loss=4.589, nll_loss=1.774, w2v_ctc_loss=0.557, task_loss=2.134, contrastive_loss=0.21, total=6860.11, n_correct=4954.45, ppl=3.42, accuracy=72.221, wps=18800.7, ups=1.37, wpb=13720.2, bsz=485.7, num_updates=29100, lr=8.29027e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=26769
2023-08-29 18:28:18 | INFO | train_inner | epoch 025:    630 / 1191 loss=1.846, trans_loss=4.584, nll_loss=1.768, w2v_ctc_loss=0.558, task_loss=2.326, contrastive_loss=0.208, total=6752.55, n_correct=4879.77, ppl=3.4, accuracy=72.266, wps=18637.8, ups=1.38, wpb=13505.1, bsz=450.4, num_updates=29200, lr=8.27606e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=14.7, wall=26842
2023-08-29 18:29:31 | INFO | train_inner | epoch 025:    730 / 1191 loss=1.861, trans_loss=4.592, nll_loss=1.777, w2v_ctc_loss=0.565, task_loss=2.383, contrastive_loss=0.302, total=6689.05, n_correct=4817.77, ppl=3.43, accuracy=72.025, wps=18354.6, ups=1.37, wpb=13378.1, bsz=451.1, num_updates=29300, lr=8.26192e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=26915
2023-08-29 18:30:43 | INFO | train_inner | epoch 025:    830 / 1191 loss=1.853, trans_loss=4.593, nll_loss=1.779, w2v_ctc_loss=0.561, task_loss=2.284, contrastive_loss=0.223, total=6731.35, n_correct=4851.63, ppl=3.43, accuracy=72.075, wps=18544.1, ups=1.38, wpb=13462.7, bsz=460.3, num_updates=29400, lr=8.24786e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=26987
2023-08-29 18:31:56 | INFO | train_inner | epoch 025:    930 / 1191 loss=1.85, trans_loss=4.589, nll_loss=1.773, w2v_ctc_loss=0.561, task_loss=2.261, contrastive_loss=0.211, total=6765.8, n_correct=4881.93, ppl=3.42, accuracy=72.156, wps=18547.4, ups=1.37, wpb=13531.6, bsz=466.3, num_updates=29500, lr=8.23387e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=27060
2023-08-29 18:33:08 | INFO | train_inner | epoch 025:   1030 / 1191 loss=1.856, trans_loss=4.6, nll_loss=1.788, w2v_ctc_loss=0.562, task_loss=2.305, contrastive_loss=0.23, total=6676.04, n_correct=4800.17, ppl=3.45, accuracy=71.901, wps=18577.6, ups=1.39, wpb=13352.1, bsz=454.8, num_updates=29600, lr=8.21995e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=71, gb_free=13.3, wall=27132
2023-08-29 18:34:21 | INFO | train_inner | epoch 025:   1130 / 1191 loss=1.852, trans_loss=4.587, nll_loss=1.772, w2v_ctc_loss=0.567, task_loss=2.438, contrastive_loss=0.217, total=6684.13, n_correct=4823.05, ppl=3.41, accuracy=72.157, wps=18300.2, ups=1.37, wpb=13368.3, bsz=445.1, num_updates=29700, lr=8.2061e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=73, gb_free=11.9, wall=27205
2023-08-29 18:35:06 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 18:35:38 | INFO | dev_st | epoch 025 | valid on 'dev_st' subset | loss 3.799 | trans_loss 4.862 | nll_loss 2.083 | w2v_ctc_loss 1.275 | task_loss 8.615 | contrastive_loss 0.441 | total 6138.43 | n_correct 4373.43 | ppl 4.24 | accuracy 71.247 | uer 17.303 | wer 18.866 | raw_wer 18.866 | bleu 28.77 | wps 1715.1 | wpb 6138.4 | bsz 201.1 | num_updates 29761 | best_bleu 28.97
2023-08-29 18:35:38 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 25 @ 29761 updates
2023-08-29 18:35:38 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7709.pt
2023-08-29 18:35:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7709.pt
2023-08-29 18:35:46 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.7709.pt (epoch 25 @ 29761 updates, score 28.77) (writing took 7.551051784001174 seconds)
2023-08-29 18:35:46 | INFO | fairseq_cli.train | end of epoch 25 (average epoch stats below)
2023-08-29 18:35:46 | INFO | train | epoch 025 | loss 1.852 | trans_loss 4.589 | nll_loss 1.774 | w2v_ctc_loss 0.561 | task_loss 2.354 | contrastive_loss 0.227 | total 6703.69 | n_correct 4835.84 | ppl 3.42 | accuracy 72.137 | wps 17446.5 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 29761 | lr 8.19769e-05 | gnorm 0.422 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 11.5 | wall 27291
2023-08-29 18:35:47 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 18:35:47 | INFO | fairseq.trainer | begin training epoch 26
2023-08-29 18:35:47 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 18:36:22 | INFO | train_inner | epoch 026:     39 / 1191 loss=1.857, trans_loss=4.593, nll_loss=1.779, w2v_ctc_loss=0.561, task_loss=2.256, contrastive_loss=0.26, total=6812.72, n_correct=4910.42, ppl=3.43, accuracy=72.077, wps=11237.9, ups=0.82, wpb=13625.4, bsz=462.2, num_updates=29800, lr=8.19232e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=27326
2023-08-29 18:37:36 | INFO | train_inner | epoch 026:    139 / 1191 loss=1.836, trans_loss=4.575, nll_loss=1.756, w2v_ctc_loss=0.546, task_loss=2.36, contrastive_loss=0.204, total=6718.44, n_correct=4874.84, ppl=3.38, accuracy=72.559, wps=18282.2, ups=1.36, wpb=13436.9, bsz=456.6, num_updates=29900, lr=8.17861e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=73, gb_free=13.8, wall=27400
2023-08-29 18:38:48 | INFO | train_inner | epoch 026:    239 / 1191 loss=1.842, trans_loss=4.575, nll_loss=1.755, w2v_ctc_loss=0.553, task_loss=2.342, contrastive_loss=0.23, total=6678.33, n_correct=4841.02, ppl=3.38, accuracy=72.488, wps=18496.4, ups=1.38, wpb=13356.7, bsz=451.1, num_updates=30000, lr=8.16497e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=71, gb_free=11.7, wall=27472
2023-08-29 18:38:48 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 18:39:20 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.779 | trans_loss 4.866 | nll_loss 2.085 | w2v_ctc_loss 1.206 | task_loss 8.574 | contrastive_loss 0.431 | total 6138.43 | n_correct 4377.29 | ppl 4.24 | accuracy 71.31 | uer 16.939 | wer 18.561 | raw_wer 18.561 | bleu 28.72 | wps 1754.5 | wpb 6138.4 | bsz 201.1 | num_updates 30000 | best_bleu 28.97
2023-08-29 18:39:20 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30000 updates
2023-08-29 18:39:20 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-29 18:39:23 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt
2023-08-29 18:39:28 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_26_30000.pt (epoch 26 @ 30000 updates, score 28.72) (writing took 7.439530037998338 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 18:40:41 | INFO | train_inner | epoch 026:    339 / 1191 loss=1.845, trans_loss=4.58, nll_loss=1.763, w2v_ctc_loss=0.548, task_loss=2.056, contrastive_loss=0.276, total=6888.24, n_correct=4987.74, ppl=3.39, accuracy=72.409, wps=12167, ups=0.88, wpb=13776.5, bsz=498.1, num_updates=30100, lr=8.15139e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=27585
2023-08-29 18:41:54 | INFO | train_inner | epoch 026:    439 / 1191 loss=1.849, trans_loss=4.579, nll_loss=1.76, w2v_ctc_loss=0.561, task_loss=2.535, contrastive_loss=0.227, total=6569.92, n_correct=4750.68, ppl=3.39, accuracy=72.31, wps=18050.5, ups=1.37, wpb=13139.8, bsz=423, num_updates=30200, lr=8.13788e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=10.6, wall=27658
2023-08-29 18:43:08 | INFO | train_inner | epoch 026:    539 / 1191 loss=1.847, trans_loss=4.579, nll_loss=1.761, w2v_ctc_loss=0.554, task_loss=2.379, contrastive_loss=0.243, total=6684.51, n_correct=4835.58, ppl=3.39, accuracy=72.34, wps=18191.1, ups=1.36, wpb=13369, bsz=453.1, num_updates=30300, lr=8.12444e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=73, gb_free=14.5, wall=27732
2023-08-29 18:44:20 | INFO | train_inner | epoch 026:    639 / 1191 loss=1.852, trans_loss=4.583, nll_loss=1.765, w2v_ctc_loss=0.561, task_loss=2.541, contrastive_loss=0.234, total=6606.67, n_correct=4773.28, ppl=3.4, accuracy=72.249, wps=18241, ups=1.38, wpb=13213.3, bsz=426.7, num_updates=30400, lr=8.11107e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=27804
2023-08-29 18:45:33 | INFO | train_inner | epoch 026:    739 / 1191 loss=1.846, trans_loss=4.584, nll_loss=1.768, w2v_ctc_loss=0.557, task_loss=2.372, contrastive_loss=0.189, total=6778.79, n_correct=4898.57, ppl=3.4, accuracy=72.263, wps=18577.6, ups=1.37, wpb=13557.6, bsz=446.5, num_updates=30500, lr=8.09776e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=27877
2023-08-29 18:46:28 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 18:46:46 | INFO | train_inner | epoch 026:    840 / 1191 loss=1.845, trans_loss=4.578, nll_loss=1.76, w2v_ctc_loss=0.554, task_loss=2.333, contrastive_loss=0.236, total=6666.28, n_correct=4824.37, ppl=3.39, accuracy=72.37, wps=18163.5, ups=1.36, wpb=13332.6, bsz=452.6, num_updates=30600, lr=8.08452e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=73, gb_free=13.9, wall=27951
2023-08-29 18:47:59 | INFO | train_inner | epoch 026:    940 / 1191 loss=1.853, trans_loss=4.587, nll_loss=1.771, w2v_ctc_loss=0.561, task_loss=2.36, contrastive_loss=0.253, total=6698.83, n_correct=4836.14, ppl=3.41, accuracy=72.194, wps=18561.8, ups=1.39, wpb=13397.7, bsz=452.2, num_updates=30700, lr=8.07134e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=71, gb_free=14.2, wall=28023
2023-08-29 18:49:11 | INFO | train_inner | epoch 026:   1040 / 1191 loss=1.851, trans_loss=4.588, nll_loss=1.772, w2v_ctc_loss=0.567, task_loss=2.415, contrastive_loss=0.189, total=6684.83, n_correct=4816.96, ppl=3.42, accuracy=72.058, wps=18386.8, ups=1.38, wpb=13369.7, bsz=443.7, num_updates=30800, lr=8.05823e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=11.1, wall=28095
2023-08-29 18:50:25 | INFO | train_inner | epoch 026:   1140 / 1191 loss=1.845, trans_loss=4.586, nll_loss=1.77, w2v_ctc_loss=0.554, task_loss=2.233, contrastive_loss=0.219, total=6799.05, n_correct=4916.02, ppl=3.41, accuracy=72.305, wps=18525.5, ups=1.36, wpb=13598.1, bsz=477.3, num_updates=30900, lr=8.04518e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=73, gb_free=13.9, wall=28169
2023-08-29 18:51:02 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
2023-08-29 18:51:34 | INFO | dev_st | epoch 026 | valid on 'dev_st' subset | loss 3.762 | trans_loss 4.859 | nll_loss 2.077 | w2v_ctc_loss 1.167 | task_loss 8.636 | contrastive_loss 0.429 | total 6138.43 | n_correct 4378.14 | ppl 4.22 | accuracy 71.324 | uer 16.591 | wer 18.293 | raw_wer 18.293 | bleu 28.56 | wps 1760.7 | wpb 6138.4 | bsz 201.1 | num_updates 30951 | best_bleu 28.97
2023-08-29 18:51:34 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 26 @ 30951 updates
2023-08-29 18:51:34 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 18:51:41 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 18:51:41 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 26 @ 30951 updates, score 28.56) (writing took 6.536960414989153 seconds)
2023-08-29 18:51:41 | INFO | fairseq_cli.train | end of epoch 26 (average epoch stats below)
2023-08-29 18:51:41 | INFO | train | epoch 026 | loss 1.847 | trans_loss 4.582 | nll_loss 1.765 | w2v_ctc_loss 0.556 | task_loss 2.355 | contrastive_loss 0.225 | total 6703.41 | n_correct 4847.48 | ppl 3.4 | accuracy 72.314 | wps 16715.1 | ups 1.25 | wpb 13406.8 | bsz 452 | num_updates 30951 | lr 8.03855e-05 | gnorm 0.42 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 12.4 | wall 28245
2023-08-29 18:51:41 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 18:51:41 | INFO | fairseq.trainer | begin training epoch 27
2023-08-29 18:51:41 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 18:52:25 | INFO | train_inner | epoch 027:     49 / 1191 loss=1.841, trans_loss=4.58, nll_loss=1.763, w2v_ctc_loss=0.555, task_loss=2.421, contrastive_loss=0.18, total=6623.22, n_correct=4793.77, ppl=3.39, accuracy=72.378, wps=11053.5, ups=0.83, wpb=13246.4, bsz=438.8, num_updates=31000, lr=8.03219e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=9.8, wall=28289
2023-08-29 18:53:38 | INFO | train_inner | epoch 027:    149 / 1191 loss=1.844, trans_loss=4.571, nll_loss=1.75, w2v_ctc_loss=0.549, task_loss=2.326, contrastive_loss=0.274, total=6716.13, n_correct=4871.55, ppl=3.36, accuracy=72.535, wps=18330.8, ups=1.36, wpb=13432.3, bsz=463.1, num_updates=31100, lr=8.01927e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=73, gb_free=14.3, wall=28362
2023-08-29 18:54:50 | INFO | train_inner | epoch 027:    249 / 1191 loss=1.834, trans_loss=4.569, nll_loss=1.748, w2v_ctc_loss=0.541, task_loss=2.153, contrastive_loss=0.24, total=6828.06, n_correct=4958.13, ppl=3.36, accuracy=72.614, wps=18828.9, ups=1.38, wpb=13656.1, bsz=483.7, num_updates=31200, lr=8.00641e-05, gnorm=0.413, clip=0, loss_scale=16, train_wall=72, gb_free=11.9, wall=28435
2023-08-29 18:56:03 | INFO | train_inner | epoch 027:    349 / 1191 loss=1.832, trans_loss=4.567, nll_loss=1.746, w2v_ctc_loss=0.542, task_loss=2.237, contrastive_loss=0.21, total=6735.45, n_correct=4895.15, ppl=3.35, accuracy=72.677, wps=18584.1, ups=1.38, wpb=13470.9, bsz=468.3, num_updates=31300, lr=7.99361e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=28507
2023-08-29 18:57:16 | INFO | train_inner | epoch 027:    449 / 1191 loss=1.846, trans_loss=4.58, nll_loss=1.762, w2v_ctc_loss=0.557, task_loss=2.508, contrastive_loss=0.221, total=6615.51, n_correct=4790.23, ppl=3.39, accuracy=72.409, wps=18085.1, ups=1.37, wpb=13231, bsz=437.7, num_updates=31400, lr=7.98087e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=73, gb_free=14.3, wall=28580
2023-08-29 18:58:29 | INFO | train_inner | epoch 027:    549 / 1191 loss=1.836, trans_loss=4.57, nll_loss=1.75, w2v_ctc_loss=0.551, task_loss=2.26, contrastive_loss=0.197, total=6772.35, n_correct=4914.26, ppl=3.36, accuracy=72.564, wps=18511.2, ups=1.37, wpb=13544.7, bsz=464.2, num_updates=31500, lr=7.96819e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=72, gb_free=14.2, wall=28653
2023-08-29 18:59:42 | INFO | train_inner | epoch 027:    649 / 1191 loss=1.846, trans_loss=4.575, nll_loss=1.756, w2v_ctc_loss=0.551, task_loss=2.404, contrastive_loss=0.27, total=6684.99, n_correct=4843.01, ppl=3.38, accuracy=72.446, wps=18384.3, ups=1.38, wpb=13370, bsz=444.5, num_updates=31600, lr=7.95557e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=72, gb_free=10.3, wall=28726
2023-08-29 19:00:55 | INFO | train_inner | epoch 027:    749 / 1191 loss=1.843, trans_loss=4.577, nll_loss=1.758, w2v_ctc_loss=0.558, task_loss=2.445, contrastive_loss=0.199, total=6680.05, n_correct=4838.15, ppl=3.38, accuracy=72.427, wps=18362.9, ups=1.37, wpb=13360.1, bsz=443.5, num_updates=31700, lr=7.94301e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=28799
2023-08-29 19:02:07 | INFO | train_inner | epoch 027:    849 / 1191 loss=1.843, trans_loss=4.577, nll_loss=1.759, w2v_ctc_loss=0.558, task_loss=2.472, contrastive_loss=0.192, total=6647.72, n_correct=4811.67, ppl=3.38, accuracy=72.381, wps=18319.6, ups=1.38, wpb=13295.4, bsz=440.9, num_updates=31800, lr=7.93052e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=72, gb_free=12.5, wall=28871
2023-08-29 19:03:20 | INFO | train_inner | epoch 027:    949 / 1191 loss=1.849, trans_loss=4.584, nll_loss=1.767, w2v_ctc_loss=0.56, task_loss=2.557, contrastive_loss=0.207, total=6634.42, n_correct=4794.02, ppl=3.4, accuracy=72.26, wps=18129.7, ups=1.37, wpb=13268.8, bsz=422.9, num_updates=31900, lr=7.91808e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=73, gb_free=12.6, wall=28945
2023-08-29 19:04:33 | INFO | train_inner | epoch 027:   1049 / 1191 loss=1.85, trans_loss=4.585, nll_loss=1.769, w2v_ctc_loss=0.557, task_loss=2.37, contrastive_loss=0.259, total=6652.45, n_correct=4803.33, ppl=3.41, accuracy=72.204, wps=18287.6, ups=1.37, wpb=13304.9, bsz=450.6, num_updates=32000, lr=7.90569e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=72, gb_free=12.8, wall=29017
2023-08-29 19:04:33 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:05:06 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.763 | trans_loss 4.856 | nll_loss 2.073 | w2v_ctc_loss 1.174 | task_loss 8.636 | contrastive_loss 0.434 | total 6138.43 | n_correct 4384.29 | ppl 4.21 | accuracy 71.424 | uer 16.819 | wer 18.327 | raw_wer 18.327 | bleu 28.86 | wps 1761.6 | wpb 6138.4 | bsz 201.1 | num_updates 32000 | best_bleu 28.97
2023-08-29 19:05:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32000 updates
2023-08-29 19:05:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-29 19:05:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt
2023-08-29 19:05:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_27_32000.pt (epoch 27 @ 32000 updates, score 28.86) (writing took 8.921915546990931 seconds)
2023-08-29 19:06:27 | INFO | train_inner | epoch 027:   1149 / 1191 loss=1.842, trans_loss=4.577, nll_loss=1.759, w2v_ctc_loss=0.549, task_loss=2.298, contrastive_loss=0.226, total=6753.53, n_correct=4893.38, ppl=3.38, accuracy=72.457, wps=11835.3, ups=0.88, wpb=13507.1, bsz=452.5, num_updates=32100, lr=7.89337e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=10.6, wall=29131
2023-08-29 19:06:58 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:07:30 | INFO | dev_st | epoch 027 | valid on 'dev_st' subset | loss 3.763 | trans_loss 4.852 | nll_loss 2.067 | w2v_ctc_loss 1.194 | task_loss 8.635 | contrastive_loss 0.425 | total 6138.43 | n_correct 4380.86 | ppl 4.19 | accuracy 71.368 | uer 16.712 | wer 18.185 | raw_wer 18.185 | bleu 28.92 | wps 1758.6 | wpb 6138.4 | bsz 201.1 | num_updates 32142 | best_bleu 28.97
2023-08-29 19:07:30 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 27 @ 32142 updates
2023-08-29 19:07:30 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9201.pt
2023-08-29 19:07:32 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9201.pt
2023-08-29 19:07:38 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.9201.pt (epoch 27 @ 32142 updates, score 28.92) (writing took 8.121265692010638 seconds)
2023-08-29 19:07:39 | INFO | fairseq_cli.train | end of epoch 27 (average epoch stats below)
2023-08-29 19:07:39 | INFO | train | epoch 027 | loss 1.841 | trans_loss 4.575 | nll_loss 1.755 | w2v_ctc_loss 0.551 | task_loss 2.356 | contrastive_loss 0.222 | total 6703.69 | n_correct 4858.34 | ppl 3.38 | accuracy 72.473 | wps 16674.1 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 32142 | lr 7.88821e-05 | gnorm 0.42 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 13.3 | wall 29203
2023-08-29 19:07:39 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 19:07:39 | INFO | fairseq.trainer | begin training epoch 28
2023-08-29 19:07:39 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 19:08:29 | INFO | train_inner | epoch 028:     58 / 1191 loss=1.83, trans_loss=4.563, nll_loss=1.741, w2v_ctc_loss=0.54, task_loss=2.301, contrastive_loss=0.214, total=6702.18, n_correct=4873.78, ppl=3.34, accuracy=72.719, wps=11065, ups=0.83, wpb=13404.4, bsz=456.4, num_updates=32200, lr=7.8811e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=29253
2023-08-29 19:09:41 | INFO | train_inner | epoch 028:    158 / 1191 loss=1.833, trans_loss=4.565, nll_loss=1.743, w2v_ctc_loss=0.555, task_loss=2.465, contrastive_loss=0.164, total=6676.02, n_correct=4854.11, ppl=3.35, accuracy=72.71, wps=18396.1, ups=1.38, wpb=13352, bsz=432.6, num_updates=32300, lr=7.86889e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=72, gb_free=13.5, wall=29325
2023-08-29 19:10:54 | INFO | train_inner | epoch 028:    258 / 1191 loss=1.834, trans_loss=4.568, nll_loss=1.746, w2v_ctc_loss=0.544, task_loss=2.377, contrastive_loss=0.212, total=6680.3, n_correct=4854.33, ppl=3.35, accuracy=72.666, wps=18293.7, ups=1.37, wpb=13360.6, bsz=450.4, num_updates=32400, lr=7.85674e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=72, gb_free=10.2, wall=29398
2023-08-29 19:12:07 | INFO | train_inner | epoch 028:    358 / 1191 loss=1.83, trans_loss=4.563, nll_loss=1.741, w2v_ctc_loss=0.546, task_loss=2.318, contrastive_loss=0.183, total=6733.45, n_correct=4896.81, ppl=3.34, accuracy=72.724, wps=18507.7, ups=1.37, wpb=13466.9, bsz=460.2, num_updates=32500, lr=7.84465e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=72, gb_free=14, wall=29471
2023-08-29 19:13:20 | INFO | train_inner | epoch 028:    458 / 1191 loss=1.842, trans_loss=4.568, nll_loss=1.747, w2v_ctc_loss=0.544, task_loss=2.238, contrastive_loss=0.302, total=6786.13, n_correct=4931.15, ppl=3.36, accuracy=72.665, wps=18463.2, ups=1.36, wpb=13572.3, bsz=473.9, num_updates=32600, lr=7.8326e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=73, gb_free=14.1, wall=29545
2023-08-29 19:14:32 | INFO | train_inner | epoch 028:    558 / 1191 loss=1.824, trans_loss=4.564, nll_loss=1.741, w2v_ctc_loss=0.537, task_loss=2.321, contrastive_loss=0.167, total=6699.39, n_correct=4873.27, ppl=3.34, accuracy=72.742, wps=18664.3, ups=1.39, wpb=13398.8, bsz=453, num_updates=32700, lr=7.82062e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=71, gb_free=13.8, wall=29616
2023-08-29 19:15:44 | INFO | train_inner | epoch 028:    658 / 1191 loss=1.834, trans_loss=4.566, nll_loss=1.745, w2v_ctc_loss=0.542, task_loss=2.311, contrastive_loss=0.234, total=6757.2, n_correct=4912.58, ppl=3.35, accuracy=72.701, wps=18727.9, ups=1.39, wpb=13514.4, bsz=457.5, num_updates=32800, lr=7.80869e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=71, gb_free=13.4, wall=29688
2023-08-29 19:16:58 | INFO | train_inner | epoch 028:    758 / 1191 loss=1.835, trans_loss=4.568, nll_loss=1.747, w2v_ctc_loss=0.549, task_loss=2.363, contrastive_loss=0.2, total=6689.37, n_correct=4855.06, ppl=3.36, accuracy=72.579, wps=18208.3, ups=1.36, wpb=13378.7, bsz=453.8, num_updates=32900, lr=7.79681e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=73, gb_free=14, wall=29762
2023-08-29 19:18:10 | INFO | train_inner | epoch 028:    858 / 1191 loss=1.835, trans_loss=4.568, nll_loss=1.747, w2v_ctc_loss=0.548, task_loss=2.349, contrastive_loss=0.203, total=6644.99, n_correct=4826.51, ppl=3.36, accuracy=72.634, wps=18334.7, ups=1.38, wpb=13290, bsz=451.4, num_updates=33000, lr=7.78499e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=12.4, wall=29834
2023-08-29 19:19:23 | INFO | train_inner | epoch 028:    958 / 1191 loss=1.842, trans_loss=4.573, nll_loss=1.753, w2v_ctc_loss=0.552, task_loss=2.461, contrastive_loss=0.236, total=6647.77, n_correct=4820.19, ppl=3.37, accuracy=72.508, wps=18269.2, ups=1.37, wpb=13295.5, bsz=438, num_updates=33100, lr=7.77322e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=29907
2023-08-29 19:20:36 | INFO | train_inner | epoch 028:   1058 / 1191 loss=1.846, trans_loss=4.574, nll_loss=1.755, w2v_ctc_loss=0.544, task_loss=2.455, contrastive_loss=0.296, total=6683.12, n_correct=4841.29, ppl=3.38, accuracy=72.441, wps=18261, ups=1.37, wpb=13366.2, bsz=439.6, num_updates=33200, lr=7.76151e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=73, gb_free=13.7, wall=29980
2023-08-29 19:21:50 | INFO | train_inner | epoch 028:   1158 / 1191 loss=1.835, trans_loss=4.569, nll_loss=1.748, w2v_ctc_loss=0.545, task_loss=2.427, contrastive_loss=0.207, total=6679.78, n_correct=4849.77, ppl=3.36, accuracy=72.604, wps=18221.7, ups=1.36, wpb=13359.6, bsz=445.2, num_updates=33300, lr=7.74984e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=73, gb_free=13.9, wall=30054
2023-08-29 19:22:13 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:22:46 | INFO | dev_st | epoch 028 | valid on 'dev_st' subset | loss 3.771 | trans_loss 4.858 | nll_loss 2.074 | w2v_ctc_loss 1.204 | task_loss 8.553 | contrastive_loss 0.426 | total 6138.43 | n_correct 4386 | ppl 4.21 | accuracy 71.452 | uer 16.819 | wer 18.438 | raw_wer 18.438 | bleu 29.13 | wps 1759.2 | wpb 6138.4 | bsz 201.1 | num_updates 33333 | best_bleu 29.13
2023-08-29 19:22:46 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 28 @ 33333 updates
2023-08-29 19:22:46 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 19:22:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 19:22:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 28 @ 33333 updates, score 29.13) (writing took 13.383888228010619 seconds)
2023-08-29 19:23:00 | INFO | fairseq_cli.train | end of epoch 28 (average epoch stats below)
2023-08-29 19:23:00 | INFO | train | epoch 028 | loss 1.835 | trans_loss 4.567 | nll_loss 1.746 | w2v_ctc_loss 0.546 | task_loss 2.355 | contrastive_loss 0.221 | total 6703.69 | n_correct 4869.84 | ppl 3.35 | accuracy 72.644 | wps 17335.5 | ups 1.29 | wpb 13407.4 | bsz 452.1 | num_updates 33333 | lr 7.74601e-05 | gnorm 0.421 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.2 | wall 30124
2023-08-29 19:23:00 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 19:23:00 | INFO | fairseq.trainer | begin training epoch 29
2023-08-29 19:23:00 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 19:23:57 | INFO | train_inner | epoch 029:     67 / 1191 loss=1.824, trans_loss=4.552, nll_loss=1.726, w2v_ctc_loss=0.535, task_loss=2.154, contrastive_loss=0.217, total=6806.79, n_correct=4971.14, ppl=3.31, accuracy=73.032, wps=10712.1, ups=0.79, wpb=13613.6, bsz=476.8, num_updates=33400, lr=7.73823e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=30181
2023-08-29 19:25:10 | INFO | train_inner | epoch 029:    167 / 1191 loss=1.822, trans_loss=4.555, nll_loss=1.73, w2v_ctc_loss=0.535, task_loss=2.412, contrastive_loss=0.17, total=6676.33, n_correct=4867.11, ppl=3.32, accuracy=72.901, wps=18326.2, ups=1.37, wpb=13352.7, bsz=438, num_updates=33500, lr=7.72667e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=11.8, wall=30254
2023-08-29 19:26:22 | INFO | train_inner | epoch 029:    267 / 1191 loss=1.839, trans_loss=4.562, nll_loss=1.739, w2v_ctc_loss=0.535, task_loss=2.357, contrastive_loss=0.308, total=6670.27, n_correct=4853.4, ppl=3.34, accuracy=72.762, wps=18374.2, ups=1.38, wpb=13340.5, bsz=453.4, num_updates=33600, lr=7.71517e-05, gnorm=0.428, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=30326
2023-08-29 19:27:35 | INFO | train_inner | epoch 029:    367 / 1191 loss=1.825, trans_loss=4.56, nll_loss=1.736, w2v_ctc_loss=0.541, task_loss=2.366, contrastive_loss=0.172, total=6747.17, n_correct=4916.15, ppl=3.33, accuracy=72.862, wps=18428.1, ups=1.37, wpb=13494.3, bsz=452, num_updates=33700, lr=7.70371e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=30400
2023-08-29 19:28:23 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 19:28:49 | INFO | train_inner | epoch 029:    468 / 1191 loss=1.829, trans_loss=4.561, nll_loss=1.738, w2v_ctc_loss=0.537, task_loss=2.278, contrastive_loss=0.226, total=6771.73, n_correct=4933.09, ppl=3.34, accuracy=72.848, wps=18394.1, ups=1.36, wpb=13543.5, bsz=465.3, num_updates=33800, lr=7.69231e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=73, gb_free=14.5, wall=30473
2023-08-29 19:30:02 | INFO | train_inner | epoch 029:    568 / 1191 loss=1.84, trans_loss=4.568, nll_loss=1.746, w2v_ctc_loss=0.558, task_loss=2.577, contrastive_loss=0.206, total=6588.51, n_correct=4778.9, ppl=3.35, accuracy=72.534, wps=18072.5, ups=1.37, wpb=13177, bsz=423.7, num_updates=33900, lr=7.68095e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=13.8, wall=30546
2023-08-29 19:31:14 | INFO | train_inner | epoch 029:    668 / 1191 loss=1.826, trans_loss=4.554, nll_loss=1.729, w2v_ctc_loss=0.539, task_loss=2.237, contrastive_loss=0.205, total=6747.88, n_correct=4920.12, ppl=3.31, accuracy=72.914, wps=18690.6, ups=1.38, wpb=13495.8, bsz=466.6, num_updates=34000, lr=7.66965e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=71, gb_free=13.5, wall=30618
2023-08-29 19:31:14 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:31:47 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.859 | nll_loss 2.077 | w2v_ctc_loss 1.198 | task_loss 8.583 | contrastive_loss 0.427 | total 6138.43 | n_correct 4378.86 | ppl 4.22 | accuracy 71.335 | uer 16.936 | wer 18.438 | raw_wer 18.438 | bleu 29.02 | wps 1758.8 | wpb 6138.4 | bsz 201.1 | num_updates 34000 | best_bleu 29.13
2023-08-29 19:31:47 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34000 updates
2023-08-29 19:31:47 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-29 19:31:49 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt
2023-08-29 19:31:56 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_29_34000.pt (epoch 29 @ 34000 updates, score 29.02) (writing took 9.596706096999696 seconds)
2023-08-29 19:33:09 | INFO | train_inner | epoch 029:    768 / 1191 loss=1.826, trans_loss=4.558, nll_loss=1.733, w2v_ctc_loss=0.538, task_loss=2.366, contrastive_loss=0.199, total=6665.46, n_correct=4857.56, ppl=3.33, accuracy=72.877, wps=11601.5, ups=0.87, wpb=13330.9, bsz=450.3, num_updates=34100, lr=7.6584e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=72, gb_free=12.4, wall=30733
2023-08-29 19:34:22 | INFO | train_inner | epoch 029:    868 / 1191 loss=1.833, trans_loss=4.568, nll_loss=1.746, w2v_ctc_loss=0.549, task_loss=2.455, contrastive_loss=0.175, total=6653.55, n_correct=4830.31, ppl=3.36, accuracy=72.597, wps=18278.6, ups=1.37, wpb=13307.1, bsz=434.6, num_updates=34200, lr=7.64719e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=30806
2023-08-29 19:35:35 | INFO | train_inner | epoch 029:    968 / 1191 loss=1.84, trans_loss=4.562, nll_loss=1.74, w2v_ctc_loss=0.543, task_loss=2.339, contrastive_loss=0.294, total=6724.42, n_correct=4887.69, ppl=3.34, accuracy=72.686, wps=18326.2, ups=1.36, wpb=13448.8, bsz=460.8, num_updates=34300, lr=7.63604e-05, gnorm=0.422, clip=0, loss_scale=16, train_wall=73, gb_free=13, wall=30879
2023-08-29 19:36:48 | INFO | train_inner | epoch 029:   1068 / 1191 loss=1.832, trans_loss=4.561, nll_loss=1.738, w2v_ctc_loss=0.539, task_loss=2.328, contrastive_loss=0.241, total=6722.03, n_correct=4895.05, ppl=3.34, accuracy=72.821, wps=18469.8, ups=1.37, wpb=13444.1, bsz=457.9, num_updates=34400, lr=7.62493e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=30952
2023-08-29 19:38:01 | INFO | train_inner | epoch 029:   1168 / 1191 loss=1.83, trans_loss=4.565, nll_loss=1.743, w2v_ctc_loss=0.539, task_loss=2.276, contrastive_loss=0.214, total=6758.08, n_correct=4918.18, ppl=3.35, accuracy=72.775, wps=18487, ups=1.37, wpb=13516.2, bsz=463.1, num_updates=34500, lr=7.61387e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=9.9, wall=31025
2023-08-29 19:38:18 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:38:50 | INFO | dev_st | epoch 029 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.858 | nll_loss 2.077 | w2v_ctc_loss 1.195 | task_loss 8.627 | contrastive_loss 0.435 | total 6138.43 | n_correct 4384.29 | ppl 4.22 | accuracy 71.424 | uer 16.944 | wer 18.538 | raw_wer 18.538 | bleu 29.08 | wps 1759.8 | wpb 6138.4 | bsz 201.1 | num_updates 34523 | best_bleu 29.13
2023-08-29 19:38:50 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 29 @ 34523 updates
2023-08-29 19:38:50 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0802.pt
2023-08-29 19:38:53 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0802.pt
2023-08-29 19:38:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0802.pt (epoch 29 @ 34523 updates, score 29.08) (writing took 8.335520362001262 seconds)
2023-08-29 19:38:59 | INFO | fairseq_cli.train | end of epoch 29 (average epoch stats below)
2023-08-29 19:38:59 | INFO | train | epoch 029 | loss 1.83 | trans_loss 4.56 | nll_loss 1.737 | w2v_ctc_loss 0.541 | task_loss 2.355 | contrastive_loss 0.218 | total 6703.55 | n_correct 4880.23 | ppl 3.33 | accuracy 72.801 | wps 16633.3 | ups 1.24 | wpb 13407.1 | bsz 452.2 | num_updates 34523 | lr 7.61133e-05 | gnorm 0.42 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 13.5 | wall 31083
2023-08-29 19:38:59 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 19:38:59 | INFO | fairseq.trainer | begin training epoch 30
2023-08-29 19:38:59 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 19:40:02 | INFO | train_inner | epoch 030:     77 / 1191 loss=1.82, trans_loss=4.552, nll_loss=1.726, w2v_ctc_loss=0.531, task_loss=2.122, contrastive_loss=0.211, total=6834.34, n_correct=4994.34, ppl=3.31, accuracy=73.077, wps=11325.2, ups=0.83, wpb=13668.7, bsz=482.5, num_updates=34600, lr=7.60286e-05, gnorm=0.412, clip=0, loss_scale=16, train_wall=71, gb_free=13.9, wall=31146
2023-08-29 19:41:14 | INFO | train_inner | epoch 030:    177 / 1191 loss=1.821, trans_loss=4.55, nll_loss=1.724, w2v_ctc_loss=0.531, task_loss=2.343, contrastive_loss=0.208, total=6675.83, n_correct=4877.73, ppl=3.3, accuracy=73.066, wps=18621.2, ups=1.39, wpb=13351.7, bsz=447.1, num_updates=34700, lr=7.5919e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=71, gb_free=13.6, wall=31218
2023-08-29 19:42:26 | INFO | train_inner | epoch 030:    277 / 1191 loss=1.82, trans_loss=4.545, nll_loss=1.718, w2v_ctc_loss=0.531, task_loss=2.27, contrastive_loss=0.213, total=6761.75, n_correct=4943.57, ppl=3.29, accuracy=73.111, wps=18586.9, ups=1.37, wpb=13523.5, bsz=461.1, num_updates=34800, lr=7.58098e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=31290
2023-08-29 19:43:40 | INFO | train_inner | epoch 030:    377 / 1191 loss=1.818, trans_loss=4.551, nll_loss=1.725, w2v_ctc_loss=0.527, task_loss=2.14, contrastive_loss=0.214, total=6854.16, n_correct=5009.83, ppl=3.31, accuracy=73.092, wps=18554, ups=1.35, wpb=13708.3, bsz=487.8, num_updates=34900, lr=7.57011e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=73, gb_free=14, wall=31364
2023-08-29 19:44:53 | INFO | train_inner | epoch 030:    477 / 1191 loss=1.825, trans_loss=4.553, nll_loss=1.728, w2v_ctc_loss=0.54, task_loss=2.457, contrastive_loss=0.205, total=6643.16, n_correct=4845.86, ppl=3.31, accuracy=72.945, wps=18264.6, ups=1.37, wpb=13286.3, bsz=443.7, num_updates=35000, lr=7.55929e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=31437
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 19:46:06 | INFO | train_inner | epoch 030:    577 / 1191 loss=1.827, trans_loss=4.555, nll_loss=1.729, w2v_ctc_loss=0.535, task_loss=2.421, contrastive_loss=0.224, total=6672.12, n_correct=4861.19, ppl=3.32, accuracy=72.858, wps=18367.9, ups=1.38, wpb=13344.2, bsz=443.1, num_updates=35100, lr=7.54851e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=12.6, wall=31510
2023-08-29 19:47:18 | INFO | train_inner | epoch 030:    677 / 1191 loss=1.829, trans_loss=4.554, nll_loss=1.729, w2v_ctc_loss=0.546, task_loss=2.57, contrastive_loss=0.188, total=6569.5, n_correct=4783.39, ppl=3.31, accuracy=72.812, wps=18176.9, ups=1.38, wpb=13139, bsz=422.2, num_updates=35200, lr=7.53778e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=12.5, wall=31582
2023-08-29 19:48:32 | INFO | train_inner | epoch 030:    777 / 1191 loss=1.837, trans_loss=4.555, nll_loss=1.73, w2v_ctc_loss=0.542, task_loss=2.479, contrastive_loss=0.285, total=6649.43, n_correct=4844.88, ppl=3.32, accuracy=72.862, wps=18068.4, ups=1.36, wpb=13298.9, bsz=438, num_updates=35300, lr=7.5271e-05, gnorm=0.435, clip=0, loss_scale=16, train_wall=73, gb_free=13.7, wall=31656
2023-08-29 19:49:45 | INFO | train_inner | epoch 030:    877 / 1191 loss=1.824, trans_loss=4.556, nll_loss=1.732, w2v_ctc_loss=0.532, task_loss=2.403, contrastive_loss=0.215, total=6691.44, n_correct=4879.66, ppl=3.32, accuracy=72.924, wps=18303.8, ups=1.37, wpb=13382.9, bsz=447.9, num_updates=35400, lr=7.51646e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=72, gb_free=13.6, wall=31729
2023-08-29 19:50:58 | INFO | train_inner | epoch 030:    977 / 1191 loss=1.831, trans_loss=4.558, nll_loss=1.734, w2v_ctc_loss=0.544, task_loss=2.456, contrastive_loss=0.222, total=6640.53, n_correct=4833.36, ppl=3.33, accuracy=72.786, wps=18142.9, ups=1.37, wpb=13281.1, bsz=444.6, num_updates=35500, lr=7.50587e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=72, gb_free=13.2, wall=31802
2023-08-29 19:52:11 | INFO | train_inner | epoch 030:   1077 / 1191 loss=1.824, trans_loss=4.557, nll_loss=1.733, w2v_ctc_loss=0.539, task_loss=2.308, contrastive_loss=0.175, total=6764.46, n_correct=4932.31, ppl=3.32, accuracy=72.915, wps=18467.2, ups=1.37, wpb=13528.9, bsz=456.1, num_updates=35600, lr=7.49532e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=72, gb_free=14.5, wall=31875
2023-08-29 19:53:24 | INFO | train_inner | epoch 030:   1177 / 1191 loss=1.831, trans_loss=4.566, nll_loss=1.745, w2v_ctc_loss=0.536, task_loss=2.333, contrastive_loss=0.234, total=6687.11, n_correct=4862.09, ppl=3.35, accuracy=72.708, wps=18338.1, ups=1.37, wpb=13374.2, bsz=453.8, num_updates=35700, lr=7.48481e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=10.3, wall=31948
2023-08-29 19:53:34 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
2023-08-29 19:54:07 | INFO | dev_st | epoch 030 | valid on 'dev_st' subset | loss 3.766 | trans_loss 4.855 | nll_loss 2.071 | w2v_ctc_loss 1.194 | task_loss 8.649 | contrastive_loss 0.428 | total 6138.43 | n_correct 4387.43 | ppl 4.2 | accuracy 71.475 | uer 16.744 | wer 18.468 | raw_wer 18.468 | bleu 28.79 | wps 1752.3 | wpb 6138.4 | bsz 201.1 | num_updates 35714 | best_bleu 29.13
2023-08-29 19:54:07 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 30 @ 35714 updates
2023-08-29 19:54:07 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 19:54:14 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 19:54:15 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 30 @ 35714 updates, score 28.79) (writing took 7.977529301002505 seconds)
2023-08-29 19:54:15 | INFO | fairseq_cli.train | end of epoch 30 (average epoch stats below)
2023-08-29 19:54:15 | INFO | train | epoch 030 | loss 1.826 | trans_loss 4.554 | nll_loss 1.729 | w2v_ctc_loss 0.536 | task_loss 2.354 | contrastive_loss 0.216 | total 6703.69 | n_correct 4889.12 | ppl 3.32 | accuracy 72.932 | wps 17440.6 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 35714 | lr 7.48334e-05 | gnorm 0.42 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 14.2 | wall 31999
2023-08-29 19:54:15 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 19:54:15 | INFO | fairseq.trainer | begin training epoch 31
2023-08-29 19:54:15 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 19:55:25 | INFO | train_inner | epoch 031:     86 / 1191 loss=1.823, trans_loss=4.547, nll_loss=1.72, w2v_ctc_loss=0.539, task_loss=2.58, contrastive_loss=0.188, total=6599.42, n_correct=4822.61, ppl=3.29, accuracy=73.076, wps=10916.2, ups=0.83, wpb=13198.8, bsz=419.2, num_updates=35800, lr=7.47435e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=11.2, wall=32069
2023-08-29 19:56:38 | INFO | train_inner | epoch 031:    186 / 1191 loss=1.815, trans_loss=4.545, nll_loss=1.717, w2v_ctc_loss=0.525, task_loss=2.308, contrastive_loss=0.188, total=6732.09, n_correct=4925.37, ppl=3.29, accuracy=73.163, wps=18337.9, ups=1.36, wpb=13464.2, bsz=458.4, num_updates=35900, lr=7.46393e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=12.1, wall=32143
2023-08-29 19:57:40 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 19:57:52 | INFO | train_inner | epoch 031:    287 / 1191 loss=1.825, trans_loss=4.546, nll_loss=1.718, w2v_ctc_loss=0.536, task_loss=2.54, contrastive_loss=0.225, total=6562.33, n_correct=4797.14, ppl=3.29, accuracy=73.101, wps=17928.9, ups=1.37, wpb=13124.7, bsz=432.2, num_updates=36000, lr=7.45356e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=32216
2023-08-29 19:57:52 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 19:58:25 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.761 | trans_loss 4.851 | nll_loss 2.066 | w2v_ctc_loss 1.184 | task_loss 8.58 | contrastive_loss 0.432 | total 6138.43 | n_correct 4386.86 | ppl 4.19 | accuracy 71.465 | uer 16.714 | wer 18.412 | raw_wer 18.412 | bleu 28.76 | wps 1726.1 | wpb 6138.4 | bsz 201.1 | num_updates 36000 | best_bleu 29.13
2023-08-29 19:58:25 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36000 updates
2023-08-29 19:58:25 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-29 19:58:27 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt
2023-08-29 19:58:31 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_31_36000.pt (epoch 31 @ 36000 updates, score 28.76) (writing took 6.564296109994757 seconds)
2023-08-29 19:59:44 | INFO | train_inner | epoch 031:    387 / 1191 loss=1.815, trans_loss=4.548, nll_loss=1.721, w2v_ctc_loss=0.531, task_loss=2.331, contrastive_loss=0.166, total=6748.95, n_correct=4933.27, ppl=3.3, accuracy=73.097, wps=12056, ups=0.89, wpb=13497.9, bsz=458.1, num_updates=36100, lr=7.44323e-05, gnorm=0.415, clip=0, loss_scale=16, train_wall=72, gb_free=14.5, wall=32328
2023-08-29 20:00:56 | INFO | train_inner | epoch 031:    487 / 1191 loss=1.824, trans_loss=4.556, nll_loss=1.731, w2v_ctc_loss=0.534, task_loss=2.564, contrastive_loss=0.187, total=6661.78, n_correct=4855.43, ppl=3.32, accuracy=72.885, wps=18328.5, ups=1.38, wpb=13323.6, bsz=426.6, num_updates=36200, lr=7.43294e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=13.4, wall=32400
2023-08-29 20:02:09 | INFO | train_inner | epoch 031:    587 / 1191 loss=1.821, trans_loss=4.545, nll_loss=1.718, w2v_ctc_loss=0.526, task_loss=2.344, contrastive_loss=0.247, total=6681.68, n_correct=4886.42, ppl=3.29, accuracy=73.132, wps=18389.5, ups=1.38, wpb=13363.4, bsz=451.8, num_updates=36300, lr=7.4227e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=72, gb_free=12, wall=32473
2023-08-29 20:03:22 | INFO | train_inner | epoch 031:    687 / 1191 loss=1.821, trans_loss=4.545, nll_loss=1.717, w2v_ctc_loss=0.53, task_loss=2.16, contrastive_loss=0.24, total=6839.98, n_correct=5002.18, ppl=3.29, accuracy=73.132, wps=18761.6, ups=1.37, wpb=13680, bsz=478.1, num_updates=36400, lr=7.41249e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=32546
2023-08-29 20:04:35 | INFO | train_inner | epoch 031:    787 / 1191 loss=1.821, trans_loss=4.549, nll_loss=1.723, w2v_ctc_loss=0.532, task_loss=2.21, contrastive_loss=0.22, total=6796.23, n_correct=4966.85, ppl=3.3, accuracy=73.082, wps=18494.5, ups=1.36, wpb=13592.5, bsz=476.2, num_updates=36500, lr=7.40233e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=73, gb_free=12.5, wall=32620
2023-08-29 20:05:48 | INFO | train_inner | epoch 031:    887 / 1191 loss=1.826, trans_loss=4.554, nll_loss=1.729, w2v_ctc_loss=0.532, task_loss=2.423, contrastive_loss=0.246, total=6613.41, n_correct=4827.15, ppl=3.31, accuracy=72.99, wps=18112.4, ups=1.37, wpb=13226.8, bsz=445.6, num_updates=36600, lr=7.39221e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=13.9, wall=32693
2023-08-29 20:07:01 | INFO | train_inner | epoch 031:    987 / 1191 loss=1.825, trans_loss=4.548, nll_loss=1.722, w2v_ctc_loss=0.537, task_loss=2.333, contrastive_loss=0.229, total=6712.51, n_correct=4903.01, ppl=3.3, accuracy=73.043, wps=18531.4, ups=1.38, wpb=13425, bsz=455.1, num_updates=36700, lr=7.38213e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=14.3, wall=32765
2023-08-29 20:08:13 | INFO | train_inner | epoch 031:   1087 / 1191 loss=1.815, trans_loss=4.547, nll_loss=1.721, w2v_ctc_loss=0.524, task_loss=2.077, contrastive_loss=0.21, total=6884.21, n_correct=5034.47, ppl=3.3, accuracy=73.131, wps=18983.9, ups=1.38, wpb=13768.4, bsz=489.3, num_updates=36800, lr=7.3721e-05, gnorm=0.41, clip=0, loss_scale=16, train_wall=72, gb_free=12, wall=32838
2023-08-29 20:09:26 | INFO | train_inner | epoch 031:   1187 / 1191 loss=1.822, trans_loss=4.549, nll_loss=1.723, w2v_ctc_loss=0.53, task_loss=2.389, contrastive_loss=0.234, total=6656.88, n_correct=4860.77, ppl=3.3, accuracy=73.019, wps=18433.1, ups=1.38, wpb=13313.8, bsz=445.6, num_updates=36900, lr=7.3621e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=71, gb_free=13.9, wall=32910
2023-08-29 20:09:29 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 20:10:01 | INFO | dev_st | epoch 031 | valid on 'dev_st' subset | loss 3.762 | trans_loss 4.855 | nll_loss 2.071 | w2v_ctc_loss 1.184 | task_loss 8.581 | contrastive_loss 0.429 | total 6138.43 | n_correct 4389.71 | ppl 4.2 | accuracy 71.512 | uer 16.463 | wer 18.022 | raw_wer 18.022 | bleu 28.74 | wps 1763.3 | wpb 6138.4 | bsz 201.1 | num_updates 36904 | best_bleu 29.13
2023-08-29 20:10:01 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 31 @ 36904 updates
2023-08-29 20:10:01 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 20:10:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 20:10:08 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 31 @ 36904 updates, score 28.74) (writing took 6.786388056993019 seconds)
2023-08-29 20:10:08 | INFO | fairseq_cli.train | end of epoch 31 (average epoch stats below)
2023-08-29 20:10:08 | INFO | train | epoch 031 | loss 1.821 | trans_loss 4.548 | nll_loss 1.721 | w2v_ctc_loss 0.531 | task_loss 2.355 | contrastive_loss 0.215 | total 6704.43 | n_correct 4899.01 | ppl 3.3 | accuracy 73.071 | wps 16736.9 | ups 1.25 | wpb 13408.9 | bsz 452.3 | num_updates 36904 | lr 7.3617e-05 | gnorm 0.42 | clip 0 | loss_scale 16 | train_wall 858 | gb_free 10 | wall 32952
2023-08-29 20:10:08 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 20:10:08 | INFO | fairseq.trainer | begin training epoch 32
2023-08-29 20:10:08 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 20:11:25 | INFO | train_inner | epoch 032:     96 / 1191 loss=1.808, trans_loss=4.531, nll_loss=1.699, w2v_ctc_loss=0.521, task_loss=2.298, contrastive_loss=0.189, total=6689.32, n_correct=4909.67, ppl=3.25, accuracy=73.396, wps=11207, ups=0.84, wpb=13378.6, bsz=452.4, num_updates=37000, lr=7.35215e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=71, gb_free=12.1, wall=33029
2023-08-29 20:12:38 | INFO | train_inner | epoch 032:    196 / 1191 loss=1.823, trans_loss=4.544, nll_loss=1.715, w2v_ctc_loss=0.524, task_loss=2.259, contrastive_loss=0.288, total=6806.67, n_correct=4979.42, ppl=3.28, accuracy=73.155, wps=18657.7, ups=1.37, wpb=13613.3, bsz=466.5, num_updates=37100, lr=7.34223e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=72, gb_free=10.5, wall=33102
2023-08-29 20:13:51 | INFO | train_inner | epoch 032:    296 / 1191 loss=1.816, trans_loss=4.543, nll_loss=1.715, w2v_ctc_loss=0.53, task_loss=2.413, contrastive_loss=0.182, total=6678.58, n_correct=4885.19, ppl=3.28, accuracy=73.147, wps=18402.3, ups=1.38, wpb=13357.2, bsz=446.2, num_updates=37200, lr=7.33236e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=33175
2023-08-29 20:15:03 | INFO | train_inner | epoch 032:    396 / 1191 loss=1.806, trans_loss=4.531, nll_loss=1.7, w2v_ctc_loss=0.52, task_loss=2.282, contrastive_loss=0.183, total=6758.65, n_correct=4962.34, ppl=3.25, accuracy=73.422, wps=18565.5, ups=1.37, wpb=13517.3, bsz=458.9, num_updates=37300, lr=7.32252e-05, gnorm=0.411, clip=0, loss_scale=16, train_wall=72, gb_free=7.7, wall=33247
2023-08-29 20:16:16 | INFO | train_inner | epoch 032:    496 / 1191 loss=1.814, trans_loss=4.545, nll_loss=1.717, w2v_ctc_loss=0.53, task_loss=2.315, contrastive_loss=0.173, total=6744.1, n_correct=4935.49, ppl=3.29, accuracy=73.182, wps=18530.3, ups=1.37, wpb=13488.2, bsz=454.9, num_updates=37400, lr=7.31272e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=72, gb_free=14, wall=33320
2023-08-29 20:17:29 | INFO | train_inner | epoch 032:    596 / 1191 loss=1.813, trans_loss=4.542, nll_loss=1.714, w2v_ctc_loss=0.529, task_loss=2.402, contrastive_loss=0.165, total=6688.42, n_correct=4899.79, ppl=3.28, accuracy=73.258, wps=18277.3, ups=1.37, wpb=13376.8, bsz=444.7, num_updates=37500, lr=7.30297e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=12, wall=33393
2023-08-29 20:18:43 | INFO | train_inner | epoch 032:    696 / 1191 loss=1.815, trans_loss=4.538, nll_loss=1.708, w2v_ctc_loss=0.527, task_loss=2.516, contrastive_loss=0.21, total=6670, n_correct=4887.47, ppl=3.27, accuracy=73.275, wps=18038.9, ups=1.35, wpb=13340, bsz=436.6, num_updates=37600, lr=7.29325e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=73, gb_free=14.1, wall=33467
2023-08-29 20:19:56 | INFO | train_inner | epoch 032:    796 / 1191 loss=1.825, trans_loss=4.543, nll_loss=1.716, w2v_ctc_loss=0.529, task_loss=2.304, contrastive_loss=0.273, total=6761.99, n_correct=4942.07, ppl=3.28, accuracy=73.086, wps=18576.9, ups=1.37, wpb=13524, bsz=465.5, num_updates=37700, lr=7.28357e-05, gnorm=0.425, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=33540
2023-08-29 20:21:09 | INFO | train_inner | epoch 032:    896 / 1191 loss=1.822, trans_loss=4.546, nll_loss=1.719, w2v_ctc_loss=0.53, task_loss=2.427, contrastive_loss=0.232, total=6694.46, n_correct=4890.85, ppl=3.29, accuracy=73.058, wps=18366.7, ups=1.37, wpb=13388.9, bsz=444.9, num_updates=37800, lr=7.27393e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=14.1, wall=33613
2023-08-29 20:22:21 | INFO | train_inner | epoch 032:    996 / 1191 loss=1.816, trans_loss=4.543, nll_loss=1.715, w2v_ctc_loss=0.53, task_loss=2.411, contrastive_loss=0.194, total=6610.12, n_correct=4839.07, ppl=3.28, accuracy=73.207, wps=18333.2, ups=1.39, wpb=13220.2, bsz=440.7, num_updates=37900, lr=7.26433e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=71, gb_free=13, wall=33685
2023-08-29 20:23:33 | INFO | train_inner | epoch 032:   1096 / 1191 loss=1.816, trans_loss=4.546, nll_loss=1.718, w2v_ctc_loss=0.534, task_loss=2.48, contrastive_loss=0.16, total=6609.06, n_correct=4831.26, ppl=3.29, accuracy=73.101, wps=18350.8, ups=1.39, wpb=13218.1, bsz=431, num_updates=38000, lr=7.25476e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=71, gb_free=15, wall=33757
2023-08-29 20:23:33 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 20:24:06 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.855 | nll_loss 2.071 | w2v_ctc_loss 1.213 | task_loss 8.594 | contrastive_loss 0.425 | total 6138.43 | n_correct 4390 | ppl 4.2 | accuracy 71.517 | uer 16.551 | wer 17.951 | raw_wer 17.951 | bleu 28.93 | wps 1745.3 | wpb 6138.4 | bsz 201.1 | num_updates 38000 | best_bleu 29.13
2023-08-29 20:24:06 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38000 updates
2023-08-29 20:24:06 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-29 20:24:08 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt
2023-08-29 20:24:14 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_32_38000.pt (epoch 32 @ 38000 updates, score 28.93) (writing took 8.063878318993375 seconds)
2023-08-29 20:25:23 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 20:25:56 | INFO | dev_st | epoch 032 | valid on 'dev_st' subset | loss 3.764 | trans_loss 4.856 | nll_loss 2.072 | w2v_ctc_loss 1.191 | task_loss 8.585 | contrastive_loss 0.424 | total 6138.43 | n_correct 4389.29 | ppl 4.2 | accuracy 71.505 | uer 16.682 | wer 18.286 | raw_wer 18.286 | bleu 28.87 | wps 1758 | wpb 6138.4 | bsz 201.1 | num_updates 38095 | best_bleu 29.13
2023-08-29 20:25:56 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 32 @ 38095 updates
2023-08-29 20:25:56 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8708.pt
2023-08-29 20:25:59 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8708.pt
2023-08-29 20:26:04 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_28.8708.pt (epoch 32 @ 38095 updates, score 28.87) (writing took 7.780965289988671 seconds)
2023-08-29 20:26:04 | INFO | fairseq_cli.train | end of epoch 32 (average epoch stats below)
2023-08-29 20:26:04 | INFO | train | epoch 032 | loss 1.816 | trans_loss 4.542 | nll_loss 1.713 | w2v_ctc_loss 0.527 | task_loss 2.353 | contrastive_loss 0.213 | total 6703.69 | n_correct 4907.36 | ppl 3.28 | accuracy 73.204 | wps 16699.6 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 38095 | lr 7.24571e-05 | gnorm 0.419 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 11.4 | wall 33908
2023-08-29 20:26:04 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 20:26:04 | INFO | fairseq.trainer | begin training epoch 33
2023-08-29 20:26:04 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 20:26:16 | INFO | train_inner | epoch 033:      5 / 1191 loss=1.824, trans_loss=4.55, nll_loss=1.724, w2v_ctc_loss=0.522, task_loss=2.179, contrastive_loss=0.327, total=6703.57, n_correct=4902.98, ppl=3.3, accuracy=73.14, wps=8255.8, ups=0.62, wpb=13407.1, bsz=482.5, num_updates=38100, lr=7.24524e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=33920
2023-08-29 20:27:29 | INFO | train_inner | epoch 033:    105 / 1191 loss=1.8, trans_loss=4.53, nll_loss=1.699, w2v_ctc_loss=0.509, task_loss=2.262, contrastive_loss=0.178, total=6806.82, n_correct=5006.97, ppl=3.25, accuracy=73.558, wps=18637.7, ups=1.37, wpb=13613.6, bsz=467.7, num_updates=38200, lr=7.23575e-05, gnorm=0.413, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=33993
2023-08-29 20:28:40 | INFO | train_inner | epoch 033:    205 / 1191 loss=1.803, trans_loss=4.528, nll_loss=1.695, w2v_ctc_loss=0.514, task_loss=2.284, contrastive_loss=0.195, total=6763.38, n_correct=4974.48, ppl=3.24, accuracy=73.55, wps=18854.7, ups=1.39, wpb=13526.8, bsz=455.5, num_updates=38300, lr=7.22629e-05, gnorm=0.409, clip=0, loss_scale=32, train_wall=71, gb_free=12.6, wall=34065
2023-08-29 20:29:54 | INFO | train_inner | epoch 033:    305 / 1191 loss=1.815, trans_loss=4.534, nll_loss=1.703, w2v_ctc_loss=0.526, task_loss=2.517, contrastive_loss=0.228, total=6595.67, n_correct=4837.51, ppl=3.26, accuracy=73.344, wps=18055.6, ups=1.37, wpb=13191.3, bsz=434, num_updates=38400, lr=7.21688e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=12.1, wall=34138
2023-08-29 20:31:05 | INFO | train_inner | epoch 033:    405 / 1191 loss=1.815, trans_loss=4.539, nll_loss=1.709, w2v_ctc_loss=0.526, task_loss=2.464, contrastive_loss=0.207, total=6592.1, n_correct=4831.59, ppl=3.27, accuracy=73.294, wps=18369.7, ups=1.39, wpb=13184.2, bsz=432.6, num_updates=38500, lr=7.2075e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=71, gb_free=4, wall=34209
2023-08-29 20:32:17 | INFO | train_inner | epoch 033:    505 / 1191 loss=1.809, trans_loss=4.534, nll_loss=1.704, w2v_ctc_loss=0.518, task_loss=2.287, contrastive_loss=0.208, total=6691.29, n_correct=4910.71, ppl=3.26, accuracy=73.39, wps=18570.7, ups=1.39, wpb=13382.6, bsz=456.4, num_updates=38600, lr=7.19816e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=71, gb_free=14.8, wall=34282
2023-08-29 20:33:31 | INFO | train_inner | epoch 033:    605 / 1191 loss=1.812, trans_loss=4.53, nll_loss=1.698, w2v_ctc_loss=0.531, task_loss=2.419, contrastive_loss=0.187, total=6673.5, n_correct=4897.74, ppl=3.24, accuracy=73.391, wps=18204.3, ups=1.36, wpb=13347, bsz=446.7, num_updates=38700, lr=7.18885e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=73, gb_free=11.3, wall=34355
2023-08-29 20:34:44 | INFO | train_inner | epoch 033:    705 / 1191 loss=1.813, trans_loss=4.538, nll_loss=1.709, w2v_ctc_loss=0.527, task_loss=2.409, contrastive_loss=0.194, total=6684.47, n_correct=4899.1, ppl=3.27, accuracy=73.291, wps=18209.9, ups=1.36, wpb=13368.9, bsz=443.1, num_updates=38800, lr=7.17958e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=73, gb_free=4.2, wall=34428
2023-08-29 20:35:58 | INFO | train_inner | epoch 033:    805 / 1191 loss=1.81, trans_loss=4.534, nll_loss=1.703, w2v_ctc_loss=0.513, task_loss=2.216, contrastive_loss=0.252, total=6794.84, n_correct=4990.74, ppl=3.26, accuracy=73.449, wps=18735.2, ups=1.38, wpb=13589.7, bsz=467.9, num_updates=38900, lr=7.17035e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=34501
2023-08-29 20:37:11 | INFO | train_inner | epoch 033:    905 / 1191 loss=1.815, trans_loss=4.54, nll_loss=1.711, w2v_ctc_loss=0.53, task_loss=2.285, contrastive_loss=0.192, total=6754.04, n_correct=4945.18, ppl=3.27, accuracy=73.218, wps=18596.2, ups=1.38, wpb=13508.1, bsz=463.2, num_updates=39000, lr=7.16115e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=34575
2023-08-29 20:38:25 | INFO | train_inner | epoch 033:   1005 / 1191 loss=1.815, trans_loss=4.544, nll_loss=1.716, w2v_ctc_loss=0.527, task_loss=2.48, contrastive_loss=0.191, total=6679.84, n_correct=4892.04, ppl=3.28, accuracy=73.236, wps=18028.3, ups=1.35, wpb=13359.7, bsz=440.5, num_updates=39100, lr=7.15199e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=73, gb_free=4.3, wall=34649
2023-08-29 20:39:38 | INFO | train_inner | epoch 033:   1105 / 1191 loss=1.822, trans_loss=4.544, nll_loss=1.716, w2v_ctc_loss=0.532, task_loss=2.305, contrastive_loss=0.238, total=6749.49, n_correct=4933.49, ppl=3.28, accuracy=73.094, wps=18509.8, ups=1.37, wpb=13499, bsz=463.2, num_updates=39200, lr=7.14286e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=12.6, wall=34722
2023-08-29 20:40:40 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 20:41:13 | INFO | dev_st | epoch 033 | valid on 'dev_st' subset | loss 3.774 | trans_loss 4.848 | nll_loss 2.064 | w2v_ctc_loss 1.239 | task_loss 8.647 | contrastive_loss 0.425 | total 6138.43 | n_correct 4397.71 | ppl 4.18 | accuracy 71.642 | uer 16.738 | wer 18.438 | raw_wer 18.438 | bleu 29.09 | wps 1751.9 | wpb 6138.4 | bsz 201.1 | num_updates 39286 | best_bleu 29.13
2023-08-29 20:41:13 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 33 @ 39286 updates
2023-08-29 20:41:13 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0902.pt
2023-08-29 20:41:15 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0902.pt
2023-08-29 20:41:20 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0902.pt (epoch 33 @ 39286 updates, score 29.09) (writing took 7.495241598007851 seconds)
2023-08-29 20:41:20 | INFO | fairseq_cli.train | end of epoch 33 (average epoch stats below)
2023-08-29 20:41:20 | INFO | train | epoch 033 | loss 1.812 | trans_loss 4.536 | nll_loss 1.706 | w2v_ctc_loss 0.523 | task_loss 2.353 | contrastive_loss 0.211 | total 6703.69 | n_correct 4917.16 | ppl 3.26 | accuracy 73.35 | wps 17427.4 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 39286 | lr 7.13503e-05 | gnorm 0.419 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 10.4 | wall 34825
2023-08-29 20:41:21 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 20:41:21 | INFO | fairseq.trainer | begin training epoch 34
2023-08-29 20:41:21 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 20:41:39 | INFO | train_inner | epoch 034:     14 / 1191 loss=1.813, trans_loss=4.534, nll_loss=1.704, w2v_ctc_loss=0.521, task_loss=2.258, contrastive_loss=0.267, total=6714.43, n_correct=4930.78, ppl=3.26, accuracy=73.436, wps=11079.5, ups=0.83, wpb=13428.9, bsz=468.7, num_updates=39300, lr=7.13376e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=34843
2023-08-29 20:42:51 | INFO | train_inner | epoch 034:    114 / 1191 loss=1.81, trans_loss=4.527, nll_loss=1.695, w2v_ctc_loss=0.51, task_loss=2.155, contrastive_loss=0.287, total=6812.86, n_correct=5010.9, ppl=3.24, accuracy=73.551, wps=18902.8, ups=1.39, wpb=13625.7, bsz=478.9, num_updates=39400, lr=7.1247e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=71, gb_free=14.3, wall=34915
2023-08-29 20:44:04 | INFO | train_inner | epoch 034:    214 / 1191 loss=1.811, trans_loss=4.53, nll_loss=1.698, w2v_ctc_loss=0.52, task_loss=2.427, contrastive_loss=0.225, total=6669.32, n_correct=4900.06, ppl=3.24, accuracy=73.472, wps=18240.9, ups=1.37, wpb=13338.6, bsz=448.9, num_updates=39500, lr=7.11568e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=34988
2023-08-29 20:45:17 | INFO | train_inner | epoch 034:    314 / 1191 loss=1.802, trans_loss=4.527, nll_loss=1.694, w2v_ctc_loss=0.518, task_loss=2.511, contrastive_loss=0.158, total=6597.66, n_correct=4847.12, ppl=3.24, accuracy=73.467, wps=18050.8, ups=1.37, wpb=13195.3, bsz=431.8, num_updates=39600, lr=7.10669e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=35061
2023-08-29 20:46:30 | INFO | train_inner | epoch 034:    414 / 1191 loss=1.808, trans_loss=4.532, nll_loss=1.701, w2v_ctc_loss=0.52, task_loss=2.485, contrastive_loss=0.171, total=6670.6, n_correct=4894.95, ppl=3.25, accuracy=73.381, wps=18224.1, ups=1.37, wpb=13341.2, bsz=433.1, num_updates=39700, lr=7.09773e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=35134
2023-08-29 20:47:43 | INFO | train_inner | epoch 034:    514 / 1191 loss=1.805, trans_loss=4.529, nll_loss=1.697, w2v_ctc_loss=0.517, task_loss=2.462, contrastive_loss=0.196, total=6672.9, n_correct=4904.96, ppl=3.24, accuracy=73.506, wps=18347.5, ups=1.37, wpb=13345.8, bsz=440, num_updates=39800, lr=7.08881e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=5.1, wall=35207
2023-08-29 20:48:57 | INFO | train_inner | epoch 034:    614 / 1191 loss=1.816, trans_loss=4.536, nll_loss=1.706, w2v_ctc_loss=0.525, task_loss=2.29, contrastive_loss=0.239, total=6739.24, n_correct=4941.68, ppl=3.26, accuracy=73.327, wps=18562.3, ups=1.38, wpb=13478.5, bsz=463.2, num_updates=39900, lr=7.07992e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=12.5, wall=35280
2023-08-29 20:50:09 | INFO | train_inner | epoch 034:    714 / 1191 loss=1.809, trans_loss=4.533, nll_loss=1.702, w2v_ctc_loss=0.521, task_loss=2.408, contrastive_loss=0.191, total=6627.68, n_correct=4862.61, ppl=3.25, accuracy=73.368, wps=18372.1, ups=1.39, wpb=13255.4, bsz=441.5, num_updates=40000, lr=7.07107e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=71, gb_free=13.6, wall=35353
2023-08-29 20:50:09 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 20:50:41 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.768 | trans_loss 4.849 | nll_loss 2.063 | w2v_ctc_loss 1.221 | task_loss 8.597 | contrastive_loss 0.425 | total 6138.43 | n_correct 4390.71 | ppl 4.18 | accuracy 71.528 | uer 16.664 | wer 18.237 | raw_wer 18.237 | bleu 29.05 | wps 1760.5 | wpb 6138.4 | bsz 201.1 | num_updates 40000 | best_bleu 29.13
2023-08-29 20:50:41 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40000 updates
2023-08-29 20:50:41 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-29 20:50:44 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt
2023-08-29 20:50:50 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_34_40000.pt (epoch 34 @ 40000 updates, score 29.05) (writing took 8.542271558995708 seconds)
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 20:52:04 | INFO | train_inner | epoch 034:    814 / 1191 loss=1.808, trans_loss=4.529, nll_loss=1.697, w2v_ctc_loss=0.525, task_loss=2.386, contrastive_loss=0.192, total=6664.33, n_correct=4895.67, ppl=3.24, accuracy=73.461, wps=11586.3, ups=0.87, wpb=13328.7, bsz=454.5, num_updates=40100, lr=7.06225e-05, gnorm=0.425, clip=0, loss_scale=64, train_wall=73, gb_free=13.9, wall=35468
2023-08-29 20:53:16 | INFO | train_inner | epoch 034:    914 / 1191 loss=1.807, trans_loss=4.527, nll_loss=1.694, w2v_ctc_loss=0.523, task_loss=2.502, contrastive_loss=0.179, total=6654.7, n_correct=4890.11, ppl=3.24, accuracy=73.484, wps=18395.4, ups=1.38, wpb=13309.4, bsz=428.5, num_updates=40200, lr=7.05346e-05, gnorm=0.421, clip=0, loss_scale=64, train_wall=72, gb_free=14.2, wall=35540
2023-08-29 20:54:29 | INFO | train_inner | epoch 034:   1014 / 1191 loss=1.809, trans_loss=4.537, nll_loss=1.707, w2v_ctc_loss=0.522, task_loss=2.412, contrastive_loss=0.168, total=6667.27, n_correct=4888.59, ppl=3.26, accuracy=73.322, wps=18346.1, ups=1.38, wpb=13334.5, bsz=439.7, num_updates=40300, lr=7.0447e-05, gnorm=0.416, clip=0, loss_scale=64, train_wall=72, gb_free=12.1, wall=35613
2023-08-29 20:55:00 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 20:55:42 | INFO | train_inner | epoch 034:   1115 / 1191 loss=1.803, trans_loss=4.53, nll_loss=1.699, w2v_ctc_loss=0.513, task_loss=2.176, contrastive_loss=0.204, total=6851.2, n_correct=5036.42, ppl=3.25, accuracy=73.512, wps=18671.5, ups=1.36, wpb=13702.4, bsz=477.3, num_updates=40400, lr=7.03598e-05, gnorm=0.411, clip=0, loss_scale=32, train_wall=73, gb_free=14, wall=35686
2023-08-29 20:56:38 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
2023-08-29 20:57:10 | INFO | dev_st | epoch 034 | valid on 'dev_st' subset | loss 3.765 | trans_loss 4.852 | nll_loss 2.07 | w2v_ctc_loss 1.199 | task_loss 8.587 | contrastive_loss 0.428 | total 6138.43 | n_correct 4393.43 | ppl 4.2 | accuracy 71.573 | uer 16.626 | wer 18.215 | raw_wer 18.215 | bleu 29 | wps 1756.5 | wpb 6138.4 | bsz 201.1 | num_updates 40476 | best_bleu 29.13
2023-08-29 20:57:10 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 34 @ 40476 updates
2023-08-29 20:57:10 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0003.pt
2023-08-29 20:57:13 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0003.pt
2023-08-29 20:57:18 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0003.pt (epoch 34 @ 40476 updates, score 29.0) (writing took 7.6679777140088845 seconds)
2023-08-29 20:57:18 | INFO | fairseq_cli.train | end of epoch 34 (average epoch stats below)
2023-08-29 20:57:18 | INFO | train | epoch 034 | loss 1.808 | trans_loss 4.531 | nll_loss 1.699 | w2v_ctc_loss 0.519 | task_loss 2.356 | contrastive_loss 0.21 | total 6703.19 | n_correct 4922.92 | ppl 3.25 | accuracy 73.441 | wps 16653.4 | ups 1.24 | wpb 13406.4 | bsz 452 | num_updates 40476 | lr 7.02937e-05 | gnorm 0.419 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 13.8 | wall 35782
2023-08-29 20:57:19 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 20:57:19 | INFO | fairseq.trainer | begin training epoch 35
2023-08-29 20:57:19 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 20:57:44 | INFO | train_inner | epoch 035:     24 / 1191 loss=1.811, trans_loss=4.53, nll_loss=1.699, w2v_ctc_loss=0.515, task_loss=2.214, contrastive_loss=0.274, total=6771.92, n_correct=4974.15, ppl=3.25, accuracy=73.453, wps=11169.2, ups=0.82, wpb=13543.8, bsz=471.7, num_updates=40500, lr=7.02728e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13.3, wall=35808
2023-08-29 20:58:57 | INFO | train_inner | epoch 035:    124 / 1191 loss=1.802, trans_loss=4.524, nll_loss=1.69, w2v_ctc_loss=0.519, task_loss=2.355, contrastive_loss=0.17, total=6711.06, n_correct=4941.88, ppl=3.23, accuracy=73.638, wps=18326.2, ups=1.37, wpb=13422.1, bsz=452.8, num_updates=40600, lr=7.01862e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=73, gb_free=11.5, wall=35881
2023-08-29 21:00:09 | INFO | train_inner | epoch 035:    224 / 1191 loss=1.81, trans_loss=4.523, nll_loss=1.689, w2v_ctc_loss=0.516, task_loss=2.453, contrastive_loss=0.286, total=6627.11, n_correct=4875.98, ppl=3.22, accuracy=73.576, wps=18397.3, ups=1.39, wpb=13254.2, bsz=444, num_updates=40700, lr=7.01e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=71, gb_free=14.9, wall=35953
2023-08-29 21:01:21 | INFO | train_inner | epoch 035:    324 / 1191 loss=1.799, trans_loss=4.518, nll_loss=1.683, w2v_ctc_loss=0.509, task_loss=2.259, contrastive_loss=0.221, total=6768.12, n_correct=4994.2, ppl=3.21, accuracy=73.79, wps=18670.1, ups=1.38, wpb=13536.2, bsz=463.6, num_updates=40800, lr=7.0014e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13.4, wall=36025
2023-08-29 21:02:35 | INFO | train_inner | epoch 035:    424 / 1191 loss=1.801, trans_loss=4.525, nll_loss=1.691, w2v_ctc_loss=0.518, task_loss=2.641, contrastive_loss=0.155, total=6573.32, n_correct=4838.51, ppl=3.23, accuracy=73.608, wps=17931.8, ups=1.36, wpb=13146.6, bsz=420.1, num_updates=40900, lr=6.99284e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=73, gb_free=13.5, wall=36099
2023-08-29 21:03:47 | INFO | train_inner | epoch 035:    524 / 1191 loss=1.802, trans_loss=4.52, nll_loss=1.686, w2v_ctc_loss=0.518, task_loss=2.357, contrastive_loss=0.187, total=6718.03, n_correct=4945.67, ppl=3.22, accuracy=73.618, wps=18511.2, ups=1.38, wpb=13436.1, bsz=456.1, num_updates=41000, lr=6.9843e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=12.3, wall=36171
2023-08-29 21:05:01 | INFO | train_inner | epoch 035:    624 / 1191 loss=1.802, trans_loss=4.523, nll_loss=1.689, w2v_ctc_loss=0.515, task_loss=2.394, contrastive_loss=0.191, total=6702.8, n_correct=4932.06, ppl=3.22, accuracy=73.582, wps=18061.6, ups=1.35, wpb=13405.6, bsz=446.4, num_updates=41100, lr=6.9758e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=74, gb_free=9.4, wall=36246
2023-08-29 21:06:14 | INFO | train_inner | epoch 035:    724 / 1191 loss=1.809, trans_loss=4.53, nll_loss=1.698, w2v_ctc_loss=0.515, task_loss=2.355, contrastive_loss=0.233, total=6709.59, n_correct=4927.3, ppl=3.24, accuracy=73.437, wps=18525.2, ups=1.38, wpb=13419.2, bsz=453.6, num_updates=41200, lr=6.96733e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=12.9, wall=36318
2023-08-29 21:07:27 | INFO | train_inner | epoch 035:    824 / 1191 loss=1.808, trans_loss=4.533, nll_loss=1.703, w2v_ctc_loss=0.514, task_loss=2.26, contrastive_loss=0.219, total=6756.65, n_correct=4961.86, ppl=3.26, accuracy=73.437, wps=18591.3, ups=1.38, wpb=13513.3, bsz=459.7, num_updates=41300, lr=6.95889e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=14.1, wall=36391
2023-08-29 21:08:39 | INFO | train_inner | epoch 035:    924 / 1191 loss=1.805, trans_loss=4.526, nll_loss=1.694, w2v_ctc_loss=0.508, task_loss=2.163, contrastive_loss=0.245, total=6770.43, n_correct=4980.98, ppl=3.23, accuracy=73.57, wps=18741.9, ups=1.38, wpb=13540.9, bsz=473.1, num_updates=41400, lr=6.95048e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=14.6, wall=36463
2023-08-29 21:09:51 | INFO | train_inner | epoch 035:   1024 / 1191 loss=1.804, trans_loss=4.524, nll_loss=1.69, w2v_ctc_loss=0.522, task_loss=2.387, contrastive_loss=0.172, total=6727.5, n_correct=4945.05, ppl=3.23, accuracy=73.505, wps=18583, ups=1.38, wpb=13455, bsz=442.9, num_updates=41500, lr=6.9421e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=36535
2023-08-29 21:11:05 | INFO | train_inner | epoch 035:   1124 / 1191 loss=1.807, trans_loss=4.533, nll_loss=1.702, w2v_ctc_loss=0.524, task_loss=2.432, contrastive_loss=0.169, total=6632.13, n_correct=4866.84, ppl=3.25, accuracy=73.383, wps=18036.5, ups=1.36, wpb=13264.3, bsz=443.4, num_updates=41600, lr=6.93375e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=73, gb_free=13.4, wall=36609
2023-08-29 21:11:54 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 21:12:26 | INFO | dev_st | epoch 035 | valid on 'dev_st' subset | loss 3.776 | trans_loss 4.849 | nll_loss 2.063 | w2v_ctc_loss 1.245 | task_loss 8.594 | contrastive_loss 0.421 | total 6138.43 | n_correct 4396.86 | ppl 4.18 | accuracy 71.628 | uer 16.91 | wer 18.509 | raw_wer 18.509 | bleu 29.03 | wps 1755.3 | wpb 6138.4 | bsz 201.1 | num_updates 41667 | best_bleu 29.13
2023-08-29 21:12:26 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 35 @ 41667 updates
2023-08-29 21:12:26 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0309.pt
2023-08-29 21:12:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0309.pt
2023-08-29 21:12:34 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0309.pt (epoch 35 @ 41667 updates, score 29.03) (writing took 7.754831537997234 seconds)
2023-08-29 21:12:34 | INFO | fairseq_cli.train | end of epoch 35 (average epoch stats below)
2023-08-29 21:12:34 | INFO | train | epoch 035 | loss 1.805 | trans_loss 4.526 | nll_loss 1.693 | w2v_ctc_loss 0.516 | task_loss 2.355 | contrastive_loss 0.208 | total 6703.69 | n_correct 4931.18 | ppl 3.23 | accuracy 73.559 | wps 17434 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 41667 | lr 6.92818e-05 | gnorm 0.42 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 14.1 | wall 36698
2023-08-29 21:12:35 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 21:12:35 | INFO | fairseq.trainer | begin training epoch 36
2023-08-29 21:12:35 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 21:13:06 | INFO | train_inner | epoch 036:     33 / 1191 loss=1.806, trans_loss=4.525, nll_loss=1.692, w2v_ctc_loss=0.512, task_loss=2.275, contrastive_loss=0.24, total=6723.84, n_correct=4948.84, ppl=3.23, accuracy=73.601, wps=11122.8, ups=0.83, wpb=13447.7, bsz=466.4, num_updates=41700, lr=6.92543e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=36730
2023-08-29 21:14:18 | INFO | train_inner | epoch 036:    133 / 1191 loss=1.803, trans_loss=4.514, nll_loss=1.677, w2v_ctc_loss=0.513, task_loss=2.428, contrastive_loss=0.253, total=6619.6, n_correct=4882.21, ppl=3.2, accuracy=73.754, wps=18380.3, ups=1.39, wpb=13239.2, bsz=440.5, num_updates=41800, lr=6.91714e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=71, gb_free=12.1, wall=36802
2023-08-29 21:15:30 | INFO | train_inner | epoch 036:    233 / 1191 loss=1.785, trans_loss=4.506, nll_loss=1.668, w2v_ctc_loss=0.5, task_loss=2.204, contrastive_loss=0.165, total=6746.42, n_correct=4994.56, ppl=3.18, accuracy=74.033, wps=18608.8, ups=1.38, wpb=13492.8, bsz=471.8, num_updates=41900, lr=6.90889e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=36874
2023-08-29 21:16:42 | INFO | train_inner | epoch 036:    333 / 1191 loss=1.791, trans_loss=4.516, nll_loss=1.68, w2v_ctc_loss=0.504, task_loss=2.246, contrastive_loss=0.17, total=6782.22, n_correct=5010.36, ppl=3.2, accuracy=73.875, wps=18870.1, ups=1.39, wpb=13564.4, bsz=465.7, num_updates=42000, lr=6.90066e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=71, gb_free=14.2, wall=36946
2023-08-29 21:16:42 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 21:17:15 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.781 | trans_loss 4.853 | nll_loss 2.067 | w2v_ctc_loss 1.258 | task_loss 8.638 | contrastive_loss 0.419 | total 6138.43 | n_correct 4392.57 | ppl 4.19 | accuracy 71.559 | uer 16.698 | wer 18.353 | raw_wer 18.353 | bleu 29.07 | wps 1745.1 | wpb 6138.4 | bsz 201.1 | num_updates 42000 | best_bleu 29.13
2023-08-29 21:17:15 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42000 updates
2023-08-29 21:17:15 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-29 21:17:17 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt
2023-08-29 21:17:23 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_36_42000.pt (epoch 36 @ 42000 updates, score 29.07) (writing took 8.154954051002278 seconds)
2023-08-29 21:18:37 | INFO | train_inner | epoch 036:    433 / 1191 loss=1.799, trans_loss=4.519, nll_loss=1.684, w2v_ctc_loss=0.512, task_loss=2.227, contrastive_loss=0.209, total=6792.65, n_correct=5011.12, ppl=3.21, accuracy=73.773, wps=11795.8, ups=0.87, wpb=13585.3, bsz=471.5, num_updates=42100, lr=6.89246e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=73, gb_free=13.7, wall=37062
2023-08-29 21:19:50 | INFO | train_inner | epoch 036:    533 / 1191 loss=1.812, trans_loss=4.527, nll_loss=1.695, w2v_ctc_loss=0.511, task_loss=2.201, contrastive_loss=0.297, total=6799.2, n_correct=4998.09, ppl=3.24, accuracy=73.51, wps=18736.6, ups=1.38, wpb=13598.4, bsz=476.6, num_updates=42200, lr=6.88428e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=37134
2023-08-29 21:21:03 | INFO | train_inner | epoch 036:    633 / 1191 loss=1.798, trans_loss=4.518, nll_loss=1.684, w2v_ctc_loss=0.516, task_loss=2.421, contrastive_loss=0.159, total=6677.2, n_correct=4921.39, ppl=3.21, accuracy=73.704, wps=18339.7, ups=1.37, wpb=13354.4, bsz=440.8, num_updates=42300, lr=6.87614e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=37207
2023-08-29 21:22:16 | INFO | train_inner | epoch 036:    733 / 1191 loss=1.805, trans_loss=4.522, nll_loss=1.688, w2v_ctc_loss=0.515, task_loss=2.356, contrastive_loss=0.228, total=6721.98, n_correct=4945.71, ppl=3.22, accuracy=73.575, wps=18427.1, ups=1.37, wpb=13444, bsz=451.5, num_updates=42400, lr=6.86803e-05, gnorm=0.42, clip=0, loss_scale=64, train_wall=72, gb_free=13.8, wall=37280
2023-08-29 21:23:29 | INFO | train_inner | epoch 036:    833 / 1191 loss=1.8, trans_loss=4.528, nll_loss=1.696, w2v_ctc_loss=0.514, task_loss=2.457, contrastive_loss=0.164, total=6667.94, n_correct=4905.2, ppl=3.24, accuracy=73.564, wps=18196.9, ups=1.36, wpb=13335.9, bsz=443.4, num_updates=42500, lr=6.85994e-05, gnorm=0.421, clip=0, loss_scale=64, train_wall=73, gb_free=14.4, wall=37353
2023-08-29 21:24:43 | INFO | train_inner | epoch 036:    933 / 1191 loss=1.81, trans_loss=4.525, nll_loss=1.691, w2v_ctc_loss=0.517, task_loss=2.516, contrastive_loss=0.248, total=6687.67, n_correct=4914.5, ppl=3.23, accuracy=73.486, wps=18173.4, ups=1.36, wpb=13375.3, bsz=433.6, num_updates=42600, lr=6.85189e-05, gnorm=0.42, clip=0, loss_scale=64, train_wall=73, gb_free=13.8, wall=37427
2023-08-29 21:25:55 | INFO | train_inner | epoch 036:   1033 / 1191 loss=1.799, trans_loss=4.525, nll_loss=1.693, w2v_ctc_loss=0.51, task_loss=2.29, contrastive_loss=0.188, total=6704.37, n_correct=4931.2, ppl=3.23, accuracy=73.552, wps=18620.3, ups=1.39, wpb=13408.7, bsz=460.9, num_updates=42700, lr=6.84386e-05, gnorm=0.419, clip=0, loss_scale=64, train_wall=71, gb_free=14, wall=37499
2023-08-29 21:27:07 | INFO | train_inner | epoch 036:   1133 / 1191 loss=1.801, trans_loss=4.52, nll_loss=1.685, w2v_ctc_loss=0.521, task_loss=2.488, contrastive_loss=0.166, total=6606.86, n_correct=4861.29, ppl=3.22, accuracy=73.579, wps=18226.8, ups=1.38, wpb=13213.7, bsz=434.3, num_updates=42800, lr=6.83586e-05, gnorm=0.424, clip=0, loss_scale=64, train_wall=72, gb_free=14.8, wall=37571
2023-08-29 21:27:49 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 21:28:22 | INFO | dev_st | epoch 036 | valid on 'dev_st' subset | loss 3.772 | trans_loss 4.851 | nll_loss 2.064 | w2v_ctc_loss 1.23 | task_loss 8.613 | contrastive_loss 0.429 | total 6138.43 | n_correct 4385.86 | ppl 4.18 | accuracy 71.449 | uer 16.455 | wer 18.089 | raw_wer 18.089 | bleu 28.77 | wps 1760.7 | wpb 6138.4 | bsz 201.1 | num_updates 42858 | best_bleu 29.13
2023-08-29 21:28:22 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 36 @ 42858 updates
2023-08-29 21:28:22 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 21:28:29 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 21:28:29 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 36 @ 42858 updates, score 28.77) (writing took 7.064459668006748 seconds)
2023-08-29 21:28:29 | INFO | fairseq_cli.train | end of epoch 36 (average epoch stats below)
2023-08-29 21:28:29 | INFO | train | epoch 036 | loss 1.801 | trans_loss 4.521 | nll_loss 1.686 | w2v_ctc_loss 0.512 | task_loss 2.356 | contrastive_loss 0.207 | total 6703.69 | n_correct 4937.6 | ppl 3.22 | accuracy 73.655 | wps 16730.2 | ups 1.25 | wpb 13407.4 | bsz 452.1 | num_updates 42858 | lr 6.83123e-05 | gnorm 0.42 | clip 0 | loss_scale 64 | train_wall 858 | gb_free 12.7 | wall 37653
2023-08-29 21:28:29 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 21:28:29 | INFO | fairseq.trainer | begin training epoch 37
2023-08-29 21:28:29 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 21:29:07 | INFO | train_inner | epoch 037:     42 / 1191 loss=1.803, trans_loss=4.522, nll_loss=1.688, w2v_ctc_loss=0.512, task_loss=2.447, contrastive_loss=0.211, total=6674.02, n_correct=4911.89, ppl=3.22, accuracy=73.597, wps=11103, ups=0.83, wpb=13348, bsz=440.6, num_updates=42900, lr=6.82789e-05, gnorm=0.42, clip=0, loss_scale=64, train_wall=72, gb_free=14.6, wall=37692
2023-08-29 21:30:20 | INFO | train_inner | epoch 037:    142 / 1191 loss=1.802, trans_loss=4.513, nll_loss=1.677, w2v_ctc_loss=0.504, task_loss=2.244, contrastive_loss=0.283, total=6760.41, n_correct=4988.29, ppl=3.2, accuracy=73.787, wps=18544.7, ups=1.37, wpb=13520.8, bsz=463.7, num_updates=43000, lr=6.81994e-05, gnorm=0.417, clip=0, loss_scale=64, train_wall=72, gb_free=11.7, wall=37764
2023-08-29 21:30:29 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 21:31:34 | INFO | train_inner | epoch 037:    243 / 1191 loss=1.795, trans_loss=4.511, nll_loss=1.673, w2v_ctc_loss=0.51, task_loss=2.361, contrastive_loss=0.192, total=6711.32, n_correct=4958.28, ppl=3.19, accuracy=73.879, wps=18280.4, ups=1.36, wpb=13422.6, bsz=451.9, num_updates=43100, lr=6.81203e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=73, gb_free=11.6, wall=37838
2023-08-29 21:32:46 | INFO | train_inner | epoch 037:    343 / 1191 loss=1.796, trans_loss=4.515, nll_loss=1.679, w2v_ctc_loss=0.511, task_loss=2.417, contrastive_loss=0.183, total=6637.72, n_correct=4896.37, ppl=3.2, accuracy=73.766, wps=18307.4, ups=1.38, wpb=13275.4, bsz=440.5, num_updates=43200, lr=6.80414e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=37910
2023-08-29 21:33:59 | INFO | train_inner | epoch 037:    443 / 1191 loss=1.789, trans_loss=4.508, nll_loss=1.669, w2v_ctc_loss=0.501, task_loss=2.361, contrastive_loss=0.181, total=6703.75, n_correct=4957.94, ppl=3.18, accuracy=73.958, wps=18423.4, ups=1.37, wpb=13407.5, bsz=446.8, num_updates=43300, lr=6.79628e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=37983
2023-08-29 21:35:12 | INFO | train_inner | epoch 037:    543 / 1191 loss=1.797, trans_loss=4.514, nll_loss=1.677, w2v_ctc_loss=0.513, task_loss=2.411, contrastive_loss=0.2, total=6639.95, n_correct=4898.67, ppl=3.2, accuracy=73.776, wps=18229.1, ups=1.37, wpb=13279.9, bsz=449.3, num_updates=43400, lr=6.78844e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=38056
2023-08-29 21:36:25 | INFO | train_inner | epoch 037:    643 / 1191 loss=1.799, trans_loss=4.52, nll_loss=1.685, w2v_ctc_loss=0.509, task_loss=2.523, contrastive_loss=0.19, total=6631.82, n_correct=4887.24, ppl=3.21, accuracy=73.694, wps=18214.2, ups=1.37, wpb=13263.6, bsz=428.1, num_updates=43500, lr=6.78064e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=12.2, wall=38129
2023-08-29 21:37:38 | INFO | train_inner | epoch 037:    743 / 1191 loss=1.796, trans_loss=4.513, nll_loss=1.676, w2v_ctc_loss=0.507, task_loss=2.345, contrastive_loss=0.21, total=6719.07, n_correct=4961.31, ppl=3.2, accuracy=73.839, wps=18343.9, ups=1.37, wpb=13438.1, bsz=451.8, num_updates=43600, lr=6.77285e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=13.3, wall=38202
2023-08-29 21:38:51 | INFO | train_inner | epoch 037:    843 / 1191 loss=1.795, trans_loss=4.519, nll_loss=1.685, w2v_ctc_loss=0.504, task_loss=2.256, contrastive_loss=0.209, total=6808.88, n_correct=5024.81, ppl=3.22, accuracy=73.798, wps=18589.8, ups=1.37, wpb=13617.8, bsz=466.8, num_updates=43700, lr=6.7651e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=73, gb_free=14.2, wall=38275
2023-08-29 21:40:04 | INFO | train_inner | epoch 037:    943 / 1191 loss=1.795, trans_loss=4.515, nll_loss=1.68, w2v_ctc_loss=0.502, task_loss=2.064, contrastive_loss=0.244, total=6855.49, n_correct=5060.02, ppl=3.2, accuracy=73.81, wps=18761.5, ups=1.37, wpb=13711, bsz=499.9, num_updates=43800, lr=6.75737e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=38348
2023-08-29 21:41:17 | INFO | train_inner | epoch 037:   1043 / 1191 loss=1.793, trans_loss=4.514, nll_loss=1.677, w2v_ctc_loss=0.51, task_loss=2.458, contrastive_loss=0.156, total=6689.96, n_correct=4939.15, ppl=3.2, accuracy=73.829, wps=18324.5, ups=1.37, wpb=13379.9, bsz=441.4, num_updates=43900, lr=6.74967e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=38422
2023-08-29 21:42:30 | INFO | train_inner | epoch 037:   1143 / 1191 loss=1.809, trans_loss=4.525, nll_loss=1.692, w2v_ctc_loss=0.52, task_loss=2.436, contrastive_loss=0.23, total=6631.9, n_correct=4878.01, ppl=3.23, accuracy=73.554, wps=18237.3, ups=1.37, wpb=13263.8, bsz=443.6, num_updates=44000, lr=6.742e-05, gnorm=0.426, clip=0, loss_scale=32, train_wall=72, gb_free=14.4, wall=38494
2023-08-29 21:42:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 21:43:03 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.768 | trans_loss 4.85 | nll_loss 2.065 | w2v_ctc_loss 1.217 | task_loss 8.596 | contrastive_loss 0.429 | total 6138.43 | n_correct 4391.57 | ppl 4.19 | accuracy 71.542 | uer 16.664 | wer 18.256 | raw_wer 18.256 | bleu 28.92 | wps 1740.9 | wpb 6138.4 | bsz 201.1 | num_updates 44000 | best_bleu 29.13
2023-08-29 21:43:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44000 updates
2023-08-29 21:43:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-29 21:43:05 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt
2023-08-29 21:43:10 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_37_44000.pt (epoch 37 @ 44000 updates, score 28.92) (writing took 7.420141066002543 seconds)
2023-08-29 21:43:45 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 21:44:17 | INFO | dev_st | epoch 037 | valid on 'dev_st' subset | loss 3.767 | trans_loss 4.852 | nll_loss 2.065 | w2v_ctc_loss 1.213 | task_loss 8.599 | contrastive_loss 0.428 | total 6138.43 | n_correct 4388.86 | ppl 4.19 | accuracy 71.498 | uer 16.442 | wer 18.137 | raw_wer 18.137 | bleu 29.03 | wps 1765.7 | wpb 6138.4 | bsz 201.1 | num_updates 44048 | best_bleu 29.13
2023-08-29 21:44:17 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 37 @ 44048 updates
2023-08-29 21:44:17 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0300.pt
2023-08-29 21:44:20 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0300.pt
2023-08-29 21:44:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint.best_bleu_29.0300.pt (epoch 37 @ 44048 updates, score 29.03) (writing took 7.695407947001513 seconds)
2023-08-29 21:44:26 | INFO | fairseq_cli.train | end of epoch 37 (average epoch stats below)
2023-08-29 21:44:26 | INFO | train | epoch 037 | loss 1.797 | trans_loss 4.515 | nll_loss 1.679 | w2v_ctc_loss 0.508 | task_loss 2.354 | contrastive_loss 0.205 | total 6704.36 | n_correct 4947.52 | ppl 3.2 | accuracy 73.796 | wps 16677.1 | ups 1.24 | wpb 13408.7 | bsz 452.3 | num_updates 44048 | lr 6.73832e-05 | gnorm 0.421 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 13.5 | wall 38610
2023-08-29 21:44:26 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 21:44:26 | INFO | fairseq.trainer | begin training epoch 38
2023-08-29 21:44:26 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 21:45:11 | INFO | train_inner | epoch 038:     52 / 1191 loss=1.791, trans_loss=4.515, nll_loss=1.679, w2v_ctc_loss=0.503, task_loss=2.482, contrastive_loss=0.16, total=6590.11, n_correct=4864.96, ppl=3.2, accuracy=73.822, wps=8211.5, ups=0.62, wpb=13180.2, bsz=432.1, num_updates=44100, lr=6.73435e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=71, gb_free=11.8, wall=38655
2023-08-29 21:46:24 | INFO | train_inner | epoch 038:    152 / 1191 loss=1.786, trans_loss=4.501, nll_loss=1.661, w2v_ctc_loss=0.499, task_loss=2.333, contrastive_loss=0.179, total=6707.39, n_correct=4973.21, ppl=3.16, accuracy=74.145, wps=18377.7, ups=1.37, wpb=13414.8, bsz=449.4, num_updates=44200, lr=6.72673e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=8, wall=38728
2023-08-29 21:47:36 | INFO | train_inner | epoch 038:    252 / 1191 loss=1.8, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.503, task_loss=2.346, contrastive_loss=0.297, total=6683.44, n_correct=4941.36, ppl=3.18, accuracy=73.934, wps=18362.8, ups=1.37, wpb=13366.9, bsz=456.5, num_updates=44300, lr=6.71913e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=38801
2023-08-29 21:48:50 | INFO | train_inner | epoch 038:    352 / 1191 loss=1.789, trans_loss=4.504, nll_loss=1.664, w2v_ctc_loss=0.507, task_loss=2.416, contrastive_loss=0.164, total=6695.6, n_correct=4956.52, ppl=3.17, accuracy=74.027, wps=18328.8, ups=1.37, wpb=13391.2, bsz=443, num_updates=44400, lr=6.71156e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=38874
2023-08-29 21:50:03 | INFO | train_inner | epoch 038:    452 / 1191 loss=1.79, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.498, task_loss=2.224, contrastive_loss=0.229, total=6755.69, n_correct=4997.77, ppl=3.19, accuracy=73.979, wps=18506.8, ups=1.37, wpb=13511.4, bsz=476.3, num_updates=44500, lr=6.70402e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13, wall=38947
2023-08-29 21:51:16 | INFO | train_inner | epoch 038:    552 / 1191 loss=1.794, trans_loss=4.509, nll_loss=1.671, w2v_ctc_loss=0.503, task_loss=2.279, contrastive_loss=0.221, total=6799.96, n_correct=5027.43, ppl=3.19, accuracy=73.933, wps=18592.8, ups=1.37, wpb=13599.9, bsz=463.7, num_updates=44600, lr=6.6965e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=11.7, wall=39020
2023-08-29 21:52:29 | INFO | train_inner | epoch 038:    652 / 1191 loss=1.799, trans_loss=4.519, nll_loss=1.684, w2v_ctc_loss=0.505, task_loss=2.166, contrastive_loss=0.232, total=6826.7, n_correct=5036.61, ppl=3.21, accuracy=73.778, wps=18696.8, ups=1.37, wpb=13653.4, bsz=474.6, num_updates=44700, lr=6.689e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=11.9, wall=39093
2023-08-29 21:53:41 | INFO | train_inner | epoch 038:    752 / 1191 loss=1.794, trans_loss=4.512, nll_loss=1.676, w2v_ctc_loss=0.506, task_loss=2.3, contrastive_loss=0.219, total=6730.12, n_correct=4972.92, ppl=3.19, accuracy=73.891, wps=18584.9, ups=1.38, wpb=13460.2, bsz=464.2, num_updates=44800, lr=6.68153e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=39165
2023-08-29 21:54:54 | INFO | train_inner | epoch 038:    852 / 1191 loss=1.791, trans_loss=4.51, nll_loss=1.672, w2v_ctc_loss=0.508, task_loss=2.455, contrastive_loss=0.156, total=6687.39, n_correct=4937.61, ppl=3.19, accuracy=73.835, wps=18347.6, ups=1.37, wpb=13374.8, bsz=435.4, num_updates=44900, lr=6.67409e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=11.5, wall=39238
2023-08-29 21:56:07 | INFO | train_inner | epoch 038:    952 / 1191 loss=1.794, trans_loss=4.513, nll_loss=1.676, w2v_ctc_loss=0.506, task_loss=2.379, contrastive_loss=0.183, total=6685.88, n_correct=4938.42, ppl=3.2, accuracy=73.863, wps=18271, ups=1.37, wpb=13371.8, bsz=446, num_updates=45000, lr=6.66667e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=73, gb_free=10.6, wall=39311
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:0')
2023-08-29 21:57:20 | INFO | train_inner | epoch 038:   1052 / 1191 loss=1.798, trans_loss=4.511, nll_loss=1.675, w2v_ctc_loss=0.51, task_loss=2.474, contrastive_loss=0.212, total=6622.97, n_correct=4889.56, ppl=3.19, accuracy=73.827, wps=18314.4, ups=1.38, wpb=13245.9, bsz=440.1, num_updates=45100, lr=6.65927e-05, gnorm=0.428, clip=0, loss_scale=64, train_wall=72, gb_free=12.2, wall=39384
2023-08-29 21:58:32 | INFO | train_inner | epoch 038:   1152 / 1191 loss=1.794, trans_loss=4.515, nll_loss=1.679, w2v_ctc_loss=0.505, task_loss=2.374, contrastive_loss=0.188, total=6688.64, n_correct=4933.99, ppl=3.2, accuracy=73.767, wps=18353, ups=1.37, wpb=13377.3, bsz=448.4, num_updates=45200, lr=6.6519e-05, gnorm=0.42, clip=0, loss_scale=64, train_wall=72, gb_free=13, wall=39457
2023-08-29 21:59:00 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:3')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:2')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:7')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:5')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:6')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:1')
mt_weight tensor(0.5000)
asr_weight tensor(0.2347, device='cuda:4')
2023-08-29 21:59:33 | INFO | dev_st | epoch 038 | valid on 'dev_st' subset | loss 3.76 | trans_loss 4.85 | nll_loss 2.064 | w2v_ctc_loss 1.2 | task_loss 8.572 | contrastive_loss 0.412 | total 6138.43 | n_correct 4390 | ppl 4.18 | accuracy 71.517 | uer 16.415 | wer 18.07 | raw_wer 18.07 | bleu 28.86 | wps 1740.5 | wpb 6138.4 | bsz 201.1 | num_updates 45239 | best_bleu 29.13
2023-08-29 21:59:33 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 38 @ 45239 updates
2023-08-29 21:59:33 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 21:59:39 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 21:59:39 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 38 @ 45239 updates, score 28.86) (writing took 6.32292050900287 seconds)
2023-08-29 21:59:39 | INFO | fairseq_cli.train | end of epoch 38 (average epoch stats below)
2023-08-29 21:59:39 | INFO | train | epoch 038 | loss 1.793 | trans_loss 4.51 | nll_loss 1.673 | w2v_ctc_loss 0.504 | task_loss 2.355 | contrastive_loss 0.204 | total 6703.69 | n_correct 4954.73 | ppl 3.19 | accuracy 73.91 | wps 17474.7 | ups 1.3 | wpb 13407.4 | bsz 452.1 | num_updates 45239 | lr 6.64903e-05 | gnorm 0.421 | clip 0 | loss_scale 64 | train_wall 858 | gb_free 13.8 | wall 39523
2023-08-29 21:59:40 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 21:59:40 | INFO | fairseq.trainer | begin training epoch 39
2023-08-29 21:59:40 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 22:00:32 | INFO | train_inner | epoch 039:     61 / 1191 loss=1.79, trans_loss=4.51, nll_loss=1.672, w2v_ctc_loss=0.505, task_loss=2.658, contrastive_loss=0.163, total=6527.07, n_correct=4826.76, ppl=3.19, accuracy=73.95, wps=10904.2, ups=0.84, wpb=13054.1, bsz=420.4, num_updates=45300, lr=6.64455e-05, gnorm=0.424, clip=0, loss_scale=64, train_wall=72, gb_free=10.1, wall=39576
2023-08-29 22:01:45 | INFO | train_inner | epoch 039:    161 / 1191 loss=1.784, trans_loss=4.498, nll_loss=1.657, w2v_ctc_loss=0.502, task_loss=2.386, contrastive_loss=0.162, total=6683.06, n_correct=4961.85, ppl=3.15, accuracy=74.245, wps=18329.3, ups=1.37, wpb=13366.1, bsz=440.5, num_updates=45400, lr=6.63723e-05, gnorm=0.423, clip=0, loss_scale=64, train_wall=72, gb_free=12.8, wall=39649
2023-08-29 22:02:58 | INFO | train_inner | epoch 039:    261 / 1191 loss=1.793, trans_loss=4.509, nll_loss=1.67, w2v_ctc_loss=0.503, task_loss=2.428, contrastive_loss=0.233, total=6673.47, n_correct=4935.7, ppl=3.18, accuracy=73.96, wps=18334.4, ups=1.37, wpb=13346.9, bsz=445, num_updates=45500, lr=6.62994e-05, gnorm=0.414, clip=0, loss_scale=64, train_wall=72, gb_free=13.6, wall=39722
2023-08-29 22:04:11 | INFO | train_inner | epoch 039:    361 / 1191 loss=1.792, trans_loss=4.507, nll_loss=1.668, w2v_ctc_loss=0.508, task_loss=2.56, contrastive_loss=0.179, total=6602.39, n_correct=4886.58, ppl=3.18, accuracy=74.012, wps=18015.6, ups=1.36, wpb=13204.8, bsz=427.5, num_updates=45600, lr=6.62266e-05, gnorm=0.425, clip=0, loss_scale=64, train_wall=73, gb_free=12.5, wall=39795
2023-08-29 22:05:24 | INFO | train_inner | epoch 039:    461 / 1191 loss=1.788, trans_loss=4.502, nll_loss=1.662, w2v_ctc_loss=0.495, task_loss=2.277, contrastive_loss=0.236, total=6752.25, n_correct=5005.18, ppl=3.16, accuracy=74.126, wps=18580.2, ups=1.38, wpb=13504.5, bsz=462.8, num_updates=45700, lr=6.61541e-05, gnorm=0.417, clip=0, loss_scale=64, train_wall=72, gb_free=14.2, wall=39868
2023-08-29 22:06:37 | INFO | train_inner | epoch 039:    561 / 1191 loss=1.784, trans_loss=4.501, nll_loss=1.661, w2v_ctc_loss=0.493, task_loss=2.363, contrastive_loss=0.19, total=6699.88, n_correct=4966.56, ppl=3.16, accuracy=74.129, wps=18453.8, ups=1.38, wpb=13399.8, bsz=450.3, num_updates=45800, lr=6.60819e-05, gnorm=0.418, clip=0, loss_scale=64, train_wall=72, gb_free=14, wall=39941
2023-08-29 22:06:55 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
2023-08-29 22:07:50 | INFO | train_inner | epoch 039:    662 / 1191 loss=1.794, trans_loss=4.51, nll_loss=1.673, w2v_ctc_loss=0.504, task_loss=2.312, contrastive_loss=0.222, total=6716.12, n_correct=4957.9, ppl=3.19, accuracy=73.821, wps=18238.3, ups=1.36, wpb=13432.2, bsz=463.4, num_updates=45900, lr=6.60098e-05, gnorm=0.423, clip=0, loss_scale=32, train_wall=73, gb_free=6.1, wall=40014
2023-08-29 22:09:03 | INFO | train_inner | epoch 039:    762 / 1191 loss=1.792, trans_loss=4.509, nll_loss=1.672, w2v_ctc_loss=0.503, task_loss=2.337, contrastive_loss=0.207, total=6736.15, n_correct=4982.08, ppl=3.19, accuracy=73.96, wps=18457.2, ups=1.37, wpb=13472.3, bsz=455.3, num_updates=46000, lr=6.5938e-05, gnorm=0.419, clip=0, loss_scale=32, train_wall=72, gb_free=12.7, wall=40087
2023-08-29 22:09:03 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 22:09:36 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.762 | trans_loss 4.848 | nll_loss 2.062 | w2v_ctc_loss 1.211 | task_loss 8.585 | contrastive_loss 0.419 | total 6138.43 | n_correct 4395.43 | ppl 4.18 | accuracy 71.605 | uer 16.511 | wer 18.193 | raw_wer 18.193 | bleu 29.11 | wps 1766.3 | wpb 6138.4 | bsz 201.1 | num_updates 46000 | best_bleu 29.13
2023-08-29 22:09:36 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46000 updates
2023-08-29 22:09:36 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-29 22:09:38 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt
2023-08-29 22:09:45 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_39_46000.pt (epoch 39 @ 46000 updates, score 29.11) (writing took 9.464777970002615 seconds)
2023-08-29 22:10:58 | INFO | train_inner | epoch 039:    862 / 1191 loss=1.789, trans_loss=4.51, nll_loss=1.672, w2v_ctc_loss=0.5, task_loss=2.235, contrastive_loss=0.2, total=6798.2, n_correct=5024.72, ppl=3.19, accuracy=73.913, wps=11808.8, ups=0.87, wpb=13596.4, bsz=472.1, num_updates=46100, lr=6.58665e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=40202
2023-08-29 22:12:12 | INFO | train_inner | epoch 039:    962 / 1191 loss=1.788, trans_loss=4.501, nll_loss=1.661, w2v_ctc_loss=0.497, task_loss=2.161, contrastive_loss=0.224, total=6835.31, n_correct=5064.43, ppl=3.16, accuracy=74.092, wps=18667.6, ups=1.37, wpb=13670.6, bsz=480.9, num_updates=46200, lr=6.57952e-05, gnorm=0.414, clip=0, loss_scale=32, train_wall=72, gb_free=13.6, wall=40276
2023-08-29 22:13:24 | INFO | train_inner | epoch 039:   1062 / 1191 loss=1.79, trans_loss=4.506, nll_loss=1.668, w2v_ctc_loss=0.499, task_loss=2.288, contrastive_loss=0.211, total=6757.98, n_correct=4996.84, ppl=3.18, accuracy=73.94, wps=18709, ups=1.38, wpb=13516, bsz=459.7, num_updates=46300, lr=6.57241e-05, gnorm=0.416, clip=0, loss_scale=32, train_wall=72, gb_free=14.3, wall=40348
2023-08-29 22:14:36 | INFO | train_inner | epoch 039:   1162 / 1191 loss=1.797, trans_loss=4.51, nll_loss=1.672, w2v_ctc_loss=0.515, task_loss=2.482, contrastive_loss=0.187, total=6582.59, n_correct=4859.44, ppl=3.19, accuracy=73.823, wps=18199.3, ups=1.38, wpb=13165.2, bsz=428.8, num_updates=46400, lr=6.56532e-05, gnorm=0.436, clip=0, loss_scale=32, train_wall=72, gb_free=14, wall=40420
2023-08-29 22:14:57 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 22:15:29 | INFO | dev_st | epoch 039 | valid on 'dev_st' subset | loss 3.752 | trans_loss 4.849 | nll_loss 2.06 | w2v_ctc_loss 1.176 | task_loss 8.622 | contrastive_loss 0.417 | total 6138.43 | n_correct 4388.57 | ppl 4.17 | accuracy 71.493 | uer 16.113 | wer 17.869 | raw_wer 17.869 | bleu 28.99 | wps 1757.2 | wpb 6138.4 | bsz 201.1 | num_updates 46429 | best_bleu 29.13
2023-08-29 22:15:29 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 39 @ 46429 updates
2023-08-29 22:15:29 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 22:15:36 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 22:15:36 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 39 @ 46429 updates, score 28.99) (writing took 6.328163140991819 seconds)
2023-08-29 22:15:36 | INFO | fairseq_cli.train | end of epoch 39 (average epoch stats below)
2023-08-29 22:15:36 | INFO | train | epoch 039 | loss 1.79 | trans_loss 4.506 | nll_loss 1.667 | w2v_ctc_loss 0.502 | task_loss 2.354 | contrastive_loss 0.202 | total 6703.96 | n_correct 4961.34 | ppl 3.18 | accuracy 74.006 | wps 16685 | ups 1.24 | wpb 13407.9 | bsz 452.2 | num_updates 46429 | lr 6.56327e-05 | gnorm 0.421 | clip 0 | loss_scale 32 | train_wall 858 | gb_free 13.1 | wall 40480
2023-08-29 22:15:36 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 22:15:36 | INFO | fairseq.trainer | begin training epoch 40
2023-08-29 22:15:36 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 22:16:36 | INFO | train_inner | epoch 040:     71 / 1191 loss=1.782, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.495, task_loss=2.239, contrastive_loss=0.189, total=6767.38, n_correct=5020.21, ppl=3.15, accuracy=74.182, wps=11333, ups=0.84, wpb=13534.8, bsz=468.9, num_updates=46500, lr=6.55826e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=40540
2023-08-29 22:17:48 | INFO | train_inner | epoch 040:    171 / 1191 loss=1.779, trans_loss=4.495, nll_loss=1.653, w2v_ctc_loss=0.498, task_loss=2.342, contrastive_loss=0.152, total=6723.92, n_correct=4996.17, ppl=3.15, accuracy=74.304, wps=18591.4, ups=1.38, wpb=13447.8, bsz=450.2, num_updates=46600, lr=6.55122e-05, gnorm=0.417, clip=0, loss_scale=32, train_wall=72, gb_free=13.9, wall=40612
2023-08-29 22:18:39 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 22:19:02 | INFO | train_inner | epoch 040:    272 / 1191 loss=1.776, trans_loss=4.492, nll_loss=1.65, w2v_ctc_loss=0.489, task_loss=2.225, contrastive_loss=0.186, total=6762.15, n_correct=5025.24, ppl=3.14, accuracy=74.314, wps=18223.5, ups=1.35, wpb=13524.3, bsz=468.4, num_updates=46700, lr=6.5442e-05, gnorm=0.414, clip=0, loss_scale=16, train_wall=73, gb_free=13.2, wall=40686
2023-08-29 22:20:16 | INFO | train_inner | epoch 040:    372 / 1191 loss=1.791, trans_loss=4.501, nll_loss=1.661, w2v_ctc_loss=0.502, task_loss=2.531, contrastive_loss=0.214, total=6606.29, n_correct=4889.81, ppl=3.16, accuracy=74.017, wps=17983.4, ups=1.36, wpb=13212.6, bsz=434.7, num_updates=46800, lr=6.5372e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=73, gb_free=14.9, wall=40760
2023-08-29 22:21:27 | INFO | train_inner | epoch 040:    472 / 1191 loss=1.779, trans_loss=4.5, nll_loss=1.66, w2v_ctc_loss=0.494, task_loss=2.313, contrastive_loss=0.154, total=6731.67, n_correct=4996.71, ppl=3.16, accuracy=74.227, wps=18761.4, ups=1.39, wpb=13463.3, bsz=458, num_updates=46900, lr=6.53023e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=71, gb_free=13.9, wall=40831
2023-08-29 22:22:40 | INFO | train_inner | epoch 040:    572 / 1191 loss=1.784, trans_loss=4.497, nll_loss=1.655, w2v_ctc_loss=0.486, task_loss=2.311, contrastive_loss=0.26, total=6676.16, n_correct=4956.35, ppl=3.15, accuracy=74.24, wps=18421.3, ups=1.38, wpb=13352.3, bsz=454.3, num_updates=47000, lr=6.52328e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=72, gb_free=14.8, wall=40904
2023-08-29 22:23:53 | INFO | train_inner | epoch 040:    672 / 1191 loss=1.795, trans_loss=4.503, nll_loss=1.663, w2v_ctc_loss=0.502, task_loss=2.36, contrastive_loss=0.262, total=6714.1, n_correct=4970.96, ppl=3.17, accuracy=74.038, wps=18238.7, ups=1.36, wpb=13428.2, bsz=449.9, num_updates=47100, lr=6.51635e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=73, gb_free=13.7, wall=40978
2023-08-29 22:25:06 | INFO | train_inner | epoch 040:    772 / 1191 loss=1.786, trans_loss=4.502, nll_loss=1.663, w2v_ctc_loss=0.504, task_loss=2.445, contrastive_loss=0.166, total=6645.63, n_correct=4921.21, ppl=3.17, accuracy=74.052, wps=18243.9, ups=1.37, wpb=13291.3, bsz=440.4, num_updates=47200, lr=6.50945e-05, gnorm=0.427, clip=0, loss_scale=16, train_wall=72, gb_free=13.2, wall=41050
2023-08-29 22:26:20 | INFO | train_inner | epoch 040:    872 / 1191 loss=1.792, trans_loss=4.506, nll_loss=1.667, w2v_ctc_loss=0.507, task_loss=2.444, contrastive_loss=0.197, total=6695.84, n_correct=4953.44, ppl=3.18, accuracy=73.978, wps=18242.3, ups=1.36, wpb=13391.7, bsz=442.3, num_updates=47300, lr=6.50256e-05, gnorm=0.429, clip=0, loss_scale=16, train_wall=73, gb_free=13.3, wall=41124
2023-08-29 22:27:32 | INFO | train_inner | epoch 040:    972 / 1191 loss=1.791, trans_loss=4.507, nll_loss=1.669, w2v_ctc_loss=0.496, task_loss=2.323, contrastive_loss=0.232, total=6689.77, n_correct=4954.55, ppl=3.18, accuracy=74.062, wps=18533.7, ups=1.39, wpb=13379.5, bsz=454, num_updates=47400, lr=6.4957e-05, gnorm=0.424, clip=0, loss_scale=16, train_wall=72, gb_free=13.2, wall=41196
2023-08-29 22:28:45 | INFO | train_inner | epoch 040:   1072 / 1191 loss=1.787, trans_loss=4.502, nll_loss=1.663, w2v_ctc_loss=0.503, task_loss=2.328, contrastive_loss=0.186, total=6761.55, n_correct=5010.07, ppl=3.17, accuracy=74.096, wps=18408.5, ups=1.36, wpb=13523.1, bsz=459.1, num_updates=47500, lr=6.48886e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=73, gb_free=14, wall=41270
2023-08-29 22:29:58 | INFO | train_inner | epoch 040:   1172 / 1191 loss=1.785, trans_loss=4.502, nll_loss=1.663, w2v_ctc_loss=0.492, task_loss=2.319, contrastive_loss=0.217, total=6688.64, n_correct=4956.15, ppl=3.17, accuracy=74.098, wps=18371.7, ups=1.37, wpb=13377.3, bsz=458.8, num_updates=47600, lr=6.48204e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=72, gb_free=12.6, wall=41342
2023-08-29 22:30:12 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 22:30:45 | INFO | dev_st | epoch 040 | valid on 'dev_st' subset | loss 3.774 | trans_loss 4.85 | nll_loss 2.064 | w2v_ctc_loss 1.249 | task_loss 8.622 | contrastive_loss 0.413 | total 6138.43 | n_correct 4394.43 | ppl 4.18 | accuracy 71.589 | uer 16.503 | wer 18.133 | raw_wer 18.133 | bleu 29.31 | wps 1733.3 | wpb 6138.4 | bsz 201.1 | num_updates 47619 | best_bleu 29.31
2023-08-29 22:30:45 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 40 @ 47619 updates
2023-08-29 22:30:45 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 22:30:51 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt
2023-08-29 22:30:57 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_best.pt (epoch 40 @ 47619 updates, score 29.31) (writing took 12.63771196299058 seconds)
2023-08-29 22:30:58 | INFO | fairseq_cli.train | end of epoch 40 (average epoch stats below)
2023-08-29 22:30:58 | INFO | train | epoch 040 | loss 1.786 | trans_loss 4.5 | nll_loss 1.66 | w2v_ctc_loss 0.497 | task_loss 2.355 | contrastive_loss 0.201 | total 6703.8 | n_correct 4969.18 | ppl 3.16 | accuracy 74.125 | wps 17304.2 | ups 1.29 | wpb 13407.6 | bsz 452.2 | num_updates 47619 | lr 6.48074e-05 | gnorm 0.421 | clip 0 | loss_scale 16 | train_wall 859 | gb_free 12.1 | wall 41402
2023-08-29 22:30:58 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 22:30:58 | INFO | fairseq.trainer | begin training epoch 41
2023-08-29 22:30:58 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 22:32:04 | INFO | train_inner | epoch 041:     81 / 1191 loss=1.784, trans_loss=4.498, nll_loss=1.657, w2v_ctc_loss=0.493, task_loss=2.319, contrastive_loss=0.222, total=6722.93, n_correct=4987.11, ppl=3.15, accuracy=74.181, wps=10675.2, ups=0.79, wpb=13445.9, bsz=464.5, num_updates=47700, lr=6.47524e-05, gnorm=0.419, clip=0, loss_scale=16, train_wall=72, gb_free=14, wall=41468
2023-08-29 22:33:17 | INFO | train_inner | epoch 041:    181 / 1191 loss=1.788, trans_loss=4.494, nll_loss=1.652, w2v_ctc_loss=0.492, task_loss=2.409, contrastive_loss=0.251, total=6672.05, n_correct=4950.21, ppl=3.14, accuracy=74.193, wps=18365.3, ups=1.38, wpb=13344.1, bsz=445, num_updates=47800, lr=6.46846e-05, gnorm=0.42, clip=0, loss_scale=16, train_wall=72, gb_free=11.6, wall=41541
2023-08-29 22:34:30 | INFO | train_inner | epoch 041:    281 / 1191 loss=1.778, trans_loss=4.494, nll_loss=1.652, w2v_ctc_loss=0.485, task_loss=2.207, contrastive_loss=0.208, total=6804.18, n_correct=5056.4, ppl=3.14, accuracy=74.313, wps=18486.4, ups=1.36, wpb=13608.4, bsz=478.8, num_updates=47900, lr=6.46171e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=73, gb_free=13, wall=41615
2023-08-29 22:35:43 | INFO | train_inner | epoch 041:    381 / 1191 loss=1.777, trans_loss=4.495, nll_loss=1.654, w2v_ctc_loss=0.495, task_loss=2.27, contrastive_loss=0.155, total=6779.91, n_correct=5035.61, ppl=3.15, accuracy=74.273, wps=18596.6, ups=1.37, wpb=13559.8, bsz=459.7, num_updates=48000, lr=6.45497e-05, gnorm=0.416, clip=0, loss_scale=16, train_wall=72, gb_free=13.7, wall=41688
2023-08-29 22:35:43 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 22:36:16 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.766 | trans_loss 4.854 | nll_loss 2.069 | w2v_ctc_loss 1.216 | task_loss 8.62 | contrastive_loss 0.414 | total 6138.43 | n_correct 4383.57 | ppl 4.2 | accuracy 71.412 | uer 16.209 | wer 17.832 | raw_wer 17.832 | bleu 29.26 | wps 1754 | wpb 6138.4 | bsz 201.1 | num_updates 48000 | best_bleu 29.31
2023-08-29 22:36:16 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48000 updates
2023-08-29 22:36:16 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-29 22:36:19 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt
2023-08-29 22:36:25 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_41_48000.pt (epoch 41 @ 48000 updates, score 29.26) (writing took 9.588685815004283 seconds)
2023-08-29 22:37:38 | INFO | train_inner | epoch 041:    481 / 1191 loss=1.777, trans_loss=4.494, nll_loss=1.652, w2v_ctc_loss=0.494, task_loss=2.274, contrastive_loss=0.15, total=6790.05, n_correct=5044.03, ppl=3.14, accuracy=74.286, wps=11797.3, ups=0.87, wpb=13580.1, bsz=461.9, num_updates=48100, lr=6.44826e-05, gnorm=0.409, clip=0, loss_scale=16, train_wall=72, gb_free=12.3, wall=41803
2023-08-29 22:38:51 | INFO | train_inner | epoch 041:    581 / 1191 loss=1.775, trans_loss=4.49, nll_loss=1.647, w2v_ctc_loss=0.486, task_loss=2.257, contrastive_loss=0.171, total=6773.53, n_correct=5039.13, ppl=3.13, accuracy=74.394, wps=18779.7, ups=1.39, wpb=13547.1, bsz=458, num_updates=48200, lr=6.44157e-05, gnorm=0.417, clip=0, loss_scale=16, train_wall=71, gb_free=10.9, wall=41875
2023-08-29 22:40:03 | INFO | train_inner | epoch 041:    681 / 1191 loss=1.783, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.498, task_loss=2.372, contrastive_loss=0.195, total=6677.75, n_correct=4956.96, ppl=3.15, accuracy=74.231, wps=18464, ups=1.38, wpb=13355.5, bsz=448.7, num_updates=48300, lr=6.43489e-05, gnorm=0.421, clip=0, loss_scale=16, train_wall=71, gb_free=10.3, wall=41947
2023-08-29 22:41:16 | INFO | train_inner | epoch 041:    781 / 1191 loss=1.783, trans_loss=4.495, nll_loss=1.653, w2v_ctc_loss=0.498, task_loss=2.583, contrastive_loss=0.185, total=6547.43, n_correct=4855.5, ppl=3.14, accuracy=74.159, wps=17870.9, ups=1.36, wpb=13094.9, bsz=422.4, num_updates=48400, lr=6.42824e-05, gnorm=0.426, clip=0, loss_scale=16, train_wall=73, gb_free=12.8, wall=42020
2023-08-29 22:42:29 | INFO | train_inner | epoch 041:    881 / 1191 loss=1.786, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.501, task_loss=2.525, contrastive_loss=0.189, total=6581.95, n_correct=4883.77, ppl=3.15, accuracy=74.199, wps=18033.8, ups=1.37, wpb=13163.9, bsz=427.6, num_updates=48500, lr=6.42161e-05, gnorm=0.429, clip=0, loss_scale=16, train_wall=72, gb_free=10.4, wall=42093
2023-08-29 22:43:42 | INFO | train_inner | epoch 041:    981 / 1191 loss=1.791, trans_loss=4.505, nll_loss=1.666, w2v_ctc_loss=0.498, task_loss=2.458, contrastive_loss=0.221, total=6677.96, n_correct=4935.48, ppl=3.17, accuracy=73.907, wps=18281.4, ups=1.37, wpb=13355.9, bsz=444.6, num_updates=48600, lr=6.415e-05, gnorm=0.423, clip=0, loss_scale=16, train_wall=72, gb_free=13.8, wall=42166
2023-08-29 22:44:56 | INFO | train_inner | epoch 041:   1081 / 1191 loss=1.78, trans_loss=4.498, nll_loss=1.658, w2v_ctc_loss=0.49, task_loss=2.184, contrastive_loss=0.213, total=6841.34, n_correct=5080.62, ppl=3.16, accuracy=74.264, wps=18658.1, ups=1.36, wpb=13682.7, bsz=478.7, num_updates=48700, lr=6.40841e-05, gnorm=0.418, clip=0, loss_scale=16, train_wall=73, gb_free=14.2, wall=42240
2023-08-29 22:46:08 | INFO | train_inner | epoch 041:   1181 / 1191 loss=1.785, trans_loss=4.498, nll_loss=1.657, w2v_ctc_loss=0.491, task_loss=2.491, contrastive_loss=0.231, total=6589.42, n_correct=4887.85, ppl=3.15, accuracy=74.177, wps=18164.2, ups=1.38, wpb=13178.8, bsz=431.4, num_updates=48800, lr=6.40184e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=72, gb_free=13.2, wall=42312
2023-08-29 22:46:15 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 22:46:48 | INFO | dev_st | epoch 041 | valid on 'dev_st' subset | loss 3.763 | trans_loss 4.852 | nll_loss 2.068 | w2v_ctc_loss 1.201 | task_loss 8.578 | contrastive_loss 0.426 | total 6138.43 | n_correct 4389.43 | ppl 4.19 | accuracy 71.507 | uer 16.503 | wer 18.274 | raw_wer 18.274 | bleu 28.9 | wps 1745.8 | wpb 6138.4 | bsz 201.1 | num_updates 48810 | best_bleu 29.31
2023-08-29 22:46:48 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 41 @ 48810 updates
2023-08-29 22:46:48 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 22:46:55 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 22:46:55 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 41 @ 48810 updates, score 28.9) (writing took 7.4780702860007295 seconds)
2023-08-29 22:46:55 | INFO | fairseq_cli.train | end of epoch 41 (average epoch stats below)
2023-08-29 22:46:55 | INFO | train | epoch 041 | loss 1.782 | trans_loss 4.496 | nll_loss 1.654 | w2v_ctc_loss 0.493 | task_loss 2.355 | contrastive_loss 0.199 | total 6703.69 | n_correct 4975.85 | ppl 3.15 | accuracy 74.226 | wps 16676.9 | ups 1.24 | wpb 13407.4 | bsz 452.1 | num_updates 48810 | lr 6.40119e-05 | gnorm 0.42 | clip 0 | loss_scale 32 | train_wall 859 | gb_free 11.3 | wall 42359
2023-08-29 22:46:55 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 22:46:55 | INFO | fairseq.trainer | begin training epoch 42
2023-08-29 22:46:55 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 22:48:08 | INFO | train_inner | epoch 042:     90 / 1191 loss=1.772, trans_loss=4.484, nll_loss=1.64, w2v_ctc_loss=0.478, task_loss=2.122, contrastive_loss=0.219, total=6824.86, n_correct=5087.49, ppl=3.12, accuracy=74.544, wps=11348.6, ups=0.83, wpb=13649.7, bsz=483.3, num_updates=48900, lr=6.39529e-05, gnorm=0.41, clip=0, loss_scale=32, train_wall=72, gb_free=13.7, wall=42433
2023-08-29 22:49:22 | INFO | train_inner | epoch 042:    190 / 1191 loss=1.789, trans_loss=4.493, nll_loss=1.651, w2v_ctc_loss=0.491, task_loss=2.437, contrastive_loss=0.277, total=6671.53, n_correct=4950.46, ppl=3.14, accuracy=74.203, wps=18277.9, ups=1.37, wpb=13343.1, bsz=441.1, num_updates=49000, lr=6.38877e-05, gnorm=0.422, clip=0, loss_scale=32, train_wall=72, gb_free=13.5, wall=42506
2023-08-29 22:50:35 | INFO | train_inner | epoch 042:    290 / 1191 loss=1.783, trans_loss=4.487, nll_loss=1.643, w2v_ctc_loss=0.5, task_loss=2.407, contrastive_loss=0.203, total=6650.86, n_correct=4945.92, ppl=3.12, accuracy=74.365, wps=18092.4, ups=1.36, wpb=13301.7, bsz=445.5, num_updates=49100, lr=6.38226e-05, gnorm=0.427, clip=0, loss_scale=32, train_wall=73, gb_free=14.3, wall=42579
2023-08-29 22:51:47 | INFO | train_inner | epoch 042:    390 / 1191 loss=1.775, trans_loss=4.487, nll_loss=1.642, w2v_ctc_loss=0.488, task_loss=2.417, contrastive_loss=0.192, total=6626.36, n_correct=4931.29, ppl=3.12, accuracy=74.419, wps=18333.4, ups=1.38, wpb=13252.7, bsz=447.3, num_updates=49200, lr=6.37577e-05, gnorm=0.418, clip=0, loss_scale=32, train_wall=71, gb_free=13.9, wall=42652
2023-08-29 22:53:01 | INFO | train_inner | epoch 042:    490 / 1191 loss=1.777, trans_loss=4.493, nll_loss=1.649, w2v_ctc_loss=0.492, task_loss=2.649, contrastive_loss=0.144, total=6622.87, n_correct=4918.79, ppl=3.14, accuracy=74.27, wps=18011.5, ups=1.36, wpb=13245.7, bsz=418.4, num_updates=49300, lr=6.3693e-05, gnorm=0.42, clip=0, loss_scale=32, train_wall=73, gb_free=14.2, wall=42725
2023-08-29 22:54:13 | INFO | train_inner | epoch 042:    590 / 1191 loss=1.791, trans_loss=4.498, nll_loss=1.657, w2v_ctc_loss=0.505, task_loss=2.522, contrastive_loss=0.227, total=6598.24, n_correct=4886.53, ppl=3.15, accuracy=74.058, wps=18209.9, ups=1.38, wpb=13196.5, bsz=431.9, num_updates=49400, lr=6.36285e-05, gnorm=0.433, clip=0, loss_scale=32, train_wall=72, gb_free=12, wall=42798
2023-08-29 22:55:26 | INFO | train_inner | epoch 042:    690 / 1191 loss=1.778, trans_loss=4.493, nll_loss=1.651, w2v_ctc_loss=0.486, task_loss=2.153, contrastive_loss=0.211, total=6827.49, n_correct=5074.54, ppl=3.14, accuracy=74.325, wps=18737.4, ups=1.37, wpb=13655, bsz=480.8, num_updates=49500, lr=6.35642e-05, gnorm=0.421, clip=0, loss_scale=32, train_wall=72, gb_free=8.5, wall=42870
2023-08-29 22:56:39 | INFO | train_inner | epoch 042:    790 / 1191 loss=1.781, trans_loss=4.496, nll_loss=1.654, w2v_ctc_loss=0.493, task_loss=2.262, contrastive_loss=0.195, total=6715.54, n_correct=4987.76, ppl=3.15, accuracy=74.272, wps=18528.3, ups=1.38, wpb=13431.1, bsz=463.9, num_updates=49600, lr=6.35001e-05, gnorm=0.424, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=42943
2023-08-29 22:57:51 | INFO | train_inner | epoch 042:    890 / 1191 loss=1.773, trans_loss=4.487, nll_loss=1.644, w2v_ctc_loss=0.49, task_loss=2.422, contrastive_loss=0.156, total=6567.62, n_correct=4886.2, ppl=3.12, accuracy=74.398, wps=18139.4, ups=1.38, wpb=13135.2, bsz=440.7, num_updates=49700, lr=6.34361e-05, gnorm=0.425, clip=0, loss_scale=32, train_wall=72, gb_free=13.1, wall=43015
2023-08-29 22:59:04 | INFO | train_inner | epoch 042:    990 / 1191 loss=1.779, trans_loss=4.491, nll_loss=1.649, w2v_ctc_loss=0.486, task_loss=2.141, contrastive_loss=0.231, total=6827.16, n_correct=5074.64, ppl=3.14, accuracy=74.33, wps=18802.6, ups=1.38, wpb=13654.3, bsz=484, num_updates=49800, lr=6.33724e-05, gnorm=0.415, clip=0, loss_scale=32, train_wall=72, gb_free=14.5, wall=43088
2023-08-29 23:00:10 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
2023-08-29 23:00:16 | INFO | fairseq.trainer | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
2023-08-29 23:00:18 | INFO | train_inner | epoch 042:   1092 / 1191 loss=1.778, trans_loss=4.495, nll_loss=1.653, w2v_ctc_loss=0.494, task_loss=2.55, contrastive_loss=0.143, total=6673.12, n_correct=4954.76, ppl=3.14, accuracy=74.25, wps=18114.2, ups=1.36, wpb=13346.2, bsz=422.8, num_updates=49900, lr=6.33089e-05, gnorm=0.42, clip=0, loss_scale=8, train_wall=73, gb_free=11.4, wall=43162
2023-08-29 23:01:30 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 23:02:03 | INFO | dev_st | epoch 042 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.85 | nll_loss 2.064 | w2v_ctc_loss 1.239 | task_loss 8.62 | contrastive_loss 0.409 | total 6138.43 | n_correct 4392.29 | ppl 4.18 | accuracy 71.554 | uer 16.535 | wer 18.178 | raw_wer 18.178 | bleu 28.89 | wps 1730.9 | wpb 6138.4 | bsz 201.1 | num_updates 49999 | best_bleu 29.31
2023-08-29 23:02:03 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 42 @ 49999 updates
2023-08-29 23:02:03 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 23:02:11 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt
2023-08-29 23:02:11 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_last.pt (epoch 42 @ 49999 updates, score 28.89) (writing took 8.27514277100272 seconds)
2023-08-29 23:02:11 | INFO | fairseq_cli.train | end of epoch 42 (average epoch stats below)
2023-08-29 23:02:11 | INFO | train | epoch 042 | loss 1.779 | trans_loss 4.491 | nll_loss 1.649 | w2v_ctc_loss 0.491 | task_loss 2.354 | contrastive_loss 0.199 | total 6703.71 | n_correct 4981.73 | ppl 3.14 | accuracy 74.313 | wps 17405 | ups 1.3 | wpb 13407.4 | bsz 452.2 | num_updates 49999 | lr 6.32462e-05 | gnorm 0.421 | clip 0 | loss_scale 8 | train_wall 858 | gb_free 10.8 | wall 43275
2023-08-29 23:02:11 | INFO | fairseq.data.iterators | grouped total_num_itrs = 1191
2023-08-29 23:02:11 | INFO | fairseq.trainer | begin training epoch 43
2023-08-29 23:02:11 | INFO | fairseq_cli.train | Start iterating over samples
2023-08-29 23:02:20 | INFO | train_inner | epoch 043:      1 / 1191 loss=1.777, trans_loss=4.492, nll_loss=1.65, w2v_ctc_loss=0.492, task_loss=2.287, contrastive_loss=0.173, total=6794.07, n_correct=5051.06, ppl=3.14, accuracy=74.345, wps=11110.2, ups=0.82, wpb=13588.1, bsz=460.7, num_updates=50000, lr=6.32456e-05, gnorm=0.416, clip=0, loss_scale=8, train_wall=73, gb_free=14.3, wall=43284
2023-08-29 23:02:20 | INFO | fairseq_cli.train | Stopping training due to num_updates: 50000 >= max_update: 50000
2023-08-29 23:02:20 | INFO | fairseq_cli.train | begin validation on "dev_st" subset
2023-08-29 23:02:52 | INFO | dev_st | epoch 043 | valid on 'dev_st' subset | loss 3.77 | trans_loss 4.85 | nll_loss 2.064 | w2v_ctc_loss 1.239 | task_loss 8.619 | contrastive_loss 0.409 | total 6138.43 | n_correct 4392.86 | ppl 4.18 | accuracy 71.563 | uer 16.511 | wer 18.193 | raw_wer 18.193 | bleu 28.78 | wps 1770 | wpb 6138.4 | bsz 201.1 | num_updates 50000 | best_bleu 29.31
2023-08-29 23:02:52 | INFO | fairseq.checkpoint_utils | Preparing to save checkpoint for epoch 43 @ 50000 updates
2023-08-29 23:02:52 | INFO | fairseq.trainer | Saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_43_50000.pt
2023-08-29 23:02:54 | INFO | fairseq.trainer | Finished saving checkpoint to /mnt/zhangyh/fairseq-AT/egs/pretrain-all/checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_43_50000.pt
2023-08-29 23:02:59 | INFO | fairseq.checkpoint_utils | Saved checkpoint ./checkpoints/mustc/st/enfr_shrink_v2_merge_wmt_0829_both_topCL_AT_sentence_mixup0307_scale2.5_alpha1.5_mt0.5_nograd/checkpoint_43_50000.pt (epoch 43 @ 50000 updates, score 28.78) (writing took 6.3836970279953675 seconds)
2023-08-29 23:02:59 | INFO | fairseq_cli.train | end of epoch 43 (average epoch stats below)
2023-08-29 23:02:59 | INFO | train | epoch 043 | loss 1.747 | trans_loss 4.463 | nll_loss 1.614 | w2v_ctc_loss 0.458 | task_loss 2.011 | contrastive_loss 0.122 | total 6690 | n_correct 5036 | ppl 3.06 | accuracy 75.277 | wps 279.9 | ups 0.02 | wpb 13380 | bsz 432 | num_updates 50000 | lr 6.32456e-05 | gnorm 0.406 | clip 0 | loss_scale 8 | train_wall 1 | gb_free 14.3 | wall 43323
2023-08-29 23:02:59 | INFO | fairseq_cli.train | done training in 43267.1 seconds
Exception in thread Thread-7:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
Exception in thread Thread-3:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
Exception in thread Thread-6:
Traceback (most recent call last):
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/site-packages/tensorboardX/event_file_writer.py", line 202, in run
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    data = self._queue.get(True, queue_wait_duration)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/queues.py", line 111, in get
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
    res = self._recv_bytes()
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/connection.py", line 383, in _recv
    raise EOFError
EOFError
/mnt/zhangyh/miniconda3/envs/at/lib/python3.8/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 1760 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
